var V_e=Object.create;var tR=Object.defineProperty,B_e=Object.defineProperties,U_e=Object.getOwnPropertyDescriptor,W_e=Object.getOwnPropertyDescriptors,j_e=Object.getOwnPropertyNames,eR=Object.getOwnPropertySymbols,$_e=Object.getPrototypeOf,Hk=Object.prototype.hasOwnProperty,iG=Object.prototype.propertyIsEnumerable;var rG=(t,e,n)=>e in t?tR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ee=(t,e)=>{for(var n in e||={})Hk.call(e,n)&&rG(t,n,e[n]);if(eR)for(var n of eR(e))iG.call(e,n)&&rG(t,n,e[n]);return t},ft=(t,e)=>B_e(t,W_e(e));var Dm=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var tr=(t,e)=>{var n={};for(var r in t)Hk.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&eR)for(var r of eR(t))e.indexOf(r)<0&&iG.call(t,r)&&(n[r]=t[r]);return n};var We=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),G_e=(t,e)=>{for(var n in e)tR(t,n,{get:e[n],enumerable:!0})},z_e=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of j_e(e))!Hk.call(t,i)&&i!==n&&tR(t,i,{get:()=>e[i],enumerable:!(r=U_e(e,i))||r.enumerable});return t};var Q=(t,e,n)=>(n=t!=null?V_e($_e(t)):{},z_e(e||!t||!t.__esModule?tR(n,"default",{value:t,enumerable:!0}):n,t));var Vk=(t,e,n)=>new Promise((r,i)=>{var o=l=>{try{a(n.next(l))}catch(c){i(c)}},s=l=>{try{a(n.throw(l))}catch(c){i(c)}},a=l=>l.done?r(l.value):Promise.resolve(l.value).then(o,s);a((n=n.apply(t,e)).next())});var Bo=We((b3,Fee)=>{"use strict";var nS=function(t){return t&&t.Math===Math&&t};Fee.exports=nS(typeof globalThis=="object"&&globalThis)||nS(typeof window=="object"&&window)||nS(typeof self=="object"&&self)||nS(typeof global=="object"&&global)||nS(typeof b3=="object"&&b3)||function(){return this}()||Function("return this")()});var Ia=We((D1t,Lee)=>{"use strict";Lee.exports=function(t){try{return!!t()}catch{return!0}}});var dc=We((I1t,Hee)=>{"use strict";var o8e=Ia();Hee.exports=!o8e(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7})});var rS=We((A1t,Vee)=>{"use strict";var s8e=Ia();Vee.exports=!s8e(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")})});var iS=We((M1t,Bee)=>{"use strict";var a8e=rS(),HA=Function.prototype.call;Bee.exports=a8e?HA.bind(HA):function(){return HA.apply(HA,arguments)}});var $ee=We(jee=>{"use strict";var Uee={}.propertyIsEnumerable,Wee=Object.getOwnPropertyDescriptor,l8e=Wee&&!Uee.call({1:2},1);jee.f=l8e?function(e){var n=Wee(this,e);return!!n&&n.enumerable}:Uee});var VA=We((N1t,Gee)=>{"use strict";Gee.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}});var cs=We((P1t,qee)=>{"use strict";var zee=rS(),Yee=Function.prototype,T3=Yee.call,c8e=zee&&Yee.bind.bind(T3,T3);qee.exports=zee?c8e:function(t){return function(){return T3.apply(t,arguments)}}});var Vp=We((k1t,Xee)=>{"use strict";var Kee=cs(),u8e=Kee({}.toString),d8e=Kee("".slice);Xee.exports=function(t){return d8e(u8e(t),8,-1)}});var Qee=We((F1t,Zee)=>{"use strict";var h8e=cs(),f8e=Ia(),m8e=Vp(),R3=Object,p8e=h8e("".split);Zee.exports=f8e(function(){return!R3("z").propertyIsEnumerable(0)})?function(t){return m8e(t)==="String"?p8e(t,""):R3(t)}:R3});var D3=We((L1t,Jee)=>{"use strict";Jee.exports=function(t){return t==null}});var I3=We((H1t,ete)=>{"use strict";var g8e=D3(),v8e=TypeError;ete.exports=function(t){if(g8e(t))throw new v8e("Can't call method on "+t);return t}});var oS=We((V1t,tte)=>{"use strict";var w8e=Qee(),y8e=I3();tte.exports=function(t){return w8e(y8e(t))}});var M3=We((B1t,nte)=>{"use strict";var A3=typeof document=="object"&&document.all,_8e=typeof A3>"u"&&A3!==void 0;nte.exports={all:A3,IS_HTMLDDA:_8e}});var vo=We((U1t,ite)=>{"use strict";var rte=M3(),C8e=rte.all;ite.exports=rte.IS_HTMLDDA?function(t){return typeof t=="function"||t===C8e}:function(t){return typeof t=="function"}});var bf=We((W1t,ate)=>{"use strict";var ote=vo(),ste=M3(),S8e=ste.all;ate.exports=ste.IS_HTMLDDA?function(t){return typeof t=="object"?t!==null:ote(t)||t===S8e}:function(t){return typeof t=="object"?t!==null:ote(t)}});var qv=We((j1t,lte)=>{"use strict";var O3=Bo(),E8e=vo(),x8e=function(t){return E8e(t)?t:void 0};lte.exports=function(t,e){return arguments.length<2?x8e(O3[t]):O3[t]&&O3[t][e]}});var N3=We(($1t,cte)=>{"use strict";var b8e=cs();cte.exports=b8e({}.isPrototypeOf)});var BA=We((G1t,ute)=>{"use strict";ute.exports=typeof navigator<"u"&&String(navigator.userAgent)||""});var vte=We((z1t,gte)=>{"use strict";var pte=Bo(),P3=BA(),dte=pte.process,hte=pte.Deno,fte=dte&&dte.versions||hte&&hte.version,mte=fte&&fte.v8,hc,UA;mte&&(hc=mte.split("."),UA=hc[0]>0&&hc[0]<4?1:+(hc[0]+hc[1]));!UA&&P3&&(hc=P3.match(/Edge\/(\d+)/),(!hc||hc[1]>=74)&&(hc=P3.match(/Chrome\/(\d+)/),hc&&(UA=+hc[1])));gte.exports=UA});var WA=We((Y1t,yte)=>{"use strict";var wte=vte(),T8e=Ia(),R8e=Bo(),D8e=R8e.String;yte.exports=!!Object.getOwnPropertySymbols&&!T8e(function(){var t=Symbol("symbol detection");return!D8e(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&wte&&wte<41})});var k3=We((q1t,_te)=>{"use strict";var I8e=WA();_te.exports=I8e&&!Symbol.sham&&typeof Symbol.iterator=="symbol"});var jA=We((K1t,Cte)=>{"use strict";var A8e=qv(),M8e=vo(),O8e=N3(),N8e=k3(),P8e=Object;Cte.exports=N8e?function(t){return typeof t=="symbol"}:function(t){var e=A8e("Symbol");return M8e(e)&&O8e(e.prototype,P8e(t))}});var F3=We((X1t,Ste)=>{"use strict";var k8e=String;Ste.exports=function(t){try{return k8e(t)}catch{return"Object"}}});var $A=We((Z1t,Ete)=>{"use strict";var F8e=vo(),L8e=F3(),H8e=TypeError;Ete.exports=function(t){if(F8e(t))return t;throw new H8e(L8e(t)+" is not a function")}});var bte=We((Q1t,xte)=>{"use strict";var V8e=$A(),B8e=D3();xte.exports=function(t,e){var n=t[e];return B8e(n)?void 0:V8e(n)}});var Rte=We((J1t,Tte)=>{"use strict";var L3=iS(),H3=vo(),V3=bf(),U8e=TypeError;Tte.exports=function(t,e){var n,r;if(e==="string"&&H3(n=t.toString)&&!V3(r=L3(n,t))||H3(n=t.valueOf)&&!V3(r=L3(n,t))||e!=="string"&&H3(n=t.toString)&&!V3(r=L3(n,t)))return r;throw new U8e("Can't convert object to primitive value")}});var B3=We((eSt,Dte)=>{"use strict";Dte.exports=!1});var GA=We((tSt,Ate)=>{"use strict";var Ite=Bo(),W8e=Object.defineProperty;Ate.exports=function(t,e){try{W8e(Ite,t,{value:e,configurable:!0,writable:!0})}catch{Ite[t]=e}return e}});var zA=We((nSt,Ote)=>{"use strict";var j8e=Bo(),$8e=GA(),Mte="__core-js_shared__",G8e=j8e[Mte]||$8e(Mte,{});Ote.exports=G8e});var U3=We((rSt,Pte)=>{"use strict";var z8e=B3(),Nte=zA();(Pte.exports=function(t,e){return Nte[t]||(Nte[t]=e!==void 0?e:{})})("versions",[]).push({version:"3.34.0",mode:z8e?"pure":"global",copyright:"\xA9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.34.0/LICENSE",source:"https://github.com/zloirock/core-js"})});var sS=We((iSt,kte)=>{"use strict";var Y8e=I3(),q8e=Object;kte.exports=function(t){return q8e(Y8e(t))}});var gu=We((oSt,Fte)=>{"use strict";var K8e=cs(),X8e=sS(),Z8e=K8e({}.hasOwnProperty);Fte.exports=Object.hasOwn||function(e,n){return Z8e(X8e(e),n)}});var W3=We((sSt,Lte)=>{"use strict";var Q8e=cs(),J8e=0,e6e=Math.random(),t6e=Q8e(1 .toString);Lte.exports=function(t){return"Symbol("+(t===void 0?"":t)+")_"+t6e(++J8e+e6e,36)}});var aS=We((aSt,Vte)=>{"use strict";var n6e=Bo(),r6e=U3(),Hte=gu(),i6e=W3(),o6e=WA(),s6e=k3(),Kv=n6e.Symbol,j3=r6e("wks"),a6e=s6e?Kv.for||Kv:Kv&&Kv.withoutSetter||i6e;Vte.exports=function(t){return Hte(j3,t)||(j3[t]=o6e&&Hte(Kv,t)?Kv[t]:a6e("Symbol."+t)),j3[t]}});var jte=We((lSt,Wte)=>{"use strict";var l6e=iS(),Bte=bf(),Ute=jA(),c6e=bte(),u6e=Rte(),d6e=aS(),h6e=TypeError,f6e=d6e("toPrimitive");Wte.exports=function(t,e){if(!Bte(t)||Ute(t))return t;var n=c6e(t,f6e),r;if(n){if(e===void 0&&(e="default"),r=l6e(n,t,e),!Bte(r)||Ute(r))return r;throw new h6e("Can't convert object to primitive value")}return e===void 0&&(e="number"),u6e(t,e)}});var $3=We((cSt,$te)=>{"use strict";var m6e=jte(),p6e=jA();$te.exports=function(t){var e=m6e(t,"string");return p6e(e)?e:e+""}});var YA=We((uSt,zte)=>{"use strict";var g6e=Bo(),Gte=bf(),G3=g6e.document,v6e=Gte(G3)&&Gte(G3.createElement);zte.exports=function(t){return v6e?G3.createElement(t):{}}});var z3=We((dSt,Yte)=>{"use strict";var w6e=dc(),y6e=Ia(),_6e=YA();Yte.exports=!w6e&&!y6e(function(){return Object.defineProperty(_6e("div"),"a",{get:function(){return 7}}).a!==7})});var Y3=We(Kte=>{"use strict";var C6e=dc(),S6e=iS(),E6e=$ee(),x6e=VA(),b6e=oS(),T6e=$3(),R6e=gu(),D6e=z3(),qte=Object.getOwnPropertyDescriptor;Kte.f=C6e?qte:function(e,n){if(e=b6e(e),n=T6e(n),D6e)try{return qte(e,n)}catch{}if(R6e(e,n))return x6e(!S6e(E6e.f,e,n),e[n])}});var q3=We((fSt,Xte)=>{"use strict";var I6e=dc(),A6e=Ia();Xte.exports=I6e&&A6e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42})});var Xv=We((mSt,Zte)=>{"use strict";var M6e=bf(),O6e=String,N6e=TypeError;Zte.exports=function(t){if(M6e(t))return t;throw new N6e(O6e(t)+" is not an object")}});var Bp=We(Jte=>{"use strict";var P6e=dc(),k6e=z3(),F6e=q3(),qA=Xv(),Qte=$3(),L6e=TypeError,K3=Object.defineProperty,H6e=Object.getOwnPropertyDescriptor,X3="enumerable",Z3="configurable",Q3="writable";Jte.f=P6e?F6e?function(e,n,r){if(qA(e),n=Qte(n),qA(r),typeof e=="function"&&n==="prototype"&&"value"in r&&Q3 in r&&!r[Q3]){var i=H6e(e,n);i&&i[Q3]&&(e[n]=r.value,r={configurable:Z3 in r?r[Z3]:i[Z3],enumerable:X3 in r?r[X3]:i[X3],writable:!1})}return K3(e,n,r)}:K3:function(e,n,r){if(qA(e),n=Qte(n),qA(r),k6e)try{return K3(e,n,r)}catch{}if("get"in r||"set"in r)throw new L6e("Accessors not supported");return"value"in r&&(e[n]=r.value),e}});var Zv=We((gSt,ene)=>{"use strict";var V6e=dc(),B6e=Bp(),U6e=VA();ene.exports=V6e?function(t,e,n){return B6e.f(t,e,U6e(1,n))}:function(t,e,n){return t[e]=n,t}});var rne=We((vSt,nne)=>{"use strict";var J3=dc(),W6e=gu(),tne=Function.prototype,j6e=J3&&Object.getOwnPropertyDescriptor,e4=W6e(tne,"name"),$6e=e4&&(function(){}).name==="something",G6e=e4&&(!J3||J3&&j6e(tne,"name").configurable);nne.exports={EXISTS:e4,PROPER:$6e,CONFIGURABLE:G6e}});var one=We((wSt,ine)=>{"use strict";var z6e=cs(),Y6e=vo(),t4=zA(),q6e=z6e(Function.toString);Y6e(t4.inspectSource)||(t4.inspectSource=function(t){return q6e(t)});ine.exports=t4.inspectSource});var lne=We((ySt,ane)=>{"use strict";var K6e=Bo(),X6e=vo(),sne=K6e.WeakMap;ane.exports=X6e(sne)&&/native code/.test(String(sne))});var n4=We((_St,une)=>{"use strict";var Z6e=U3(),Q6e=W3(),cne=Z6e("keys");une.exports=function(t){return cne[t]||(cne[t]=Q6e(t))}});var KA=We((CSt,dne)=>{"use strict";dne.exports={}});var pne=We((SSt,mne)=>{"use strict";var J6e=lne(),fne=Bo(),e5e=bf(),t5e=Zv(),r4=gu(),i4=zA(),n5e=n4(),r5e=KA(),hne="Object already initialized",o4=fne.TypeError,i5e=fne.WeakMap,XA,lS,ZA,o5e=function(t){return ZA(t)?lS(t):XA(t,{})},s5e=function(t){return function(e){var n;if(!e5e(e)||(n=lS(e)).type!==t)throw new o4("Incompatible receiver, "+t+" required");return n}};J6e||i4.state?(fc=i4.state||(i4.state=new i5e),fc.get=fc.get,fc.has=fc.has,fc.set=fc.set,XA=function(t,e){if(fc.has(t))throw new o4(hne);return e.facade=t,fc.set(t,e),e},lS=function(t){return fc.get(t)||{}},ZA=function(t){return fc.has(t)}):(Up=n5e("state"),r5e[Up]=!0,XA=function(t,e){if(r4(t,Up))throw new o4(hne);return e.facade=t,t5e(t,Up,e),e},lS=function(t){return r4(t,Up)?t[Up]:{}},ZA=function(t){return r4(t,Up)});var fc,Up;mne.exports={set:XA,get:lS,has:ZA,enforce:o5e,getterFor:s5e}});var yne=We((ESt,wne)=>{"use strict";var a4=cs(),a5e=Ia(),l5e=vo(),QA=gu(),s4=dc(),c5e=rne().CONFIGURABLE,u5e=one(),vne=pne(),d5e=vne.enforce,h5e=vne.get,gne=String,JA=Object.defineProperty,f5e=a4("".slice),m5e=a4("".replace),p5e=a4([].join),g5e=s4&&!a5e(function(){return JA(function(){},"length",{value:8}).length!==8}),v5e=String(String).split("String"),w5e=wne.exports=function(t,e,n){f5e(gne(e),0,7)==="Symbol("&&(e="["+m5e(gne(e),/^Symbol\(([^)]*)\)/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!QA(t,"name")||c5e&&t.name!==e)&&(s4?JA(t,"name",{value:e,configurable:!0}):t.name=e),g5e&&n&&QA(n,"arity")&&t.length!==n.arity&&JA(t,"length",{value:n.arity});try{n&&QA(n,"constructor")&&n.constructor?s4&&JA(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=d5e(t);return QA(r,"source")||(r.source=p5e(v5e,typeof e=="string"?e:"")),t};Function.prototype.toString=w5e(function(){return l5e(this)&&h5e(this).source||u5e(this)},"toString")});var Cne=We((xSt,_ne)=>{"use strict";var y5e=vo(),_5e=Bp(),C5e=yne(),S5e=GA();_ne.exports=function(t,e,n,r){r||(r={});var i=r.enumerable,o=r.name!==void 0?r.name:e;if(y5e(n)&&C5e(n,o,r),r.global)i?t[e]=n:S5e(e,n);else{try{r.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=n:_5e.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t}});var Ene=We((bSt,Sne)=>{"use strict";var E5e=Math.ceil,x5e=Math.floor;Sne.exports=Math.trunc||function(e){var n=+e;return(n>0?x5e:E5e)(n)}});var eM=We((TSt,xne)=>{"use strict";var b5e=Ene();xne.exports=function(t){var e=+t;return e!==e||e===0?0:b5e(e)}});var Tne=We((RSt,bne)=>{"use strict";var T5e=eM(),R5e=Math.max,D5e=Math.min;bne.exports=function(t,e){var n=T5e(t);return n<0?R5e(n+e,0):D5e(n,e)}});var Dne=We((DSt,Rne)=>{"use strict";var I5e=eM(),A5e=Math.min;Rne.exports=function(t){return t>0?A5e(I5e(t),9007199254740991):0}});var cS=We((ISt,Ine)=>{"use strict";var M5e=Dne();Ine.exports=function(t){return M5e(t.length)}});var One=We((ASt,Mne)=>{"use strict";var O5e=oS(),N5e=Tne(),P5e=cS(),Ane=function(t){return function(e,n,r){var i=O5e(e),o=P5e(i),s=N5e(r,o),a;if(t&&n!==n){for(;o>s;)if(a=i[s++],a!==a)return!0}else for(;o>s;s++)if((t||s in i)&&i[s]===n)return t||s||0;return!t&&-1}};Mne.exports={includes:Ane(!0),indexOf:Ane(!1)}});var c4=We((MSt,Pne)=>{"use strict";var k5e=cs(),l4=gu(),F5e=oS(),L5e=One().indexOf,H5e=KA(),Nne=k5e([].push);Pne.exports=function(t,e){var n=F5e(t),r=0,i=[],o;for(o in n)!l4(H5e,o)&&l4(n,o)&&Nne(i,o);for(;e.length>r;)l4(n,o=e[r++])&&(~L5e(i,o)||Nne(i,o));return i}});var tM=We((OSt,kne)=>{"use strict";kne.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]});var Lne=We(Fne=>{"use strict";var V5e=c4(),B5e=tM(),U5e=B5e.concat("length","prototype");Fne.f=Object.getOwnPropertyNames||function(e){return V5e(e,U5e)}});var Vne=We(Hne=>{"use strict";Hne.f=Object.getOwnPropertySymbols});var Une=We((kSt,Bne)=>{"use strict";var W5e=qv(),j5e=cs(),$5e=Lne(),G5e=Vne(),z5e=Xv(),Y5e=j5e([].concat);Bne.exports=W5e("Reflect","ownKeys")||function(e){var n=$5e.f(z5e(e)),r=G5e.f;return r?Y5e(n,r(e)):n}});var u4=We((FSt,jne)=>{"use strict";var Wne=gu(),q5e=Une(),K5e=Y3(),X5e=Bp();jne.exports=function(t,e,n){for(var r=q5e(e),i=X5e.f,o=K5e.f,s=0;s<r.length;s++){var a=r[s];!Wne(t,a)&&!(n&&Wne(n,a))&&i(t,a,o(e,a))}}});var Gne=We((LSt,$ne)=>{"use strict";var Z5e=Ia(),Q5e=vo(),J5e=/#|\.prototype\./,uS=function(t,e){var n=tje[eje(t)];return n===rje?!0:n===nje?!1:Q5e(e)?Z5e(e):!!e},eje=uS.normalize=function(t){return String(t).replace(J5e,".").toLowerCase()},tje=uS.data={},nje=uS.NATIVE="N",rje=uS.POLYFILL="P";$ne.exports=uS});var Tf=We((HSt,zne)=>{"use strict";var d4=Bo(),ije=Y3().f,oje=Zv(),sje=Cne(),aje=GA(),lje=u4(),cje=Gne();zne.exports=function(t,e){var n=t.target,r=t.global,i=t.stat,o,s,a,l,c,u;if(r?s=d4:i?s=d4[n]||aje(n,{}):s=(d4[n]||{}).prototype,s)for(a in e){if(c=e[a],t.dontCallGetSet?(u=ije(s,a),l=u&&u.value):l=s[a],o=cje(r?a:n+(i?".":"#")+a,t.forced),!o&&l!==void 0){if(typeof c==typeof l)continue;lje(c,l)}(t.sham||l&&l.sham)&&oje(c,"sham",!0),sje(s,a,c,t)}}});var h4=We((VSt,Yne)=>{"use strict";var uje=Vp();Yne.exports=Array.isArray||function(e){return uje(e)==="Array"}});var f4=We((BSt,qne)=>{"use strict";var dje=dc(),hje=h4(),fje=TypeError,mje=Object.getOwnPropertyDescriptor,pje=dje&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();qne.exports=pje?function(t,e){if(hje(t)&&!mje(t,"length").writable)throw new fje("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}});var m4=We((USt,Kne)=>{"use strict";var gje=TypeError,vje=9007199254740991;Kne.exports=function(t){if(t>vje)throw gje("Maximum allowed index exceeded");return t}});var ze=We(()=>{"use strict";var wje=Tf(),yje=sS(),_je=cS(),Cje=f4(),Sje=m4(),Eje=Ia(),xje=Eje(function(){return[].push.call({length:4294967296},1)!==4294967297}),bje=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},Tje=xje||!bje();wje({target:"Array",proto:!0,arity:1,forced:Tje},{push:function(e){var n=yje(this),r=_je(n),i=arguments.length;Sje(r+i);for(var o=0;o<i;o++)n[r]=arguments[o],r++;return Cje(n,r),r}})});var dS=We(($St,Jne)=>{"use strict";var Rje=rS(),Qne=Function.prototype,Xne=Qne.apply,Zne=Qne.call;Jne.exports=typeof Reflect=="object"&&Reflect.apply||(Rje?Zne.bind(Xne):function(){return Zne.apply(Xne,arguments)})});var tre=We((GSt,ere)=>{"use strict";var Dje=cs(),Ije=$A();ere.exports=function(t,e,n){try{return Dje(Ije(Object.getOwnPropertyDescriptor(t,e)[n]))}catch{}}});var rre=We((zSt,nre)=>{"use strict";var Aje=vo(),Mje=String,Oje=TypeError;nre.exports=function(t){if(typeof t=="object"||Aje(t))return t;throw new Oje("Can't set "+Mje(t)+" as a prototype")}});var p4=We((YSt,ire)=>{"use strict";var Nje=tre(),Pje=Xv(),kje=rre();ire.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},n;try{n=Nje(Object.prototype,"__proto__","set"),n(e,[]),t=e instanceof Array}catch{}return function(i,o){return Pje(i),kje(o),t?n(i,o):i.__proto__=o,i}}():void 0)});var sre=We((qSt,ore)=>{"use strict";var Fje=Bp().f;ore.exports=function(t,e,n){n in t||Fje(t,n,{configurable:!0,get:function(){return e[n]},set:function(r){e[n]=r}})}});var cre=We((KSt,lre)=>{"use strict";var Lje=vo(),Hje=bf(),are=p4();lre.exports=function(t,e,n){var r,i;return are&&Lje(r=e.constructor)&&r!==n&&Hje(i=r.prototype)&&i!==n.prototype&&are(t,i),t}});var hre=We((XSt,dre)=>{"use strict";var Vje=aS(),Bje=Vje("toStringTag"),ure={};ure[Bje]="z";dre.exports=String(ure)==="[object z]"});var mre=We((ZSt,fre)=>{"use strict";var Uje=hre(),Wje=vo(),nM=Vp(),jje=aS(),$je=jje("toStringTag"),Gje=Object,zje=nM(function(){return arguments}())==="Arguments",Yje=function(t,e){try{return t[e]}catch{}};fre.exports=Uje?nM:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=Yje(e=Gje(t),$je))=="string"?n:zje?nM(e):(r=nM(e))==="Object"&&Wje(e.callee)?"Arguments":r}});var g4=We((QSt,pre)=>{"use strict";var qje=mre(),Kje=String;pre.exports=function(t){if(qje(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return Kje(t)}});var vre=We((JSt,gre)=>{"use strict";var Xje=g4();gre.exports=function(t,e){return t===void 0?arguments.length<2?"":e:Xje(t)}});var yre=We((eEt,wre)=>{"use strict";var Zje=bf(),Qje=Zv();wre.exports=function(t,e){Zje(e)&&"cause"in e&&Qje(t,"cause",e.cause)}});var Ere=We((tEt,Sre)=>{"use strict";var Jje=cs(),_re=Error,e$e=Jje("".replace),t$e=function(t){return String(new _re(t).stack)}("zxcasd"),Cre=/\n\s*at [^:]*:[^\n]*/,n$e=Cre.test(t$e);Sre.exports=function(t,e){if(n$e&&typeof t=="string"&&!_re.prepareStackTrace)for(;e--;)t=e$e(t,Cre,"");return t}});var bre=We((nEt,xre)=>{"use strict";var r$e=Ia(),i$e=VA();xre.exports=!r$e(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",i$e(1,7)),t.stack!==7):!0})});var Dre=We((rEt,Rre)=>{"use strict";var o$e=Zv(),s$e=Ere(),a$e=bre(),Tre=Error.captureStackTrace;Rre.exports=function(t,e,n,r){a$e&&(Tre?Tre(t,e):o$e(t,"stack",s$e(n,r)))}});var Fre=We((iEt,kre)=>{"use strict";var Ire=qv(),l$e=gu(),Are=Zv(),c$e=N3(),Mre=p4(),Ore=u4(),Nre=sre(),u$e=cre(),d$e=vre(),h$e=yre(),f$e=Dre(),m$e=dc(),Pre=B3();kre.exports=function(t,e,n,r){var i="stackTraceLimit",o=r?2:1,s=t.split("."),a=s[s.length-1],l=Ire.apply(null,s);if(l){var c=l.prototype;if(!Pre&&l$e(c,"cause")&&delete c.cause,!n)return l;var u=Ire("Error"),d=e(function(h,f){var p=d$e(r?f:h,void 0),g=r?new l(h):new l;return p!==void 0&&Are(g,"message",p),f$e(g,d,g.stack,2),this&&c$e(c,this)&&u$e(g,this,d),arguments.length>o&&h$e(g,arguments[o]),g});if(d.prototype=c,a!=="Error"?Mre?Mre(d,u):Ore(d,u,{name:!0}):m$e&&i in l&&(Nre(d,l,i),Nre(d,l,"prepareStackTrace")),Ore(d,l),!Pre)try{c.name!==a&&Are(c,"name",a),c.constructor=d}catch{}return d}}});var De=We(()=>{"use strict";var Hre=Tf(),p$e=Bo(),vu=dS(),Vre=Fre(),v4="WebAssembly",Lre=p$e[v4],rM=new Error("e",{cause:7}).cause!==7,Wp=function(t,e){var n={};n[t]=Vre(t,e,rM),Hre({global:!0,constructor:!0,arity:1,forced:rM},n)},w4=function(t,e){if(Lre&&Lre[t]){var n={};n[t]=Vre(v4+"."+t,e,rM),Hre({target:v4,stat:!0,constructor:!0,arity:1,forced:rM},n)}};Wp("Error",function(t){return function(n){return vu(t,this,arguments)}});Wp("EvalError",function(t){return function(n){return vu(t,this,arguments)}});Wp("RangeError",function(t){return function(n){return vu(t,this,arguments)}});Wp("ReferenceError",function(t){return function(n){return vu(t,this,arguments)}});Wp("SyntaxError",function(t){return function(n){return vu(t,this,arguments)}});Wp("TypeError",function(t){return function(n){return vu(t,this,arguments)}});Wp("URIError",function(t){return function(n){return vu(t,this,arguments)}});w4("CompileError",function(t){return function(n){return vu(t,this,arguments)}});w4("LinkError",function(t){return function(n){return vu(t,this,arguments)}});w4("RuntimeError",function(t){return function(n){return vu(t,this,arguments)}})});var Ure=We((aEt,Bre)=>{"use strict";var g$e=Vp(),v$e=cs();Bre.exports=function(t){if(g$e(t)==="Function")return v$e(t)}});var $re=We((lEt,jre)=>{"use strict";var Wre=Ure(),w$e=$A(),y$e=rS(),_$e=Wre(Wre.bind);jre.exports=function(t,e){return w$e(t),e===void 0?t:y$e?_$e(t,e):function(){return t.apply(e,arguments)}}});var y4=We((cEt,Gre)=>{"use strict";var C$e=qv();Gre.exports=C$e("document","documentElement")});var iM=We((uEt,zre)=>{"use strict";var S$e=cs();zre.exports=S$e([].slice)});var _4=We((dEt,Yre)=>{"use strict";var E$e=TypeError;Yre.exports=function(t,e){if(t<e)throw new E$e("Not enough arguments");return t}});var Kre=We((hEt,qre)=>{"use strict";var x$e=BA();qre.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(x$e)});var Zre=We((fEt,Xre)=>{"use strict";var b$e=Bo(),T$e=Vp();Xre.exports=T$e(b$e.process)==="process"});var I4=We((mEt,sie)=>{"use strict";var Aa=Bo(),R$e=dS(),D$e=$re(),Qre=vo(),I$e=gu(),oie=Ia(),Jre=y4(),A$e=iM(),eie=YA(),M$e=_4(),O$e=Kre(),N$e=Zre(),T4=Aa.setImmediate,R4=Aa.clearImmediate,P$e=Aa.process,C4=Aa.Dispatch,k$e=Aa.Function,tie=Aa.MessageChannel,F$e=Aa.String,S4=0,hS={},nie="onreadystatechange",fS,jp,E4,x4;oie(function(){fS=Aa.location});var D4=function(t){if(I$e(hS,t)){var e=hS[t];delete hS[t],e()}},b4=function(t){return function(){D4(t)}},rie=function(t){D4(t.data)},iie=function(t){Aa.postMessage(F$e(t),fS.protocol+"//"+fS.host)};(!T4||!R4)&&(T4=function(e){M$e(arguments.length,1);var n=Qre(e)?e:k$e(e),r=A$e(arguments,1);return hS[++S4]=function(){R$e(n,void 0,r)},jp(S4),S4},R4=function(e){delete hS[e]},N$e?jp=function(t){P$e.nextTick(b4(t))}:C4&&C4.now?jp=function(t){C4.now(b4(t))}:tie&&!O$e?(E4=new tie,x4=E4.port2,E4.port1.onmessage=rie,jp=D$e(x4.postMessage,x4)):Aa.addEventListener&&Qre(Aa.postMessage)&&!Aa.importScripts&&fS&&fS.protocol!=="file:"&&!oie(iie)?(jp=iie,Aa.addEventListener("message",rie,!1)):nie in eie("script")?jp=function(t){Jre.appendChild(eie("script"))[nie]=function(){Jre.removeChild(this),D4(t)}}:jp=function(t){setTimeout(b4(t),0)});sie.exports={set:T4,clear:R4}});var lie=We(()=>{"use strict";var L$e=Tf(),H$e=Bo(),aie=I4().clear;L$e({global:!0,bind:!0,enumerable:!0,forced:H$e.clearImmediate!==aie},{clearImmediate:aie})});var uie=We((vEt,cie)=>{"use strict";cie.exports=typeof Bun=="function"&&Bun&&typeof Bun.version=="string"});var fie=We((wEt,hie)=>{"use strict";var die=Bo(),V$e=dS(),B$e=vo(),U$e=uie(),W$e=BA(),j$e=iM(),$$e=_4(),G$e=die.Function,z$e=/MSIE .\./.test(W$e)||U$e&&function(){var t=die.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}();hie.exports=function(t,e){var n=e?2:1;return z$e?function(r,i){var o=$$e(arguments.length,1)>n,s=B$e(r)?r:G$e(r),a=o?j$e(arguments,n):[],l=o?function(){V$e(s,this,a)}:s;return e?t(l,i):t(l)}:t}});var vie=We(()=>{"use strict";var Y$e=Tf(),gie=Bo(),mie=I4().set,q$e=fie(),pie=gie.setImmediate?q$e(mie,!1):mie;Y$e({global:!0,bind:!0,enumerable:!0,forced:gie.setImmediate!==pie},{setImmediate:pie})});var wie=We(()=>{"use strict";lie();vie()});var yie=We((A4,M4)=>{(function(t,e){typeof A4=="object"&&typeof M4<"u"?M4.exports=e():typeof define=="function"&&define.amd?define(e):(t=typeof globalThis<"u"?globalThis:t||self,t.DOMPurify=e())})(A4,function(){"use strict";function t(ne){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ce){return typeof ce}:function(ce){return ce&&typeof Symbol=="function"&&ce.constructor===Symbol&&ce!==Symbol.prototype?"symbol":typeof ce},t(ne)}function e(ne,ce){return e=Object.setPrototypeOf||function(ge,Ve){return ge.__proto__=Ve,ge},e(ne,ce)}function n(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function r(ne,ce,oe){return n()?r=Reflect.construct:r=function(Ve,ke,Xe){var gt=[null];gt.push.apply(gt,ke);var Mt=Function.bind.apply(Ve,gt),Nt=new Mt;return Xe&&e(Nt,Xe.prototype),Nt},r.apply(null,arguments)}function i(ne){return o(ne)||s(ne)||a(ne)||c()}function o(ne){if(Array.isArray(ne))return l(ne)}function s(ne){if(typeof Symbol<"u"&&ne[Symbol.iterator]!=null||ne["@@iterator"]!=null)return Array.from(ne)}function a(ne,ce){if(ne){if(typeof ne=="string")return l(ne,ce);var oe=Object.prototype.toString.call(ne).slice(8,-1);if(oe==="Object"&&ne.constructor&&(oe=ne.constructor.name),oe==="Map"||oe==="Set")return Array.from(ne);if(oe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(oe))return l(ne,ce)}}function l(ne,ce){(ce==null||ce>ne.length)&&(ce=ne.length);for(var oe=0,ge=new Array(ce);oe<ce;oe++)ge[oe]=ne[oe];return ge}function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var u=Object.hasOwnProperty,d=Object.setPrototypeOf,h=Object.isFrozen,f=Object.getPrototypeOf,p=Object.getOwnPropertyDescriptor,g=Object.freeze,w=Object.seal,_=Object.create,S=typeof Reflect<"u"&&Reflect,x=S.apply,P=S.construct;x||(x=function(ce,oe,ge){return ce.apply(oe,ge)}),g||(g=function(ce){return ce}),w||(w=function(ce){return ce}),P||(P=function(ce,oe){return r(ce,i(oe))});var k=L(Array.prototype.forEach),b=L(Array.prototype.pop),C=L(Array.prototype.push),N=L(String.prototype.toLowerCase),B=L(String.prototype.toString),Y=L(String.prototype.match),ee=L(String.prototype.replace),te=L(String.prototype.indexOf),Ce=L(String.prototype.trim),Re=L(RegExp.prototype.test),_e=M(TypeError);function L(ne){return function(ce){for(var oe=arguments.length,ge=new Array(oe>1?oe-1:0),Ve=1;Ve<oe;Ve++)ge[Ve-1]=arguments[Ve];return x(ne,ce,ge)}}function M(ne){return function(){for(var ce=arguments.length,oe=new Array(ce),ge=0;ge<ce;ge++)oe[ge]=arguments[ge];return P(ne,oe)}}function q(ne,ce,oe){var ge;oe=(ge=oe)!==null&&ge!==void 0?ge:N,d&&d(ne,null);for(var Ve=ce.length;Ve--;){var ke=ce[Ve];if(typeof ke=="string"){var Xe=oe(ke);Xe!==ke&&(h(ce)||(ce[Ve]=Xe),ke=Xe)}ne[ke]=!0}return ne}function y(ne){var ce=_(null),oe;for(oe in ne)x(u,ne,[oe])===!0&&(ce[oe]=ne[oe]);return ce}function E(ne,ce){for(;ne!==null;){var oe=p(ne,ce);if(oe){if(oe.get)return L(oe.get);if(typeof oe.value=="function")return L(oe.value)}ne=f(ne)}function ge(Ve){return console.warn("fallback value for",Ve),null}return ge}var R=g(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),D=g(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),A=g(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),O=g(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),U=g(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ie=g(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),ue=g(["#text"]),fe=g(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),de=g(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ye=g(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Pe=g(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=w(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ke=w(/<%[\w\W]*|[\w\W]*%>/gm),$e=w(/\${[\w\W]*}/gm),rt=w(/^data-[\-\w.\u00B7-\uFFFF]/),Ye=w(/^aria-[\-\w]+$/),Me=w(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),j=w(/^(?:\w+script|data):/i),z=w(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),J=w(/^html$/i),pe=function(){return typeof window>"u"?null:window},he=function(ce,oe){if(t(ce)!=="object"||typeof ce.createPolicy!="function")return null;var ge=null,Ve="data-tt-policy-suffix";oe.currentScript&&oe.currentScript.hasAttribute(Ve)&&(ge=oe.currentScript.getAttribute(Ve));var ke="dompurify"+(ge?"#"+ge:"");try{return ce.createPolicy(ke,{createHTML:function(gt){return gt},createScriptURL:function(gt){return gt}})}catch{return console.warn("TrustedTypes policy "+ke+" could not be created."),null}};function me(){var ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:pe(),ce=function(Se){return me(Se)};if(ce.version="2.4.7",ce.removed=[],!ne||!ne.document||ne.document.nodeType!==9)return ce.isSupported=!1,ce;var oe=ne.document,ge=ne.document,Ve=ne.DocumentFragment,ke=ne.HTMLTemplateElement,Xe=ne.Node,gt=ne.Element,Mt=ne.NodeFilter,Nt=ne.NamedNodeMap,$t=Nt===void 0?ne.NamedNodeMap||ne.MozNamedAttrMap:Nt,Rn=ne.HTMLFormElement,yr=ne.DOMParser,Mn=ne.trustedTypes,zs=gt.prototype,kl=E(zs,"cloneNode"),ji=E(zs,"nextSibling"),ga=E(zs,"childNodes"),Ir=E(zs,"parentNode");if(typeof ke=="function"){var _r=ge.createElement("template");_r.content&&_r.content.ownerDocument&&(ge=_r.content.ownerDocument)}var vn=he(Mn,oe),Sm=vn?vn.createHTML(""):"",Fl=ge,Em=Fl.implementation,Ku=Fl.createNodeIterator,vh=Fl.createDocumentFragment,Et=Fl.getElementsByTagName,xm=oe.importNode,s0={};try{s0=y(ge).documentMode?ge.documentMode:{}}catch{}var Ar={};ce.isSupported=typeof Ir=="function"&&Em&&Em.createHTMLDocument!==void 0&&s0!==9;var Xu=F,H=Ke,se=$e,X=rt,K=Ye,ae=j,le=z,be=Me,Ae=null,Ie=q({},[].concat(i(R),i(D),i(A),i(U),i(ue))),xe=null,Oe=q({},[].concat(i(fe),i(de),i(ye),i(Pe))),Be=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),tt=null,it=null,nt=!0,ut=!0,Yt=!1,er=!0,qr=!1,sr=!1,$i=!1,Ll=!1,Ys=!1,qs=!1,Hl=!1,ws=!0,NT=!1,vk="user-content-",s_=!0,wh=!1,za={},Zu=null,PT=q({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),kT=null,yh=q({},["audio","video","img","source","image","track"]),_h=null,a_=q({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Bc="http://www.w3.org/1998/Math/MathML",Ks="http://www.w3.org/2000/svg",Vl="http://www.w3.org/1999/xhtml",Ch=Vl,l_=!1,c_=null,wk=q({},[Bc,Ks,Vl],B),Qu,yk=["application/xhtml+xml","text/html"],_k="text/html",ai,Sh=null,FT=ge.createElement("form"),LT=function(Se){return Se instanceof RegExp||Se instanceof Function},u_=function(Se){Sh&&Sh===Se||((!Se||t(Se)!=="object")&&(Se={}),Se=y(Se),Qu=yk.indexOf(Se.PARSER_MEDIA_TYPE)===-1?Qu=_k:Qu=Se.PARSER_MEDIA_TYPE,ai=Qu==="application/xhtml+xml"?B:N,Ae="ALLOWED_TAGS"in Se?q({},Se.ALLOWED_TAGS,ai):Ie,xe="ALLOWED_ATTR"in Se?q({},Se.ALLOWED_ATTR,ai):Oe,c_="ALLOWED_NAMESPACES"in Se?q({},Se.ALLOWED_NAMESPACES,B):wk,_h="ADD_URI_SAFE_ATTR"in Se?q(y(a_),Se.ADD_URI_SAFE_ATTR,ai):a_,kT="ADD_DATA_URI_TAGS"in Se?q(y(yh),Se.ADD_DATA_URI_TAGS,ai):yh,Zu="FORBID_CONTENTS"in Se?q({},Se.FORBID_CONTENTS,ai):PT,tt="FORBID_TAGS"in Se?q({},Se.FORBID_TAGS,ai):{},it="FORBID_ATTR"in Se?q({},Se.FORBID_ATTR,ai):{},za="USE_PROFILES"in Se?Se.USE_PROFILES:!1,nt=Se.ALLOW_ARIA_ATTR!==!1,ut=Se.ALLOW_DATA_ATTR!==!1,Yt=Se.ALLOW_UNKNOWN_PROTOCOLS||!1,er=Se.ALLOW_SELF_CLOSE_IN_ATTR!==!1,qr=Se.SAFE_FOR_TEMPLATES||!1,sr=Se.WHOLE_DOCUMENT||!1,Ys=Se.RETURN_DOM||!1,qs=Se.RETURN_DOM_FRAGMENT||!1,Hl=Se.RETURN_TRUSTED_TYPE||!1,Ll=Se.FORCE_BODY||!1,ws=Se.SANITIZE_DOM!==!1,NT=Se.SANITIZE_NAMED_PROPS||!1,s_=Se.KEEP_CONTENT!==!1,wh=Se.IN_PLACE||!1,be=Se.ALLOWED_URI_REGEXP||be,Ch=Se.NAMESPACE||Vl,Be=Se.CUSTOM_ELEMENT_HANDLING||{},Se.CUSTOM_ELEMENT_HANDLING&&LT(Se.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Be.tagNameCheck=Se.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Se.CUSTOM_ELEMENT_HANDLING&&LT(Se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Be.attributeNameCheck=Se.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Se.CUSTOM_ELEMENT_HANDLING&&typeof Se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Be.allowCustomizedBuiltInElements=Se.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),qr&&(ut=!1),qs&&(Ys=!0),za&&(Ae=q({},i(ue)),xe=[],za.html===!0&&(q(Ae,R),q(xe,fe)),za.svg===!0&&(q(Ae,D),q(xe,de),q(xe,Pe)),za.svgFilters===!0&&(q(Ae,A),q(xe,de),q(xe,Pe)),za.mathMl===!0&&(q(Ae,U),q(xe,ye),q(xe,Pe))),Se.ADD_TAGS&&(Ae===Ie&&(Ae=y(Ae)),q(Ae,Se.ADD_TAGS,ai)),Se.ADD_ATTR&&(xe===Oe&&(xe=y(xe)),q(xe,Se.ADD_ATTR,ai)),Se.ADD_URI_SAFE_ATTR&&q(_h,Se.ADD_URI_SAFE_ATTR,ai),Se.FORBID_CONTENTS&&(Zu===PT&&(Zu=y(Zu)),q(Zu,Se.FORBID_CONTENTS,ai)),s_&&(Ae["#text"]=!0),sr&&q(Ae,["html","head","body"]),Ae.table&&(q(Ae,["tbody"]),delete tt.tbody),g&&g(Se),Sh=Se)},HT=q({},["mi","mo","mn","ms","mtext"]),VT=q({},["foreignobject","desc","title","annotation-xml"]),Ck=q({},["title","style","font","a","script"]),a0=q({},D);q(a0,A),q(a0,O);var d_=q({},U);q(d_,ie);var Sk=function(Se){var Qe=Ir(Se);(!Qe||!Qe.tagName)&&(Qe={namespaceURI:Ch,tagName:"template"});var wt=N(Se.tagName),Un=N(Qe.tagName);return c_[Se.namespaceURI]?Se.namespaceURI===Ks?Qe.namespaceURI===Vl?wt==="svg":Qe.namespaceURI===Bc?wt==="svg"&&(Un==="annotation-xml"||HT[Un]):!!a0[wt]:Se.namespaceURI===Bc?Qe.namespaceURI===Vl?wt==="math":Qe.namespaceURI===Ks?wt==="math"&&VT[Un]:!!d_[wt]:Se.namespaceURI===Vl?Qe.namespaceURI===Ks&&!VT[Un]||Qe.namespaceURI===Bc&&!HT[Un]?!1:!d_[wt]&&(Ck[wt]||!a0[wt]):!!(Qu==="application/xhtml+xml"&&c_[Se.namespaceURI]):!1},Bl=function(Se){C(ce.removed,{element:Se});try{Se.parentNode.removeChild(Se)}catch{try{Se.outerHTML=Sm}catch{Se.remove()}}},h_=function(Se,Qe){try{C(ce.removed,{attribute:Qe.getAttributeNode(Se),from:Qe})}catch{C(ce.removed,{attribute:null,from:Qe})}if(Qe.removeAttribute(Se),Se==="is"&&!xe[Se])if(Ys||qs)try{Bl(Qe)}catch{}else try{Qe.setAttribute(Se,"")}catch{}},BT=function(Se){var Qe,wt;if(Ll)Se="<remove></remove>"+Se;else{var Un=Y(Se,/^[\r\n\t ]+/);wt=Un&&Un[0]}Qu==="application/xhtml+xml"&&Ch===Vl&&(Se='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Se+"</body></html>");var Dn=vn?vn.createHTML(Se):Se;if(Ch===Vl)try{Qe=new yr().parseFromString(Dn,Qu)}catch{}if(!Qe||!Qe.documentElement){Qe=Em.createDocument(Ch,"template",null);try{Qe.documentElement.innerHTML=l_?Sm:Dn}catch{}}var li=Qe.body||Qe.documentElement;return Se&&wt&&li.insertBefore(ge.createTextNode(wt),li.childNodes[0]||null),Ch===Vl?Et.call(Qe,sr?"html":"body")[0]:sr?Qe.documentElement:li},UT=function(Se){return Ku.call(Se.ownerDocument||Se,Se,Mt.SHOW_ELEMENT|Mt.SHOW_COMMENT|Mt.SHOW_TEXT,null,!1)},Ek=function(Se){return Se instanceof Rn&&(typeof Se.nodeName!="string"||typeof Se.textContent!="string"||typeof Se.removeChild!="function"||!(Se.attributes instanceof $t)||typeof Se.removeAttribute!="function"||typeof Se.setAttribute!="function"||typeof Se.namespaceURI!="string"||typeof Se.insertBefore!="function"||typeof Se.hasChildNodes!="function")},bm=function(Se){return t(Xe)==="object"?Se instanceof Xe:Se&&t(Se)==="object"&&typeof Se.nodeType=="number"&&typeof Se.nodeName=="string"},Ul=function(Se,Qe,wt){Ar[Se]&&k(Ar[Se],function(Un){Un.call(ce,Qe,wt,Sh)})},l0=function(Se){var Qe;if(Ul("beforeSanitizeElements",Se,null),Ek(Se)||Re(/[\u0080-\uFFFF]/,Se.nodeName))return Bl(Se),!0;var wt=ai(Se.nodeName);if(Ul("uponSanitizeElement",Se,{tagName:wt,allowedTags:Ae}),Se.hasChildNodes()&&!bm(Se.firstElementChild)&&(!bm(Se.content)||!bm(Se.content.firstElementChild))&&Re(/<[/\w]/g,Se.innerHTML)&&Re(/<[/\w]/g,Se.textContent)||wt==="select"&&Re(/<template/i,Se.innerHTML))return Bl(Se),!0;if(!Ae[wt]||tt[wt]){if(!tt[wt]&&WT(wt)&&(Be.tagNameCheck instanceof RegExp&&Re(Be.tagNameCheck,wt)||Be.tagNameCheck instanceof Function&&Be.tagNameCheck(wt)))return!1;if(s_&&!Zu[wt]){var Un=Ir(Se)||Se.parentNode,Dn=ga(Se)||Se.childNodes;if(Dn&&Un)for(var li=Dn.length,Kr=li-1;Kr>=0;--Kr)Un.insertBefore(kl(Dn[Kr],!0),ji(Se))}return Bl(Se),!0}return Se instanceof gt&&!Sk(Se)||(wt==="noscript"||wt==="noembed"||wt==="noframes")&&Re(/<\/no(script|embed|frames)/i,Se.innerHTML)?(Bl(Se),!0):(qr&&Se.nodeType===3&&(Qe=Se.textContent,Qe=ee(Qe,Xu," "),Qe=ee(Qe,H," "),Qe=ee(Qe,se," "),Se.textContent!==Qe&&(C(ce.removed,{element:Se.cloneNode()}),Se.textContent=Qe)),Ul("afterSanitizeElements",Se,null),!1)},c0=function(Se,Qe,wt){if(ws&&(Qe==="id"||Qe==="name")&&(wt in ge||wt in FT))return!1;if(!(ut&&!it[Qe]&&Re(X,Qe))){if(!(nt&&Re(K,Qe))){if(!xe[Qe]||it[Qe]){if(!(WT(Se)&&(Be.tagNameCheck instanceof RegExp&&Re(Be.tagNameCheck,Se)||Be.tagNameCheck instanceof Function&&Be.tagNameCheck(Se))&&(Be.attributeNameCheck instanceof RegExp&&Re(Be.attributeNameCheck,Qe)||Be.attributeNameCheck instanceof Function&&Be.attributeNameCheck(Qe))||Qe==="is"&&Be.allowCustomizedBuiltInElements&&(Be.tagNameCheck instanceof RegExp&&Re(Be.tagNameCheck,wt)||Be.tagNameCheck instanceof Function&&Be.tagNameCheck(wt))))return!1}else if(!_h[Qe]){if(!Re(be,ee(wt,le,""))){if(!((Qe==="src"||Qe==="xlink:href"||Qe==="href")&&Se!=="script"&&te(wt,"data:")===0&&kT[Se])){if(!(Yt&&!Re(ae,ee(wt,le,"")))){if(wt)return!1}}}}}}return!0},WT=function(Se){return Se.indexOf("-")>0},f_=function(Se){var Qe,wt,Un,Dn;Ul("beforeSanitizeAttributes",Se,null);var li=Se.attributes;if(li){var Kr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(Dn=li.length;Dn--;){Qe=li[Dn];var u0=Qe,Si=u0.name,m_=u0.namespaceURI;if(wt=Si==="value"?Qe.value:Ce(Qe.value),Un=ai(Si),Kr.attrName=Un,Kr.attrValue=wt,Kr.keepAttr=!0,Kr.forceKeepAttr=void 0,Ul("uponSanitizeAttribute",Se,Kr),wt=Kr.attrValue,!Kr.forceKeepAttr&&(h_(Si,Se),!!Kr.keepAttr)){if(!er&&Re(/\/>/i,wt)){h_(Si,Se);continue}qr&&(wt=ee(wt,Xu," "),wt=ee(wt,H," "),wt=ee(wt,se," "));var $T=ai(Se.nodeName);if(c0($T,Un,wt)){if(NT&&(Un==="id"||Un==="name")&&(h_(Si,Se),wt=vk+wt),vn&&t(Mn)==="object"&&typeof Mn.getAttributeType=="function"&&!m_)switch(Mn.getAttributeType($T,Un)){case"TrustedHTML":{wt=vn.createHTML(wt);break}case"TrustedScriptURL":{wt=vn.createScriptURL(wt);break}}try{m_?Se.setAttributeNS(m_,Si,wt):Se.setAttribute(Si,wt),b(ce.removed)}catch{}}}}Ul("afterSanitizeAttributes",Se,null)}},jT=function Lt(Se){var Qe,wt=UT(Se);for(Ul("beforeSanitizeShadowDOM",Se,null);Qe=wt.nextNode();)Ul("uponSanitizeShadowNode",Qe,null),!l0(Qe)&&(Qe.content instanceof Ve&&Lt(Qe.content),f_(Qe));Ul("afterSanitizeShadowDOM",Se,null)};return ce.sanitize=function(Lt){var Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Qe,wt,Un,Dn,li;if(l_=!Lt,l_&&(Lt="<!-->"),typeof Lt!="string"&&!bm(Lt))if(typeof Lt.toString=="function"){if(Lt=Lt.toString(),typeof Lt!="string")throw _e("dirty is not a string, aborting")}else throw _e("toString is not a function");if(!ce.isSupported){if(t(ne.toStaticHTML)==="object"||typeof ne.toStaticHTML=="function"){if(typeof Lt=="string")return ne.toStaticHTML(Lt);if(bm(Lt))return ne.toStaticHTML(Lt.outerHTML)}return Lt}if($i||u_(Se),ce.removed=[],typeof Lt=="string"&&(wh=!1),wh){if(Lt.nodeName){var Kr=ai(Lt.nodeName);if(!Ae[Kr]||tt[Kr])throw _e("root node is forbidden and cannot be sanitized in-place")}}else if(Lt instanceof Xe)Qe=BT("<!---->"),wt=Qe.ownerDocument.importNode(Lt,!0),wt.nodeType===1&&wt.nodeName==="BODY"||wt.nodeName==="HTML"?Qe=wt:Qe.appendChild(wt);else{if(!Ys&&!qr&&!sr&&Lt.indexOf("<")===-1)return vn&&Hl?vn.createHTML(Lt):Lt;if(Qe=BT(Lt),!Qe)return Ys?null:Hl?Sm:""}Qe&&Ll&&Bl(Qe.firstChild);for(var u0=UT(wh?Lt:Qe);Un=u0.nextNode();)Un.nodeType===3&&Un===Dn||l0(Un)||(Un.content instanceof Ve&&jT(Un.content),f_(Un),Dn=Un);if(Dn=null,wh)return Lt;if(Ys){if(qs)for(li=vh.call(Qe.ownerDocument);Qe.firstChild;)li.appendChild(Qe.firstChild);else li=Qe;return(xe.shadowroot||xe.shadowrootmod)&&(li=xm.call(oe,li,!0)),li}var Si=sr?Qe.outerHTML:Qe.innerHTML;return sr&&Ae["!doctype"]&&Qe.ownerDocument&&Qe.ownerDocument.doctype&&Qe.ownerDocument.doctype.name&&Re(J,Qe.ownerDocument.doctype.name)&&(Si="<!DOCTYPE "+Qe.ownerDocument.doctype.name+`>
`+Si),qr&&(Si=ee(Si,Xu," "),Si=ee(Si,H," "),Si=ee(Si,se," ")),vn&&Hl?vn.createHTML(Si):Si},ce.setConfig=function(Lt){u_(Lt),$i=!0},ce.clearConfig=function(){Sh=null,$i=!1},ce.isValidAttribute=function(Lt,Se,Qe){Sh||u_({});var wt=ai(Lt),Un=ai(Se);return c0(wt,Un,Qe)},ce.addHook=function(Lt,Se){typeof Se=="function"&&(Ar[Lt]=Ar[Lt]||[],C(Ar[Lt],Se))},ce.removeHook=function(Lt){if(Ar[Lt])return b(Ar[Lt])},ce.removeHooks=function(Lt){Ar[Lt]&&(Ar[Lt]=[])},ce.removeAllHooks=function(){Ar={}},ce}var ve=me();return ve})});var Ma=We((O4,Qv)=>{(function(t,e){typeof O4=="object"&&typeof Qv<"u"?Qv.exports=e():typeof define=="function"&&define.amd?define(e):t.moment=e()})(O4,function(){"use strict";var t;function e(){return t.apply(null,arguments)}function n(m){t=m}function r(m){return m instanceof Array||Object.prototype.toString.call(m)==="[object Array]"}function i(m){return m!=null&&Object.prototype.toString.call(m)==="[object Object]"}function o(m,v){return Object.prototype.hasOwnProperty.call(m,v)}function s(m){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(m).length===0;var v;for(v in m)if(o(m,v))return!1;return!0}function a(m){return m===void 0}function l(m){return typeof m=="number"||Object.prototype.toString.call(m)==="[object Number]"}function c(m){return m instanceof Date||Object.prototype.toString.call(m)==="[object Date]"}function u(m,v){var T=[],I,G=m.length;for(I=0;I<G;++I)T.push(v(m[I],I));return T}function d(m,v){for(var T in v)o(v,T)&&(m[T]=v[T]);return o(v,"toString")&&(m.toString=v.toString),o(v,"valueOf")&&(m.valueOf=v.valueOf),m}function h(m,v,T,I){return k$(m,v,T,I,!0).utc()}function f(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function p(m){return m._pf==null&&(m._pf=f()),m._pf}var g;Array.prototype.some?g=Array.prototype.some:g=function(m){var v=Object(this),T=v.length>>>0,I;for(I=0;I<T;I++)if(I in v&&m.call(this,v[I],I,v))return!0;return!1};function w(m){if(m._isValid==null){var v=p(m),T=g.call(v.parsedDateParts,function(G){return G!=null}),I=!isNaN(m._d.getTime())&&v.overflow<0&&!v.empty&&!v.invalidEra&&!v.invalidMonth&&!v.invalidWeekday&&!v.weekdayMismatch&&!v.nullInput&&!v.invalidFormat&&!v.userInvalidated&&(!v.meridiem||v.meridiem&&T);if(m._strict&&(I=I&&v.charsLeftOver===0&&v.unusedTokens.length===0&&v.bigHour===void 0),Object.isFrozen==null||!Object.isFrozen(m))m._isValid=I;else return I}return m._isValid}function _(m){var v=h(NaN);return m!=null?d(p(v),m):p(v).userInvalidated=!0,v}var S=e.momentProperties=[],x=!1;function P(m,v){var T,I,G,we=S.length;if(a(v._isAMomentObject)||(m._isAMomentObject=v._isAMomentObject),a(v._i)||(m._i=v._i),a(v._f)||(m._f=v._f),a(v._l)||(m._l=v._l),a(v._strict)||(m._strict=v._strict),a(v._tzm)||(m._tzm=v._tzm),a(v._isUTC)||(m._isUTC=v._isUTC),a(v._offset)||(m._offset=v._offset),a(v._pf)||(m._pf=p(v)),a(v._locale)||(m._locale=v._locale),we>0)for(T=0;T<we;T++)I=S[T],G=v[I],a(G)||(m[I]=G);return m}function k(m){P(this,m),this._d=new Date(m._d!=null?m._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),x===!1&&(x=!0,e.updateOffset(this),x=!1)}function b(m){return m instanceof k||m!=null&&m._isAMomentObject!=null}function C(m){e.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+m)}function N(m,v){var T=!0;return d(function(){if(e.deprecationHandler!=null&&e.deprecationHandler(null,m),T){var I=[],G,we,Fe,Ht=arguments.length;for(we=0;we<Ht;we++){if(G="",typeof arguments[we]=="object"){G+=`
[`+we+"] ";for(Fe in arguments[0])o(arguments[0],Fe)&&(G+=Fe+": "+arguments[0][Fe]+", ");G=G.slice(0,-2)}else G=arguments[we];I.push(G)}C(m+`
Arguments: `+Array.prototype.slice.call(I).join("")+`
`+new Error().stack),T=!1}return v.apply(this,arguments)},v)}var B={};function Y(m,v){e.deprecationHandler!=null&&e.deprecationHandler(m,v),B[m]||(C(v),B[m]=!0)}e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;function ee(m){return typeof Function<"u"&&m instanceof Function||Object.prototype.toString.call(m)==="[object Function]"}function te(m){var v,T;for(T in m)o(m,T)&&(v=m[T],ee(v)?this[T]=v:this["_"+T]=v);this._config=m,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Ce(m,v){var T=d({},m),I;for(I in v)o(v,I)&&(i(m[I])&&i(v[I])?(T[I]={},d(T[I],m[I]),d(T[I],v[I])):v[I]!=null?T[I]=v[I]:delete T[I]);for(I in m)o(m,I)&&!o(v,I)&&i(m[I])&&(T[I]=d({},T[I]));return T}function Re(m){m!=null&&this.set(m)}var _e;Object.keys?_e=Object.keys:_e=function(m){var v,T=[];for(v in m)o(m,v)&&T.push(v);return T};var L={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function M(m,v,T){var I=this._calendar[m]||this._calendar.sameElse;return ee(I)?I.call(v,T):I}function q(m,v,T){var I=""+Math.abs(m),G=v-I.length,we=m>=0;return(we?T?"+":"":"-")+Math.pow(10,Math.max(0,G)).toString().substr(1)+I}var y=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,E=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,R={},D={};function A(m,v,T,I){var G=I;typeof I=="string"&&(G=function(){return this[I]()}),m&&(D[m]=G),v&&(D[v[0]]=function(){return q(G.apply(this,arguments),v[1],v[2])}),T&&(D[T]=function(){return this.localeData().ordinal(G.apply(this,arguments),m)})}function O(m){return m.match(/\[[\s\S]/)?m.replace(/^\[|\]$/g,""):m.replace(/\\/g,"")}function U(m){var v=m.match(y),T,I;for(T=0,I=v.length;T<I;T++)D[v[T]]?v[T]=D[v[T]]:v[T]=O(v[T]);return function(G){var we="",Fe;for(Fe=0;Fe<I;Fe++)we+=ee(v[Fe])?v[Fe].call(G,m):v[Fe];return we}}function ie(m,v){return m.isValid()?(v=ue(v,m.localeData()),R[v]=R[v]||U(v),R[v](m)):m.localeData().invalidDate()}function ue(m,v){var T=5;function I(G){return v.longDateFormat(G)||G}for(E.lastIndex=0;T>=0&&E.test(m);)m=m.replace(E,I),E.lastIndex=0,T-=1;return m}var fe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function de(m){var v=this._longDateFormat[m],T=this._longDateFormat[m.toUpperCase()];return v||!T?v:(this._longDateFormat[m]=T.match(y).map(function(I){return I==="MMMM"||I==="MM"||I==="DD"||I==="dddd"?I.slice(1):I}).join(""),this._longDateFormat[m])}var ye="Invalid date";function Pe(){return this._invalidDate}var F="%d",Ke=/\d{1,2}/;function $e(m){return this._ordinal.replace("%d",m)}var rt={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Ye(m,v,T,I){var G=this._relativeTime[T];return ee(G)?G(m,v,T,I):G.replace(/%d/i,m)}function Me(m,v){var T=this._relativeTime[m>0?"future":"past"];return ee(T)?T(v):T.replace(/%s/i,v)}var j={};function z(m,v){var T=m.toLowerCase();j[T]=j[T+"s"]=j[v]=m}function J(m){return typeof m=="string"?j[m]||j[m.toLowerCase()]:void 0}function pe(m){var v={},T,I;for(I in m)o(m,I)&&(T=J(I),T&&(v[T]=m[I]));return v}var he={};function me(m,v){he[m]=v}function ve(m){var v=[],T;for(T in m)o(m,T)&&v.push({unit:T,priority:he[T]});return v.sort(function(I,G){return I.priority-G.priority}),v}function ne(m){return m%4===0&&m%100!==0||m%400===0}function ce(m){return m<0?Math.ceil(m)||0:Math.floor(m)}function oe(m){var v=+m,T=0;return v!==0&&isFinite(v)&&(T=ce(v)),T}function ge(m,v){return function(T){return T!=null?(ke(this,m,T),e.updateOffset(this,v),this):Ve(this,m)}}function Ve(m,v){return m.isValid()?m._d["get"+(m._isUTC?"UTC":"")+v]():NaN}function ke(m,v,T){m.isValid()&&!isNaN(T)&&(v==="FullYear"&&ne(m.year())&&m.month()===1&&m.date()===29?(T=oe(T),m._d["set"+(m._isUTC?"UTC":"")+v](T,m.month(),nt(T,m.month()))):m._d["set"+(m._isUTC?"UTC":"")+v](T))}function Xe(m){return m=J(m),ee(this[m])?this[m]():this}function gt(m,v){if(typeof m=="object"){m=pe(m);var T=ve(m),I,G=T.length;for(I=0;I<G;I++)this[T[I].unit](m[T[I].unit])}else if(m=J(m),ee(this[m]))return this[m](v);return this}var Mt=/\d/,Nt=/\d\d/,$t=/\d{3}/,Rn=/\d{4}/,yr=/[+-]?\d{6}/,Mn=/\d\d?/,zs=/\d\d\d\d?/,kl=/\d\d\d\d\d\d?/,ji=/\d{1,3}/,ga=/\d{1,4}/,Ir=/[+-]?\d{1,6}/,_r=/\d+/,vn=/[+-]?\d+/,Sm=/Z|[+-]\d\d:?\d\d/gi,Fl=/Z|[+-]\d\d(?::?\d\d)?/gi,Em=/[+-]?\d+(\.\d{1,3})?/,Ku=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,vh;vh={};function Et(m,v,T){vh[m]=ee(v)?v:function(I,G){return I&&T?T:v}}function xm(m,v){return o(vh,m)?vh[m](v._strict,v._locale):new RegExp(s0(m))}function s0(m){return Ar(m.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(v,T,I,G,we){return T||I||G||we}))}function Ar(m){return m.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var Xu={};function H(m,v){var T,I=v,G;for(typeof m=="string"&&(m=[m]),l(v)&&(I=function(we,Fe){Fe[v]=oe(we)}),G=m.length,T=0;T<G;T++)Xu[m[T]]=I}function se(m,v){H(m,function(T,I,G,we){G._w=G._w||{},v(T,G._w,G,we)})}function X(m,v,T){v!=null&&o(Xu,m)&&Xu[m](v,T._a,T,m)}var K=0,ae=1,le=2,be=3,Ae=4,Ie=5,xe=6,Oe=7,Be=8;function tt(m,v){return(m%v+v)%v}var it;Array.prototype.indexOf?it=Array.prototype.indexOf:it=function(m){var v;for(v=0;v<this.length;++v)if(this[v]===m)return v;return-1};function nt(m,v){if(isNaN(m)||isNaN(v))return NaN;var T=tt(v,12);return m+=(v-T)/12,T===1?ne(m)?29:28:31-T%7%2}A("M",["MM",2],"Mo",function(){return this.month()+1}),A("MMM",0,0,function(m){return this.localeData().monthsShort(this,m)}),A("MMMM",0,0,function(m){return this.localeData().months(this,m)}),z("month","M"),me("month",8),Et("M",Mn),Et("MM",Mn,Nt),Et("MMM",function(m,v){return v.monthsShortRegex(m)}),Et("MMMM",function(m,v){return v.monthsRegex(m)}),H(["M","MM"],function(m,v){v[ae]=oe(m)-1}),H(["MMM","MMMM"],function(m,v,T,I){var G=T._locale.monthsParse(m,I,T._strict);G!=null?v[ae]=G:p(T).invalidMonth=m});var ut="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Yt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),er=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,qr=Ku,sr=Ku;function $i(m,v){return m?r(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||er).test(v)?"format":"standalone"][m.month()]:r(this._months)?this._months:this._months.standalone}function Ll(m,v){return m?r(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[er.test(v)?"format":"standalone"][m.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Ys(m,v,T){var I,G,we,Fe=m.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],I=0;I<12;++I)we=h([2e3,I]),this._shortMonthsParse[I]=this.monthsShort(we,"").toLocaleLowerCase(),this._longMonthsParse[I]=this.months(we,"").toLocaleLowerCase();return T?v==="MMM"?(G=it.call(this._shortMonthsParse,Fe),G!==-1?G:null):(G=it.call(this._longMonthsParse,Fe),G!==-1?G:null):v==="MMM"?(G=it.call(this._shortMonthsParse,Fe),G!==-1?G:(G=it.call(this._longMonthsParse,Fe),G!==-1?G:null)):(G=it.call(this._longMonthsParse,Fe),G!==-1?G:(G=it.call(this._shortMonthsParse,Fe),G!==-1?G:null))}function qs(m,v,T){var I,G,we;if(this._monthsParseExact)return Ys.call(this,m,v,T);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),I=0;I<12;I++){if(G=h([2e3,I]),T&&!this._longMonthsParse[I]&&(this._longMonthsParse[I]=new RegExp("^"+this.months(G,"").replace(".","")+"$","i"),this._shortMonthsParse[I]=new RegExp("^"+this.monthsShort(G,"").replace(".","")+"$","i")),!T&&!this._monthsParse[I]&&(we="^"+this.months(G,"")+"|^"+this.monthsShort(G,""),this._monthsParse[I]=new RegExp(we.replace(".",""),"i")),T&&v==="MMMM"&&this._longMonthsParse[I].test(m))return I;if(T&&v==="MMM"&&this._shortMonthsParse[I].test(m))return I;if(!T&&this._monthsParse[I].test(m))return I}}function Hl(m,v){var T;if(!m.isValid())return m;if(typeof v=="string"){if(/^\d+$/.test(v))v=oe(v);else if(v=m.localeData().monthsParse(v),!l(v))return m}return T=Math.min(m.date(),nt(m.year(),v)),m._d["set"+(m._isUTC?"UTC":"")+"Month"](v,T),m}function ws(m){return m!=null?(Hl(this,m),e.updateOffset(this,!0),this):Ve(this,"Month")}function NT(){return nt(this.year(),this.month())}function vk(m){return this._monthsParseExact?(o(this,"_monthsRegex")||wh.call(this),m?this._monthsShortStrictRegex:this._monthsShortRegex):(o(this,"_monthsShortRegex")||(this._monthsShortRegex=qr),this._monthsShortStrictRegex&&m?this._monthsShortStrictRegex:this._monthsShortRegex)}function s_(m){return this._monthsParseExact?(o(this,"_monthsRegex")||wh.call(this),m?this._monthsStrictRegex:this._monthsRegex):(o(this,"_monthsRegex")||(this._monthsRegex=sr),this._monthsStrictRegex&&m?this._monthsStrictRegex:this._monthsRegex)}function wh(){function m(Fe,Ht){return Ht.length-Fe.length}var v=[],T=[],I=[],G,we;for(G=0;G<12;G++)we=h([2e3,G]),v.push(this.monthsShort(we,"")),T.push(this.months(we,"")),I.push(this.months(we,"")),I.push(this.monthsShort(we,""));for(v.sort(m),T.sort(m),I.sort(m),G=0;G<12;G++)v[G]=Ar(v[G]),T[G]=Ar(T[G]);for(G=0;G<24;G++)I[G]=Ar(I[G]);this._monthsRegex=new RegExp("^("+I.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+T.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+v.join("|")+")","i")}A("Y",0,0,function(){var m=this.year();return m<=9999?q(m,4):"+"+m}),A(0,["YY",2],0,function(){return this.year()%100}),A(0,["YYYY",4],0,"year"),A(0,["YYYYY",5],0,"year"),A(0,["YYYYYY",6,!0],0,"year"),z("year","y"),me("year",1),Et("Y",vn),Et("YY",Mn,Nt),Et("YYYY",ga,Rn),Et("YYYYY",Ir,yr),Et("YYYYYY",Ir,yr),H(["YYYYY","YYYYYY"],K),H("YYYY",function(m,v){v[K]=m.length===2?e.parseTwoDigitYear(m):oe(m)}),H("YY",function(m,v){v[K]=e.parseTwoDigitYear(m)}),H("Y",function(m,v){v[K]=parseInt(m,10)});function za(m){return ne(m)?366:365}e.parseTwoDigitYear=function(m){return oe(m)+(oe(m)>68?1900:2e3)};var Zu=ge("FullYear",!0);function PT(){return ne(this.year())}function kT(m,v,T,I,G,we,Fe){var Ht;return m<100&&m>=0?(Ht=new Date(m+400,v,T,I,G,we,Fe),isFinite(Ht.getFullYear())&&Ht.setFullYear(m)):Ht=new Date(m,v,T,I,G,we,Fe),Ht}function yh(m){var v,T;return m<100&&m>=0?(T=Array.prototype.slice.call(arguments),T[0]=m+400,v=new Date(Date.UTC.apply(null,T)),isFinite(v.getUTCFullYear())&&v.setUTCFullYear(m)):v=new Date(Date.UTC.apply(null,arguments)),v}function _h(m,v,T){var I=7+v-T,G=(7+yh(m,0,I).getUTCDay()-v)%7;return-G+I-1}function a_(m,v,T,I,G){var we=(7+T-I)%7,Fe=_h(m,I,G),Ht=1+7*(v-1)+we+Fe,En,Cr;return Ht<=0?(En=m-1,Cr=za(En)+Ht):Ht>za(m)?(En=m+1,Cr=Ht-za(m)):(En=m,Cr=Ht),{year:En,dayOfYear:Cr}}function Bc(m,v,T){var I=_h(m.year(),v,T),G=Math.floor((m.dayOfYear()-I-1)/7)+1,we,Fe;return G<1?(Fe=m.year()-1,we=G+Ks(Fe,v,T)):G>Ks(m.year(),v,T)?(we=G-Ks(m.year(),v,T),Fe=m.year()+1):(Fe=m.year(),we=G),{week:we,year:Fe}}function Ks(m,v,T){var I=_h(m,v,T),G=_h(m+1,v,T);return(za(m)-I+G)/7}A("w",["ww",2],"wo","week"),A("W",["WW",2],"Wo","isoWeek"),z("week","w"),z("isoWeek","W"),me("week",5),me("isoWeek",5),Et("w",Mn),Et("ww",Mn,Nt),Et("W",Mn),Et("WW",Mn,Nt),se(["w","ww","W","WW"],function(m,v,T,I){v[I.substr(0,1)]=oe(m)});function Vl(m){return Bc(m,this._week.dow,this._week.doy).week}var Ch={dow:0,doy:6};function l_(){return this._week.dow}function c_(){return this._week.doy}function wk(m){var v=this.localeData().week(this);return m==null?v:this.add((m-v)*7,"d")}function Qu(m){var v=Bc(this,1,4).week;return m==null?v:this.add((m-v)*7,"d")}A("d",0,"do","day"),A("dd",0,0,function(m){return this.localeData().weekdaysMin(this,m)}),A("ddd",0,0,function(m){return this.localeData().weekdaysShort(this,m)}),A("dddd",0,0,function(m){return this.localeData().weekdays(this,m)}),A("e",0,0,"weekday"),A("E",0,0,"isoWeekday"),z("day","d"),z("weekday","e"),z("isoWeekday","E"),me("day",11),me("weekday",11),me("isoWeekday",11),Et("d",Mn),Et("e",Mn),Et("E",Mn),Et("dd",function(m,v){return v.weekdaysMinRegex(m)}),Et("ddd",function(m,v){return v.weekdaysShortRegex(m)}),Et("dddd",function(m,v){return v.weekdaysRegex(m)}),se(["dd","ddd","dddd"],function(m,v,T,I){var G=T._locale.weekdaysParse(m,I,T._strict);G!=null?v.d=G:p(T).invalidWeekday=m}),se(["d","e","E"],function(m,v,T,I){v[I]=oe(m)});function yk(m,v){return typeof m!="string"?m:isNaN(m)?(m=v.weekdaysParse(m),typeof m=="number"?m:null):parseInt(m,10)}function _k(m,v){return typeof m=="string"?v.weekdaysParse(m)%7||7:isNaN(m)?null:m}function ai(m,v){return m.slice(v,7).concat(m.slice(0,v))}var Sh="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),FT="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),LT="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),u_=Ku,HT=Ku,VT=Ku;function Ck(m,v){var T=r(this._weekdays)?this._weekdays:this._weekdays[m&&m!==!0&&this._weekdays.isFormat.test(v)?"format":"standalone"];return m===!0?ai(T,this._week.dow):m?T[m.day()]:T}function a0(m){return m===!0?ai(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort}function d_(m){return m===!0?ai(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin}function Sk(m,v,T){var I,G,we,Fe=m.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],I=0;I<7;++I)we=h([2e3,1]).day(I),this._minWeekdaysParse[I]=this.weekdaysMin(we,"").toLocaleLowerCase(),this._shortWeekdaysParse[I]=this.weekdaysShort(we,"").toLocaleLowerCase(),this._weekdaysParse[I]=this.weekdays(we,"").toLocaleLowerCase();return T?v==="dddd"?(G=it.call(this._weekdaysParse,Fe),G!==-1?G:null):v==="ddd"?(G=it.call(this._shortWeekdaysParse,Fe),G!==-1?G:null):(G=it.call(this._minWeekdaysParse,Fe),G!==-1?G:null):v==="dddd"?(G=it.call(this._weekdaysParse,Fe),G!==-1||(G=it.call(this._shortWeekdaysParse,Fe),G!==-1)?G:(G=it.call(this._minWeekdaysParse,Fe),G!==-1?G:null)):v==="ddd"?(G=it.call(this._shortWeekdaysParse,Fe),G!==-1||(G=it.call(this._weekdaysParse,Fe),G!==-1)?G:(G=it.call(this._minWeekdaysParse,Fe),G!==-1?G:null)):(G=it.call(this._minWeekdaysParse,Fe),G!==-1||(G=it.call(this._weekdaysParse,Fe),G!==-1)?G:(G=it.call(this._shortWeekdaysParse,Fe),G!==-1?G:null))}function Bl(m,v,T){var I,G,we;if(this._weekdaysParseExact)return Sk.call(this,m,v,T);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),I=0;I<7;I++){if(G=h([2e3,1]).day(I),T&&!this._fullWeekdaysParse[I]&&(this._fullWeekdaysParse[I]=new RegExp("^"+this.weekdays(G,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[I]=new RegExp("^"+this.weekdaysShort(G,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[I]=new RegExp("^"+this.weekdaysMin(G,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[I]||(we="^"+this.weekdays(G,"")+"|^"+this.weekdaysShort(G,"")+"|^"+this.weekdaysMin(G,""),this._weekdaysParse[I]=new RegExp(we.replace(".",""),"i")),T&&v==="dddd"&&this._fullWeekdaysParse[I].test(m))return I;if(T&&v==="ddd"&&this._shortWeekdaysParse[I].test(m))return I;if(T&&v==="dd"&&this._minWeekdaysParse[I].test(m))return I;if(!T&&this._weekdaysParse[I].test(m))return I}}function h_(m){if(!this.isValid())return m!=null?this:NaN;var v=this._isUTC?this._d.getUTCDay():this._d.getDay();return m!=null?(m=yk(m,this.localeData()),this.add(m-v,"d")):v}function BT(m){if(!this.isValid())return m!=null?this:NaN;var v=(this.day()+7-this.localeData()._week.dow)%7;return m==null?v:this.add(m-v,"d")}function UT(m){if(!this.isValid())return m!=null?this:NaN;if(m!=null){var v=_k(m,this.localeData());return this.day(this.day()%7?v:v-7)}else return this.day()||7}function Ek(m){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||l0.call(this),m?this._weekdaysStrictRegex:this._weekdaysRegex):(o(this,"_weekdaysRegex")||(this._weekdaysRegex=u_),this._weekdaysStrictRegex&&m?this._weekdaysStrictRegex:this._weekdaysRegex)}function bm(m){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||l0.call(this),m?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(o(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=HT),this._weekdaysShortStrictRegex&&m?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ul(m){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||l0.call(this),m?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(o(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=VT),this._weekdaysMinStrictRegex&&m?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function l0(){function m(ys,rd){return rd.length-ys.length}var v=[],T=[],I=[],G=[],we,Fe,Ht,En,Cr;for(we=0;we<7;we++)Fe=h([2e3,1]).day(we),Ht=Ar(this.weekdaysMin(Fe,"")),En=Ar(this.weekdaysShort(Fe,"")),Cr=Ar(this.weekdays(Fe,"")),v.push(Ht),T.push(En),I.push(Cr),G.push(Ht),G.push(En),G.push(Cr);v.sort(m),T.sort(m),I.sort(m),G.sort(m),this._weekdaysRegex=new RegExp("^("+G.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+I.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+T.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+v.join("|")+")","i")}function c0(){return this.hours()%12||12}function WT(){return this.hours()||24}A("H",["HH",2],0,"hour"),A("h",["hh",2],0,c0),A("k",["kk",2],0,WT),A("hmm",0,0,function(){return""+c0.apply(this)+q(this.minutes(),2)}),A("hmmss",0,0,function(){return""+c0.apply(this)+q(this.minutes(),2)+q(this.seconds(),2)}),A("Hmm",0,0,function(){return""+this.hours()+q(this.minutes(),2)}),A("Hmmss",0,0,function(){return""+this.hours()+q(this.minutes(),2)+q(this.seconds(),2)});function f_(m,v){A(m,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),v)})}f_("a",!0),f_("A",!1),z("hour","h"),me("hour",13);function jT(m,v){return v._meridiemParse}Et("a",jT),Et("A",jT),Et("H",Mn),Et("h",Mn),Et("k",Mn),Et("HH",Mn,Nt),Et("hh",Mn,Nt),Et("kk",Mn,Nt),Et("hmm",zs),Et("hmmss",kl),Et("Hmm",zs),Et("Hmmss",kl),H(["H","HH"],be),H(["k","kk"],function(m,v,T){var I=oe(m);v[be]=I===24?0:I}),H(["a","A"],function(m,v,T){T._isPm=T._locale.isPM(m),T._meridiem=m}),H(["h","hh"],function(m,v,T){v[be]=oe(m),p(T).bigHour=!0}),H("hmm",function(m,v,T){var I=m.length-2;v[be]=oe(m.substr(0,I)),v[Ae]=oe(m.substr(I)),p(T).bigHour=!0}),H("hmmss",function(m,v,T){var I=m.length-4,G=m.length-2;v[be]=oe(m.substr(0,I)),v[Ae]=oe(m.substr(I,2)),v[Ie]=oe(m.substr(G)),p(T).bigHour=!0}),H("Hmm",function(m,v,T){var I=m.length-2;v[be]=oe(m.substr(0,I)),v[Ae]=oe(m.substr(I))}),H("Hmmss",function(m,v,T){var I=m.length-4,G=m.length-2;v[be]=oe(m.substr(0,I)),v[Ae]=oe(m.substr(I,2)),v[Ie]=oe(m.substr(G))});function Lt(m){return(m+"").toLowerCase().charAt(0)==="p"}var Se=/[ap]\.?m?\.?/i,Qe=ge("Hours",!0);function wt(m,v,T){return m>11?T?"pm":"PM":T?"am":"AM"}var Un={calendar:L,longDateFormat:fe,invalidDate:ye,ordinal:F,dayOfMonthOrdinalParse:Ke,relativeTime:rt,months:ut,monthsShort:Yt,week:Ch,weekdays:Sh,weekdaysMin:LT,weekdaysShort:FT,meridiemParse:Se},Dn={},li={},Kr;function u0(m,v){var T,I=Math.min(m.length,v.length);for(T=0;T<I;T+=1)if(m[T]!==v[T])return T;return I}function Si(m){return m&&m.toLowerCase().replace("_","-")}function m_(m){for(var v=0,T,I,G,we;v<m.length;){for(we=Si(m[v]).split("-"),T=we.length,I=Si(m[v+1]),I=I?I.split("-"):null;T>0;){if(G=p_(we.slice(0,T).join("-")),G)return G;if(I&&I.length>=T&&u0(we,I)>=T-1)break;T--}v++}return Kr}function $T(m){return m.match("^[^/\\\\]*$")!=null}function p_(m){var v=null,T;if(Dn[m]===void 0&&typeof Qv<"u"&&Qv&&Qv.exports&&$T(m))try{v=Kr._abbr,T=Dm,T("./locale/"+m),Eh(v)}catch{Dn[m]=null}return Dn[m]}function Eh(m,v){var T;return m&&(a(v)?T=Ju(m):T=xk(m,v),T?Kr=T:typeof console<"u"&&console.warn&&console.warn("Locale "+m+" not found. Did you forget to load it?")),Kr._abbr}function xk(m,v){if(v!==null){var T,I=Un;if(v.abbr=m,Dn[m]!=null)Y("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),I=Dn[m]._config;else if(v.parentLocale!=null)if(Dn[v.parentLocale]!=null)I=Dn[v.parentLocale]._config;else if(T=p_(v.parentLocale),T!=null)I=T._config;else return li[v.parentLocale]||(li[v.parentLocale]=[]),li[v.parentLocale].push({name:m,config:v}),null;return Dn[m]=new Re(Ce(I,v)),li[m]&&li[m].forEach(function(G){xk(G.name,G.config)}),Eh(m),Dn[m]}else return delete Dn[m],null}function rwe(m,v){if(v!=null){var T,I,G=Un;Dn[m]!=null&&Dn[m].parentLocale!=null?Dn[m].set(Ce(Dn[m]._config,v)):(I=p_(m),I!=null&&(G=I._config),v=Ce(G,v),I==null&&(v.abbr=m),T=new Re(v),T.parentLocale=Dn[m],Dn[m]=T),Eh(m)}else Dn[m]!=null&&(Dn[m].parentLocale!=null?(Dn[m]=Dn[m].parentLocale,m===Eh()&&Eh(m)):Dn[m]!=null&&delete Dn[m]);return Dn[m]}function Ju(m){var v;if(m&&m._locale&&m._locale._abbr&&(m=m._locale._abbr),!m)return Kr;if(!r(m)){if(v=p_(m),v)return v;m=[m]}return m_(m)}function iwe(){return _e(Dn)}function bk(m){var v,T=m._a;return T&&p(m).overflow===-2&&(v=T[ae]<0||T[ae]>11?ae:T[le]<1||T[le]>nt(T[K],T[ae])?le:T[be]<0||T[be]>24||T[be]===24&&(T[Ae]!==0||T[Ie]!==0||T[xe]!==0)?be:T[Ae]<0||T[Ae]>59?Ae:T[Ie]<0||T[Ie]>59?Ie:T[xe]<0||T[xe]>999?xe:-1,p(m)._overflowDayOfYear&&(v<K||v>le)&&(v=le),p(m)._overflowWeeks&&v===-1&&(v=Oe),p(m)._overflowWeekday&&v===-1&&(v=Be),p(m).overflow=v),m}var owe=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,swe=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,awe=/Z|[+-]\d\d(?::?\d\d)?/,GT=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Tk=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],lwe=/^\/?Date\((-?\d+)/i,cwe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,uwe={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function O$(m){var v,T,I=m._i,G=owe.exec(I)||swe.exec(I),we,Fe,Ht,En,Cr=GT.length,ys=Tk.length;if(G){for(p(m).iso=!0,v=0,T=Cr;v<T;v++)if(GT[v][1].exec(G[1])){Fe=GT[v][0],we=GT[v][2]!==!1;break}if(Fe==null){m._isValid=!1;return}if(G[3]){for(v=0,T=ys;v<T;v++)if(Tk[v][1].exec(G[3])){Ht=(G[2]||" ")+Tk[v][0];break}if(Ht==null){m._isValid=!1;return}}if(!we&&Ht!=null){m._isValid=!1;return}if(G[4])if(awe.exec(G[4]))En="Z";else{m._isValid=!1;return}m._f=Fe+(Ht||"")+(En||""),Dk(m)}else m._isValid=!1}function dwe(m,v,T,I,G,we){var Fe=[hwe(m),Yt.indexOf(v),parseInt(T,10),parseInt(I,10),parseInt(G,10)];return we&&Fe.push(parseInt(we,10)),Fe}function hwe(m){var v=parseInt(m,10);return v<=49?2e3+v:v<=999?1900+v:v}function fwe(m){return m.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function mwe(m,v,T){if(m){var I=FT.indexOf(m),G=new Date(v[0],v[1],v[2]).getDay();if(I!==G)return p(T).weekdayMismatch=!0,T._isValid=!1,!1}return!0}function pwe(m,v,T){if(m)return uwe[m];if(v)return 0;var I=parseInt(T,10),G=I%100,we=(I-G)/100;return we*60+G}function N$(m){var v=cwe.exec(fwe(m._i)),T;if(v){if(T=dwe(v[4],v[3],v[2],v[5],v[6],v[7]),!mwe(v[1],T,m))return;m._a=T,m._tzm=pwe(v[8],v[9],v[10]),m._d=yh.apply(null,m._a),m._d.setUTCMinutes(m._d.getUTCMinutes()-m._tzm),p(m).rfc2822=!0}else m._isValid=!1}function gwe(m){var v=lwe.exec(m._i);if(v!==null){m._d=new Date(+v[1]);return}if(O$(m),m._isValid===!1)delete m._isValid;else return;if(N$(m),m._isValid===!1)delete m._isValid;else return;m._strict?m._isValid=!1:e.createFromInputFallback(m)}e.createFromInputFallback=N("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(m){m._d=new Date(m._i+(m._useUTC?" UTC":""))});function d0(m,v,T){return m??v??T}function vwe(m){var v=new Date(e.now());return m._useUTC?[v.getUTCFullYear(),v.getUTCMonth(),v.getUTCDate()]:[v.getFullYear(),v.getMonth(),v.getDate()]}function Rk(m){var v,T,I=[],G,we,Fe;if(!m._d){for(G=vwe(m),m._w&&m._a[le]==null&&m._a[ae]==null&&wwe(m),m._dayOfYear!=null&&(Fe=d0(m._a[K],G[K]),(m._dayOfYear>za(Fe)||m._dayOfYear===0)&&(p(m)._overflowDayOfYear=!0),T=yh(Fe,0,m._dayOfYear),m._a[ae]=T.getUTCMonth(),m._a[le]=T.getUTCDate()),v=0;v<3&&m._a[v]==null;++v)m._a[v]=I[v]=G[v];for(;v<7;v++)m._a[v]=I[v]=m._a[v]==null?v===2?1:0:m._a[v];m._a[be]===24&&m._a[Ae]===0&&m._a[Ie]===0&&m._a[xe]===0&&(m._nextDay=!0,m._a[be]=0),m._d=(m._useUTC?yh:kT).apply(null,I),we=m._useUTC?m._d.getUTCDay():m._d.getDay(),m._tzm!=null&&m._d.setUTCMinutes(m._d.getUTCMinutes()-m._tzm),m._nextDay&&(m._a[be]=24),m._w&&typeof m._w.d<"u"&&m._w.d!==we&&(p(m).weekdayMismatch=!0)}}function wwe(m){var v,T,I,G,we,Fe,Ht,En,Cr;v=m._w,v.GG!=null||v.W!=null||v.E!=null?(we=1,Fe=4,T=d0(v.GG,m._a[K],Bc(Or(),1,4).year),I=d0(v.W,1),G=d0(v.E,1),(G<1||G>7)&&(En=!0)):(we=m._locale._week.dow,Fe=m._locale._week.doy,Cr=Bc(Or(),we,Fe),T=d0(v.gg,m._a[K],Cr.year),I=d0(v.w,Cr.week),v.d!=null?(G=v.d,(G<0||G>6)&&(En=!0)):v.e!=null?(G=v.e+we,(v.e<0||v.e>6)&&(En=!0)):G=we),I<1||I>Ks(T,we,Fe)?p(m)._overflowWeeks=!0:En!=null?p(m)._overflowWeekday=!0:(Ht=a_(T,I,G,we,Fe),m._a[K]=Ht.year,m._dayOfYear=Ht.dayOfYear)}e.ISO_8601=function(){},e.RFC_2822=function(){};function Dk(m){if(m._f===e.ISO_8601){O$(m);return}if(m._f===e.RFC_2822){N$(m);return}m._a=[],p(m).empty=!0;var v=""+m._i,T,I,G,we,Fe,Ht=v.length,En=0,Cr,ys;for(G=ue(m._f,m._locale).match(y)||[],ys=G.length,T=0;T<ys;T++)we=G[T],I=(v.match(xm(we,m))||[])[0],I&&(Fe=v.substr(0,v.indexOf(I)),Fe.length>0&&p(m).unusedInput.push(Fe),v=v.slice(v.indexOf(I)+I.length),En+=I.length),D[we]?(I?p(m).empty=!1:p(m).unusedTokens.push(we),X(we,I,m)):m._strict&&!I&&p(m).unusedTokens.push(we);p(m).charsLeftOver=Ht-En,v.length>0&&p(m).unusedInput.push(v),m._a[be]<=12&&p(m).bigHour===!0&&m._a[be]>0&&(p(m).bigHour=void 0),p(m).parsedDateParts=m._a.slice(0),p(m).meridiem=m._meridiem,m._a[be]=ywe(m._locale,m._a[be],m._meridiem),Cr=p(m).era,Cr!==null&&(m._a[K]=m._locale.erasConvertYear(Cr,m._a[K])),Rk(m),bk(m)}function ywe(m,v,T){var I;return T==null?v:m.meridiemHour!=null?m.meridiemHour(v,T):(m.isPM!=null&&(I=m.isPM(T),I&&v<12&&(v+=12),!I&&v===12&&(v=0)),v)}function _we(m){var v,T,I,G,we,Fe,Ht=!1,En=m._f.length;if(En===0){p(m).invalidFormat=!0,m._d=new Date(NaN);return}for(G=0;G<En;G++)we=0,Fe=!1,v=P({},m),m._useUTC!=null&&(v._useUTC=m._useUTC),v._f=m._f[G],Dk(v),w(v)&&(Fe=!0),we+=p(v).charsLeftOver,we+=p(v).unusedTokens.length*10,p(v).score=we,Ht?we<I&&(I=we,T=v):(I==null||we<I||Fe)&&(I=we,T=v,Fe&&(Ht=!0));d(m,T||v)}function Cwe(m){if(!m._d){var v=pe(m._i),T=v.day===void 0?v.date:v.day;m._a=u([v.year,v.month,T,v.hour,v.minute,v.second,v.millisecond],function(I){return I&&parseInt(I,10)}),Rk(m)}}function Swe(m){var v=new k(bk(P$(m)));return v._nextDay&&(v.add(1,"d"),v._nextDay=void 0),v}function P$(m){var v=m._i,T=m._f;return m._locale=m._locale||Ju(m._l),v===null||T===void 0&&v===""?_({nullInput:!0}):(typeof v=="string"&&(m._i=v=m._locale.preparse(v)),b(v)?new k(bk(v)):(c(v)?m._d=v:r(T)?_we(m):T?Dk(m):Ewe(m),w(m)||(m._d=null),m))}function Ewe(m){var v=m._i;a(v)?m._d=new Date(e.now()):c(v)?m._d=new Date(v.valueOf()):typeof v=="string"?gwe(m):r(v)?(m._a=u(v.slice(0),function(T){return parseInt(T,10)}),Rk(m)):i(v)?Cwe(m):l(v)?m._d=new Date(v):e.createFromInputFallback(m)}function k$(m,v,T,I,G){var we={};return(v===!0||v===!1)&&(I=v,v=void 0),(T===!0||T===!1)&&(I=T,T=void 0),(i(m)&&s(m)||r(m)&&m.length===0)&&(m=void 0),we._isAMomentObject=!0,we._useUTC=we._isUTC=G,we._l=T,we._i=m,we._f=v,we._strict=I,Swe(we)}function Or(m,v,T,I){return k$(m,v,T,I,!1)}var xwe=N("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var m=Or.apply(null,arguments);return this.isValid()&&m.isValid()?m<this?this:m:_()}),bwe=N("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var m=Or.apply(null,arguments);return this.isValid()&&m.isValid()?m>this?this:m:_()});function F$(m,v){var T,I;if(v.length===1&&r(v[0])&&(v=v[0]),!v.length)return Or();for(T=v[0],I=1;I<v.length;++I)(!v[I].isValid()||v[I][m](T))&&(T=v[I]);return T}function Twe(){var m=[].slice.call(arguments,0);return F$("isBefore",m)}function Rwe(){var m=[].slice.call(arguments,0);return F$("isAfter",m)}var Dwe=function(){return Date.now?Date.now():+new Date},g_=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Iwe(m){var v,T=!1,I,G=g_.length;for(v in m)if(o(m,v)&&!(it.call(g_,v)!==-1&&(m[v]==null||!isNaN(m[v]))))return!1;for(I=0;I<G;++I)if(m[g_[I]]){if(T)return!1;parseFloat(m[g_[I]])!==oe(m[g_[I]])&&(T=!0)}return!0}function Awe(){return this._isValid}function Mwe(){return Wl(NaN)}function zT(m){var v=pe(m),T=v.year||0,I=v.quarter||0,G=v.month||0,we=v.week||v.isoWeek||0,Fe=v.day||0,Ht=v.hour||0,En=v.minute||0,Cr=v.second||0,ys=v.millisecond||0;this._isValid=Iwe(v),this._milliseconds=+ys+Cr*1e3+En*6e4+Ht*1e3*60*60,this._days=+Fe+we*7,this._months=+G+I*3+T*12,this._data={},this._locale=Ju(),this._bubble()}function YT(m){return m instanceof zT}function Ik(m){return m<0?Math.round(-1*m)*-1:Math.round(m)}function Owe(m,v,T){var I=Math.min(m.length,v.length),G=Math.abs(m.length-v.length),we=0,Fe;for(Fe=0;Fe<I;Fe++)(T&&m[Fe]!==v[Fe]||!T&&oe(m[Fe])!==oe(v[Fe]))&&we++;return we+G}function L$(m,v){A(m,0,0,function(){var T=this.utcOffset(),I="+";return T<0&&(T=-T,I="-"),I+q(~~(T/60),2)+v+q(~~T%60,2)})}L$("Z",":"),L$("ZZ",""),Et("Z",Fl),Et("ZZ",Fl),H(["Z","ZZ"],function(m,v,T){T._useUTC=!0,T._tzm=Ak(Fl,m)});var Nwe=/([\+\-]|\d\d)/gi;function Ak(m,v){var T=(v||"").match(m),I,G,we;return T===null?null:(I=T[T.length-1]||[],G=(I+"").match(Nwe)||["-",0,0],we=+(G[1]*60)+oe(G[2]),we===0?0:G[0]==="+"?we:-we)}function Mk(m,v){var T,I;return v._isUTC?(T=v.clone(),I=(b(m)||c(m)?m.valueOf():Or(m).valueOf())-T.valueOf(),T._d.setTime(T._d.valueOf()+I),e.updateOffset(T,!1),T):Or(m).local()}function Ok(m){return-Math.round(m._d.getTimezoneOffset())}e.updateOffset=function(){};function Pwe(m,v,T){var I=this._offset||0,G;if(!this.isValid())return m!=null?this:NaN;if(m!=null){if(typeof m=="string"){if(m=Ak(Fl,m),m===null)return this}else Math.abs(m)<16&&!T&&(m=m*60);return!this._isUTC&&v&&(G=Ok(this)),this._offset=m,this._isUTC=!0,G!=null&&this.add(G,"m"),I!==m&&(!v||this._changeInProgress?U$(this,Wl(m-I,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?I:Ok(this)}function kwe(m,v){return m!=null?(typeof m!="string"&&(m=-m),this.utcOffset(m,v),this):-this.utcOffset()}function Fwe(m){return this.utcOffset(0,m)}function Lwe(m){return this._isUTC&&(this.utcOffset(0,m),this._isUTC=!1,m&&this.subtract(Ok(this),"m")),this}function Hwe(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var m=Ak(Sm,this._i);m!=null?this.utcOffset(m):this.utcOffset(0,!0)}return this}function Vwe(m){return this.isValid()?(m=m?Or(m).utcOffset():0,(this.utcOffset()-m)%60===0):!1}function Bwe(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Uwe(){if(!a(this._isDSTShifted))return this._isDSTShifted;var m={},v;return P(m,this),m=P$(m),m._a?(v=m._isUTC?h(m._a):Or(m._a),this._isDSTShifted=this.isValid()&&Owe(m._a,v.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Wwe(){return this.isValid()?!this._isUTC:!1}function jwe(){return this.isValid()?this._isUTC:!1}function H$(){return this.isValid()?this._isUTC&&this._offset===0:!1}var $we=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Gwe=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Wl(m,v){var T=m,I=null,G,we,Fe;return YT(m)?T={ms:m._milliseconds,d:m._days,M:m._months}:l(m)||!isNaN(+m)?(T={},v?T[v]=+m:T.milliseconds=+m):(I=$we.exec(m))?(G=I[1]==="-"?-1:1,T={y:0,d:oe(I[le])*G,h:oe(I[be])*G,m:oe(I[Ae])*G,s:oe(I[Ie])*G,ms:oe(Ik(I[xe]*1e3))*G}):(I=Gwe.exec(m))?(G=I[1]==="-"?-1:1,T={y:Tm(I[2],G),M:Tm(I[3],G),w:Tm(I[4],G),d:Tm(I[5],G),h:Tm(I[6],G),m:Tm(I[7],G),s:Tm(I[8],G)}):T==null?T={}:typeof T=="object"&&("from"in T||"to"in T)&&(Fe=zwe(Or(T.from),Or(T.to)),T={},T.ms=Fe.milliseconds,T.M=Fe.months),we=new zT(T),YT(m)&&o(m,"_locale")&&(we._locale=m._locale),YT(m)&&o(m,"_isValid")&&(we._isValid=m._isValid),we}Wl.fn=zT.prototype,Wl.invalid=Mwe;function Tm(m,v){var T=m&&parseFloat(m.replace(",","."));return(isNaN(T)?0:T)*v}function V$(m,v){var T={};return T.months=v.month()-m.month()+(v.year()-m.year())*12,m.clone().add(T.months,"M").isAfter(v)&&--T.months,T.milliseconds=+v-+m.clone().add(T.months,"M"),T}function zwe(m,v){var T;return m.isValid()&&v.isValid()?(v=Mk(v,m),m.isBefore(v)?T=V$(m,v):(T=V$(v,m),T.milliseconds=-T.milliseconds,T.months=-T.months),T):{milliseconds:0,months:0}}function B$(m,v){return function(T,I){var G,we;return I!==null&&!isNaN(+I)&&(Y(v,"moment()."+v+"(period, number) is deprecated. Please use moment()."+v+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),we=T,T=I,I=we),G=Wl(T,I),U$(this,G,m),this}}function U$(m,v,T,I){var G=v._milliseconds,we=Ik(v._days),Fe=Ik(v._months);m.isValid()&&(I=I??!0,Fe&&Hl(m,Ve(m,"Month")+Fe*T),we&&ke(m,"Date",Ve(m,"Date")+we*T),G&&m._d.setTime(m._d.valueOf()+G*T),I&&e.updateOffset(m,we||Fe))}var Ywe=B$(1,"add"),qwe=B$(-1,"subtract");function W$(m){return typeof m=="string"||m instanceof String}function Kwe(m){return b(m)||c(m)||W$(m)||l(m)||Zwe(m)||Xwe(m)||m===null||m===void 0}function Xwe(m){var v=i(m)&&!s(m),T=!1,I=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],G,we,Fe=I.length;for(G=0;G<Fe;G+=1)we=I[G],T=T||o(m,we);return v&&T}function Zwe(m){var v=r(m),T=!1;return v&&(T=m.filter(function(I){return!l(I)&&W$(m)}).length===0),v&&T}function Qwe(m){var v=i(m)&&!s(m),T=!1,I=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],G,we;for(G=0;G<I.length;G+=1)we=I[G],T=T||o(m,we);return v&&T}function Jwe(m,v){var T=m.diff(v,"days",!0);return T<-6?"sameElse":T<-1?"lastWeek":T<0?"lastDay":T<1?"sameDay":T<2?"nextDay":T<7?"nextWeek":"sameElse"}function eye(m,v){arguments.length===1&&(arguments[0]?Kwe(arguments[0])?(m=arguments[0],v=void 0):Qwe(arguments[0])&&(v=arguments[0],m=void 0):(m=void 0,v=void 0));var T=m||Or(),I=Mk(T,this).startOf("day"),G=e.calendarFormat(this,I)||"sameElse",we=v&&(ee(v[G])?v[G].call(this,T):v[G]);return this.format(we||this.localeData().calendar(G,this,Or(T)))}function tye(){return new k(this)}function nye(m,v){var T=b(m)?m:Or(m);return this.isValid()&&T.isValid()?(v=J(v)||"millisecond",v==="millisecond"?this.valueOf()>T.valueOf():T.valueOf()<this.clone().startOf(v).valueOf()):!1}function rye(m,v){var T=b(m)?m:Or(m);return this.isValid()&&T.isValid()?(v=J(v)||"millisecond",v==="millisecond"?this.valueOf()<T.valueOf():this.clone().endOf(v).valueOf()<T.valueOf()):!1}function iye(m,v,T,I){var G=b(m)?m:Or(m),we=b(v)?v:Or(v);return this.isValid()&&G.isValid()&&we.isValid()?(I=I||"()",(I[0]==="("?this.isAfter(G,T):!this.isBefore(G,T))&&(I[1]===")"?this.isBefore(we,T):!this.isAfter(we,T))):!1}function oye(m,v){var T=b(m)?m:Or(m),I;return this.isValid()&&T.isValid()?(v=J(v)||"millisecond",v==="millisecond"?this.valueOf()===T.valueOf():(I=T.valueOf(),this.clone().startOf(v).valueOf()<=I&&I<=this.clone().endOf(v).valueOf())):!1}function sye(m,v){return this.isSame(m,v)||this.isAfter(m,v)}function aye(m,v){return this.isSame(m,v)||this.isBefore(m,v)}function lye(m,v,T){var I,G,we;if(!this.isValid())return NaN;if(I=Mk(m,this),!I.isValid())return NaN;switch(G=(I.utcOffset()-this.utcOffset())*6e4,v=J(v),v){case"year":we=qT(this,I)/12;break;case"month":we=qT(this,I);break;case"quarter":we=qT(this,I)/3;break;case"second":we=(this-I)/1e3;break;case"minute":we=(this-I)/6e4;break;case"hour":we=(this-I)/36e5;break;case"day":we=(this-I-G)/864e5;break;case"week":we=(this-I-G)/6048e5;break;default:we=this-I}return T?we:ce(we)}function qT(m,v){if(m.date()<v.date())return-qT(v,m);var T=(v.year()-m.year())*12+(v.month()-m.month()),I=m.clone().add(T,"months"),G,we;return v-I<0?(G=m.clone().add(T-1,"months"),we=(v-I)/(I-G)):(G=m.clone().add(T+1,"months"),we=(v-I)/(G-I)),-(T+we)||0}e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function cye(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function uye(m){if(!this.isValid())return null;var v=m!==!0,T=v?this.clone().utc():this;return T.year()<0||T.year()>9999?ie(T,v?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):ee(Date.prototype.toISOString)?v?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",ie(T,"Z")):ie(T,v?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function dye(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var m="moment",v="",T,I,G,we;return this.isLocal()||(m=this.utcOffset()===0?"moment.utc":"moment.parseZone",v="Z"),T="["+m+'("]',I=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",G="-MM-DD[T]HH:mm:ss.SSS",we=v+'[")]',this.format(T+I+G+we)}function hye(m){m||(m=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var v=ie(this,m);return this.localeData().postformat(v)}function fye(m,v){return this.isValid()&&(b(m)&&m.isValid()||Or(m).isValid())?Wl({to:this,from:m}).locale(this.locale()).humanize(!v):this.localeData().invalidDate()}function mye(m){return this.from(Or(),m)}function pye(m,v){return this.isValid()&&(b(m)&&m.isValid()||Or(m).isValid())?Wl({from:this,to:m}).locale(this.locale()).humanize(!v):this.localeData().invalidDate()}function gye(m){return this.to(Or(),m)}function j$(m){var v;return m===void 0?this._locale._abbr:(v=Ju(m),v!=null&&(this._locale=v),this)}var $$=N("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(m){return m===void 0?this.localeData():this.locale(m)});function G$(){return this._locale}var KT=1e3,h0=60*KT,XT=60*h0,z$=(365*400+97)*24*XT;function f0(m,v){return(m%v+v)%v}function Y$(m,v,T){return m<100&&m>=0?new Date(m+400,v,T)-z$:new Date(m,v,T).valueOf()}function q$(m,v,T){return m<100&&m>=0?Date.UTC(m+400,v,T)-z$:Date.UTC(m,v,T)}function vye(m){var v,T;if(m=J(m),m===void 0||m==="millisecond"||!this.isValid())return this;switch(T=this._isUTC?q$:Y$,m){case"year":v=T(this.year(),0,1);break;case"quarter":v=T(this.year(),this.month()-this.month()%3,1);break;case"month":v=T(this.year(),this.month(),1);break;case"week":v=T(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":v=T(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":v=T(this.year(),this.month(),this.date());break;case"hour":v=this._d.valueOf(),v-=f0(v+(this._isUTC?0:this.utcOffset()*h0),XT);break;case"minute":v=this._d.valueOf(),v-=f0(v,h0);break;case"second":v=this._d.valueOf(),v-=f0(v,KT);break}return this._d.setTime(v),e.updateOffset(this,!0),this}function wye(m){var v,T;if(m=J(m),m===void 0||m==="millisecond"||!this.isValid())return this;switch(T=this._isUTC?q$:Y$,m){case"year":v=T(this.year()+1,0,1)-1;break;case"quarter":v=T(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":v=T(this.year(),this.month()+1,1)-1;break;case"week":v=T(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":v=T(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":v=T(this.year(),this.month(),this.date()+1)-1;break;case"hour":v=this._d.valueOf(),v+=XT-f0(v+(this._isUTC?0:this.utcOffset()*h0),XT)-1;break;case"minute":v=this._d.valueOf(),v+=h0-f0(v,h0)-1;break;case"second":v=this._d.valueOf(),v+=KT-f0(v,KT)-1;break}return this._d.setTime(v),e.updateOffset(this,!0),this}function yye(){return this._d.valueOf()-(this._offset||0)*6e4}function _ye(){return Math.floor(this.valueOf()/1e3)}function Cye(){return new Date(this.valueOf())}function Sye(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function Eye(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function xye(){return this.isValid()?this.toISOString():null}function bye(){return w(this)}function Tye(){return d({},p(this))}function Rye(){return p(this).overflow}function Dye(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}A("N",0,0,"eraAbbr"),A("NN",0,0,"eraAbbr"),A("NNN",0,0,"eraAbbr"),A("NNNN",0,0,"eraName"),A("NNNNN",0,0,"eraNarrow"),A("y",["y",1],"yo","eraYear"),A("y",["yy",2],0,"eraYear"),A("y",["yyy",3],0,"eraYear"),A("y",["yyyy",4],0,"eraYear"),Et("N",Nk),Et("NN",Nk),Et("NNN",Nk),Et("NNNN",Vye),Et("NNNNN",Bye),H(["N","NN","NNN","NNNN","NNNNN"],function(m,v,T,I){var G=T._locale.erasParse(m,I,T._strict);G?p(T).era=G:p(T).invalidEra=m}),Et("y",_r),Et("yy",_r),Et("yyy",_r),Et("yyyy",_r),Et("yo",Uye),H(["y","yy","yyy","yyyy"],K),H(["yo"],function(m,v,T,I){var G;T._locale._eraYearOrdinalRegex&&(G=m.match(T._locale._eraYearOrdinalRegex)),T._locale.eraYearOrdinalParse?v[K]=T._locale.eraYearOrdinalParse(m,G):v[K]=parseInt(m,10)});function Iye(m,v){var T,I,G,we=this._eras||Ju("en")._eras;for(T=0,I=we.length;T<I;++T){switch(typeof we[T].since){case"string":G=e(we[T].since).startOf("day"),we[T].since=G.valueOf();break}switch(typeof we[T].until){case"undefined":we[T].until=1/0;break;case"string":G=e(we[T].until).startOf("day").valueOf(),we[T].until=G.valueOf();break}}return we}function Aye(m,v,T){var I,G,we=this.eras(),Fe,Ht,En;for(m=m.toUpperCase(),I=0,G=we.length;I<G;++I)if(Fe=we[I].name.toUpperCase(),Ht=we[I].abbr.toUpperCase(),En=we[I].narrow.toUpperCase(),T)switch(v){case"N":case"NN":case"NNN":if(Ht===m)return we[I];break;case"NNNN":if(Fe===m)return we[I];break;case"NNNNN":if(En===m)return we[I];break}else if([Fe,Ht,En].indexOf(m)>=0)return we[I]}function Mye(m,v){var T=m.since<=m.until?1:-1;return v===void 0?e(m.since).year():e(m.since).year()+(v-m.offset)*T}function Oye(){var m,v,T,I=this.localeData().eras();for(m=0,v=I.length;m<v;++m)if(T=this.clone().startOf("day").valueOf(),I[m].since<=T&&T<=I[m].until||I[m].until<=T&&T<=I[m].since)return I[m].name;return""}function Nye(){var m,v,T,I=this.localeData().eras();for(m=0,v=I.length;m<v;++m)if(T=this.clone().startOf("day").valueOf(),I[m].since<=T&&T<=I[m].until||I[m].until<=T&&T<=I[m].since)return I[m].narrow;return""}function Pye(){var m,v,T,I=this.localeData().eras();for(m=0,v=I.length;m<v;++m)if(T=this.clone().startOf("day").valueOf(),I[m].since<=T&&T<=I[m].until||I[m].until<=T&&T<=I[m].since)return I[m].abbr;return""}function kye(){var m,v,T,I,G=this.localeData().eras();for(m=0,v=G.length;m<v;++m)if(T=G[m].since<=G[m].until?1:-1,I=this.clone().startOf("day").valueOf(),G[m].since<=I&&I<=G[m].until||G[m].until<=I&&I<=G[m].since)return(this.year()-e(G[m].since).year())*T+G[m].offset;return this.year()}function Fye(m){return o(this,"_erasNameRegex")||Pk.call(this),m?this._erasNameRegex:this._erasRegex}function Lye(m){return o(this,"_erasAbbrRegex")||Pk.call(this),m?this._erasAbbrRegex:this._erasRegex}function Hye(m){return o(this,"_erasNarrowRegex")||Pk.call(this),m?this._erasNarrowRegex:this._erasRegex}function Nk(m,v){return v.erasAbbrRegex(m)}function Vye(m,v){return v.erasNameRegex(m)}function Bye(m,v){return v.erasNarrowRegex(m)}function Uye(m,v){return v._eraYearOrdinalRegex||_r}function Pk(){var m=[],v=[],T=[],I=[],G,we,Fe=this.eras();for(G=0,we=Fe.length;G<we;++G)v.push(Ar(Fe[G].name)),m.push(Ar(Fe[G].abbr)),T.push(Ar(Fe[G].narrow)),I.push(Ar(Fe[G].name)),I.push(Ar(Fe[G].abbr)),I.push(Ar(Fe[G].narrow));this._erasRegex=new RegExp("^("+I.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+v.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+m.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+T.join("|")+")","i")}A(0,["gg",2],0,function(){return this.weekYear()%100}),A(0,["GG",2],0,function(){return this.isoWeekYear()%100});function ZT(m,v){A(0,[m,m.length],0,v)}ZT("gggg","weekYear"),ZT("ggggg","weekYear"),ZT("GGGG","isoWeekYear"),ZT("GGGGG","isoWeekYear"),z("weekYear","gg"),z("isoWeekYear","GG"),me("weekYear",1),me("isoWeekYear",1),Et("G",vn),Et("g",vn),Et("GG",Mn,Nt),Et("gg",Mn,Nt),Et("GGGG",ga,Rn),Et("gggg",ga,Rn),Et("GGGGG",Ir,yr),Et("ggggg",Ir,yr),se(["gggg","ggggg","GGGG","GGGGG"],function(m,v,T,I){v[I.substr(0,2)]=oe(m)}),se(["gg","GG"],function(m,v,T,I){v[I]=e.parseTwoDigitYear(m)});function Wye(m){return K$.call(this,m,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function jye(m){return K$.call(this,m,this.isoWeek(),this.isoWeekday(),1,4)}function $ye(){return Ks(this.year(),1,4)}function Gye(){return Ks(this.isoWeekYear(),1,4)}function zye(){var m=this.localeData()._week;return Ks(this.year(),m.dow,m.doy)}function Yye(){var m=this.localeData()._week;return Ks(this.weekYear(),m.dow,m.doy)}function K$(m,v,T,I,G){var we;return m==null?Bc(this,I,G).year:(we=Ks(m,I,G),v>we&&(v=we),qye.call(this,m,v,T,I,G))}function qye(m,v,T,I,G){var we=a_(m,v,T,I,G),Fe=yh(we.year,0,we.dayOfYear);return this.year(Fe.getUTCFullYear()),this.month(Fe.getUTCMonth()),this.date(Fe.getUTCDate()),this}A("Q",0,"Qo","quarter"),z("quarter","Q"),me("quarter",7),Et("Q",Mt),H("Q",function(m,v){v[ae]=(oe(m)-1)*3});function Kye(m){return m==null?Math.ceil((this.month()+1)/3):this.month((m-1)*3+this.month()%3)}A("D",["DD",2],"Do","date"),z("date","D"),me("date",9),Et("D",Mn),Et("DD",Mn,Nt),Et("Do",function(m,v){return m?v._dayOfMonthOrdinalParse||v._ordinalParse:v._dayOfMonthOrdinalParseLenient}),H(["D","DD"],le),H("Do",function(m,v){v[le]=oe(m.match(Mn)[0])});var X$=ge("Date",!0);A("DDD",["DDDD",3],"DDDo","dayOfYear"),z("dayOfYear","DDD"),me("dayOfYear",4),Et("DDD",ji),Et("DDDD",$t),H(["DDD","DDDD"],function(m,v,T){T._dayOfYear=oe(m)});function Xye(m){var v=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return m==null?v:this.add(m-v,"d")}A("m",["mm",2],0,"minute"),z("minute","m"),me("minute",14),Et("m",Mn),Et("mm",Mn,Nt),H(["m","mm"],Ae);var Zye=ge("Minutes",!1);A("s",["ss",2],0,"second"),z("second","s"),me("second",15),Et("s",Mn),Et("ss",Mn,Nt),H(["s","ss"],Ie);var Qye=ge("Seconds",!1);A("S",0,0,function(){return~~(this.millisecond()/100)}),A(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),A(0,["SSS",3],0,"millisecond"),A(0,["SSSS",4],0,function(){return this.millisecond()*10}),A(0,["SSSSS",5],0,function(){return this.millisecond()*100}),A(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),A(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),A(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),A(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),z("millisecond","ms"),me("millisecond",16),Et("S",ji,Mt),Et("SS",ji,Nt),Et("SSS",ji,$t);var xh,Z$;for(xh="SSSS";xh.length<=9;xh+="S")Et(xh,_r);function Jye(m,v){v[xe]=oe(("0."+m)*1e3)}for(xh="S";xh.length<=9;xh+="S")H(xh,Jye);Z$=ge("Milliseconds",!1),A("z",0,0,"zoneAbbr"),A("zz",0,0,"zoneName");function e_e(){return this._isUTC?"UTC":""}function t_e(){return this._isUTC?"Coordinated Universal Time":""}var et=k.prototype;et.add=Ywe,et.calendar=eye,et.clone=tye,et.diff=lye,et.endOf=wye,et.format=hye,et.from=fye,et.fromNow=mye,et.to=pye,et.toNow=gye,et.get=Xe,et.invalidAt=Rye,et.isAfter=nye,et.isBefore=rye,et.isBetween=iye,et.isSame=oye,et.isSameOrAfter=sye,et.isSameOrBefore=aye,et.isValid=bye,et.lang=$$,et.locale=j$,et.localeData=G$,et.max=bwe,et.min=xwe,et.parsingFlags=Tye,et.set=gt,et.startOf=vye,et.subtract=qwe,et.toArray=Sye,et.toObject=Eye,et.toDate=Cye,et.toISOString=uye,et.inspect=dye,typeof Symbol<"u"&&Symbol.for!=null&&(et[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),et.toJSON=xye,et.toString=cye,et.unix=_ye,et.valueOf=yye,et.creationData=Dye,et.eraName=Oye,et.eraNarrow=Nye,et.eraAbbr=Pye,et.eraYear=kye,et.year=Zu,et.isLeapYear=PT,et.weekYear=Wye,et.isoWeekYear=jye,et.quarter=et.quarters=Kye,et.month=ws,et.daysInMonth=NT,et.week=et.weeks=wk,et.isoWeek=et.isoWeeks=Qu,et.weeksInYear=zye,et.weeksInWeekYear=Yye,et.isoWeeksInYear=$ye,et.isoWeeksInISOWeekYear=Gye,et.date=X$,et.day=et.days=h_,et.weekday=BT,et.isoWeekday=UT,et.dayOfYear=Xye,et.hour=et.hours=Qe,et.minute=et.minutes=Zye,et.second=et.seconds=Qye,et.millisecond=et.milliseconds=Z$,et.utcOffset=Pwe,et.utc=Fwe,et.local=Lwe,et.parseZone=Hwe,et.hasAlignedHourOffset=Vwe,et.isDST=Bwe,et.isLocal=Wwe,et.isUtcOffset=jwe,et.isUtc=H$,et.isUTC=H$,et.zoneAbbr=e_e,et.zoneName=t_e,et.dates=N("dates accessor is deprecated. Use date instead.",X$),et.months=N("months accessor is deprecated. Use month instead",ws),et.years=N("years accessor is deprecated. Use year instead",Zu),et.zone=N("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",kwe),et.isDSTShifted=N("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Uwe);function n_e(m){return Or(m*1e3)}function r_e(){return Or.apply(null,arguments).parseZone()}function Q$(m){return m}var Xn=Re.prototype;Xn.calendar=M,Xn.longDateFormat=de,Xn.invalidDate=Pe,Xn.ordinal=$e,Xn.preparse=Q$,Xn.postformat=Q$,Xn.relativeTime=Ye,Xn.pastFuture=Me,Xn.set=te,Xn.eras=Iye,Xn.erasParse=Aye,Xn.erasConvertYear=Mye,Xn.erasAbbrRegex=Lye,Xn.erasNameRegex=Fye,Xn.erasNarrowRegex=Hye,Xn.months=$i,Xn.monthsShort=Ll,Xn.monthsParse=qs,Xn.monthsRegex=s_,Xn.monthsShortRegex=vk,Xn.week=Vl,Xn.firstDayOfYear=c_,Xn.firstDayOfWeek=l_,Xn.weekdays=Ck,Xn.weekdaysMin=d_,Xn.weekdaysShort=a0,Xn.weekdaysParse=Bl,Xn.weekdaysRegex=Ek,Xn.weekdaysShortRegex=bm,Xn.weekdaysMinRegex=Ul,Xn.isPM=Lt,Xn.meridiem=wt;function QT(m,v,T,I){var G=Ju(),we=h().set(I,v);return G[T](we,m)}function J$(m,v,T){if(l(m)&&(v=m,m=void 0),m=m||"",v!=null)return QT(m,v,T,"month");var I,G=[];for(I=0;I<12;I++)G[I]=QT(m,I,T,"month");return G}function kk(m,v,T,I){typeof m=="boolean"?(l(v)&&(T=v,v=void 0),v=v||""):(v=m,T=v,m=!1,l(v)&&(T=v,v=void 0),v=v||"");var G=Ju(),we=m?G._week.dow:0,Fe,Ht=[];if(T!=null)return QT(v,(T+we)%7,I,"day");for(Fe=0;Fe<7;Fe++)Ht[Fe]=QT(v,(Fe+we)%7,I,"day");return Ht}function i_e(m,v){return J$(m,v,"months")}function o_e(m,v){return J$(m,v,"monthsShort")}function s_e(m,v,T){return kk(m,v,T,"weekdays")}function a_e(m,v,T){return kk(m,v,T,"weekdaysShort")}function l_e(m,v,T){return kk(m,v,T,"weekdaysMin")}Eh("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(m){var v=m%10,T=oe(m%100/10)===1?"th":v===1?"st":v===2?"nd":v===3?"rd":"th";return m+T}}),e.lang=N("moment.lang is deprecated. Use moment.locale instead.",Eh),e.langData=N("moment.langData is deprecated. Use moment.localeData instead.",Ju);var ed=Math.abs;function c_e(){var m=this._data;return this._milliseconds=ed(this._milliseconds),this._days=ed(this._days),this._months=ed(this._months),m.milliseconds=ed(m.milliseconds),m.seconds=ed(m.seconds),m.minutes=ed(m.minutes),m.hours=ed(m.hours),m.months=ed(m.months),m.years=ed(m.years),this}function eG(m,v,T,I){var G=Wl(v,T);return m._milliseconds+=I*G._milliseconds,m._days+=I*G._days,m._months+=I*G._months,m._bubble()}function u_e(m,v){return eG(this,m,v,1)}function d_e(m,v){return eG(this,m,v,-1)}function tG(m){return m<0?Math.floor(m):Math.ceil(m)}function h_e(){var m=this._milliseconds,v=this._days,T=this._months,I=this._data,G,we,Fe,Ht,En;return m>=0&&v>=0&&T>=0||m<=0&&v<=0&&T<=0||(m+=tG(Fk(T)+v)*864e5,v=0,T=0),I.milliseconds=m%1e3,G=ce(m/1e3),I.seconds=G%60,we=ce(G/60),I.minutes=we%60,Fe=ce(we/60),I.hours=Fe%24,v+=ce(Fe/24),En=ce(nG(v)),T+=En,v-=tG(Fk(En)),Ht=ce(T/12),T%=12,I.days=v,I.months=T,I.years=Ht,this}function nG(m){return m*4800/146097}function Fk(m){return m*146097/4800}function f_e(m){if(!this.isValid())return NaN;var v,T,I=this._milliseconds;if(m=J(m),m==="month"||m==="quarter"||m==="year")switch(v=this._days+I/864e5,T=this._months+nG(v),m){case"month":return T;case"quarter":return T/3;case"year":return T/12}else switch(v=this._days+Math.round(Fk(this._months)),m){case"week":return v/7+I/6048e5;case"day":return v+I/864e5;case"hour":return v*24+I/36e5;case"minute":return v*1440+I/6e4;case"second":return v*86400+I/1e3;case"millisecond":return Math.floor(v*864e5)+I;default:throw new Error("Unknown unit "+m)}}function m_e(){return this.isValid()?this._milliseconds+this._days*864e5+this._months%12*2592e6+oe(this._months/12)*31536e6:NaN}function td(m){return function(){return this.as(m)}}var p_e=td("ms"),g_e=td("s"),v_e=td("m"),w_e=td("h"),y_e=td("d"),__e=td("w"),C_e=td("M"),S_e=td("Q"),E_e=td("y");function x_e(){return Wl(this)}function b_e(m){return m=J(m),this.isValid()?this[m+"s"]():NaN}function Rm(m){return function(){return this.isValid()?this._data[m]:NaN}}var T_e=Rm("milliseconds"),R_e=Rm("seconds"),D_e=Rm("minutes"),I_e=Rm("hours"),A_e=Rm("days"),M_e=Rm("months"),O_e=Rm("years");function N_e(){return ce(this.days()/7)}var nd=Math.round,m0={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function P_e(m,v,T,I,G){return G.relativeTime(v||1,!!T,m,I)}function k_e(m,v,T,I){var G=Wl(m).abs(),we=nd(G.as("s")),Fe=nd(G.as("m")),Ht=nd(G.as("h")),En=nd(G.as("d")),Cr=nd(G.as("M")),ys=nd(G.as("w")),rd=nd(G.as("y")),bh=we<=T.ss&&["s",we]||we<T.s&&["ss",we]||Fe<=1&&["m"]||Fe<T.m&&["mm",Fe]||Ht<=1&&["h"]||Ht<T.h&&["hh",Ht]||En<=1&&["d"]||En<T.d&&["dd",En];return T.w!=null&&(bh=bh||ys<=1&&["w"]||ys<T.w&&["ww",ys]),bh=bh||Cr<=1&&["M"]||Cr<T.M&&["MM",Cr]||rd<=1&&["y"]||["yy",rd],bh[2]=v,bh[3]=+m>0,bh[4]=I,P_e.apply(null,bh)}function F_e(m){return m===void 0?nd:typeof m=="function"?(nd=m,!0):!1}function L_e(m,v){return m0[m]===void 0?!1:v===void 0?m0[m]:(m0[m]=v,m==="s"&&(m0.ss=v-1),!0)}function H_e(m,v){if(!this.isValid())return this.localeData().invalidDate();var T=!1,I=m0,G,we;return typeof m=="object"&&(v=m,m=!1),typeof m=="boolean"&&(T=m),typeof v=="object"&&(I=Object.assign({},m0,v),v.s!=null&&v.ss==null&&(I.ss=v.s-1)),G=this.localeData(),we=k_e(this,!T,I,G),T&&(we=G.pastFuture(+this,we)),G.postformat(we)}var Lk=Math.abs;function p0(m){return(m>0)-(m<0)||+m}function JT(){if(!this.isValid())return this.localeData().invalidDate();var m=Lk(this._milliseconds)/1e3,v=Lk(this._days),T=Lk(this._months),I,G,we,Fe,Ht=this.asSeconds(),En,Cr,ys,rd;return Ht?(I=ce(m/60),G=ce(I/60),m%=60,I%=60,we=ce(T/12),T%=12,Fe=m?m.toFixed(3).replace(/\.?0+$/,""):"",En=Ht<0?"-":"",Cr=p0(this._months)!==p0(Ht)?"-":"",ys=p0(this._days)!==p0(Ht)?"-":"",rd=p0(this._milliseconds)!==p0(Ht)?"-":"",En+"P"+(we?Cr+we+"Y":"")+(T?Cr+T+"M":"")+(v?ys+v+"D":"")+(G||I||m?"T":"")+(G?rd+G+"H":"")+(I?rd+I+"M":"")+(m?rd+Fe+"S":"")):"P0D"}var Wn=zT.prototype;Wn.isValid=Awe,Wn.abs=c_e,Wn.add=u_e,Wn.subtract=d_e,Wn.as=f_e,Wn.asMilliseconds=p_e,Wn.asSeconds=g_e,Wn.asMinutes=v_e,Wn.asHours=w_e,Wn.asDays=y_e,Wn.asWeeks=__e,Wn.asMonths=C_e,Wn.asQuarters=S_e,Wn.asYears=E_e,Wn.valueOf=m_e,Wn._bubble=h_e,Wn.clone=x_e,Wn.get=b_e,Wn.milliseconds=T_e,Wn.seconds=R_e,Wn.minutes=D_e,Wn.hours=I_e,Wn.days=A_e,Wn.weeks=N_e,Wn.months=M_e,Wn.years=O_e,Wn.humanize=H_e,Wn.toISOString=JT,Wn.toString=JT,Wn.toJSON=JT,Wn.locale=j$,Wn.localeData=G$,Wn.toIsoString=N("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",JT),Wn.lang=$$,A("X",0,0,"unix"),A("x",0,0,"valueOf"),Et("x",vn),Et("X",Em),H("X",function(m,v,T){T._d=new Date(parseFloat(m)*1e3)}),H("x",function(m,v,T){T._d=new Date(oe(m))});return e.version="2.29.4",n(Or),e.fn=et,e.min=Twe,e.max=Rwe,e.now=Dwe,e.utc=h,e.unix=n_e,e.months=i_e,e.isDate=c,e.locale=Eh,e.invalid=_,e.duration=Wl,e.isMoment=b,e.weekdays=s_e,e.parseZone=r_e,e.localeData=Ju,e.isDuration=YT,e.monthsShort=o_e,e.weekdaysMin=l_e,e.defineLocale=xk,e.updateLocale=rwe,e.locales=iwe,e.weekdaysShort=a_e,e.normalizeUnits=J,e.relativeTimeRounding=F_e,e.relativeTimeThreshold=L_e,e.calendarFormat=Jwe,e.prototype=et,e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},e})});var hoe=We((BEt,doe)=>{"use strict";var tGe=cs(),loe=h4(),nGe=vo(),coe=Vp(),rGe=g4(),uoe=tGe([].push);doe.exports=function(t){if(nGe(t))return t;if(loe(t)){for(var e=t.length,n=[],r=0;r<e;r++){var i=t[r];typeof i=="string"?uoe(n,i):(typeof i=="number"||coe(i)==="Number"||coe(i)==="String")&&uoe(n,rGe(i))}var o=n.length,s=!0;return function(a,l){if(s)return s=!1,l;if(loe(this))return l;for(var c=0;c<o;c++)if(n[c]===a)return l}}}});var CM=We(()=>{"use strict";var iGe=Tf(),_oe=qv(),Coe=dS(),oGe=iS(),ES=cs(),Soe=Ia(),foe=vo(),moe=jA(),Eoe=iM(),sGe=hoe(),aGe=WA(),lGe=String,Mf=_oe("JSON","stringify"),_M=ES(/./.exec),poe=ES("".charAt),cGe=ES("".charCodeAt),uGe=ES("".replace),dGe=ES(1 .toString),hGe=/[\uD800-\uDFFF]/g,goe=/^[\uD800-\uDBFF]$/,voe=/^[\uDC00-\uDFFF]$/,woe=!aGe||Soe(function(){var t=_oe("Symbol")("stringify detection");return Mf([t])!=="[null]"||Mf({a:t})!=="{}"||Mf(Object(t))!=="{}"}),yoe=Soe(function(){return Mf("\uDF06\uD834")!=='"\\udf06\\ud834"'||Mf("\uDEAD")!=='"\\udead"'}),fGe=function(t,e){var n=Eoe(arguments),r=sGe(e);if(!(!foe(r)&&(t===void 0||moe(t))))return n[1]=function(i,o){if(foe(r)&&(o=oGe(r,this,lGe(i),o)),!moe(o))return o},Coe(Mf,null,n)},mGe=function(t,e,n){var r=poe(n,e-1),i=poe(n,e+1);return _M(goe,t)&&!_M(voe,i)||_M(voe,t)&&!_M(goe,r)?"\\u"+dGe(cGe(t,0),16):t};Mf&&iGe({target:"JSON",stat:!0,arity:3,forced:woe||yoe},{stringify:function(e,n,r){var i=Eoe(arguments),o=Coe(woe?fGe:Mf,null,i);return yoe&&typeof o=="string"?uGe(o,hGe,mGe):o}})});var ese=We((dbt,Joe)=>{"use strict";var tze=c4(),nze=tM();Joe.exports=Object.keys||function(e){return tze(e,nze)}});var nse=We(tse=>{"use strict";var rze=dc(),ize=q3(),oze=Bp(),sze=Xv(),aze=oS(),lze=ese();tse.f=rze&&!ize?Object.defineProperties:function(e,n){sze(e);for(var r=aze(n),i=lze(n),o=i.length,s=0,a;o>s;)oze.f(e,a=i[s++],r[a]);return e}});var use=We((fbt,cse)=>{"use strict";var cze=Xv(),uze=nse(),rse=tM(),dze=KA(),hze=y4(),fze=YA(),mze=n4(),ise=">",ose="<",fU="prototype",mU="script",ase=mze("IE_PROTO"),hU=function(){},lse=function(t){return ose+mU+ise+t+ose+"/"+mU+ise},sse=function(t){t.write(lse("")),t.close();var e=t.parentWindow.Object;return t=null,e},pze=function(){var t=fze("iframe"),e="java"+mU+":",n;return t.style.display="none",hze.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(lse("document.F=Object")),n.close(),n.F},BM,UM=function(){try{BM=new ActiveXObject("htmlfile")}catch{}UM=typeof document<"u"?document.domain&&BM?sse(BM):pze():sse(BM);for(var t=rse.length;t--;)delete UM[fU][rse[t]];return UM()};dze[ase]=!0;cse.exports=Object.create||function(e,n){var r;return e!==null?(hU[fU]=cze(e),r=new hU,hU[fU]=null,r[ase]=e):r=UM(),n===void 0?r:uze.f(r,n)}});var vU=We((mbt,dse)=>{"use strict";var gze=aS(),vze=use(),wze=Bp().f,pU=gze("unscopables"),gU=Array.prototype;gU[pU]===void 0&&wze(gU,pU,{configurable:!0,value:vze(null)});dse.exports=function(t){gU[pU][t]=!0}});var wU=We(()=>{"use strict";var yze=Tf(),_ze=sS(),Cze=cS(),Sze=eM(),Eze=vU();yze({target:"Array",proto:!0},{at:function(e){var n=_ze(this),r=Cze(n),i=Sze(e),o=i>=0?i:r+i;return o<0||o>=r?void 0:n[o]}});Eze("at")});var VU=We(()=>{"use strict";var G9e=vU();G9e("flat")});var kce=We((GW,Pce)=>{(function(t,e){"use strict";var n;if(typeof GW=="object"){try{n=Ma()}catch{}Pce.exports=e(n)}else typeof define=="function"&&define.amd?define(function(r){var i="moment";try{n=r(i)}catch{}return e(n)}):t.Pikaday=e(t.moment)})(GW,function(t){"use strict";var e=typeof t=="function",n=!!window.addEventListener,r=window.document,i=window.setTimeout,o=function(L,M,q,y){n?L.addEventListener(M,q,!!y):L.attachEvent("on"+M,q)},s=function(L,M,q,y){n?L.removeEventListener(M,q,!!y):L.detachEvent("on"+M,q)},a=function(L){return L.trim?L.trim():L.replace(/^\s+|\s+$/g,"")},l=function(L,M){return(" "+L.className+" ").indexOf(" "+M+" ")!==-1},c=function(L,M){l(L,M)||(L.className=L.className===""?M:L.className+" "+M)},u=function(L,M){L.className=a((" "+L.className+" ").replace(" "+M+" "," "))},d=function(L){return/Array/.test(Object.prototype.toString.call(L))},h=function(L){return/Date/.test(Object.prototype.toString.call(L))&&!isNaN(L.getTime())},f=function(L){var M=L.getDay();return M===0||M===6},p=function(L){return L%4===0&&L%100!==0||L%400===0},g=function(L,M){return[31,p(L)?29:28,31,30,31,30,31,31,30,31,30,31][M]},w=function(L){h(L)&&L.setHours(0,0,0,0)},_=function(L,M){return L.getTime()===M.getTime()},S=function(L,M,q){var y,E;for(y in M)E=L[y]!==void 0,E&&typeof M[y]=="object"&&M[y]!==null&&M[y].nodeName===void 0?h(M[y])?q&&(L[y]=new Date(M[y].getTime())):d(M[y])?q&&(L[y]=M[y].slice(0)):L[y]=S({},M[y],q):(q||!E)&&(L[y]=M[y]);return L},x=function(L,M,q){var y;r.createEvent?(y=r.createEvent("HTMLEvents"),y.initEvent(M,!0,!1),y=S(y,q),L.dispatchEvent(y)):r.createEventObject&&(y=r.createEventObject(),y=S(y,q),L.fireEvent("on"+M,y))},P=function(L){return L.month<0&&(L.year-=Math.ceil(Math.abs(L.month)/12),L.month+=12),L.month>11&&(L.year+=Math.floor(Math.abs(L.month)/12),L.month-=12),L},k={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},b=function(L,M,q){for(M+=L.firstDay;M>=7;)M-=7;return q?L.i18n.weekdaysShort[M]:L.i18n.weekdays[M]},C=function(L){var M=[],q="false";if(L.isEmpty)if(L.showDaysInNextAndPreviousMonths)M.push("is-outside-current-month"),L.enableSelectionDaysInNextAndPreviousMonths||M.push("is-selection-disabled");else return'<td class="is-empty"></td>';return L.isDisabled&&M.push("is-disabled"),L.isToday&&M.push("is-today"),L.isSelected&&(M.push("is-selected"),q="true"),L.hasEvent&&M.push("has-event"),L.isInRange&&M.push("is-inrange"),L.isStartRange&&M.push("is-startrange"),L.isEndRange&&M.push("is-endrange"),'<td data-day="'+L.day+'" class="'+M.join(" ")+'" aria-selected="'+q+'"><button class="pika-button pika-day" type="button" data-pika-year="'+L.year+'" data-pika-month="'+L.month+'" data-pika-day="'+L.day+'">'+L.day+"</button></td>"},N=function(L,M){L.setHours(0,0,0,0);var q=L.getDate(),y=L.getDay(),E=M,R=E-1,D=7,A=function(fe){return(fe+D-1)%D};L.setDate(q+R-A(y));var O=new Date(L.getFullYear(),0,E),U=24*60*60*1e3,ie=(L.getTime()-O.getTime())/U,ue=1+Math.round((ie-R+A(O.getDay()))/D);return ue},B=function(L,M,q,y){var E=new Date(q,M,L),R=e?t(E).isoWeek():N(E,y);return'<td class="pika-week">'+R+"</td>"},Y=function(L,M,q,y){return'<tr class="pika-row'+(q?" pick-whole-week":"")+(y?" is-selected":"")+'">'+(M?L.reverse():L).join("")+"</tr>"},ee=function(L){return"<tbody>"+L.join("")+"</tbody>"},te=function(L){var M,q=[];for(L.showWeekNumber&&q.push("<th></th>"),M=0;M<7;M++)q.push('<th scope="col"><abbr title="'+b(L,M)+'">'+b(L,M,!0)+"</abbr></th>");return"<thead><tr>"+(L.isRTL?q.reverse():q).join("")+"</tr></thead>"},Ce=function(L,M,q,y,E,R){var D,A,O,U=L._o,ie=q===U.minYear,ue=q===U.maxYear,fe='<div id="'+R+'" class="pika-title" role="heading" aria-live="assertive">',de,ye,Pe=!0,F=!0;for(O=[],D=0;D<12;D++)O.push('<option value="'+(q===E?D-M:12+D-M)+'"'+(D===y?' selected="selected"':"")+(ie&&D<U.minMonth||ue&&D>U.maxMonth?' disabled="disabled"':"")+">"+U.i18n.months[D]+"</option>");for(de='<div class="pika-label">'+U.i18n.months[y]+'<select class="pika-select pika-select-month" tabindex="-1">'+O.join("")+"</select></div>",d(U.yearRange)?(D=U.yearRange[0],A=U.yearRange[1]+1):(D=q-U.yearRange,A=1+q+U.yearRange),O=[];D<A&&D<=U.maxYear;D++)D>=U.minYear&&O.push('<option value="'+D+'"'+(D===q?' selected="selected"':"")+">"+D+"</option>");return ye='<div class="pika-label">'+q+U.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+O.join("")+"</select></div>",U.showMonthAfterYear?fe+=ye+de:fe+=de+ye,ie&&(y===0||U.minMonth>=y)&&(Pe=!1),ue&&(y===11||U.maxMonth<=y)&&(F=!1),M===0&&(fe+='<button class="pika-prev'+(Pe?"":" is-disabled")+'" type="button">'+U.i18n.previousMonth+"</button>"),M===L._o.numberOfMonths-1&&(fe+='<button class="pika-next'+(F?"":" is-disabled")+'" type="button">'+U.i18n.nextMonth+"</button>"),fe+="</div>"},Re=function(L,M,q){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+q+'">'+te(L)+ee(M)+"</table>"},_e=function(L){var M=this,q=M.config(L);M._onMouseDown=function(E){if(M._v){E=E||window.event;var R=E.target||E.srcElement;if(R)if(l(R,"is-disabled")||(l(R,"pika-button")&&!l(R,"is-empty")&&!l(R.parentNode,"is-disabled")?(M.setDate(new Date(R.getAttribute("data-pika-year"),R.getAttribute("data-pika-month"),R.getAttribute("data-pika-day"))),q.bound&&i(function(){M.hide(),q.blurFieldOnSelect&&q.field&&q.field.blur()},100)):l(R,"pika-prev")?M.prevMonth():l(R,"pika-next")&&M.nextMonth()),l(R,"pika-select"))M._c=!0;else if(E.preventDefault)E.preventDefault();else return E.returnValue=!1,!1}},M._onChange=function(E){E=E||window.event;var R=E.target||E.srcElement;R&&(l(R,"pika-select-month")?M.gotoMonth(R.value):l(R,"pika-select-year")&&M.gotoYear(R.value))},M._onKeyChange=function(E){if(E=E||window.event,M.isVisible())switch(E.keyCode){case 13:case 27:q.field&&q.field.blur();break;case 37:M.adjustDate("subtract",1);break;case 38:M.adjustDate("subtract",7);break;case 39:M.adjustDate("add",1);break;case 40:M.adjustDate("add",7);break;case 8:case 46:M.setDate(null);break}},M._parseFieldValue=function(){if(q.parse)return q.parse(q.field.value,q.format);if(e){var E=t(q.field.value,q.format,q.formatStrict);return E&&E.isValid()?E.toDate():null}else return new Date(Date.parse(q.field.value))},M._onInputChange=function(E){var R;E.firedBy!==M&&(R=M._parseFieldValue(),h(R)&&M.setDate(R),M._v||M.show())},M._onInputFocus=function(){M.show()},M._onInputClick=function(){M.show()},M._onInputBlur=function(){var E=r.activeElement;do if(l(E,"pika-single"))return;while(E=E.parentNode);M._c||(M._b=i(function(){M.hide()},50)),M._c=!1},M._onClick=function(E){E=E||window.event;var R=E.target||E.srcElement,D=R;if(R){!n&&l(R,"pika-select")&&(R.onchange||(R.setAttribute("onchange","return;"),o(R,"change",M._onChange)));do if(l(D,"pika-single")||D===q.trigger)return;while(D=D.parentNode);M._v&&R!==q.trigger&&D!==q.trigger&&M.hide()}},M.el=r.createElement("div"),M.el.className="pika-single"+(q.isRTL?" is-rtl":"")+(q.theme?" "+q.theme:""),o(M.el,"mousedown",M._onMouseDown,!0),o(M.el,"touchend",M._onMouseDown,!0),o(M.el,"change",M._onChange),q.keyboardInput&&o(r,"keydown",M._onKeyChange),q.field&&(q.container?q.container.appendChild(M.el):q.bound?r.body.appendChild(M.el):q.field.parentNode.insertBefore(M.el,q.field.nextSibling),o(q.field,"change",M._onInputChange),q.defaultDate||(q.defaultDate=M._parseFieldValue(),q.setDefaultDate=!0));var y=q.defaultDate;h(y)?q.setDefaultDate?M.setDate(y,!0):M.gotoDate(y):M.gotoDate(new Date),q.bound?(this.hide(),M.el.className+=" is-bound",o(q.trigger,"click",M._onInputClick),o(q.trigger,"focus",M._onInputFocus),o(q.trigger,"blur",M._onInputBlur)):this.show()};return _e.prototype={config:function(L){this._o||(this._o=S({},k,!0));var M=S(this._o,L,!0);M.isRTL=!!M.isRTL,M.field=M.field&&M.field.nodeName?M.field:null,M.theme=typeof M.theme=="string"&&M.theme?M.theme:null,M.bound=!!(M.bound!==void 0?M.field&&M.bound:M.field),M.trigger=M.trigger&&M.trigger.nodeName?M.trigger:M.field,M.disableWeekends=!!M.disableWeekends,M.disableDayFn=typeof M.disableDayFn=="function"?M.disableDayFn:null;var q=parseInt(M.numberOfMonths,10)||1;if(M.numberOfMonths=q>4?4:q,h(M.minDate)||(M.minDate=!1),h(M.maxDate)||(M.maxDate=!1),M.minDate&&M.maxDate&&M.maxDate<M.minDate&&(M.maxDate=M.minDate=!1),M.minDate&&this.setMinDate(M.minDate),M.maxDate&&this.setMaxDate(M.maxDate),d(M.yearRange)){var y=new Date().getFullYear()-10;M.yearRange[0]=parseInt(M.yearRange[0],10)||y,M.yearRange[1]=parseInt(M.yearRange[1],10)||y}else M.yearRange=Math.abs(parseInt(M.yearRange,10))||k.yearRange,M.yearRange>100&&(M.yearRange=100);return M},toString:function(L){return L=L||this._o.format,h(this._d)?this._o.toString?this._o.toString(this._d,L):e?t(this._d).format(L):this._d.toDateString():""},getMoment:function(){return e?t(this._d):null},setMoment:function(L,M){e&&t.isMoment(L)&&this.setDate(L.toDate(),M)},getDate:function(){return h(this._d)?new Date(this._d.getTime()):null},setDate:function(L,M){if(!L)return this._d=null,this._o.field&&(this._o.field.value="",x(this._o.field,"change",{firedBy:this})),this.draw();if(typeof L=="string"&&(L=new Date(Date.parse(L))),!!h(L)){var q=this._o.minDate,y=this._o.maxDate;h(q)&&L<q?L=q:h(y)&&L>y&&(L=y),this._d=new Date(L.getTime()),w(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),x(this._o.field,"change",{firedBy:this})),!M&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())}},clear:function(){this.setDate(null)},gotoDate:function(L){var M=!0;if(h(L)){if(this.calendars){var q=new Date(this.calendars[0].year,this.calendars[0].month,1),y=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),E=L.getTime();y.setMonth(y.getMonth()+1),y.setDate(y.getDate()-1),M=E<q.getTime()||y.getTime()<E}M&&(this.calendars=[{month:L.getMonth(),year:L.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(L,M){var q=this.getDate()||new Date,y=parseInt(M)*24*60*60*1e3,E;L==="add"?E=new Date(q.valueOf()+y):L==="subtract"&&(E=new Date(q.valueOf()-y)),this.setDate(E)},adjustCalendars:function(){this.calendars[0]=P(this.calendars[0]);for(var L=1;L<this._o.numberOfMonths;L++)this.calendars[L]=P({month:this.calendars[0].month+L,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(L){isNaN(L)||(this.calendars[0].month=parseInt(L,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(L){isNaN(L)||(this.calendars[0].year=parseInt(L,10),this.adjustCalendars())},setMinDate:function(L){L instanceof Date?(w(L),this._o.minDate=L,this._o.minYear=L.getFullYear(),this._o.minMonth=L.getMonth()):(this._o.minDate=k.minDate,this._o.minYear=k.minYear,this._o.minMonth=k.minMonth,this._o.startRange=k.startRange),this.draw()},setMaxDate:function(L){L instanceof Date?(w(L),this._o.maxDate=L,this._o.maxYear=L.getFullYear(),this._o.maxMonth=L.getMonth()):(this._o.maxDate=k.maxDate,this._o.maxYear=k.maxYear,this._o.maxMonth=k.maxMonth,this._o.endRange=k.endRange),this.draw()},setStartRange:function(L){this._o.startRange=L},setEndRange:function(L){this._o.endRange=L},draw:function(L){if(!(!this._v&&!L)){var M=this._o,q=M.minYear,y=M.maxYear,E=M.minMonth,R=M.maxMonth,D="",A;this._y<=q&&(this._y=q,!isNaN(E)&&this._m<E&&(this._m=E)),this._y>=y&&(this._y=y,!isNaN(R)&&this._m>R&&(this._m=R));for(var O=0;O<M.numberOfMonths;O++)A="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),D+='<div class="pika-lendar">'+Ce(this,O,this.calendars[O].year,this.calendars[O].month,this.calendars[0].year,A)+this.render(this.calendars[O].year,this.calendars[O].month,A)+"</div>";this.el.innerHTML=D,M.bound&&M.field.type!=="hidden"&&i(function(){M.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),M.bound&&M.field.setAttribute("aria-label",M.ariaLabel)}},adjustPosition:function(){var L,M,q,y,E,R,D,A,O,U,ie,ue;if(!this._o.container){if(this.el.style.position="absolute",L=this._o.trigger,M=L,q=this.el.offsetWidth,y=this.el.offsetHeight,E=window.innerWidth||r.documentElement.clientWidth,R=window.innerHeight||r.documentElement.clientHeight,D=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,ie=!0,ue=!0,typeof L.getBoundingClientRect=="function")U=L.getBoundingClientRect(),A=U.left+window.pageXOffset,O=U.bottom+window.pageYOffset;else for(A=M.offsetLeft,O=M.offsetTop+M.offsetHeight;M=M.offsetParent;)A+=M.offsetLeft,O+=M.offsetTop;(this._o.reposition&&A+q>E||this._o.position.indexOf("right")>-1&&A-q+L.offsetWidth>0)&&(A=A-q+L.offsetWidth,ie=!1),(this._o.reposition&&O+y>R+D||this._o.position.indexOf("top")>-1&&O-y-L.offsetHeight>0)&&(O=O-y-L.offsetHeight,ue=!1),this.el.style.left=A+"px",this.el.style.top=O+"px",c(this.el,ie?"left-aligned":"right-aligned"),c(this.el,ue?"bottom-aligned":"top-aligned"),u(this.el,ie?"right-aligned":"left-aligned"),u(this.el,ue?"top-aligned":"bottom-aligned")}},render:function(L,M,q){var y=this._o,E=new Date,R=g(L,M),D=new Date(L,M,1).getDay(),A=[],O=[];w(E),y.firstDay>0&&(D-=y.firstDay,D<0&&(D+=7));for(var U=M===0?11:M-1,ie=M===11?0:M+1,ue=M===0?L-1:L,fe=M===11?L+1:L,de=g(ue,U),ye=R+D,Pe=ye;Pe>7;)Pe-=7;ye+=7-Pe;for(var F=!1,Ke=0,$e=0;Ke<ye;Ke++){var rt=new Date(L,M,1+(Ke-D)),Ye=h(this._d)?_(rt,this._d):!1,Me=_(rt,E),j=y.events.indexOf(rt.toDateString())!==-1,z=Ke<D||Ke>=R+D,J=1+(Ke-D),pe=M,he=L,me=y.startRange&&_(y.startRange,rt),ve=y.endRange&&_(y.endRange,rt),ne=y.startRange&&y.endRange&&y.startRange<rt&&rt<y.endRange,ce=y.minDate&&rt<y.minDate||y.maxDate&&rt>y.maxDate||y.disableWeekends&&f(rt)||y.disableDayFn&&y.disableDayFn(rt);z&&(Ke<D?(J=de+J,pe=U,he=ue):(J=J-R,pe=ie,he=fe));var oe={day:J,month:pe,year:he,hasEvent:j,isSelected:Ye,isToday:Me,isDisabled:ce,isEmpty:z,isStartRange:me,isEndRange:ve,isInRange:ne,showDaysInNextAndPreviousMonths:y.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:y.enableSelectionDaysInNextAndPreviousMonths};y.pickWholeWeek&&Ye&&(F=!0),O.push(C(oe)),++$e===7&&(y.showWeekNumber&&O.unshift(B(Ke-D,M,L,y.firstWeekOfYearMinDays)),A.push(Y(O,y.isRTL,y.pickWholeWeek,F)),O=[],$e=0,F=!1)}return Re(y,A,q)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),u(this.el,"is-hidden"),this._o.bound&&(o(r,"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){var L=this._v;L!==!1&&(this._o.bound&&s(r,"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),c(this.el,"is-hidden"),this._v=!1,L!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){var L=this._o;this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),L.keyboardInput&&s(r,"keydown",this._onKeyChange),L.field&&(s(L.field,"change",this._onInputChange),L.bound&&(s(L.trigger,"click",this._onInputClick),s(L.trigger,"focus",this._onInputFocus),s(L.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},_e})});var Wce=We((Uce,n8)=>{(function(t){typeof Uce=="object"&&typeof n8<"u"?n8.exports=t():typeof define=="function"&&define.amd?define([],t):(typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this).numbro=t()})(function(){return function t(e,n,r){function i(a,l){if(!n[a]){if(!e[a]){var c=typeof Dm=="function"&&Dm;if(!l&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var d=n[a]={exports:{}};e[a][0].call(d.exports,function(h){return i(e[a][1][h]||h)},d,d.exports,t,e,n,r)}return n[a].exports}for(var o=typeof Dm=="function"&&Dm,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){(function(r){"use strict";var i,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,a=Math.floor,l="[BigNumber Error] ",c=l+"Number primitive has more than 15 significant digits: ",u=1e14,d=14,h=9007199254740991,f=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],p=1e7,g=1e9;function w(C){var N=0|C;return 0<C||C===N?N:N-1}function _(C){for(var N,B,Y=1,ee=C.length,te=C[0]+"";Y<ee;){for(N=C[Y++]+"",B=d-N.length;B--;N="0"+N);te+=N}for(ee=te.length;te.charCodeAt(--ee)===48;);return te.slice(0,ee+1||1)}function S(C,N){var B,Y,ee=C.c,te=N.c,Ce=C.s,Re=N.s,_e=C.e,L=N.e;if(!Ce||!Re)return null;if(B=ee&&!ee[0],Y=te&&!te[0],B||Y)return B?Y?0:-Re:Ce;if(Ce!=Re)return Ce;if(B=Ce<0,Y=_e==L,!ee||!te)return Y?0:!ee^B?1:-1;if(!Y)return L<_e^B?1:-1;for(Re=(_e=ee.length)<(L=te.length)?_e:L,Ce=0;Ce<Re;Ce++)if(ee[Ce]!=te[Ce])return ee[Ce]>te[Ce]^B?1:-1;return _e==L?0:L<_e^B?1:-1}function x(C,N,B,Y){if(C<N||B<C||C!==(C<0?s(C):a(C)))throw Error(l+(Y||"Argument")+(typeof C=="number"?C<N||B<C?" out of range: ":" not an integer: ":" not a primitive number: ")+String(C))}function P(C){var N=C.c.length-1;return w(C.e/d)==N&&C.c[N]%2!=0}function k(C,N){return(1<C.length?C.charAt(0)+"."+C.slice(1):C)+(N<0?"e":"e+")+N}function b(C,N,B){var Y,ee;if(N<0){for(ee=B+".";++N;ee+=B);C=ee+C}else if(++N>(Y=C.length)){for(ee=B,N-=Y;--N;ee+=B);C+=ee}else N<Y&&(C=C.slice(0,N)+"."+C.slice(N));return C}(i=function C(N){var B,Y,ee,te,Ce,Re,_e,L,M,q,y=F.prototype={constructor:F,toString:null,valueOf:null},E=new F(1),R=20,D=4,A=-7,O=21,U=-1e7,ie=1e7,ue=!1,fe=1,de=0,ye={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},Pe="0123456789abcdefghijklmnopqrstuvwxyz";function F(j,z){var J,pe,he,me,ve,ne,ce,oe,ge=this;if(!(ge instanceof F))return new F(j,z);if(z==null){if(j instanceof F)return ge.s=j.s,ge.e=j.e,void(ge.c=(j=j.c)?j.slice():j);if((ne=typeof j=="number")&&0*j==0){if(ge.s=1/j<0?(j=-j,-1):1,j===~~j){for(me=0,ve=j;10<=ve;ve/=10,me++);return ge.e=me,void(ge.c=[j])}oe=String(j)}else{if(oe=String(j),!o.test(oe))return ee(ge,oe,ne);ge.s=oe.charCodeAt(0)==45?(oe=oe.slice(1),-1):1}-1<(me=oe.indexOf("."))&&(oe=oe.replace(".","")),0<(ve=oe.search(/e/i))?(me<0&&(me=ve),me+=+oe.slice(ve+1),oe=oe.substring(0,ve)):me<0&&(me=oe.length)}else{if(x(z,2,Pe.length,"Base"),oe=String(j),z==10)return Ye(ge=new F(j instanceof F?j:oe),R+ge.e+1,D);if(ne=typeof j=="number"){if(0*j!=0)return ee(ge,oe,ne,z);if(ge.s=1/j<0?(oe=oe.slice(1),-1):1,F.DEBUG&&15<oe.replace(/^0\.0*|\./,"").length)throw Error(c+j);ne=!1}else ge.s=oe.charCodeAt(0)===45?(oe=oe.slice(1),-1):1;for(J=Pe.slice(0,z),me=ve=0,ce=oe.length;ve<ce;ve++)if(J.indexOf(pe=oe.charAt(ve))<0){if(pe=="."){if(me<ve){me=ce;continue}}else if(!he&&(oe==oe.toUpperCase()&&(oe=oe.toLowerCase())||oe==oe.toLowerCase()&&(oe=oe.toUpperCase()))){he=!0,ve=-1,me=0;continue}return ee(ge,String(j),ne,z)}-1<(me=(oe=Y(oe,z,10,ge.s)).indexOf("."))?oe=oe.replace(".",""):me=oe.length}for(ve=0;oe.charCodeAt(ve)===48;ve++);for(ce=oe.length;oe.charCodeAt(--ce)===48;);if(oe=oe.slice(ve,++ce)){if(ce-=ve,ne&&F.DEBUG&&15<ce&&(h<j||j!==a(j)))throw Error(c+ge.s*j);if(ie<(me=me-ve-1))ge.c=ge.e=null;else if(me<U)ge.c=[ge.e=0];else{if(ge.e=me,ge.c=[],ve=(me+1)%d,me<0&&(ve+=d),ve<ce){for(ve&&ge.c.push(+oe.slice(0,ve)),ce-=d;ve<ce;)ge.c.push(+oe.slice(ve,ve+=d));oe=oe.slice(ve),ve=d-oe.length}else ve-=ce;for(;ve--;oe+="0");ge.c.push(+oe)}}else ge.c=[ge.e=0]}function Ke(j,z,J,pe){var he,me,ve,ne,ce;if(J==null?J=D:x(J,0,8),!j.c)return j.toString();if(he=j.c[0],ve=j.e,z==null)ce=_(j.c),ce=pe==1||pe==2&&(ve<=A||O<=ve)?k(ce,ve):b(ce,ve,"0");else if(me=(j=Ye(new F(j),z,J)).e,ne=(ce=_(j.c)).length,pe==1||pe==2&&(z<=me||me<=A)){for(;ne<z;ce+="0",ne++);ce=k(ce,me)}else if(z-=ve,ce=b(ce,me,"0"),ne<me+1){if(0<--z)for(ce+=".";z--;ce+="0");}else if(0<(z+=me-ne))for(me+1==ne&&(ce+=".");z--;ce+="0");return j.s<0&&he?"-"+ce:ce}function $e(j,z){for(var J,pe=1,he=new F(j[0]);pe<j.length;pe++){if(!(J=new F(j[pe])).s){he=J;break}z.call(he,J)&&(he=J)}return he}function rt(j,z,J){for(var pe=1,he=z.length;!z[--he];z.pop());for(he=z[0];10<=he;he/=10,pe++);return(J=pe+J*d-1)>ie?j.c=j.e=null:j.c=J<U?[j.e=0]:(j.e=J,z),j}function Ye(j,z,J,pe){var he,me,ve,ne,ce,oe,ge,Ve=j.c,ke=f;if(Ve){e:{for(he=1,ne=Ve[0];10<=ne;ne/=10,he++);if((me=z-he)<0)me+=d,ve=z,ge=(ce=Ve[oe=0])/ke[he-ve-1]%10|0;else if((oe=s((me+1)/d))>=Ve.length){if(!pe)break e;for(;Ve.length<=oe;Ve.push(0));ce=ge=0,ve=(me%=d)-d+(he=1)}else{for(ce=ne=Ve[oe],he=1;10<=ne;ne/=10,he++);ge=(ve=(me%=d)-d+he)<0?0:ce/ke[he-ve-1]%10|0}if(pe=pe||z<0||Ve[oe+1]!=null||(ve<0?ce:ce%ke[he-ve-1]),pe=J<4?(ge||pe)&&(J==0||J==(j.s<0?3:2)):5<ge||ge==5&&(J==4||pe||J==6&&(0<me?0<ve?ce/ke[he-ve]:0:Ve[oe-1])%10&1||J==(j.s<0?8:7)),z<1||!Ve[0])return Ve.length=0,pe?(z-=j.e+1,Ve[0]=ke[(d-z%d)%d],j.e=-z||0):Ve[0]=j.e=0,j;if(me==0?(Ve.length=oe,ne=1,oe--):(Ve.length=oe+1,ne=ke[d-me],Ve[oe]=0<ve?a(ce/ke[he-ve]%ke[ve])*ne:0),pe)for(;;){if(oe==0){for(me=1,ve=Ve[0];10<=ve;ve/=10,me++);for(ve=Ve[0]+=ne,ne=1;10<=ve;ve/=10,ne++);me!=ne&&(j.e++,Ve[0]==u&&(Ve[0]=1));break}if(Ve[oe]+=ne,Ve[oe]!=u)break;Ve[oe--]=0,ne=1}for(me=Ve.length;Ve[--me]===0;Ve.pop());}j.e>ie?j.c=j.e=null:j.e<U&&(j.c=[j.e=0])}return j}function Me(j){var z,J=j.e;return J===null?j.toString():(z=_(j.c),z=J<=A||O<=J?k(z,J):b(z,J,"0"),j.s<0?"-"+z:z)}return F.clone=C,F.ROUND_UP=0,F.ROUND_DOWN=1,F.ROUND_CEIL=2,F.ROUND_FLOOR=3,F.ROUND_HALF_UP=4,F.ROUND_HALF_DOWN=5,F.ROUND_HALF_EVEN=6,F.ROUND_HALF_CEIL=7,F.ROUND_HALF_FLOOR=8,F.EUCLID=9,F.config=F.set=function(j){var z,J;if(j!=null){if(typeof j!="object")throw Error(l+"Object expected: "+j);if(j.hasOwnProperty(z="DECIMAL_PLACES")&&(x(J=j[z],0,g,z),R=J),j.hasOwnProperty(z="ROUNDING_MODE")&&(x(J=j[z],0,8,z),D=J),j.hasOwnProperty(z="EXPONENTIAL_AT")&&((J=j[z])&&J.pop?(x(J[0],-g,0,z),x(J[1],0,g,z),A=J[0],O=J[1]):(x(J,-g,g,z),A=-(O=J<0?-J:J))),j.hasOwnProperty(z="RANGE"))if((J=j[z])&&J.pop)x(J[0],-g,-1,z),x(J[1],1,g,z),U=J[0],ie=J[1];else{if(x(J,-g,g,z),!J)throw Error(l+z+" cannot be zero: "+J);U=-(ie=J<0?-J:J)}if(j.hasOwnProperty(z="CRYPTO")){if((J=j[z])!==!!J)throw Error(l+z+" not true or false: "+J);if(J){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw ue=!J,Error(l+"crypto unavailable");ue=J}else ue=J}if(j.hasOwnProperty(z="MODULO_MODE")&&(x(J=j[z],0,9,z),fe=J),j.hasOwnProperty(z="POW_PRECISION")&&(x(J=j[z],0,g,z),de=J),j.hasOwnProperty(z="FORMAT")){if(typeof(J=j[z])!="object")throw Error(l+z+" not an object: "+J);ye=J}if(j.hasOwnProperty(z="ALPHABET")){if(typeof(J=j[z])!="string"||/^.$|[+-.\s]|(.).*\1/.test(J))throw Error(l+z+" invalid: "+J);Pe=J}}return{DECIMAL_PLACES:R,ROUNDING_MODE:D,EXPONENTIAL_AT:[A,O],RANGE:[U,ie],CRYPTO:ue,MODULO_MODE:fe,POW_PRECISION:de,FORMAT:ye,ALPHABET:Pe}},F.isBigNumber=function(j){return j instanceof F||j&&j._isBigNumber===!0||!1},F.maximum=F.max=function(){return $e(arguments,y.lt)},F.minimum=F.min=function(){return $e(arguments,y.gt)},F.random=(te=9007199254740992,Ce=Math.random()*te&2097151?function(){return a(Math.random()*te)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(j){var z,J,pe,he,me,ve=0,ne=[],ce=new F(E);if(j==null?j=R:x(j,0,g),he=s(j/d),ue)if(crypto.getRandomValues){for(z=crypto.getRandomValues(new Uint32Array(he*=2));ve<he;)9e15<=(me=131072*z[ve]+(z[ve+1]>>>11))?(J=crypto.getRandomValues(new Uint32Array(2)),z[ve]=J[0],z[ve+1]=J[1]):(ne.push(me%1e14),ve+=2);ve=he/2}else{if(!crypto.randomBytes)throw ue=!1,Error(l+"crypto unavailable");for(z=crypto.randomBytes(he*=7);ve<he;)9e15<=(me=281474976710656*(31&z[ve])+1099511627776*z[ve+1]+4294967296*z[ve+2]+16777216*z[ve+3]+(z[ve+4]<<16)+(z[ve+5]<<8)+z[ve+6])?crypto.randomBytes(7).copy(z,ve):(ne.push(me%1e14),ve+=7);ve=he/7}if(!ue)for(;ve<he;)(me=Ce())<9e15&&(ne[ve++]=me%1e14);for(he=ne[--ve],j%=d,he&&j&&(me=f[d-j],ne[ve]=a(he/me)*me);ne[ve]===0;ne.pop(),ve--);if(ve<0)ne=[pe=0];else{for(pe=-1;ne[0]===0;ne.splice(0,1),pe-=d);for(ve=1,me=ne[0];10<=me;me/=10,ve++);ve<d&&(pe-=d-ve)}return ce.e=pe,ce.c=ne,ce}),F.sum=function(){for(var j=1,z=arguments,J=new F(z[0]);j<z.length;)J=J.plus(z[j++]);return J},Y=function(){var j="0123456789";function z(J,pe,he,me){for(var ve,ne,ce=[0],oe=0,ge=J.length;oe<ge;){for(ne=ce.length;ne--;ce[ne]*=pe);for(ce[0]+=me.indexOf(J.charAt(oe++)),ve=0;ve<ce.length;ve++)ce[ve]>he-1&&(ce[ve+1]==null&&(ce[ve+1]=0),ce[ve+1]+=ce[ve]/he|0,ce[ve]%=he)}return ce.reverse()}return function(J,pe,he,me,ve){var ne,ce,oe,ge,Ve,ke,Xe,gt,Mt=J.indexOf("."),Nt=R,$t=D;for(0<=Mt&&(ge=de,de=0,J=J.replace(".",""),ke=(gt=new F(pe)).pow(J.length-Mt),de=ge,gt.c=z(b(_(ke.c),ke.e,"0"),10,he,j),gt.e=gt.c.length),oe=ge=(Xe=z(J,pe,he,ve?(ne=Pe,j):(ne=j,Pe))).length;Xe[--ge]==0;Xe.pop());if(!Xe[0])return ne.charAt(0);if(Mt<0?--oe:(ke.c=Xe,ke.e=oe,ke.s=me,Xe=(ke=B(ke,gt,Nt,$t,he)).c,Ve=ke.r,oe=ke.e),Mt=Xe[ce=oe+Nt+1],ge=he/2,Ve=Ve||ce<0||Xe[ce+1]!=null,Ve=$t<4?(Mt!=null||Ve)&&($t==0||$t==(ke.s<0?3:2)):ge<Mt||Mt==ge&&($t==4||Ve||$t==6&&1&Xe[ce-1]||$t==(ke.s<0?8:7)),ce<1||!Xe[0])J=Ve?b(ne.charAt(1),-Nt,ne.charAt(0)):ne.charAt(0);else{if(Xe.length=ce,Ve)for(--he;++Xe[--ce]>he;)Xe[ce]=0,ce||(++oe,Xe=[1].concat(Xe));for(ge=Xe.length;!Xe[--ge];);for(Mt=0,J="";Mt<=ge;J+=ne.charAt(Xe[Mt++]));J=b(J,oe,ne.charAt(0))}return J}}(),B=function(){function j(pe,he,me){var ve,ne,ce,oe,ge=0,Ve=pe.length,ke=he%p,Xe=he/p|0;for(pe=pe.slice();Ve--;)ge=((ne=ke*(ce=pe[Ve]%p)+(ve=Xe*ce+(oe=pe[Ve]/p|0)*ke)%p*p+ge)/me|0)+(ve/p|0)+Xe*oe,pe[Ve]=ne%me;return ge&&(pe=[ge].concat(pe)),pe}function z(pe,he,me,ve){var ne,ce;if(me!=ve)ce=ve<me?1:-1;else for(ne=ce=0;ne<me;ne++)if(pe[ne]!=he[ne]){ce=pe[ne]>he[ne]?1:-1;break}return ce}function J(pe,he,me,ve){for(var ne=0;me--;)pe[me]-=ne,ne=pe[me]<he[me]?1:0,pe[me]=ne*ve+pe[me]-he[me];for(;!pe[0]&&1<pe.length;pe.splice(0,1));}return function(pe,he,me,ve,ne){var ce,oe,ge,Ve,ke,Xe,gt,Mt,Nt,$t,Rn,yr,Mn,zs,kl,ji,ga,Ir=pe.s==he.s?1:-1,_r=pe.c,vn=he.c;if(!(_r&&_r[0]&&vn&&vn[0]))return new F(pe.s&&he.s&&(_r?!vn||_r[0]!=vn[0]:vn)?_r&&_r[0]==0||!vn?0*Ir:Ir/0:NaN);for(Nt=(Mt=new F(Ir)).c=[],Ir=me+(oe=pe.e-he.e)+1,ne||(ne=u,oe=w(pe.e/d)-w(he.e/d),Ir=Ir/d|0),ge=0;vn[ge]==(_r[ge]||0);ge++);if(vn[ge]>(_r[ge]||0)&&oe--,Ir<0)Nt.push(1),Ve=!0;else{for(zs=_r.length,ji=vn.length,Ir+=2,1<(ke=a(ne/(vn[ge=0]+1)))&&(vn=j(vn,ke,ne),_r=j(_r,ke,ne),ji=vn.length,zs=_r.length),Mn=ji,Rn=($t=_r.slice(0,ji)).length;Rn<ji;$t[Rn++]=0);ga=vn.slice(),ga=[0].concat(ga),kl=vn[0],vn[1]>=ne/2&&kl++;do{if(ke=0,(ce=z(vn,$t,ji,Rn))<0){if(yr=$t[0],ji!=Rn&&(yr=yr*ne+($t[1]||0)),1<(ke=a(yr/kl)))for(ne<=ke&&(ke=ne-1),gt=(Xe=j(vn,ke,ne)).length,Rn=$t.length;z(Xe,$t,gt,Rn)==1;)ke--,J(Xe,ji<gt?ga:vn,gt,ne),gt=Xe.length,ce=1;else ke==0&&(ce=ke=1),gt=(Xe=vn.slice()).length;if(gt<Rn&&(Xe=[0].concat(Xe)),J($t,Xe,Rn,ne),Rn=$t.length,ce==-1)for(;z(vn,$t,ji,Rn)<1;)ke++,J($t,ji<Rn?ga:vn,Rn,ne),Rn=$t.length}else ce===0&&(ke++,$t=[0]);Nt[ge++]=ke,$t[0]?$t[Rn++]=_r[Mn]||0:($t=[_r[Mn]],Rn=1)}while((Mn++<zs||$t[0]!=null)&&Ir--);Ve=$t[0]!=null,Nt[0]||Nt.splice(0,1)}if(ne==u){for(ge=1,Ir=Nt[0];10<=Ir;Ir/=10,ge++);Ye(Mt,me+(Mt.e=ge+oe*d-1)+1,ve,Ve)}else Mt.e=oe,Mt.r=+Ve;return Mt}}(),Re=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_e=/^([^.]+)\.$/,L=/^\.([^.]+)$/,M=/^-?(Infinity|NaN)$/,q=/^\s*\+(?=[\w.])|^\s+|\s+$/g,ee=function(j,z,J,pe){var he,me=J?z:z.replace(q,"");if(M.test(me))j.s=isNaN(me)?null:me<0?-1:1,j.c=j.e=null;else{if(!J&&(me=me.replace(Re,function(ve,ne,ce){return he=(ce=ce.toLowerCase())=="x"?16:ce=="b"?2:8,pe&&pe!=he?ve:ne}),pe&&(he=pe,me=me.replace(_e,"$1").replace(L,"0.$1")),z!=me))return new F(me,he);if(F.DEBUG)throw Error(l+"Not a"+(pe?" base "+pe:"")+" number: "+z);j.c=j.e=j.s=null}},y.absoluteValue=y.abs=function(){var j=new F(this);return j.s<0&&(j.s=1),j},y.comparedTo=function(j,z){return S(this,new F(j,z))},y.decimalPlaces=y.dp=function(j,z){var J,pe,he;if(j!=null)return x(j,0,g),z==null?z=D:x(z,0,8),Ye(new F(this),j+this.e+1,z);if(!(J=this.c))return null;if(pe=((he=J.length-1)-w(this.e/d))*d,he=J[he])for(;he%10==0;he/=10,pe--);return pe<0&&(pe=0),pe},y.dividedBy=y.div=function(j,z){return B(this,new F(j,z),R,D)},y.dividedToIntegerBy=y.idiv=function(j,z){return B(this,new F(j,z),0,1)},y.exponentiatedBy=y.pow=function(j,z){var J,pe,he,me,ve,ne,ce,oe,ge=this;if((j=new F(j)).c&&!j.isInteger())throw Error(l+"Exponent not an integer: "+Me(j));if(z!=null&&(z=new F(z)),ve=14<j.e,!ge.c||!ge.c[0]||ge.c[0]==1&&!ge.e&&ge.c.length==1||!j.c||!j.c[0])return oe=new F(Math.pow(+Me(ge),ve?2-P(j):+Me(j))),z?oe.mod(z):oe;if(ne=j.s<0,z){if(z.c?!z.c[0]:!z.s)return new F(NaN);(pe=!ne&&ge.isInteger()&&z.isInteger())&&(ge=ge.mod(z))}else{if(9<j.e&&(0<ge.e||ge.e<-1||(ge.e==0?1<ge.c[0]||ve&&24e7<=ge.c[1]:ge.c[0]<8e13||ve&&ge.c[0]<=9999975e7)))return me=ge.s<0&&P(j)?-0:0,-1<ge.e&&(me=1/me),new F(ne?1/me:me);de&&(me=s(de/d+2))}for(ce=ve?(J=new F(.5),ne&&(j.s=1),P(j)):(he=Math.abs(+Me(j)))%2,oe=new F(E);;){if(ce){if(!(oe=oe.times(ge)).c)break;me?oe.c.length>me&&(oe.c.length=me):pe&&(oe=oe.mod(z))}if(he){if((he=a(he/2))===0)break;ce=he%2}else if(Ye(j=j.times(J),j.e+1,1),14<j.e)ce=P(j);else{if((he=+Me(j))==0)break;ce=he%2}ge=ge.times(ge),me?ge.c&&ge.c.length>me&&(ge.c.length=me):pe&&(ge=ge.mod(z))}return pe?oe:(ne&&(oe=E.div(oe)),z?oe.mod(z):me?Ye(oe,de,D,void 0):oe)},y.integerValue=function(j){var z=new F(this);return j==null?j=D:x(j,0,8),Ye(z,z.e+1,j)},y.isEqualTo=y.eq=function(j,z){return S(this,new F(j,z))===0},y.isFinite=function(){return!!this.c},y.isGreaterThan=y.gt=function(j,z){return 0<S(this,new F(j,z))},y.isGreaterThanOrEqualTo=y.gte=function(j,z){return(z=S(this,new F(j,z)))===1||z===0},y.isInteger=function(){return!!this.c&&w(this.e/d)>this.c.length-2},y.isLessThan=y.lt=function(j,z){return S(this,new F(j,z))<0},y.isLessThanOrEqualTo=y.lte=function(j,z){return(z=S(this,new F(j,z)))===-1||z===0},y.isNaN=function(){return!this.s},y.isNegative=function(){return this.s<0},y.isPositive=function(){return 0<this.s},y.isZero=function(){return!!this.c&&this.c[0]==0},y.minus=function(j,z){var J,pe,he,me,ve=this,ne=ve.s;if(z=(j=new F(j,z)).s,!ne||!z)return new F(NaN);if(ne!=z)return j.s=-z,ve.plus(j);var ce=ve.e/d,oe=j.e/d,ge=ve.c,Ve=j.c;if(!ce||!oe){if(!ge||!Ve)return ge?(j.s=-z,j):new F(Ve?ve:NaN);if(!ge[0]||!Ve[0])return Ve[0]?(j.s=-z,j):new F(ge[0]?ve:D==3?-0:0)}if(ce=w(ce),oe=w(oe),ge=ge.slice(),ne=ce-oe){for((he=(me=ne<0)?(ne=-ne,ge):(oe=ce,Ve)).reverse(),z=ne;z--;he.push(0));he.reverse()}else for(pe=(me=(ne=ge.length)<(z=Ve.length))?ne:z,ne=z=0;z<pe;z++)if(ge[z]!=Ve[z]){me=ge[z]<Ve[z];break}if(me&&(he=ge,ge=Ve,Ve=he,j.s=-j.s),0<(z=(pe=Ve.length)-(J=ge.length)))for(;z--;ge[J++]=0);for(z=u-1;ne<pe;){if(ge[--pe]<Ve[pe]){for(J=pe;J&&!ge[--J];ge[J]=z);--ge[J],ge[pe]+=u}ge[pe]-=Ve[pe]}for(;ge[0]==0;ge.splice(0,1),--oe);return ge[0]?rt(j,ge,oe):(j.s=D==3?-1:1,j.c=[j.e=0],j)},y.modulo=y.mod=function(j,z){var J,pe,he=this;return j=new F(j,z),!he.c||!j.s||j.c&&!j.c[0]?new F(NaN):!j.c||he.c&&!he.c[0]?new F(he):(fe==9?(pe=j.s,j.s=1,J=B(he,j,0,3),j.s=pe,J.s*=pe):J=B(he,j,0,fe),(j=he.minus(J.times(j))).c[0]||fe!=1||(j.s=he.s),j)},y.multipliedBy=y.times=function(j,z){var J,pe,he,me,ve,ne,ce,oe,ge,Ve,ke,Xe,gt,Mt,Nt,$t=this,Rn=$t.c,yr=(j=new F(j,z)).c;if(!(Rn&&yr&&Rn[0]&&yr[0]))return!$t.s||!j.s||Rn&&!Rn[0]&&!yr||yr&&!yr[0]&&!Rn?j.c=j.e=j.s=null:(j.s*=$t.s,Rn&&yr?(j.c=[0],j.e=0):j.c=j.e=null),j;for(pe=w($t.e/d)+w(j.e/d),j.s*=$t.s,(ce=Rn.length)<(Ve=yr.length)&&(gt=Rn,Rn=yr,yr=gt,he=ce,ce=Ve,Ve=he),he=ce+Ve,gt=[];he--;gt.push(0));for(Mt=u,Nt=p,he=Ve;0<=--he;){for(J=0,ke=yr[he]%Nt,Xe=yr[he]/Nt|0,me=he+(ve=ce);he<me;)J=((oe=ke*(oe=Rn[--ve]%Nt)+(ne=Xe*oe+(ge=Rn[ve]/Nt|0)*ke)%Nt*Nt+gt[me]+J)/Mt|0)+(ne/Nt|0)+Xe*ge,gt[me--]=oe%Mt;gt[me]=J}return J?++pe:gt.splice(0,1),rt(j,gt,pe)},y.negated=function(){var j=new F(this);return j.s=-j.s||null,j},y.plus=function(j,z){var J,pe=this,he=pe.s;if(z=(j=new F(j,z)).s,!he||!z)return new F(NaN);if(he!=z)return j.s=-z,pe.minus(j);var me=pe.e/d,ve=j.e/d,ne=pe.c,ce=j.c;if(!me||!ve){if(!ne||!ce)return new F(he/0);if(!ne[0]||!ce[0])return ce[0]?j:new F(ne[0]?pe:0*he)}if(me=w(me),ve=w(ve),ne=ne.slice(),he=me-ve){for((J=0<he?(ve=me,ce):(he=-he,ne)).reverse();he--;J.push(0));J.reverse()}for((he=ne.length)-(z=ce.length)<0&&(J=ce,ce=ne,ne=J,z=he),he=0;z;)he=(ne[--z]=ne[z]+ce[z]+he)/u|0,ne[z]=u===ne[z]?0:ne[z]%u;return he&&(ne=[he].concat(ne),++ve),rt(j,ne,ve)},y.precision=y.sd=function(j,z){var J,pe,he;if(j!=null&&j!==!!j)return x(j,1,g),z==null?z=D:x(z,0,8),Ye(new F(this),j,z);if(!(J=this.c))return null;if(pe=(he=J.length-1)*d+1,he=J[he]){for(;he%10==0;he/=10,pe--);for(he=J[0];10<=he;he/=10,pe++);}return j&&this.e+1>pe&&(pe=this.e+1),pe},y.shiftedBy=function(j){return x(j,-h,h),this.times("1e"+j)},y.squareRoot=y.sqrt=function(){var j,z,J,pe,he,me=this,ve=me.c,ne=me.s,ce=me.e,oe=R+4,ge=new F("0.5");if(ne!==1||!ve||!ve[0])return new F(!ne||ne<0&&(!ve||ve[0])?NaN:ve?me:1/0);if((J=(ne=Math.sqrt(+Me(me)))==0||ne==1/0?(((z=_(ve)).length+ce)%2==0&&(z+="0"),ne=Math.sqrt(+z),ce=w((ce+1)/2)-(ce<0||ce%2),new F(z=ne==1/0?"1e"+ce:(z=ne.toExponential()).slice(0,z.indexOf("e")+1)+ce)):new F(ne+"")).c[0]){for((ne=(ce=J.e)+oe)<3&&(ne=0);;)if(he=J,J=ge.times(he.plus(B(me,he,oe,1))),_(he.c).slice(0,ne)===(z=_(J.c)).slice(0,ne)){if(J.e<ce&&--ne,(z=z.slice(ne-3,ne+1))!="9999"&&(pe||z!="4999")){+z&&(+z.slice(1)||z.charAt(0)!="5")||(Ye(J,J.e+R+2,1),j=!J.times(J).eq(me));break}if(!pe&&(Ye(he,he.e+R+2,0),he.times(he).eq(me))){J=he;break}oe+=4,ne+=4,pe=1}}return Ye(J,J.e+R+1,D,j)},y.toExponential=function(j,z){return j!=null&&(x(j,0,g),j++),Ke(this,j,z,1)},y.toFixed=function(j,z){return j!=null&&(x(j,0,g),j=j+this.e+1),Ke(this,j,z)},y.toFormat=function(j,z,J){var pe;if(J==null)j!=null&&z&&typeof z=="object"?(J=z,z=null):j&&typeof j=="object"?(J=j,j=z=null):J=ye;else if(typeof J!="object")throw Error(l+"Argument not an object: "+J);if(pe=this.toFixed(j,z),this.c){var he,me=pe.split("."),ve=+J.groupSize,ne=+J.secondaryGroupSize,ce=J.groupSeparator||"",oe=me[0],ge=me[1],Ve=this.s<0,ke=Ve?oe.slice(1):oe,Xe=ke.length;if(ne&&(he=ve,ve=ne,Xe-=ne=he),0<ve&&0<Xe){for(he=Xe%ve||ve,oe=ke.substr(0,he);he<Xe;he+=ve)oe+=ce+ke.substr(he,ve);0<ne&&(oe+=ce+ke.slice(he)),Ve&&(oe="-"+oe)}pe=ge?oe+(J.decimalSeparator||"")+((ne=+J.fractionGroupSize)?ge.replace(new RegExp("\\d{"+ne+"}\\B","g"),"$&"+(J.fractionGroupSeparator||"")):ge):oe}return(J.prefix||"")+pe+(J.suffix||"")},y.toFraction=function(j){var z,J,pe,he,me,ve,ne,ce,oe,ge,Ve,ke,Xe=this,gt=Xe.c;if(j!=null&&(!(ne=new F(j)).isInteger()&&(ne.c||ne.s!==1)||ne.lt(E)))throw Error(l+"Argument "+(ne.isInteger()?"out of range: ":"not an integer: ")+Me(ne));if(!gt)return new F(Xe);for(z=new F(E),oe=J=new F(E),pe=ce=new F(E),ke=_(gt),me=z.e=ke.length-Xe.e-1,z.c[0]=f[(ve=me%d)<0?d+ve:ve],j=!j||0<ne.comparedTo(z)?0<me?z:oe:ne,ve=ie,ie=1/0,ne=new F(ke),ce.c[0]=0;ge=B(ne,z,0,1),(he=J.plus(ge.times(pe))).comparedTo(j)!=1;)J=pe,pe=he,oe=ce.plus(ge.times(he=oe)),ce=he,z=ne.minus(ge.times(he=z)),ne=he;return he=B(j.minus(J),pe,0,1),ce=ce.plus(he.times(oe)),J=J.plus(he.times(pe)),ce.s=oe.s=Xe.s,Ve=B(oe,pe,me*=2,D).minus(Xe).abs().comparedTo(B(ce,J,me,D).minus(Xe).abs())<1?[oe,pe]:[ce,J],ie=ve,Ve},y.toNumber=function(){return+Me(this)},y.toPrecision=function(j,z){return j!=null&&x(j,1,g),Ke(this,j,z,2)},y.toString=function(j){var z,J=this,pe=J.s,he=J.e;return he===null?pe?(z="Infinity",pe<0&&(z="-"+z)):z="NaN":(z=j==null?he<=A||O<=he?k(_(J.c),he):b(_(J.c),he,"0"):j===10?b(_((J=Ye(new F(J),R+he+1,D)).c),J.e,"0"):(x(j,2,Pe.length,"Base"),Y(b(_(J.c),he,"0"),10,j,pe,!0)),pe<0&&J.c[0]&&(z="-"+z)),z},y.valueOf=y.toJSON=function(){return Me(this)},y._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(y[Symbol.toStringTag]="BigNumber",y[Symbol.for("nodejs.util.inspect.custom")]=y.valueOf),N!=null&&F.set(N),F}()).default=i.BigNumber=i,e!==void 0&&e.exports?e.exports=i:(r||(r=typeof self<"u"&&self?self:window),r.BigNumber=i)})(this)},{}],2:[function(t,e,n){"use strict";e.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(r){var i=r%10;return~~(r%100/10)==1?"th":i===1?"st":i===2?"nd":i===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(t,e,n){"use strict";function r(w,_){return function(S){if(Array.isArray(S))return S}(w)||function(S,x){var P=[],k=!0,b=!1,C=void 0;try{for(var N,B=S[Symbol.iterator]();!(k=(N=B.next()).done)&&(P.push(N.value),!x||P.length!==x);k=!0);}catch(Y){b=!0,C=Y}finally{try{k||B.return==null||B.return()}finally{if(b)throw C}}return P}(w,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=t("./globalState"),o=t("./validating"),s=t("./parsing"),a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l={general:{scale:1024,suffixes:a,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:a,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function u(w){var _=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},S=2<arguments.length?arguments[2]:void 0;if(typeof _=="string"&&(_=s.parseFormat(_)),!o.validateFormat(_))return"ERROR: invalid format";var x=_.prefix||"",P=_.postfix||"",k=function(b,C,N){switch(C.output){case"currency":return C=g(C,i.currentCurrencyDefaultFormat()),function(Pe,F,Ke){var $e=Ke.currentCurrency(),rt=Object.assign({},c,F),Ye=void 0,Me="",j=!!rt.totalLength||!!rt.forceAverage||rt.average,z=F.currencyPosition||$e.position,J=F.currencySymbol||$e.symbol;rt.spaceSeparated&&(Me=" "),z==="infix"&&(Ye=Me+J+Me);var pe=p({instance:Pe,providedFormat:F,state:Ke,decimalSeparator:Ye});return z==="prefix"&&(pe=Pe._value<0&&rt.negative==="sign"?"-".concat(Me).concat(J).concat(pe.slice(1)):J+Me+pe),z&&z!=="postfix"||(pe=pe+(Me=j?"":Me)+J),pe}(b,C,i);case"percent":return C=g(C,i.currentPercentageDefaultFormat()),function(Pe,F,Ke,$e){var rt=F.prefixSymbol,Ye=p({instance:$e(100*Pe._value),providedFormat:F,state:Ke}),Me=Object.assign({},c,F);return rt?"%".concat(Me.spaceSeparated?" ":"").concat(Ye):"".concat(Ye).concat(Me.spaceSeparated?" ":"","%")}(b,C,i,N);case"byte":return C=g(C,i.currentByteDefaultFormat()),E=b,D=i,A=N,O=(R=C).base||"binary",U=l[O],ie=d(E._value,U.suffixes,U.scale),ue=ie.value,fe=ie.suffix,de=p({instance:A(ue),providedFormat:R,state:D,defaults:D.currentByteDefaultFormat()}),ye=D.currentAbbreviations(),"".concat(de).concat(ye.spaced?" ":"").concat(fe);case"time":return C=g(C,i.currentTimeDefaultFormat()),L=b,M=Math.floor(L._value/60/60),q=Math.floor((L._value-60*M*60)/60),y=Math.round(L._value-60*M*60-60*q),"".concat(M,":").concat(q<10?"0":"").concat(q,":").concat(y<10?"0":"").concat(y);case"ordinal":return C=g(C,i.currentOrdinalDefaultFormat()),B=b,Y=C,te=(ee=i).currentOrdinal(),Ce=Object.assign({},c,Y),Re=p({instance:B,providedFormat:Y,state:ee}),_e=te(B._value),"".concat(Re).concat(Ce.spaceSeparated?" ":"").concat(_e);case"number":default:return p({instance:b,providedFormat:C,numbro:N})}var B,Y,ee,te,Ce,Re,_e,L,M,q,y,E,R,D,A,O,U,ie,ue,fe,de,ye}(w,_,S);return k=(k=x+k)+P}function d(w,_,S){var x=_[0],P=Math.abs(w);if(S<=P){for(var k=1;k<_.length;++k){var b=Math.pow(S,k),C=Math.pow(S,k+1);if(b<=P&&P<C){x=_[k],w/=b;break}}x===_[0]&&(w/=Math.pow(S,_.length-1),x=_[_.length-1])}return{value:w,suffix:x}}function h(w){for(var _="",S=0;S<w;S++)_+="0";return _}function f(w,_){return w.toString().indexOf("e")!==-1?function(S,x){var P=S.toString(),k=r(P.split("e"),2),b=k[0],C=k[1],N=r(b.split("."),2),B=N[0],Y=N[1],ee=Y===void 0?"":Y;if(0<+C)P=B+ee+h(C-ee.length);else{var te=".";te=+B<0?"-0".concat(te):"0".concat(te);var Ce=(h(-C-1)+Math.abs(B)+ee).substr(0,x);Ce.length<x&&(Ce+=h(x-Ce.length)),P=te+Ce}return 0<+C&&0<x&&(P+=".".concat(h(x))),P}(w,_):(Math.round(+"".concat(w,"e+").concat(_))/Math.pow(10,_)).toFixed(_)}function p(w){var _=w.instance,S=w.providedFormat,x=w.state,P=x===void 0?i:x,k=w.decimalSeparator,b=w.defaults,C=b===void 0?P.currentDefaults():b,N=_._value;if(N===0&&P.hasZeroFormat())return P.getZeroFormat();if(!isFinite(N))return N.toString();var B,Y,ee,te,Ce,Re,_e,L,M=Object.assign({},c,C,S),q=M.totalLength,y=q?0:M.characteristic,E=M.optionalCharacteristic,R=M.forceAverage,D=!!q||!!R||M.average,A=q?-1:D&&S.mantissa===void 0?0:M.mantissa,O=!q&&(S.optionalMantissa===void 0?A===-1:M.optionalMantissa),U=M.trimMantissa,ie=M.thousandSeparated,ue=M.spaceSeparated,fe=M.negative,de=M.forceSign,ye=M.exponential,Pe="";if(D){var F=function(j){var z=j.value,J=j.forceAverage,pe=j.abbreviations,he=j.spaceSeparated,me=he!==void 0&&he,ve=j.totalLength,ne=ve===void 0?0:ve,ce="",oe=Math.abs(z),ge=-1;if(oe>=Math.pow(10,12)&&!J||J==="trillion"?(ce=pe.trillion,z/=Math.pow(10,12)):oe<Math.pow(10,12)&&oe>=Math.pow(10,9)&&!J||J==="billion"?(ce=pe.billion,z/=Math.pow(10,9)):oe<Math.pow(10,9)&&oe>=Math.pow(10,6)&&!J||J==="million"?(ce=pe.million,z/=Math.pow(10,6)):(oe<Math.pow(10,6)&&oe>=Math.pow(10,3)&&!J||J==="thousand")&&(ce=pe.thousand,z/=Math.pow(10,3)),ce&&(ce=(me?" ":"")+ce),ne){var Ve=z.toString().split(".")[0];ge=Math.max(ne-Ve.length,0)}return{value:z,abbreviation:ce,mantissaPrecision:ge}}({value:N,forceAverage:R,abbreviations:P.currentAbbreviations(),spaceSeparated:ue,totalLength:q});N=F.value,Pe+=F.abbreviation,q&&(A=F.mantissaPrecision)}if(ye){var Ke=(Y=(B={value:N,characteristicPrecision:y}).value,ee=B.characteristicPrecision,te=ee===void 0?0:ee,Ce=r(Y.toExponential().split("e"),2),Re=Ce[0],_e=Ce[1],L=+Re,te&&1<te&&(L*=Math.pow(10,te-1),_e=0<=(_e=+_e-(te-1))?"+".concat(_e):_e),{value:L,abbreviation:"e".concat(_e)});N=Ke.value,Pe=Ke.abbreviation+Pe}var $e,rt,Ye,Me=function(j,z,J,pe,he){if(pe===-1)return j;var me=f(z,pe),ve=r(me.toString().split("."),2),ne=ve[0],ce=ve[1],oe=ce===void 0?"":ce;if(oe.match(/^0+$/)&&(J||he))return ne;var ge=oe.match(/0+$/);return he&&ge?"".concat(ne,".").concat(oe.toString().slice(0,ge.index)):me.toString()}(N.toString(),N,O,A,U);return Me=function(j,z,J,pe,he){var me=pe.currentDelimiters(),ve=me.thousands;he=he||me.decimal;var ne=me.thousandsSize||3,ce=j.toString(),oe=ce.split(".")[0],ge=ce.split(".")[1];return J&&(z<0&&(oe=oe.slice(1)),function(Ve,ke){for(var Xe=[],gt=0,Mt=Ve;0<Mt;Mt--)gt===ke&&(Xe.unshift(Mt),gt=0),gt++;return Xe}(oe.length,ne).forEach(function(Ve,ke){oe=oe.slice(0,Ve+ke)+ve+oe.slice(Ve+ke)}),z<0&&(oe="-".concat(oe))),ce=ge?oe+he+ge:oe}(Me=function(j,z,J,pe){var he=j,me=r(he.toString().split("."),2),ve=me[0],ne=me[1];if(ve.match(/^-?0$/)&&J)return ne?"".concat(ve.replace("0",""),".").concat(ne):ve.replace("0","");if(ve.length<pe)for(var ce=pe-ve.length,oe=0;oe<ce;oe++)he="0".concat(he);return he.toString()}(Me,0,E,y),N,ie,P,k),(D||ye)&&(Me=Me+Pe),(de||N<0)&&($e=Me,Ye=fe,Me=(rt=N)===0?$e:+$e==0?$e.replace("-",""):0<rt?"+".concat($e):Ye==="sign"?$e:"(".concat($e.replace("-",""),")")),Me}function g(w,_){if(!w)return _;var S=Object.keys(w);return S.length===1&&S[0]==="output"?_:w}e.exports=function(w){return{format:function(){for(var _=arguments.length,S=new Array(_),x=0;x<_;x++)S[x]=arguments[x];return u.apply(void 0,S.concat([w]))},getByteUnit:function(){for(var _=arguments.length,S=new Array(_),x=0;x<_;x++)S[x]=arguments[x];return(function(P){var k=l.general;return d(P._value,k.suffixes,k.scale).suffix}).apply(void 0,S.concat([w]))},getBinaryByteUnit:function(){for(var _=arguments.length,S=new Array(_),x=0;x<_;x++)S[x]=arguments[x];return(function(P){var k=l.binary;return d(P._value,k.suffixes,k.scale).suffix}).apply(void 0,S.concat([w]))},getDecimalByteUnit:function(){for(var _=arguments.length,S=new Array(_),x=0;x<_;x++)S[x]=arguments[x];return(function(P){var k=l.decimal;return d(P._value,k.suffixes,k.scale).suffix}).apply(void 0,S.concat([w]))},formatOrDefault:g}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(t,e,n){"use strict";var r=t("./en-US"),i=t("./validating"),o=t("./parsing"),s={},a=void 0,l={},c=null,u={};function d(f){a=f}function h(){return l[a]}s.languages=function(){return Object.assign({},l)},s.currentLanguage=function(){return a},s.currentCurrency=function(){return h().currency},s.currentAbbreviations=function(){return h().abbreviations},s.currentDelimiters=function(){return h().delimiters},s.currentOrdinal=function(){return h().ordinal},s.currentDefaults=function(){return Object.assign({},h().defaults,u)},s.currentOrdinalDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().ordinalFormat)},s.currentByteDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().byteFormat)},s.currentPercentageDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().percentageFormat)},s.currentCurrencyDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().currencyFormat)},s.currentTimeDefaultFormat=function(){return Object.assign({},s.currentDefaults(),h().timeFormat)},s.setDefaults=function(f){f=o.parseFormat(f),i.validateFormat(f)&&(u=f)},s.getZeroFormat=function(){return c},s.setZeroFormat=function(f){return c=typeof f=="string"?f:null},s.hasZeroFormat=function(){return c!==null},s.languageData=function(f){if(f){if(l[f])return l[f];throw new Error('Unknown tag "'.concat(f,'"'))}return h()},s.registerLanguage=function(f){var p=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!i.validateLanguage(f))throw new Error("Invalid language data");l[f.languageTag]=f,p&&d(f.languageTag)},s.setLanguage=function(f){var p=1<arguments.length&&arguments[1]!==void 0?arguments[1]:r.languageTag;if(!l[f]){var g=f.split("-")[0],w=Object.keys(l).find(function(_){return _.split("-")[0]===g});return l[w]?void d(w):void d(p)}d(f)},s.registerLanguage(r),a=r.languageTag,e.exports=s},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(t,e,n){"use strict";e.exports=function(r){return{loadLanguagesInNode:function(i){return o=r,void i.forEach(function(s){var a=void 0;try{a=t("../languages/".concat(s))}catch{console.error('Unable to load "'.concat(s,'". No matching language file found.'))}a&&o.registerLanguage(a)});var o}}}},{}],6:[function(t,e,n){"use strict";var r=t("bignumber.js");function i(o,s,a){var l=new r(o._value),c=s;return a.isNumbro(s)&&(c=s._value),c=new r(c),o._value=l.minus(c).toNumber(),o}e.exports=function(o){return{add:function(s,a){return c=a,u=o,d=new r((l=s)._value),h=c,u.isNumbro(c)&&(h=c._value),h=new r(h),l._value=d.plus(h).toNumber(),l;var l,c,u,d,h},subtract:function(s,a){return i(s,a,o)},multiply:function(s,a){return c=a,u=o,d=new r((l=s)._value),h=c,u.isNumbro(c)&&(h=c._value),h=new r(h),l._value=d.times(h).toNumber(),l;var l,c,u,d,h},divide:function(s,a){return c=a,u=o,d=new r((l=s)._value),h=c,u.isNumbro(c)&&(h=c._value),h=new r(h),l._value=d.dividedBy(h).toNumber(),l;var l,c,u,d,h},set:function(s,a){return l=s,u=c=a,o.isNumbro(c)&&(u=c._value),l._value=u,l;var l,c,u},difference:function(s,a){return l=a,i(u=(c=o)(s._value),l,c),Math.abs(u._value);var l,c,u}}}},{"bignumber.js":1}],7:[function(t,e,n){"use strict";function r(p,g){for(var w=0;w<g.length;w++){var _=g[w];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(p,_.key,_)}}var i=t("./globalState"),o=t("./validating"),s=t("./loading")(f),a=t("./unformatting"),l=t("./formatting")(f),c=t("./manipulating")(f),u=t("./parsing"),d=function(){function p(S){(function(x,P){if(!(x instanceof P))throw new TypeError("Cannot call a class as a function")})(this,p),this._value=S}var g,w,_;return g=p,(w=[{key:"clone",value:function(){return f(this._value)}},{key:"format",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return l.format(this,S)}},{key:"formatCurrency",value:function(S){return typeof S=="string"&&(S=u.parseFormat(S)),(S=l.formatOrDefault(S,i.currentCurrencyDefaultFormat())).output="currency",l.format(this,S)}},{key:"formatTime",value:function(){var S=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return S.output="time",l.format(this,S)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(S){return c.difference(this,S)}},{key:"add",value:function(S){return c.add(this,S)}},{key:"subtract",value:function(S){return c.subtract(this,S)}},{key:"multiply",value:function(S){return c.multiply(this,S)}},{key:"divide",value:function(S){return c.divide(this,S)}},{key:"set",value:function(S){return c.set(this,h(S))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&r(g.prototype,w),_&&r(g,_),p}();function h(p){var g=p;return f.isNumbro(p)?g=p._value:typeof p=="string"?g=f.unformat(p):isNaN(p)&&(g=NaN),g}function f(p){return new d(h(p))}f.version="2.1.2",f.isNumbro=function(p){return p instanceof d},f.language=i.currentLanguage,f.registerLanguage=i.registerLanguage,f.setLanguage=i.setLanguage,f.languages=i.languages,f.languageData=i.languageData,f.zeroFormat=i.setZeroFormat,f.defaultFormat=i.currentDefaults,f.setDefaults=i.setDefaults,f.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,f.validate=o.validate,f.loadLanguagesInNode=s.loadLanguagesInNode,f.unformat=a.unformat,e.exports=f},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(t,e,n){"use strict";e.exports={parseFormat:function(r){var i,o,s,a,l,c,u,d,h,f,p,g,w,_,S,x,P,k,b,C,N=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof r!="string"?r:(o=N,r=(s=(i=r).match(/^{([^}]*)}/))?(o.prefix=s[1],i.slice(s[0].length)):i,l=N,function(B,Y){if(B.indexOf("$")===-1){if(B.indexOf("%")===-1)return B.indexOf("bd")!==-1?(Y.output="byte",Y.base="general"):B.indexOf("b")!==-1?(Y.output="byte",Y.base="binary"):B.indexOf("d")!==-1?(Y.output="byte",Y.base="decimal"):B.indexOf(":")===-1?B.indexOf("o")!==-1&&(Y.output="ordinal"):Y.output="time";Y.output="percent"}else Y.output="currency"}(r=(c=(a=r).match(/{([^}]*)}$/))?(l.postfix=c[1],a.slice(0,-c[0].length)):a,N),u=N,(d=r.match(/[1-9]+[0-9]*/))&&(u.totalLength=+d[0]),h=N,(f=r.split(".")[0].match(/0+/))&&(h.characteristic=f[0].length),function(B,Y){if(B.indexOf(".")!==-1){var ee=B.split(".")[0];Y.optionalCharacteristic=ee.indexOf("0")===-1}}(r,N),p=N,r.indexOf("a")!==-1&&(p.average=!0),w=N,(g=r).indexOf("K")!==-1?w.forceAverage="thousand":g.indexOf("M")!==-1?w.forceAverage="million":g.indexOf("B")!==-1?w.forceAverage="billion":g.indexOf("T")!==-1&&(w.forceAverage="trillion"),function(B,Y){var ee=B.split(".")[1];if(ee){var te=ee.match(/0+/);te&&(Y.mantissa=te[0].length)}}(r,N),S=N,(_=r).match(/\[\.]/)?S.optionalMantissa=!0:_.match(/\./)&&(S.optionalMantissa=!1),x=N,r.indexOf(",")!==-1&&(x.thousandSeparated=!0),P=N,r.indexOf(" ")!==-1&&(P.spaceSeparated=!0),b=N,(k=r).match(/^\+?\([^)]*\)$/)&&(b.negative="parenthesis"),k.match(/^\+?-/)&&(b.negative="sign"),C=N,r.match(/^\+/)&&(C.forceSign=!0),N)}}},{}],9:[function(t,e,n){"use strict";var r=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function i(s){return s.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function o(s,a){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",c=3<arguments.length?arguments[3]:void 0,u=4<arguments.length?arguments[4]:void 0,d=5<arguments.length?arguments[5]:void 0,h=6<arguments.length?arguments[6]:void 0;if(s!=="")return s===u?0:function f(p,g){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",_=3<arguments.length?arguments[3]:void 0,S=4<arguments.length?arguments[4]:void 0,x=5<arguments.length?arguments[5]:void 0,P=6<arguments.length?arguments[6]:void 0;if(!isNaN(+p))return+p;var k="",b=p.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(b!==p)return-1*f(b,g,w,_,S,x,P);for(var C=0;C<r.length;C++){var N=r[C];if((k=p.replace(N.key,""))!==p)return f(k,g,w,_,S,x,P)*N.factor}if((k=p.replace("%",""))!==p)return f(k,g,w,_,S,x,P)/100;var B=parseFloat(p);if(!isNaN(B)){var Y=_(B);if(Y&&Y!=="."&&(k=p.replace(new RegExp("".concat(i(Y),"$")),""))!==p)return f(k,g,w,_,S,x,P);var ee={};Object.keys(x).forEach(function(q){ee[x[q]]=q});for(var te=Object.keys(ee).sort().reverse(),Ce=te.length,Re=0;Re<Ce;Re++){var _e=te[Re],L=ee[_e];if((k=p.replace(_e,""))!==p){var M=void 0;switch(L){case"thousand":M=Math.pow(10,3);break;case"million":M=Math.pow(10,6);break;case"billion":M=Math.pow(10,9);break;case"trillion":M=Math.pow(10,12)}return f(k,g,w,_,S,x,P)*M}}}}(function(f,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",w=f.replace(g,"");return w=(w=w.replace(new RegExp("([0-9])".concat(i(p.thousands),"([0-9])"),"g"),"$1$2")).replace(p.decimal,".")}(s,a,l),a,l,c,u,d,h)}e.exports={unformat:function(s,a){var l,c,u,d=t("./globalState"),h=d.currentDelimiters(),f=d.currentCurrency().symbol,p=d.currentOrdinal(),g=d.getZeroFormat(),w=d.currentAbbreviations(),_=void 0;if(typeof s=="string")_=function(S,x){if(!S.indexOf(":")||x.thousands===":")return!1;var P=S.split(":");if(P.length!==3)return!1;var k=+P[0],b=+P[1],C=+P[2];return!isNaN(k)&&!isNaN(b)&&!isNaN(C)}(s,h)?(l=s.split(":"),c=+l[0],u=+l[1],+l[2]+60*u+3600*c):o(s,h,f,p,g,w,a);else{if(typeof s!="number")return;_=s}if(_!==void 0)return _}}},{"./globalState":4}],10:[function(t,e,n){"use strict";function r(h){return function(f){if(Array.isArray(f)){for(var p=0,g=new Array(f.length);p<f.length;p++)g[p]=f[p];return g}}(h)||function(f){if(Symbol.iterator in Object(f)||Object.prototype.toString.call(f)==="[object Arguments]")return Array.from(f)}(h)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(h){return(i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(h)}var o=t("./unformatting"),s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,a={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(h,f){return f.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(h){return h.output==="byte"}},characteristic:{type:"number",restriction:function(h){return 0<=h},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(h){return 0<=h},message:"value must be positive"},{restriction:function(h,f){return!f.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(h){return 0<=h},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(h,f){return f.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(h){return h.match(s)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(h){return!!o.unformat(h)}function u(h,f,p){var g=3<arguments.length&&arguments[3]!==void 0&&arguments[3],w=Object.keys(h).map(function(_){if(!f[_])return console.error("".concat(p," Invalid key: ").concat(_)),!1;var S=h[_],x=f[_];if(typeof x=="string"&&(x={type:x}),x.type==="format"){if(!u(S,a,"[Validate ".concat(_,"]"),!0))return!1}else if(i(S)!==x.type)return console.error("".concat(p," ").concat(_,' type mismatched: "').concat(x.type,'" expected, "').concat(i(S),'" provided')),!1;if(x.restrictions&&x.restrictions.length)for(var P=x.restrictions.length,k=0;k<P;k++){var b=x.restrictions[k],C=b.restriction,N=b.message;if(!C(S,h))return console.error("".concat(p," ").concat(_," invalid value: ").concat(N)),!1}return x.restriction&&!x.restriction(S,h)?(console.error("".concat(p," ").concat(_," invalid value: ").concat(x.message)),!1):x.validValues&&x.validValues.indexOf(S)===-1?(console.error("".concat(p," ").concat(_," invalid value: must be among ").concat(JSON.stringify(x.validValues),', "').concat(S,'" provided')),!1):!(x.children&&!u(S,x.children,"[Validate ".concat(_,"]")))});return g||w.push.apply(w,r(Object.keys(f).map(function(_){var S=f[_];if(typeof S=="string"&&(S={type:S}),S.mandatory){var x=S.mandatory;if(typeof x=="function"&&(x=x(h)),x&&h[_]===void 0)return console.error("".concat(p,' Missing mandatory key "').concat(_,'"')),!1}return!0}))),w.reduce(function(_,S){return _&&S},!0)}function d(h){return u(h,a,"[Validate format]")}e.exports={validate:function(h,f){var p=c(h),g=d(f);return p&&g},validateFormat:d,validateInput:c,validateLanguage:function(h){return u(h,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})});var Ade=We((Sjt,Ide)=>{"use strict";var Dde=F3(),KXe=TypeError;Ide.exports=function(t,e){if(!delete t[e])throw new KXe("Cannot delete property "+Dde(e)+" of "+Dde(t))}});var Mde=We(()=>{"use strict";var XXe=Tf(),ZXe=sS(),QXe=cS(),JXe=f4(),eZe=Ade(),tZe=m4(),nZe=[].unshift(0)!==1,rZe=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},iZe=nZe||!rZe();XXe({target:"Array",proto:!0,arity:1,forced:iZe},{unshift:function(e){var n=ZXe(this),r=QXe(n),i=arguments.length;if(i){tZe(r+i);for(var o=r;o--;){var s=o+i;o in n?n[s]=n[o]:eZe(n,s)}for(var a=0;a<i;a++)n[a]=arguments[a]}return JXe(n,r+i)}})});var pve=We((n$,r$)=>{(function(t,e){typeof define=="function"&&define.amd?define([],e):typeof r$=="object"&&typeof n$<"u"?r$.exports=e():t.Papa=e()})(n$,function t(){"use strict";var e=typeof self<"u"?self:typeof window<"u"?window:e!==void 0?e:{},n=!e.document&&!!e.postMessage,r=e.IS_PAPA_WORKER||!1,i={},o=0,s={parse:function(b,C){var N=(C=C||{}).dynamicTyping||!1;if(k(N)&&(C.dynamicTypingFunction=N,N={}),C.dynamicTyping=N,C.transform=!!k(C.transform)&&C.transform,C.worker&&s.WORKERS_SUPPORTED){var B=function(){if(!s.WORKERS_SUPPORTED)return!1;var ee=(Ce=e.URL||e.webkitURL||null,Re=t.toString(),s.BLOB_URL||(s.BLOB_URL=Ce.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",Re,")();"],{type:"text/javascript"})))),te=new e.Worker(ee),Ce,Re;return te.onmessage=w,te.id=o++,i[te.id]=te}();return B.userStep=C.step,B.userChunk=C.chunk,B.userComplete=C.complete,B.userError=C.error,C.step=k(C.step),C.chunk=k(C.chunk),C.complete=k(C.complete),C.error=k(C.error),delete C.worker,void B.postMessage({input:b,config:C,workerId:B.id})}var Y=null;return s.NODE_STREAM_INPUT,typeof b=="string"?(b=function(ee){return ee.charCodeAt(0)===65279?ee.slice(1):ee}(b),Y=C.download?new c(C):new d(C)):b.readable===!0&&k(b.read)&&k(b.on)?Y=new h(C):(e.File&&b instanceof File||b instanceof Object)&&(Y=new u(C)),Y.stream(b)},unparse:function(b,C){var N=!1,B=!0,Y=",",ee=`\r
`,te='"',Ce=te+te,Re=!1,_e=null,L=!1;(function(){if(typeof C=="object"){if(typeof C.delimiter!="string"||s.BAD_DELIMITERS.filter(function(E){return C.delimiter.indexOf(E)!==-1}).length||(Y=C.delimiter),(typeof C.quotes=="boolean"||typeof C.quotes=="function"||Array.isArray(C.quotes))&&(N=C.quotes),typeof C.skipEmptyLines!="boolean"&&typeof C.skipEmptyLines!="string"||(Re=C.skipEmptyLines),typeof C.newline=="string"&&(ee=C.newline),typeof C.quoteChar=="string"&&(te=C.quoteChar),typeof C.header=="boolean"&&(B=C.header),Array.isArray(C.columns)){if(C.columns.length===0)throw new Error("Option columns is empty");_e=C.columns}C.escapeChar!==void 0&&(Ce=C.escapeChar+te),(typeof C.escapeFormulae=="boolean"||C.escapeFormulae instanceof RegExp)&&(L=C.escapeFormulae instanceof RegExp?C.escapeFormulae:/^[=+\-@\t\r].*$/)}})();var M=new RegExp(p(te),"g");if(typeof b=="string"&&(b=JSON.parse(b)),Array.isArray(b)){if(!b.length||Array.isArray(b[0]))return q(null,b,Re);if(typeof b[0]=="object")return q(_e||Object.keys(b[0]),b,Re)}else if(typeof b=="object")return typeof b.data=="string"&&(b.data=JSON.parse(b.data)),Array.isArray(b.data)&&(b.fields||(b.fields=b.meta&&b.meta.fields||_e),b.fields||(b.fields=Array.isArray(b.data[0])?b.fields:typeof b.data[0]=="object"?Object.keys(b.data[0]):[]),Array.isArray(b.data[0])||typeof b.data[0]=="object"||(b.data=[b.data])),q(b.fields||[],b.data||[],Re);throw new Error("Unable to serialize unrecognized input");function q(E,R,D){var A="";typeof E=="string"&&(E=JSON.parse(E)),typeof R=="string"&&(R=JSON.parse(R));var O=Array.isArray(E)&&0<E.length,U=!Array.isArray(R[0]);if(O&&B){for(var ie=0;ie<E.length;ie++)0<ie&&(A+=Y),A+=y(E[ie],ie);0<R.length&&(A+=ee)}for(var ue=0;ue<R.length;ue++){var fe=O?E.length:R[ue].length,de=!1,ye=O?Object.keys(R[ue]).length===0:R[ue].length===0;if(D&&!O&&(de=D==="greedy"?R[ue].join("").trim()==="":R[ue].length===1&&R[ue][0].length===0),D==="greedy"&&O){for(var Pe=[],F=0;F<fe;F++){var Ke=U?E[F]:F;Pe.push(R[ue][Ke])}de=Pe.join("").trim()===""}if(!de){for(var $e=0;$e<fe;$e++){0<$e&&!ye&&(A+=Y);var rt=O&&U?E[$e]:$e;A+=y(R[ue][rt],$e)}ue<R.length-1&&(!D||0<fe&&!ye)&&(A+=ee)}}return A}function y(E,R){if(E==null)return"";if(E.constructor===Date)return JSON.stringify(E).slice(1,25);var D=!1;L&&typeof E=="string"&&L.test(E)&&(E="'"+E,D=!0);var A=E.toString().replace(M,Ce);return(D=D||N===!0||typeof N=="function"&&N(E,R)||Array.isArray(N)&&N[R]||function(O,U){for(var ie=0;ie<U.length;ie++)if(-1<O.indexOf(U[ie]))return!0;return!1}(A,s.BAD_DELIMITERS)||-1<A.indexOf(Y)||A.charAt(0)===" "||A.charAt(A.length-1)===" ")?te+A+te:A}}};if(s.RECORD_SEP=String.fromCharCode(30),s.UNIT_SEP=String.fromCharCode(31),s.BYTE_ORDER_MARK="\uFEFF",s.BAD_DELIMITERS=["\r",`
`,'"',s.BYTE_ORDER_MARK],s.WORKERS_SUPPORTED=!n&&!!e.Worker,s.NODE_STREAM_INPUT=1,s.LocalChunkSize=10485760,s.RemoteChunkSize=5242880,s.DefaultDelimiter=",",s.Parser=g,s.ParserHandle=f,s.NetworkStreamer=c,s.FileStreamer=u,s.StringStreamer=d,s.ReadableStreamStreamer=h,e.jQuery){var a=e.jQuery;a.fn.parse=function(b){var C=b.config||{},N=[];return this.each(function(ee){if(!(a(this).prop("tagName").toUpperCase()==="INPUT"&&a(this).attr("type").toLowerCase()==="file"&&e.FileReader)||!this.files||this.files.length===0)return!0;for(var te=0;te<this.files.length;te++)N.push({file:this.files[te],inputElem:this,instanceConfig:a.extend({},C)})}),B(),this;function B(){if(N.length!==0){var ee,te,Ce,Re,_e=N[0];if(k(b.before)){var L=b.before(_e.file,_e.inputElem);if(typeof L=="object"){if(L.action==="abort")return ee="AbortError",te=_e.file,Ce=_e.inputElem,Re=L.reason,void(k(b.error)&&b.error({name:ee},te,Ce,Re));if(L.action==="skip")return void Y();typeof L.config=="object"&&(_e.instanceConfig=a.extend(_e.instanceConfig,L.config))}else if(L==="skip")return void Y()}var M=_e.instanceConfig.complete;_e.instanceConfig.complete=function(q){k(M)&&M(q,_e.file,_e.inputElem),Y()},s.parse(_e.file,_e.instanceConfig)}else k(b.complete)&&b.complete()}function Y(){N.splice(0,1),B()}}}function l(b){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(C){var N=x(C);N.chunkSize=parseInt(N.chunkSize),C.step||C.chunk||(N.chunkSize=null),this._handle=new f(N),(this._handle.streamer=this)._config=N}).call(this,b),this.parseChunk=function(C,N){if(this.isFirstChunk&&k(this._config.beforeFirstChunk)){var B=this._config.beforeFirstChunk(C);B!==void 0&&(C=B)}this.isFirstChunk=!1,this._halted=!1;var Y=this._partialLine+C;this._partialLine="";var ee=this._handle.parse(Y,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var te=ee.meta.cursor;this._finished||(this._partialLine=Y.substring(te-this._baseIndex),this._baseIndex=te),ee&&ee.data&&(this._rowCount+=ee.data.length);var Ce=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r)e.postMessage({results:ee,workerId:s.WORKER_ID,finished:Ce});else if(k(this._config.chunk)&&!N){if(this._config.chunk(ee,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);ee=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(ee.data),this._completeResults.errors=this._completeResults.errors.concat(ee.errors),this._completeResults.meta=ee.meta),this._completed||!Ce||!k(this._config.complete)||ee&&ee.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),Ce||ee&&ee.meta.paused||this._nextChunk(),ee}this._halted=!0},this._sendError=function(C){k(this._config.error)?this._config.error(C):r&&this._config.error&&e.postMessage({workerId:s.WORKER_ID,error:C,finished:!1})}}function c(b){var C;(b=b||{}).chunkSize||(b.chunkSize=s.RemoteChunkSize),l.call(this,b),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(N){this._input=N,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(C=new XMLHttpRequest,this._config.withCredentials&&(C.withCredentials=this._config.withCredentials),n||(C.onload=P(this._chunkLoaded,this),C.onerror=P(this._chunkError,this)),C.open(this._config.downloadRequestBody?"POST":"GET",this._input,!n),this._config.downloadRequestHeaders){var N=this._config.downloadRequestHeaders;for(var B in N)C.setRequestHeader(B,N[B])}if(this._config.chunkSize){var Y=this._start+this._config.chunkSize-1;C.setRequestHeader("Range","bytes="+this._start+"-"+Y)}try{C.send(this._config.downloadRequestBody)}catch(ee){this._chunkError(ee.message)}n&&C.status===0&&this._chunkError()}},this._chunkLoaded=function(){C.readyState===4&&(C.status<200||400<=C.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:C.responseText.length,this._finished=!this._config.chunkSize||this._start>=function(N){var B=N.getResponseHeader("Content-Range");return B===null?-1:parseInt(B.substring(B.lastIndexOf("/")+1))}(C),this.parseChunk(C.responseText)))},this._chunkError=function(N){var B=C.statusText||N;this._sendError(new Error(B))}}function u(b){var C,N;(b=b||{}).chunkSize||(b.chunkSize=s.LocalChunkSize),l.call(this,b);var B=typeof FileReader<"u";this.stream=function(Y){this._input=Y,N=Y.slice||Y.webkitSlice||Y.mozSlice,B?((C=new FileReader).onload=P(this._chunkLoaded,this),C.onerror=P(this._chunkError,this)):C=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var Y=this._input;if(this._config.chunkSize){var ee=Math.min(this._start+this._config.chunkSize,this._input.size);Y=N.call(Y,this._start,ee)}var te=C.readAsText(Y,this._config.encoding);B||this._chunkLoaded({target:{result:te}})},this._chunkLoaded=function(Y){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(Y.target.result)},this._chunkError=function(){this._sendError(C.error)}}function d(b){var C;l.call(this,b=b||{}),this.stream=function(N){return C=N,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var N,B=this._config.chunkSize;return B?(N=C.substring(0,B),C=C.substring(B)):(N=C,C=""),this._finished=!C,this.parseChunk(N)}}}function h(b){l.call(this,b=b||{});var C=[],N=!0,B=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(Y){this._input=Y,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){B&&C.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),C.length?this.parseChunk(C.shift()):N=!0},this._streamData=P(function(Y){try{C.push(typeof Y=="string"?Y:Y.toString(this._config.encoding)),N&&(N=!1,this._checkIsFinished(),this.parseChunk(C.shift()))}catch(ee){this._streamError(ee)}},this),this._streamError=P(function(Y){this._streamCleanUp(),this._sendError(Y)},this),this._streamEnd=P(function(){this._streamCleanUp(),B=!0,this._streamData("")},this),this._streamCleanUp=P(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(b){var C,N,B,Y=Math.pow(2,53),ee=-Y,te=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,Ce=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,Re=this,_e=0,L=0,M=!1,q=!1,y=[],E={data:[],errors:[],meta:{}};if(k(b.step)){var R=b.step;b.step=function(ue){if(E=ue,O())A();else{if(A(),E.data.length===0)return;_e+=ue.data.length,b.preview&&_e>b.preview?N.abort():(E.data=E.data[0],R(E,Re))}}}function D(ue){return b.skipEmptyLines==="greedy"?ue.join("").trim()==="":ue.length===1&&ue[0].length===0}function A(){return E&&B&&(ie("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+s.DefaultDelimiter+"'"),B=!1),b.skipEmptyLines&&(E.data=E.data.filter(function(ue){return!D(ue)})),O()&&function(){if(!E)return;function ue(de,ye){k(b.transformHeader)&&(de=b.transformHeader(de,ye)),y.push(de)}if(Array.isArray(E.data[0])){for(var fe=0;O()&&fe<E.data.length;fe++)E.data[fe].forEach(ue);E.data.splice(0,1)}else E.data.forEach(ue)}(),function(){if(!E||!b.header&&!b.dynamicTyping&&!b.transform)return E;function ue(de,ye){var Pe,F=b.header?{}:[];for(Pe=0;Pe<de.length;Pe++){var Ke=Pe,$e=de[Pe];b.header&&(Ke=Pe>=y.length?"__parsed_extra":y[Pe]),b.transform&&($e=b.transform($e,Ke)),$e=U(Ke,$e),Ke==="__parsed_extra"?(F[Ke]=F[Ke]||[],F[Ke].push($e)):F[Ke]=$e}return b.header&&(Pe>y.length?ie("FieldMismatch","TooManyFields","Too many fields: expected "+y.length+" fields but parsed "+Pe,L+ye):Pe<y.length&&ie("FieldMismatch","TooFewFields","Too few fields: expected "+y.length+" fields but parsed "+Pe,L+ye)),F}var fe=1;return!E.data.length||Array.isArray(E.data[0])?(E.data=E.data.map(ue),fe=E.data.length):E.data=ue(E.data,0),b.header&&E.meta&&(E.meta.fields=y),L+=fe,E}()}function O(){return b.header&&y.length===0}function U(ue,fe){return de=ue,b.dynamicTypingFunction&&b.dynamicTyping[de]===void 0&&(b.dynamicTyping[de]=b.dynamicTypingFunction(de)),(b.dynamicTyping[de]||b.dynamicTyping)===!0?fe==="true"||fe==="TRUE"||fe!=="false"&&fe!=="FALSE"&&(function(ye){if(te.test(ye)){var Pe=parseFloat(ye);if(ee<Pe&&Pe<Y)return!0}return!1}(fe)?parseFloat(fe):Ce.test(fe)?new Date(fe):fe===""?null:fe):fe;var de}function ie(ue,fe,de,ye){var Pe={type:ue,code:fe,message:de};ye!==void 0&&(Pe.row=ye),E.errors.push(Pe)}this.parse=function(ue,fe,de){var ye=b.quoteChar||'"';if(b.newline||(b.newline=function(Ke,$e){Ke=Ke.substring(0,1048576);var rt=new RegExp(p($e)+"([^]*?)"+p($e),"gm"),Ye=(Ke=Ke.replace(rt,"")).split("\r"),Me=Ke.split(`
`),j=1<Me.length&&Me[0].length<Ye[0].length;if(Ye.length===1||j)return`
`;for(var z=0,J=0;J<Ye.length;J++)Ye[J][0]===`
`&&z++;return z>=Ye.length/2?`\r
`:"\r"}(ue,ye)),B=!1,b.delimiter)k(b.delimiter)&&(b.delimiter=b.delimiter(ue),E.meta.delimiter=b.delimiter);else{var Pe=function(Ke,$e,rt,Ye,Me){var j,z,J,pe;Me=Me||[",","	","|",";",s.RECORD_SEP,s.UNIT_SEP];for(var he=0;he<Me.length;he++){var me=Me[he],ve=0,ne=0,ce=0;J=void 0;for(var oe=new g({comments:Ye,delimiter:me,newline:$e,preview:10}).parse(Ke),ge=0;ge<oe.data.length;ge++)if(rt&&D(oe.data[ge]))ce++;else{var Ve=oe.data[ge].length;ne+=Ve,J!==void 0?0<Ve&&(ve+=Math.abs(Ve-J),J=Ve):J=Ve}0<oe.data.length&&(ne/=oe.data.length-ce),(z===void 0||ve<=z)&&(pe===void 0||pe<ne)&&1.99<ne&&(z=ve,j=me,pe=ne)}return{successful:!!(b.delimiter=j),bestDelimiter:j}}(ue,b.newline,b.skipEmptyLines,b.comments,b.delimitersToGuess);Pe.successful?b.delimiter=Pe.bestDelimiter:(B=!0,b.delimiter=s.DefaultDelimiter),E.meta.delimiter=b.delimiter}var F=x(b);return b.preview&&b.header&&F.preview++,C=ue,N=new g(F),E=N.parse(C,fe,de),A(),M?{meta:{paused:!0}}:E||{meta:{paused:!1}}},this.paused=function(){return M},this.pause=function(){M=!0,N.abort(),C=k(b.chunk)?"":C.substring(N.getCharIndex())},this.resume=function(){Re.streamer._halted?(M=!1,Re.streamer.parseChunk(C,!0)):setTimeout(Re.resume,3)},this.aborted=function(){return q},this.abort=function(){q=!0,N.abort(),E.meta.aborted=!0,k(b.complete)&&b.complete(E),C=""}}function p(b){return b.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function g(b){var C,N=(b=b||{}).delimiter,B=b.newline,Y=b.comments,ee=b.step,te=b.preview,Ce=b.fastMode,Re=C=b.quoteChar===void 0||b.quoteChar===null?'"':b.quoteChar;if(b.escapeChar!==void 0&&(Re=b.escapeChar),(typeof N!="string"||-1<s.BAD_DELIMITERS.indexOf(N))&&(N=","),Y===N)throw new Error("Comment character same as delimiter");Y===!0?Y="#":(typeof Y!="string"||-1<s.BAD_DELIMITERS.indexOf(Y))&&(Y=!1),B!==`
`&&B!=="\r"&&B!==`\r
`&&(B=`
`);var _e=0,L=!1;this.parse=function(M,q,y){if(typeof M!="string")throw new Error("Input must be a string");var E=M.length,R=N.length,D=B.length,A=Y.length,O=k(ee),U=[],ie=[],ue=[],fe=_e=0;if(!M)return ke();if(b.header&&!q){var de=M.split(B)[0].split(N),ye=[],Pe={},F=!1;for(var Ke in de){var $e=de[Ke];k(b.transformHeader)&&($e=b.transformHeader($e,Ke));var rt=$e,Ye=Pe[$e]||0;for(0<Ye&&(F=!0,rt=$e+"_"+Ye),Pe[$e]=Ye+1;ye.includes(rt);)rt=rt+"_"+Ye;ye.push(rt)}if(F){var Me=M.split(B);Me[0]=ye.join(N),M=Me.join(B)}}if(Ce||Ce!==!1&&M.indexOf(C)===-1){for(var j=M.split(B),z=0;z<j.length;z++){if(ue=j[z],_e+=ue.length,z!==j.length-1)_e+=B.length;else if(y)return ke();if(!Y||ue.substring(0,A)!==Y){if(O){if(U=[],ce(ue.split(N)),Xe(),L)return ke()}else ce(ue.split(N));if(te&&te<=z)return U=U.slice(0,te),ke(!0)}}return ke()}for(var J=M.indexOf(N,_e),pe=M.indexOf(B,_e),he=new RegExp(p(Re)+p(C),"g"),me=M.indexOf(C,_e);;)if(M[_e]!==C)if(Y&&ue.length===0&&M.substring(_e,_e+A)===Y){if(pe===-1)return ke();_e=pe+D,pe=M.indexOf(B,_e),J=M.indexOf(N,_e)}else if(J!==-1&&(J<pe||pe===-1))ue.push(M.substring(_e,J)),_e=J+R,J=M.indexOf(N,_e);else{if(pe===-1)break;if(ue.push(M.substring(_e,pe)),Ve(pe+D),O&&(Xe(),L))return ke();if(te&&U.length>=te)return ke(!0)}else for(me=_e,_e++;;){if((me=M.indexOf(C,me+1))===-1)return y||ie.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:U.length,index:_e}),ge();if(me===E-1)return ge(M.substring(_e,me).replace(he,C));if(C!==Re||M[me+1]!==Re){if(C===Re||me===0||M[me-1]!==Re){J!==-1&&J<me+1&&(J=M.indexOf(N,me+1)),pe!==-1&&pe<me+1&&(pe=M.indexOf(B,me+1));var ve=oe(pe===-1?J:Math.min(J,pe));if(M.substr(me+1+ve,R)===N){ue.push(M.substring(_e,me).replace(he,C)),M[_e=me+1+ve+R]!==C&&(me=M.indexOf(C,_e)),J=M.indexOf(N,_e),pe=M.indexOf(B,_e);break}var ne=oe(pe);if(M.substring(me+1+ne,me+1+ne+D)===B){if(ue.push(M.substring(_e,me).replace(he,C)),Ve(me+1+ne+D),J=M.indexOf(N,_e),me=M.indexOf(C,_e),O&&(Xe(),L))return ke();if(te&&U.length>=te)return ke(!0);break}ie.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:U.length,index:_e}),me++}}else me++}return ge();function ce(gt){U.push(gt),fe=_e}function oe(gt){var Mt=0;if(gt!==-1){var Nt=M.substring(me+1,gt);Nt&&Nt.trim()===""&&(Mt=Nt.length)}return Mt}function ge(gt){return y||(gt===void 0&&(gt=M.substring(_e)),ue.push(gt),_e=E,ce(ue),O&&Xe()),ke()}function Ve(gt){_e=gt,ce(ue),ue=[],pe=M.indexOf(B,_e)}function ke(gt){return{data:U,errors:ie,meta:{delimiter:N,linebreak:B,aborted:L,truncated:!!gt,cursor:fe+(q||0)}}}function Xe(){ee(ke()),U=[],ie=[]}},this.abort=function(){L=!0},this.getCharIndex=function(){return _e}}function w(b){var C=b.data,N=i[C.workerId],B=!1;if(C.error)N.userError(C.error,C.file);else if(C.results&&C.results.data){var Y={abort:function(){B=!0,_(C.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:S,resume:S};if(k(N.userStep)){for(var ee=0;ee<C.results.data.length&&(N.userStep({data:C.results.data[ee],errors:C.results.errors,meta:C.results.meta},Y),!B);ee++);delete C.results}else k(N.userChunk)&&(N.userChunk(C.results,Y,C.file),delete C.results)}C.finished&&!B&&_(C.workerId,C.results)}function _(b,C){var N=i[b];k(N.userComplete)&&N.userComplete(C),N.terminate(),delete i[b]}function S(){throw new Error("Not implemented.")}function x(b){if(typeof b!="object"||b===null)return b;var C=Array.isArray(b)?[]:{};for(var N in b)C[N]=x(b[N]);return C}function P(b,C){return function(){b.apply(C,arguments)}}function k(b){return typeof b=="function"}return r&&(e.onmessage=function(b){var C=b.data;if(s.WORKER_ID===void 0&&C&&(s.WORKER_ID=C.workerId),typeof C.input=="string")e.postMessage({workerId:s.WORKER_ID,results:s.parse(C.input,C.config),finished:!0});else if(e.File&&C.input instanceof File||C.input instanceof Object){var N=s.parse(C.input,C.config);N&&e.postMessage({workerId:s.WORKER_ID,results:N,finished:!0})}}),(c.prototype=Object.create(l.prototype)).constructor=c,(u.prototype=Object.create(l.prototype)).constructor=u,(d.prototype=Object.create(d.prototype)).constructor=d,(h.prototype=Object.create(l.prototype)).constructor=h,s})});var oG=null;var Bk=1;function Do(t){let e=oG;return oG=t,e}var sG={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Y_e(t){if(!(jk(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Bk)){if(!t.producerMustRecompute(t)&&!Uk(t)){t.dirty=!1,t.lastCleanEpoch=Bk;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Bk}}function aG(t){return t&&(t.nextProducerIndex=0),Do(t)}function lG(t,e){if(Do(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(jk(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Wk(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Uk(t){nR(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(Y_e(n),r!==n.version))return!0}return!1}function cG(t){if(nR(t),jk(t))for(let e=0;e<t.producerNode.length;e++)Wk(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Wk(t,e){if(q_e(t),nR(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Wk(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];nR(i),i.producerIndexOfThis[r]=e}}function jk(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function nR(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function q_e(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function K_e(){throw new Error}var X_e=K_e;function uG(t){X_e=t}function Gt(t){return typeof t=="function"}function g0(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var rR=g0(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function Im(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Ii=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let o of n)o.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(Gt(r))try{r()}catch(o){e=o instanceof rR?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{dG(o)}catch(s){e=e??[],s instanceof rR?e=[...e,...s.errors]:e.push(s)}}if(e)throw new rR(e)}}add(e){var n;if(e&&e!==this)if(this.closed)dG(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&Im(n,e)}remove(e){let{_finalizers:n}=this;n&&Im(n,e),e instanceof t&&e._removeParent(this)}};Ii.EMPTY=(()=>{let t=new Ii;return t.closed=!0,t})();var $k=Ii.EMPTY;function iR(t){return t instanceof Ii||t&&"closed"in t&&Gt(t.remove)&&Gt(t.add)&&Gt(t.unsubscribe)}function dG(t){Gt(t)?t():t.unsubscribe()}var jl={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var v0={setTimeout(t,e,...n){let{delegate:r}=v0;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=v0;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function oR(t){v0.setTimeout(()=>{let{onUnhandledError:e}=jl;if(e)e(t);else throw t})}function id(){}var hG=(()=>Gk("C",void 0,void 0))();function fG(t){return Gk("E",void 0,t)}function mG(t){return Gk("N",t,void 0)}function Gk(t,e,n){return{kind:t,value:e,error:n}}var Am=null;function w0(t){if(jl.useDeprecatedSynchronousErrorHandling){let e=!Am;if(e&&(Am={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Am;if(Am=null,n)throw r}}else t()}function pG(t){jl.useDeprecatedSynchronousErrorHandling&&Am&&(Am.errorThrown=!0,Am.error=t)}var Mm=class extends Ii{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,iR(e)&&e.add(this)):this.destination=J_e}static create(e,n,r){return new od(e,n,r)}next(e){this.isStopped?Yk(mG(e),this):this._next(e)}error(e){this.isStopped?Yk(fG(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Yk(hG,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Z_e=Function.prototype.bind;function zk(t,e){return Z_e.call(t,e)}var qk=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){sR(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){sR(r)}else sR(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){sR(n)}}},od=class extends Mm{constructor(e,n,r){super();let i;if(Gt(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let o;this&&jl.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&zk(e.next,o),error:e.error&&zk(e.error,o),complete:e.complete&&zk(e.complete,o)}):i=e}this.destination=new qk(i)}};function sR(t){jl.useDeprecatedSynchronousErrorHandling?pG(t):oR(t)}function Q_e(t){throw t}function Yk(t,e){let{onStoppedNotification:n}=jl;n&&v0.setTimeout(()=>n(t,e))}var J_e={closed:!0,next:id,error:Q_e,complete:id};var y0=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")();function Io(t){return t}function Kk(...t){return Xk(t)}function Xk(t){return t.length===0?Io:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var en=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let o=tCe(n)?n:new od(n,r,i);return w0(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=gG(r),new r((i,o)=>{let s=new od({next:a=>{try{n(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[y0](){return this}pipe(...n){return Xk(n)(this)}toPromise(n){return n=gG(n),new n((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return t.create=e=>new t(e),t})();function gG(t){var e;return(e=t??jl.Promise)!==null&&e!==void 0?e:Promise}function eCe(t){return t&&Gt(t.next)&&Gt(t.error)&&Gt(t.complete)}function tCe(t){return t&&t instanceof Mm||eCe(t)&&iR(t)}function Zk(t){return Gt(t?.lift)}function hn(t){return e=>{if(Zk(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function sn(t,e,n,r,i){return new Qk(t,e,n,r,i)}var Qk=class extends Mm{constructor(e,n,r,i,o,s){super(e),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=n?function(a){try{n(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function _0(){return hn((t,e)=>{let n=null;t._refCount++;let r=sn(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,o=n;n=null,i&&(!o||i===o)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var C0=class extends en{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Zk(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ii;let n=this.getSubject();e.add(this.source.subscribe(sn(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ii.EMPTY)}return e}refCount(){return _0()(this)}};var vG=g0(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ur=(()=>{class t extends en{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new aR(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new vG}next(n){w0(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){w0(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){w0(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:o}=this;return r||i?$k:(this.currentObservers=null,o.push(n),new Ii(()=>{this.currentObservers=null,Im(o,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:o}=this;r?n.error(i):o&&n.complete()}asObservable(){let n=new en;return n.source=this,n}}return t.create=(e,n)=>new aR(e,n),t})(),aR=class extends Ur{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:$k}};var io=class extends Ur{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Jk={now(){return(Jk.delegate||Date).now()},delegate:void 0};var lR=class extends Ii{constructor(e,n){super()}schedule(e,n=0){return this}};var v_={setInterval(t,e,...n){let{delegate:r}=v_;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=v_;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var cR=class extends lR{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,o=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(o,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(o,this.id,n),this}requestAsyncId(e,n,r=0){return v_.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&v_.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(o){r=!0,i=o||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,Im(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var S0=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};S0.now=Jk.now;var uR=class extends S0{constructor(e,n=S0.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var eF=new uR(cR),wG=eF;var Yo=new en(t=>t.complete());function dR(t){return t&&Gt(t.schedule)}function tF(t){return t[t.length-1]}function E0(t){return Gt(tF(t))?t.pop():void 0}function Uc(t){return dR(tF(t))?t.pop():void 0}function yG(t,e){return typeof tF(t)=="number"?t.pop():e}function CG(t,e,n,r){function i(o){return o instanceof n?o:new n(function(s){s(o)})}return new(n||(n=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(t,e||[])).next())})}function _G(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Om(t){return this instanceof Om?(this.v=t,this):new Om(t)}function SG(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(h){r[h]&&(i[h]=function(f){return new Promise(function(p,g){o.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{l(r[h](f))}catch(p){d(o[0][3],p)}}function l(h){h.value instanceof Om?Promise.resolve(h.value.v).then(c,u):d(o[0][2],h)}function c(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),o.shift(),o.length&&a(o[0][0],o[0][1])}}function EG(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof _G=="function"?_G(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(a,l){s=t[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}var x0=t=>t&&typeof t.length=="number"&&typeof t!="function";function hR(t){return Gt(t?.then)}function fR(t){return Gt(t[y0])}function mR(t){return Symbol.asyncIterator&&Gt(t?.[Symbol.asyncIterator])}function pR(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function nCe(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var gR=nCe();function vR(t){return Gt(t?.[gR])}function wR(t){return SG(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield Om(n.read());if(i)return yield Om(void 0);yield yield Om(r)}}finally{n.releaseLock()}})}function yR(t){return Gt(t?.getReader)}function jn(t){if(t instanceof en)return t;if(t!=null){if(fR(t))return rCe(t);if(x0(t))return iCe(t);if(hR(t))return oCe(t);if(mR(t))return xG(t);if(vR(t))return sCe(t);if(yR(t))return aCe(t)}throw pR(t)}function rCe(t){return new en(e=>{let n=t[y0]();if(Gt(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function iCe(t){return new en(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function oCe(t){return new en(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,oR)})}function sCe(t){return new en(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function xG(t){return new en(e=>{lCe(t,e).catch(n=>e.error(n))})}function aCe(t){return xG(wR(t))}function lCe(t,e){var n,r,i,o;return CG(this,void 0,void 0,function*(){try{for(n=EG(t);r=yield n.next(),!r.done;){let s=r.value;if(e.next(s),e.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=n.return)&&(yield o.call(n))}finally{if(i)throw i.error}}e.complete()})}function Xs(t,e,n,r=0,i=!1){let o=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(o),!i)return o}function _R(t,e=0){return hn((n,r)=>{n.subscribe(sn(r,i=>Xs(r,t,()=>r.next(i),e),()=>Xs(r,t,()=>r.complete(),e),i=>Xs(r,t,()=>r.error(i),e)))})}function CR(t,e=0){return hn((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function bG(t,e){return jn(t).pipe(CR(e),_R(e))}function TG(t,e){return jn(t).pipe(CR(e),_R(e))}function RG(t,e){return new en(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function DG(t,e){return new en(n=>{let r;return Xs(n,e,()=>{r=t[gR](),Xs(n,e,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){n.error(s);return}o?n.complete():n.next(i)},0,!0)}),()=>Gt(r?.return)&&r.return()})}function SR(t,e){if(!t)throw new Error("Iterable cannot be null");return new en(n=>{Xs(n,e,()=>{let r=t[Symbol.asyncIterator]();Xs(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function IG(t,e){return SR(wR(t),e)}function AG(t,e){if(t!=null){if(fR(t))return bG(t,e);if(x0(t))return RG(t,e);if(hR(t))return TG(t,e);if(mR(t))return SR(t,e);if(vR(t))return DG(t,e);if(yR(t))return IG(t,e)}throw pR(t)}function Nr(t,e){return e?AG(t,e):jn(t)}function Wt(...t){let e=Uc(t);return Nr(t,e)}function b0(t,e){let n=Gt(t)?t:()=>t,r=i=>i.error(n());return new en(e?i=>e.schedule(r,0,i):r)}function nF(t){return!!t&&(t instanceof en||Gt(t.lift)&&Gt(t.subscribe))}var sd=g0(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function MG(t){return t instanceof Date&&!isNaN(t)}function dn(t,e){return hn((n,r)=>{let i=0;n.subscribe(sn(r,o=>{r.next(t.call(e,o,i++))}))})}var{isArray:cCe}=Array;function uCe(t,e){return cCe(e)?t(...e):t(e)}function T0(t){return dn(e=>uCe(t,e))}var{isArray:dCe}=Array,{getPrototypeOf:hCe,prototype:fCe,keys:mCe}=Object;function ER(t){if(t.length===1){let e=t[0];if(dCe(e))return{args:e,keys:null};if(pCe(e)){let n=mCe(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function pCe(t){return t&&typeof t=="object"&&hCe(t)===fCe}function xR(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function w_(...t){let e=Uc(t),n=E0(t),{args:r,keys:i}=ER(t);if(r.length===0)return Nr([],e);let o=new en(gCe(r,e,i?s=>xR(i,s):Io));return n?o.pipe(T0(n)):o}function gCe(t,e,n=Io){return r=>{OG(e,()=>{let{length:i}=t,o=new Array(i),s=i,a=i;for(let l=0;l<i;l++)OG(e,()=>{let c=Nr(t[l],e),u=!1;c.subscribe(sn(r,d=>{o[l]=d,u||(u=!0,a--),a||r.next(n(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function OG(t,e,n){t?Xs(n,t,e):e()}function NG(t,e,n,r,i,o,s,a){let l=[],c=0,u=0,d=!1,h=()=>{d&&!l.length&&!c&&e.complete()},f=g=>c<r?p(g):l.push(g),p=g=>{o&&e.next(g),c++;let w=!1;jn(n(g,u++)).subscribe(sn(e,_=>{i?.(_),o?f(_):e.next(_)},()=>{w=!0},void 0,()=>{if(w)try{for(c--;l.length&&c<r;){let _=l.shift();s?Xs(e,s,()=>p(_)):p(_)}h()}catch(_){e.error(_)}}))};return t.subscribe(sn(e,f,()=>{d=!0,h()})),()=>{a?.()}}function Pr(t,e,n=1/0){return Gt(e)?Pr((r,i)=>dn((o,s)=>e(r,o,i,s))(jn(t(r,i))),n):(typeof e=="number"&&(n=e),hn((r,i)=>NG(r,i,t,n)))}function y_(t=1/0){return Pr(Io,t)}function PG(){return y_(1)}function Wc(...t){return PG()(Nr(t,Uc(t)))}function bR(t){return new en(e=>{jn(t()).subscribe(e)})}function rF(...t){let e=E0(t),{args:n,keys:r}=ER(t),i=new en(o=>{let{length:s}=n;if(!s){o.complete();return}let a=new Array(s),l=s,c=s;for(let u=0;u<s;u++){let d=!1;jn(n[u]).subscribe(sn(o,h=>{d||(d=!0,c--),a[u]=h},()=>l--,void 0,()=>{(!l||!d)&&(c||o.next(r?xR(r,a):a),o.complete())}))}});return e?i.pipe(T0(e)):i}var vCe=["addListener","removeListener"],wCe=["addEventListener","removeEventListener"],yCe=["on","off"];function Th(t,e,n,r){if(Gt(n)&&(r=n,n=void 0),r)return Th(t,e,n).pipe(T0(r));let[i,o]=SCe(t)?wCe.map(s=>a=>t[s](e,a,n)):_Ce(t)?vCe.map(kG(t,e)):CCe(t)?yCe.map(kG(t,e)):[];if(!i&&x0(t))return Pr(s=>Th(s,e,n))(jn(t));if(!i)throw new TypeError("Invalid event target");return new en(s=>{let a=(...l)=>s.next(1<l.length?l:l[0]);return i(a),()=>o(a)})}function kG(t,e){return n=>r=>t[n](e,r)}function _Ce(t){return Gt(t.addListener)&&Gt(t.removeListener)}function CCe(t){return Gt(t.on)&&Gt(t.off)}function SCe(t){return Gt(t.addEventListener)&&Gt(t.removeEventListener)}function __(t=0,e,n=wG){let r=-1;return e!=null&&(dR(e)?n=e:r=e),new en(i=>{let o=MG(t)?+t-n.now():t;o<0&&(o=0);let s=0;return n.schedule(function(){i.closed||(i.next(s++),0<=r?this.schedule(void 0,r):i.complete())},o)})}function TR(...t){let e=Uc(t),n=yG(t,1/0),r=t;return r.length?r.length===1?jn(r[0]):y_(n)(Nr(r,e)):Yo}var{isArray:ECe}=Array;function FG(t){return t.length===1&&ECe(t[0])?t[0]:t}function Gi(t,e){return hn((n,r)=>{let i=0;n.subscribe(sn(r,o=>t.call(e,o,i++)&&r.next(o)))})}function RR(...t){return t=FG(t),t.length===1?jn(t[0]):new en(xCe(t))}function xCe(t){return e=>{let n=[];for(let r=0;n&&!e.closed&&r<t.length;r++)n.push(jn(t[r]).subscribe(sn(e,i=>{if(n){for(let o=0;o<n.length;o++)o!==r&&n[o].unsubscribe();n=null}e.next(i)})))}}function Rh(t){return hn((e,n)=>{let r=null,i=!1,o;r=e.subscribe(sn(n,void 0,void 0,s=>{o=jn(t(s,Rh(t)(e))),r?(r.unsubscribe(),r=null,o.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(n))})}function LG(t,e,n,r,i){return(o,s)=>{let a=n,l=e,c=0;o.subscribe(sn(s,u=>{let d=c++;l=a?t(l,u,d):(a=!0,u),r&&s.next(l)},i&&(()=>{a&&s.next(l),s.complete()})))}}function Dh(t,e){return Gt(e)?Pr(t,e,1):Pr(t,1)}function Ih(t){return hn((e,n)=>{let r=!1;e.subscribe(sn(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function _s(t){return t<=0?()=>Yo:hn((e,n)=>{let r=0;e.subscribe(sn(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function HG(){return hn((t,e)=>{t.subscribe(sn(e,id))})}function C_(t){return dn(()=>t)}function iF(t,e){return e?n=>Wc(e.pipe(_s(1),HG()),n.pipe(iF(t))):Pr((n,r)=>jn(t(n,r)).pipe(_s(1),C_(n)))}function oF(t,e=eF){let n=__(t,e);return iF(()=>n)}function S_(t,e=Io){return t=t??bCe,hn((n,r)=>{let i,o=!0;n.subscribe(sn(r,s=>{let a=e(s);(o||!t(i,a))&&(o=!1,i=a,r.next(s))}))})}function bCe(t,e){return t===e}function DR(t=TCe){return hn((e,n)=>{let r=!1;e.subscribe(sn(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function TCe(){return new sd}function sF(...t){return e=>Wc(e,Wt(...t))}function ad(t){return hn((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function jc(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Gi((i,o)=>t(i,o,r)):Io,_s(1),n?Ih(e):DR(()=>new sd))}function R0(t){return t<=0?()=>Yo:hn((e,n)=>{let r=[];e.subscribe(sn(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function aF(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Gi((i,o)=>t(i,o,r)):Io,R0(1),n?Ih(e):DR(()=>new sd))}function lF(t,e){return hn(LG(t,e,arguments.length>=2,!0))}function IR(t={}){let{connector:e=()=>new Ur,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return o=>{let s,a,l,c=0,u=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),s=l=void 0,u=d=!1},p=()=>{let g=s;f(),g?.unsubscribe()};return hn((g,w)=>{c++,!d&&!u&&h();let _=l=l??e();w.add(()=>{c--,c===0&&!d&&!u&&(a=cF(p,i))}),_.subscribe(w),!s&&c>0&&(s=new od({next:S=>_.next(S),error:S=>{d=!0,h(),a=cF(f,n,S),_.error(S)},complete:()=>{u=!0,h(),a=cF(f,r),_.complete()}}),jn(g).subscribe(s))})(o)}}function cF(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new od({next:()=>{r.unsubscribe(),t()}});return jn(e(...n)).subscribe(r)}function uF(t){return Gi((e,n)=>t<=n)}function E_(...t){let e=Uc(t);return hn((n,r)=>{(e?Wc(t,n,e):Wc(t,n)).subscribe(r)})}function qo(t,e){return hn((n,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();n.subscribe(sn(r,l=>{i?.unsubscribe();let c=0,u=o++;jn(t(l,u)).subscribe(i=sn(r,d=>r.next(e?e(l,d,u,c++):d),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Ya(t){return hn((e,n)=>{jn(t).subscribe(sn(n,()=>n.complete(),id)),!n.closed&&e.subscribe(n)})}function kr(t,e,n){let r=Gt(t)||e||n?{next:t,error:e,complete:n}:t;return r?hn((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(sn(o,l=>{var c;(c=r.next)===null||c===void 0||c.call(r,l),o.next(l)},()=>{var l;a=!1,(l=r.complete)===null||l===void 0||l.call(r),o.complete()},l=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,l),o.error(l)},()=>{var l,c;a&&((l=r.unsubscribe)===null||l===void 0||l.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):Io}function dF(...t){let e=E0(t);return hn((n,r)=>{let i=t.length,o=new Array(i),s=t.map(()=>!1),a=!1;for(let l=0;l<i;l++)jn(t[l]).subscribe(sn(r,c=>{o[l]=c,!a&&!s[l]&&(s[l]=!0,(a=s.every(Io))&&(s=null))},id));n.subscribe(sn(r,l=>{if(a){let c=[l,...o];r.next(e?e(...c):c)}}))})}function Rr(t){for(let e in t)if(t[e]===Rr)return e;throw Error("Could not find renamed property on target object.")}function AR(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Ko(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Ko).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function AF(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var RCe=Rr({__forward_ref__:Rr});function Zo(t){return t.__forward_ref__=Zo,t.toString=function(){return Ko(this())},t}function Cs(t){return xz(t)?t():t}function xz(t){return typeof t=="function"&&t.hasOwnProperty(RCe)&&t.__forward_ref__===Zo}function bz(t){return t&&!!t.\u0275providers}var Tz="https://g.co/ng/security#xss",Je=class extends Error{constructor(e,n){super(uD(e,n)),this.code=e}};function uD(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}var DCe=Rr({\u0275cmp:Rr}),ICe=Rr({\u0275dir:Rr}),ACe=Rr({\u0275pipe:Rr}),MCe=Rr({\u0275mod:Rr}),jR=Rr({\u0275fac:Rr}),x_=Rr({__NG_ELEMENT_ID__:Rr}),VG=Rr({__NG_ENV_ID__:Rr});function zc(t){return typeof t=="string"?t:t==null?"":String(t)}function OCe(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():zc(t)}function NCe(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new Je(-200,`Circular dependency in DI detected for ${t}${n}`)}function N2(t,e){let n=e?` in ${e}`:"";throw new Je(-201,!1)}function PCe(t,e,n){t!=e&&Rz(n,t,e,"==")}function kCe(t,e){t==null&&Rz(e,t,null,"!=")}function Rz(t,e,n,r){throw new Error(`ASSERTION ERROR: ${t}`+(r==null?"":` [Expected=> ${n} ${r} ${e} <=Actual]`))}function ht(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function oo(t){return{providers:t.providers||[],imports:t.imports||[]}}function dD(t){return BG(t,Iz)||BG(t,Az)}function Dz(t){return dD(t)!==null}function BG(t,e){return t.hasOwnProperty(e)?t[e]:null}function FCe(t){let e=t&&(t[Iz]||t[Az]);return e||null}function UG(t){return t&&(t.hasOwnProperty(WG)||t.hasOwnProperty(LCe))?t[WG]:null}var Iz=Rr({\u0275prov:Rr}),WG=Rr({\u0275inj:Rr}),Az=Rr({ngInjectableDef:Rr}),LCe=Rr({ngInjectorDef:Rr}),On=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(On||{}),MF;function Mz(){return MF}function Zs(t){let e=MF;return MF=t,e}function Oz(t,e,n){let r=dD(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&On.Optional)return null;if(e!==void 0)return e;N2(Ko(t),"Injector")}var va=globalThis;var Ut=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=ht({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var HCe={},D_=HCe,OF="__NG_DI_FLAG__",$R="ngTempTokenPath",VCe="ngTokenPath",BCe=/\n/gm,UCe="\u0275",jG="__source",M0;function WCe(){return M0}function Ah(t){let e=M0;return M0=t,e}function jCe(t,e=On.Default){if(M0===void 0)throw new Je(-203,!1);return M0===null?Oz(t,void 0,e):M0.get(t,e&On.Optional?null:void 0,e)}function kt(t,e=On.Default){return(Mz()||jCe)(Cs(t),e)}function qe(t,e=On.Default){return kt(t,hD(e))}function hD(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function NF(t){let e=[];for(let n=0;n<t.length;n++){let r=Cs(t[n]);if(Array.isArray(r)){if(r.length===0)throw new Je(900,!1);let i,o=On.Default;for(let s=0;s<r.length;s++){let a=r[s],l=$Ce(a);typeof l=="number"?l===-1?i=a.token:o|=l:i=a}e.push(kt(i,o))}else e.push(kt(r))}return e}function Nz(t,e){return t[OF]=e,t.prototype[OF]=e,t}function $Ce(t){return t[OF]}function GCe(t,e,n,r){let i=t[$R];throw e[jG]&&i.unshift(e[jG]),t.message=zCe(`
`+t.message,i,n,r),t[VCe]=i,t[$R]=null,t}function zCe(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==UCe?t.slice(2):t;let i=Ko(e);if(Array.isArray(e))i=e.map(Ko).join(" -> ");else if(typeof e=="object"){let o=[];for(let s in e)if(e.hasOwnProperty(s)){let a=e[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):Ko(a)))}i=`{${o.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(BCe,`
  `)}`}function W_(t){return{toString:t}.toString()}var Pz=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Pz||{}),qc=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(qc||{}),N0={},Ss=[];function kz(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let o=e.length;if(i+o===r||t.charCodeAt(i+o)<=32)return i}n=i+1}}function PF(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let o=n[r++],s=n[r++],a=n[r++];t.setAttribute(e,s,a,o)}else{let o=i,s=n[++r];YCe(o)?t.setProperty(e,o,s):t.setAttribute(e,o,s),r++}}return r}function Fz(t){return t===3||t===4||t===6}function YCe(t){return t.charCodeAt(0)===64}function I_(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?$G(t,n,i,null,e[++r]):$G(t,n,i,null,null))}}return t}function $G(t,e,n,r,i){let o=0,s=t.length;if(e===-1)s=-1;else for(;o<t.length;){let a=t[o++];if(typeof a=="number"){if(a===e){s=-1;break}else if(a>e){s=o-1;break}}}for(;o<t.length;){let a=t[o];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[o+1]=i);return}else if(r===t[o+1]){t[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(t.splice(s,0,e),o=s+1),t.splice(o++,0,n),r!==null&&t.splice(o++,0,r),i!==null&&t.splice(o++,0,i)}var Lz="ng-template";function qCe(t,e,n){let r=0,i=!0;for(;r<t.length;){let o=t[r++];if(typeof o=="string"&&i){let s=t[r++];if(n&&o==="class"&&kz(s.toLowerCase(),e,0)!==-1)return!0}else if(o===1){for(;r<t.length&&typeof(o=t[r++])=="string";)if(o.toLowerCase()===e)return!0;return!1}else typeof o=="number"&&(i=!1)}return!1}function Hz(t){return t.type===4&&t.value!==Lz}function KCe(t,e,n){let r=t.type===4&&!n?Lz:t.value;return e===r}function XCe(t,e,n){let r=4,i=t.attrs||[],o=JCe(i),s=!1;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="number"){if(!s&&!$l(r)&&!$l(l))return!1;if(s&&$l(l))continue;s=!1,r=l|r&1;continue}if(!s)if(r&4){if(r=2|r&1,l!==""&&!KCe(t,l,n)||l===""&&e.length===1){if($l(r))return!1;s=!0}}else{let c=r&8?l:e[++a];if(r&8&&t.attrs!==null){if(!qCe(t.attrs,c,n)){if($l(r))return!1;s=!0}continue}let u=r&8?"class":l,d=ZCe(u,i,Hz(t),n);if(d===-1){if($l(r))return!1;s=!0;continue}if(c!==""){let h;d>o?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&kz(f,c,0)!==-1||r&2&&c!==h){if($l(r))return!1;s=!0}}}}return $l(r)||s}function $l(t){return(t&1)===0}function ZCe(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let o=!1;for(;i<e.length;){let s=e[i];if(s===t)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return e1e(e,t)}function Vz(t,e,n=!1){for(let r=0;r<e.length;r++)if(XCe(t,e[r],n))return!0;return!1}function QCe(t){let e=t.attrs;if(e!=null){let n=e.indexOf(5);if(!(n&1))return e[n+1]}return null}function JCe(t){for(let e=0;e<t.length;e++){let n=t[e];if(Fz(n))return e}return t.length}function e1e(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function t1e(t,e){e:for(let n=0;n<e.length;n++){let r=e[n];if(t.length===r.length){for(let i=0;i<t.length;i++)if(t[i]!==r[i])continue e;return!0}}return!1}function GG(t,e){return t?":not("+e.trim()+")":e}function n1e(t){let e=t[0],n=1,r=2,i="",o=!1;for(;n<t.length;){let s=t[n];if(typeof s=="string")if(r&2){let a=t[++n];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!$l(s)&&(e+=GG(o,i),i=""),r=s,o=o||!$l(r);n++}return i!==""&&(e+=GG(o,i)),e}function r1e(t){return t.map(n1e).join(",")}function i1e(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let o=t[r];if(typeof o=="string")i===2?o!==""&&e.push(o,t[++r]):i===8&&n.push(o);else{if(!$l(i))break;i=o}r++}return{attrs:e,classes:n}}function jt(t){return W_(()=>{let e=$z(t),n=ft(Ee({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Pz.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||qc.Emulated,styles:t.styles||Ss,_:null,schemas:t.schemas||null,tView:null,id:""});Gz(n);let r=t.dependencies;return n.directiveDefs=YG(r,!1),n.pipeDefs=YG(r,!0),n.id=a1e(n),n})}function o1e(t){return km(t)||Bz(t)}function s1e(t){return t!==null}function so(t){return W_(()=>({type:t.type,bootstrap:t.bootstrap||Ss,declarations:t.declarations||Ss,imports:t.imports||Ss,exports:t.exports||Ss,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function zG(t,e){if(t==null)return N0;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],o=i;Array.isArray(i)&&(o=i[1],i=i[0]),n[i]=r,e&&(e[i]=o)}return n}function kn(t){return W_(()=>{let e=$z(t);return Gz(e),e})}function j_(t){return{type:t.type,name:t.name,factory:null,pure:t.pure!==!1,standalone:t.standalone===!0,onDestroy:t.type.prototype.ngOnDestroy||null}}function km(t){return t[DCe]||null}function Bz(t){return t[ICe]||null}function Uz(t){return t[ACe]||null}function Wz(t){let e=km(t)||Bz(t)||Uz(t);return e!==null?e.standalone:!1}function jz(t,e){let n=t[MCe]||null;if(!n&&e===!0)throw new Error(`Type ${Ko(t)} does not have '\u0275mod' property.`);return n}function $z(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||N0,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Ss,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:zG(t.inputs,e),outputs:zG(t.outputs),debugInfo:null}}function Gz(t){t.features?.forEach(e=>e(t))}function YG(t,e){if(!t)return null;let n=e?Uz:o1e;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(s1e)}function a1e(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483647+1,"c"+e}var dd=0,an=1,tn=2,Ai=3,zl=4,Qs=5,A_=6,M_=7,Ao=8,P0=9,k0=10,ar=11,O_=12,qG=13,B0=14,wa=15,$_=16,D0=17,Yc=18,fD=19,zz=20,Mh=21,hF=22,Fm=23,zi=25,Yz=1;var Lm=7,GR=8,F0=9,Xo=10,L0=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t[t.HasChildViewsToRefresh=4]="HasChildViewsToRefresh",t}(L0||{});function Oh(t){return Array.isArray(t)&&typeof t[Yz]=="object"}function Yl(t){return Array.isArray(t)&&t[Yz]===!0}function P2(t){return(t.flags&4)!==0}function mD(t){return t.componentOffset>-1}function pD(t){return(t.flags&1)===1}function Nh(t){return!!t.template}function l1e(t){return(t[tn]&512)!==0}function Hm(t,e){let n=t.hasOwnProperty(jR);return n?t[jR]:null}var kF=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function Yi(){return qz}function qz(t){return t.type.prototype.ngOnChanges&&(t.setInput=u1e),c1e}Yi.ngInherit=!0;function c1e(){let t=Xz(this),e=t?.current;if(e){let n=t.previous;if(n===N0)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function u1e(t,e,n,r){let i=this.declaredInputs[n],o=Xz(t)||d1e(t,{previous:N0,current:null}),s=o.current||(o.current={}),a=o.previous,l=a[i];s[i]=new kF(l&&l.currentValue,e,a===N0),t[r]=e}var Kz="__ngSimpleChanges__";function Xz(t){return t[Kz]||null}function d1e(t,e){return t[Kz]=e}var KG=null;var $c=function(t,e,n){KG?.(t,e,n)},h1e="svg",f1e="math";function qa(t){for(;Array.isArray(t);)t=t[dd];return t}function gD(t,e){return qa(e[t])}function Xa(t,e){return qa(e[t.index])}function k2(t,e){return t.data[e]}function Zz(t,e){return t[e]}function kh(t,e){let n=e[t];return Oh(n)?n:n[dd]}function m1e(t){return(t[tn]&4)===4}function F2(t){return(t[tn]&128)===128}function p1e(t){return Yl(t[Ai])}function Vm(t,e){return e==null?null:t[e]}function Qz(t){t[D0]=0}function g1e(t){t[tn]&1024||(t[tn]|=1024,F2(t)&&vD(t))}function v1e(t,e){for(;t>0;)e=e[B0],t--;return e}function Jz(t){return t[tn]&9216||t[Fm]?.dirty}function e9(t){Jz(t)&&vD(t)}function vD(t){let e=t[Ai];for(;e!==null&&!(Yl(e)&&e[tn]&L0.HasChildViewsToRefresh||Oh(e)&&e[tn]&8192);){if(Yl(e))e[tn]|=L0.HasChildViewsToRefresh;else if(e[tn]|=8192,!F2(e))break;e=e[Ai]}}function t9(t,e){if((t[tn]&256)===256)throw new Je(911,!1);t[Mh]===null&&(t[Mh]=[]),t[Mh].push(e)}function w1e(t,e){if(t[Mh]===null)return;let n=t[Mh].indexOf(e);n!==-1&&t[Mh].splice(n,1)}var wn={lFrame:c9(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function y1e(){return wn.lFrame.elementDepthCount}function _1e(){wn.lFrame.elementDepthCount++}function C1e(){wn.lFrame.elementDepthCount--}function n9(){return wn.bindingsEnabled}function r9(){return wn.skipHydrationRootTNode!==null}function S1e(t){return wn.skipHydrationRootTNode===t}function E1e(){wn.skipHydrationRootTNode=null}function nn(){return wn.lFrame.lView}function Wr(){return wn.lFrame.tView}function mt(t){return wn.lFrame.contextLView=t,t[Ao]}function pt(t){return wn.lFrame.contextLView=null,t}function xs(){let t=i9();for(;t!==null&&t.type===64;)t=t.parent;return t}function i9(){return wn.lFrame.currentTNode}function N_(){let t=wn.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Kc(t,e){let n=wn.lFrame;n.currentTNode=t,n.isParent=e}function L2(){return wn.lFrame.isParent}function H2(){wn.lFrame.isParent=!1}function x1e(){return wn.lFrame.contextLView}function V2(){let t=wn.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function B2(){return wn.lFrame.bindingIndex}function b1e(t){return wn.lFrame.bindingIndex=t}function qm(){return wn.lFrame.bindingIndex++}function wD(t){let e=wn.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function T1e(){return wn.lFrame.inI18n}function o9(t){wn.lFrame.inI18n=t}function R1e(t,e){let n=wn.lFrame;n.bindingIndex=n.bindingRootIndex=t,FF(e)}function D1e(){return wn.lFrame.currentDirectiveIndex}function FF(t){wn.lFrame.currentDirectiveIndex=t}function I1e(t){let e=wn.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function s9(){return wn.lFrame.currentQueryIndex}function U2(t){wn.lFrame.currentQueryIndex=t}function A1e(t){let e=t[an];return e.type===2?e.declTNode:e.type===1?t[Qs]:null}function a9(t,e,n){if(n&On.SkipSelf){let i=e,o=t;for(;i=i.parent,i===null&&!(n&On.Host);)if(i=A1e(o),i===null||(o=o[B0],i.type&10))break;if(i===null)return!1;e=i,t=o}let r=wn.lFrame=l9();return r.currentTNode=e,r.lView=t,!0}function W2(t){let e=l9(),n=t[an];wn.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function l9(){let t=wn.lFrame,e=t===null?null:t.child;return e===null?c9(t):e}function c9(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function u9(){let t=wn.lFrame;return wn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var d9=u9;function j2(){let t=u9();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function M1e(t){return(wn.lFrame.contextLView=v1e(t,wn.lFrame.contextLView))[Ao]}function Zc(){return wn.lFrame.selectedIndex}function Bm(t){wn.lFrame.selectedIndex=t}function G_(){let t=wn.lFrame;return k2(t.tView,t.selectedIndex)}function O1e(){return wn.lFrame.currentNamespace}var h9=!0;function yD(){return h9}function _D(t){h9=t}function N1e(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=e.type.prototype;if(r){let s=qz(e);(n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s)}i&&(n.preOrderHooks??=[]).push(0-t,i),o&&((n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o))}function CD(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let o=t.data[n].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:c,ngOnDestroy:u}=o;s&&(t.contentHooks??=[]).push(-n,s),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),l&&(t.viewHooks??=[]).push(-n,l),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),u!=null&&(t.destroyHooks??=[]).push(n,u)}}function FR(t,e,n){f9(t,e,3,n)}function LR(t,e,n,r){(t[tn]&3)===n&&f9(t,e,n,r)}function fF(t,e){let n=t[tn];(n&3)===e&&(n&=16383,n+=1,t[tn]=n)}function f9(t,e,n,r){let i=r!==void 0?t[D0]&65535:0,o=r??-1,s=e.length-1,a=0;for(let l=i;l<s;l++)if(typeof e[l+1]=="number"){if(a=e[l],r!=null&&a>=r)break}else e[l]<0&&(t[D0]+=65536),(a<o||o==-1)&&(P1e(t,n,e,l),t[D0]=(t[D0]&4294901760)+l+2),l++}function XG(t,e){$c(4,t,e);let n=Do(null);try{e.call(t)}finally{Do(n),$c(5,t,e)}}function P1e(t,e,n,r){let i=n[r]<0,o=n[r+1],s=i?-n[r]:n[r],a=t[s];i?t[tn]>>14<t[D0]>>16&&(t[tn]&3)===e&&(t[tn]+=16384,XG(a,o)):XG(a,o)}var O0=-1,Um=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function k1e(t){return t instanceof Um}function F1e(t){return(t.flags&8)!==0}function L1e(t){return(t.flags&16)!==0}function m9(t){return t!==O0}function zR(t){let e=t&32767;return t&32767}function H1e(t){return t>>16}function YR(t,e){let n=H1e(t),r=e;for(;n>0;)r=r[B0],n--;return r}var LF=!0;function qR(t){let e=LF;return LF=t,e}var V1e=256,p9=V1e-1,g9=5,B1e=0,Gc={};function U1e(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(x_)&&(r=n[x_]),r==null&&(r=n[x_]=B1e++);let i=r&p9,o=1<<i;e.data[t+(i>>g9)]|=o}function KR(t,e){let n=v9(t,e);if(n!==-1)return n;let r=e[an];r.firstCreatePass&&(t.injectorIndex=e.length,mF(r.data,t),mF(e,null),mF(r.blueprint,null));let i=$2(t,e),o=t.injectorIndex;if(m9(i)){let s=zR(i),a=YR(i,e),l=a[an].data;for(let c=0;c<8;c++)e[o+c]=a[s+c]|l[s+c]}return e[o+8]=i,o}function mF(t,e){t.push(0,0,0,0,0,0,0,0,e)}function v9(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function $2(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=S9(i),r===null)return O0;if(n++,i=i[B0],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return O0}function HF(t,e,n){U1e(t,e,n)}function W1e(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let o=n[i];if(Fz(o))break;if(o===0)i=i+2;else if(typeof o=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(o===e)return n[i+1];i=i+2}}}return null}function w9(t,e,n){if(n&On.Optional||t!==void 0)return t;N2(e,"NodeInjector")}function y9(t,e,n,r){if(n&On.Optional&&r===void 0&&(r=null),!(n&(On.Self|On.Host))){let i=t[P0],o=Zs(void 0);try{return i?i.get(e,r,n&On.Optional):Oz(e,r,n&On.Optional)}finally{Zs(o)}}return w9(r,e,n)}function _9(t,e,n,r=On.Default,i){if(t!==null){if(e[tn]&2048&&!(r&On.Self)){let s=z1e(t,e,n,r,Gc);if(s!==Gc)return s}let o=C9(t,e,n,r,Gc);if(o!==Gc)return o}return y9(e,n,r,i)}function C9(t,e,n,r,i){let o=$1e(n);if(typeof o=="function"){if(!a9(e,t,r))return r&On.Host?w9(i,n,r):y9(e,n,r,i);try{let s;if(s=o(r),s==null&&!(r&On.Optional))N2(n);else return s}finally{d9()}}else if(typeof o=="number"){let s=null,a=v9(t,e),l=O0,c=r&On.Host?e[wa][Qs]:null;for((a===-1||r&On.SkipSelf)&&(l=a===-1?$2(t,e):e[a+8],l===O0||!QG(r,!1)?a=-1:(s=e[an],a=zR(l),e=YR(l,e)));a!==-1;){let u=e[an];if(ZG(o,a,u.data)){let d=j1e(a,e,n,s,r,c);if(d!==Gc)return d}l=e[a+8],l!==O0&&QG(r,e[an].data[a+8]===c)&&ZG(o,a,e)?(s=u,a=zR(l),e=YR(l,e)):a=-1}}return i}function j1e(t,e,n,r,i,o){let s=e[an],a=s.data[t+8],l=r==null?mD(a)&&LF:r!=s&&(a.type&3)!==0,c=i&On.Host&&o===a,u=HR(a,s,n,l,c);return u!==null?Wm(e,s,u,a):Gc}function HR(t,e,n,r,i){let o=t.providerIndexes,s=e.data,a=o&1048575,l=t.directiveStart,c=t.directiveEnd,u=o>>20,d=r?a:a+u,h=i?a+u:c;for(let f=d;f<h;f++){let p=s[f];if(f<l&&n===p||f>=l&&p.type===n)return f}if(i){let f=s[l];if(f&&Nh(f)&&f.type===n)return l}return null}function Wm(t,e,n,r){let i=t[n],o=e.data;if(k1e(i)){let s=i;s.resolving&&NCe(OCe(o[n]));let a=qR(s.canSeeViewProviders);s.resolving=!0;let l,c=s.injectImpl?Zs(s.injectImpl):null,u=a9(t,r,On.Default);try{i=t[n]=s.factory(void 0,o,t,r),e.firstCreatePass&&n>=r.directiveStart&&N1e(n,o[n],e)}finally{c!==null&&Zs(c),qR(a),s.resolving=!1,d9()}}return i}function $1e(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(x_)?t[x_]:void 0;return typeof e=="number"?e>=0?e&p9:G1e:e}function ZG(t,e,n){let r=1<<t;return!!(n[e+(t>>g9)]&r)}function QG(t,e){return!(t&On.Self)&&!(t&On.Host&&e)}var Pm=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return _9(this._tNode,this._lView,e,hD(r),n)}};function G1e(){return new Pm(xs(),nn())}function bs(t){return W_(()=>{let e=t.prototype.constructor,n=e[jR]||VF(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let o=i[jR]||VF(i);if(o&&o!==n)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function VF(t){return xz(t)?()=>{let e=VF(Cs(t));return e&&e()}:Hm(t)}function z1e(t,e,n,r,i){let o=t,s=e;for(;o!==null&&s!==null&&s[tn]&2048&&!(s[tn]&512);){let a=C9(o,s,n,r|On.Self,Gc);if(a!==Gc)return a;let l=o.parent;if(!l){let c=s[zz];if(c){let u=c.get(n,Gc,r);if(u!==Gc)return u}l=S9(s),s=s[B0]}o=l}return i}function S9(t){let e=t[an],n=e.type;return n===2?e.declTNode:n===1?t[Qs]:null}function Km(t){return W1e(xs(),t)}var MR="__parameters__";function Y1e(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function E9(t,e,n){return W_(()=>{let r=Y1e(e);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(l,c,u){let d=l.hasOwnProperty(MR)?l[MR]:Object.defineProperty(l,MR,{value:[]})[MR];for(;d.length<=u;)d.push(null);return(d[u]=d[u]||[]).push(s),l}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function q1e(t){return typeof t=="function"}function K1e(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],o=e[r];if(n&&(i=n(i),o=n(o)),o!==i)return!1}return!0}function X1e(t){return t.flat(Number.POSITIVE_INFINITY)}function G2(t,e){t.forEach(n=>Array.isArray(n)?G2(n,e):e(n))}function x9(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function XR(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function b9(t,e){let n=[];for(let r=0;r<t;r++)n.push(e);return n}function Z1e(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let o=i-2;t[i]=t[o],i--}t[e]=n,t[e+1]=r}}function z2(t,e,n){let r=z_(t,e);return r>=0?t[r|1]=n:(r=~r,Z1e(t,r,e,n)),r}function pF(t,e){let n=z_(t,e);if(n>=0)return t[n|1]}function z_(t,e){return Q1e(t,e,1)}function Q1e(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let o=r+(i-r>>1),s=t[o<<n];if(e===s)return o<<n;s>e?i=o:r=o+1}return~(i<<n)}var SD=Nz(E9("Optional"),8);var Y2=Nz(E9("SkipSelf"),4);var Y_=new Ut("ENVIRONMENT_INITIALIZER"),T9=new Ut("INJECTOR",-1),R9=new Ut("INJECTOR_DEF_TYPES"),ZR=class{get(e,n=D_){if(n===D_){let r=new Error(`NullInjectorError: No provider for ${Ko(e)}!`);throw r.name="NullInjectorError",r}return n}};function U0(t){return{\u0275providers:t}}function J1e(...t){return{\u0275providers:D9(!0,t),\u0275fromNgModule:!0}}function D9(t,...e){let n=[],r=new Set,i,o=s=>{n.push(s)};return G2(e,s=>{let a=s;BF(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&I9(i,o),n}function I9(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];q2(i,o=>{e(o,r)})}}function BF(t,e,n,r){if(t=Cs(t),!t)return!1;let i=null,o=UG(t),s=!o&&km(t);if(!o&&!s){let l=t.ngModule;if(o=UG(l),o)i=l;else return!1}else{if(s&&!s.standalone)return!1;i=t}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let l=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let c of l)BF(c,e,n,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let c;try{G2(o.imports,u=>{BF(u,e,n,r)&&(c||=[],c.push(u))})}finally{}c!==void 0&&I9(c,e)}if(!a){let c=Hm(i)||(()=>new i);e({provide:i,useFactory:c,deps:Ss},i),e({provide:R9,useValue:i,multi:!0},i),e({provide:Y_,useValue:()=>kt(i),multi:!0},i)}let l=o.providers;if(l!=null&&!a){let c=t;q2(l,u=>{e(u,c)})}}else return!1;return i!==t&&t.providers!==void 0}function q2(t,e){for(let n of t)bz(n)&&(n=n.\u0275providers),Array.isArray(n)?q2(n,e):e(n)}var eSe=Rr({provide:String,useValue:Rr});function A9(t){return t!==null&&typeof t=="object"&&eSe in t}function tSe(t){return!!(t&&t.useExisting)}function nSe(t){return!!(t&&t.useFactory)}function H0(t){return typeof t=="function"}function rSe(t){return!!t.useClass}var ED=new Ut("Set Injector scope."),VR={},iSe={},gF;function K2(){return gF===void 0&&(gF=new ZR),gF}var Es=class{},P_=class extends Es{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,WF(e,s=>this.processProvider(s)),this.records.set(T9,I0(void 0,this)),i.has("environment")&&this.records.set(Es,I0(void 0,this));let o=this.records.get(ED);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(R9,Ss,On.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Ah(this),r=Zs(void 0),i;try{return e()}finally{Ah(n),Zs(r)}}get(e,n=D_,r=On.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(VG))return e[VG](this);r=hD(r);let i,o=Ah(this),s=Zs(void 0);try{if(!(r&On.SkipSelf)){let l=this.records.get(e);if(l===void 0){let c=cSe(e)&&dD(e);c&&this.injectableDefInScope(c)?l=I0(UF(e),VR):l=null,this.records.set(e,l)}if(l!=null)return this.hydrate(e,l)}let a=r&On.Self?K2():this.parent;return n=r&On.Optional&&n===D_?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[$R]=a[$R]||[]).unshift(Ko(e)),o)throw a;return GCe(a,e,"R3InjectorError",this.source)}else throw a}finally{Zs(s),Ah(o)}}resolveInjectorInitializers(){let e=Ah(this),n=Zs(void 0),r;try{let i=this.get(Y_,Ss,On.Self);for(let o of i)o()}finally{Ah(e),Zs(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Ko(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Je(205,!1)}processProvider(e){e=Cs(e);let n=H0(e)?e:Cs(e&&e.provide),r=sSe(e);if(!H0(e)&&e.multi===!0){let i=this.records.get(n);i||(i=I0(void 0,VR,!0),i.factory=()=>NF(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}else{let i=this.records.get(n)}this.records.set(n,r)}hydrate(e,n){return n.value===VR&&(n.value=iSe,n.value=n.factory()),typeof n.value=="object"&&n.value&&lSe(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Cs(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function UF(t){let e=dD(t),n=e!==null?e.factory:Hm(t);if(n!==null)return n;if(t instanceof Ut)throw new Je(204,!1);if(t instanceof Function)return oSe(t);throw new Je(204,!1)}function oSe(t){let e=t.length;if(e>0){let r=b9(e,"?");throw new Je(204,!1)}let n=FCe(t);return n!==null?()=>n.factory(t):()=>new t}function sSe(t){if(A9(t))return I0(void 0,t.useValue);{let e=M9(t);return I0(e,VR)}}function M9(t,e,n){let r;if(H0(t)){let i=Cs(t);return Hm(i)||UF(i)}else if(A9(t))r=()=>Cs(t.useValue);else if(nSe(t))r=()=>t.useFactory(...NF(t.deps||[]));else if(tSe(t))r=()=>kt(Cs(t.useExisting));else{let i=Cs(t&&(t.useClass||t.provide));if(aSe(t))r=()=>new i(...NF(t.deps));else return Hm(i)||UF(i)}return r}function I0(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function aSe(t){return!!t.deps}function lSe(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function cSe(t){return typeof t=="function"||typeof t=="object"&&t instanceof Ut}function WF(t,e){for(let n of t)Array.isArray(n)?WF(n,e):n&&bz(n)?WF(n.\u0275providers,e):e(n)}function hd(t,e){t instanceof P_&&t.assertNotDestroyed();let n,r=Ah(t),i=Zs(void 0);try{return e()}finally{Ah(r),Zs(i)}}function O9(t){if(!Mz()&&!WCe())throw new Je(-203,!1)}function JG(t,e=null,n=null,r){let i=N9(t,e,n,r);return i.resolveInjectorInitializers(),i}function N9(t,e=null,n=null,r,i=new Set){let o=[n||Ss,J1e(t)];return r=r||(typeof t=="object"?void 0:Ko(t)),new P_(o,e||K2(),r||null,i)}var Qc=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return JG({name:""},i,r,"");{let o=r.name??"";return JG({name:o},r.parent,r.providers,o)}}};e.THROW_IF_NOT_FOUND=D_,e.NULL=new ZR,e.\u0275prov=ht({token:e,providedIn:"any",factory:()=>kt(T9)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var jF;function P9(t){jF=t}function k9(){if(jF!==void 0)return jF;if(typeof document<"u")return document;throw new Je(210,!1)}var X2=new Ut("AppId",{providedIn:"root",factory:()=>uSe}),uSe="ng",Z2=new Ut("Platform Initializer"),ql=new Ut("Platform ID",{providedIn:"platform",factory:()=>"unknown"});var Q2=new Ut("AnimationModuleType"),J2=new Ut("CSP nonce",{providedIn:"root",factory:()=>k9().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function F9(t){return t instanceof Function?t():t}function L9(t){return(t.flags&128)===128}var cd=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(cd||{}),dSe=/^>|^->|<!--|-->|--!>|<!-$/g,hSe=/(<|>)/g,fSe="\u200B$1\u200B";function mSe(t){return t.replace(dSe,e=>e.replace(hSe,fSe))}var H9=new Map,pSe=0;function gSe(){return pSe++}function vSe(t){H9.set(t[fD],t)}function wSe(t){H9.delete(t[fD])}var ez="__ngContext__";function Xc(t,e){Oh(e)?(t[ez]=e[fD],vSe(e)):t[ez]=e}var $F;function eL(t,e){return $F(t,e)}function ySe(t){$F===void 0&&($F=t())}function tL(t){let e=t[Ai];return Yl(e)?e[Ai]:e}function V9(t){return U9(t[O_])}function B9(t){return U9(t[zl])}function U9(t){for(;t!==null&&!Yl(t);)t=t[zl];return t}function A0(t,e,n,r,i){if(r!=null){let o,s=!1;Yl(r)?o=r:Oh(r)&&(s=!0,r=r[dd]);let a=qa(r);t===0&&n!==null?i==null?Y9(e,n,a):jm(e,n,a,i||null,!0):t===1&&n!==null?jm(e,n,a,i||null,!0):t===2?J9(e,a,s):t===3&&e.destroyNode(a),o!=null&&MSe(e,t,o,n,i)}}function nL(t,e){return t.createText(e)}function W9(t,e,n){t.setValue(e,n)}function j9(t,e){return t.createComment(mSe(e))}function rL(t,e,n){return t.createElement(e,n)}function _Se(t,e){let n=e[ar];q_(t,e,n,2,null,null),e[dd]=null,e[Qs]=null}function CSe(t,e,n,r,i,o){r[dd]=i,r[Qs]=e,q_(t,r,n,1,i,o)}function SSe(t,e){q_(t,e,e[ar],2,null,null)}function ESe(t){let e=t[O_];if(!e)return vF(t[an],t);for(;e;){let n=null;if(Oh(e))n=e[O_];else{let r=e[Xo];r&&(n=r)}if(!n){for(;e&&!e[zl]&&e!==t;)Oh(e)&&vF(e[an],e),e=e[Ai];e===null&&(e=t),Oh(e)&&vF(e[an],e),n=e&&e[zl]}e=n}}function xSe(t,e,n,r){let i=Xo+r,o=n.length;r>0&&(n[i-1][zl]=e),r<o-Xo?(e[zl]=n[i],x9(n,Xo+r,e)):(n.push(e),e[zl]=null),e[Ai]=n;let s=e[$_];s!==null&&n!==s&&bSe(s,e);let a=e[Yc];a!==null&&a.insertView(t),e9(e),e[tn]|=128}function bSe(t,e){let n=t[F0],i=e[Ai][Ai][wa];e[wa]!==i&&(t[tn]|=L0.HasTransplantedViews),n===null?t[F0]=[e]:n.push(e)}function $9(t,e){let n=t[F0],r=n.indexOf(e),i=e[Ai];n.splice(r,1)}function k_(t,e){if(t.length<=Xo)return;let n=Xo+e,r=t[n];if(r){let i=r[$_];i!==null&&i!==t&&$9(i,r),e>0&&(t[n-1][zl]=r[zl]);let o=XR(t,Xo+e);_Se(r[an],r);let s=o[Yc];s!==null&&s.detachView(o[an]),r[Ai]=null,r[zl]=null,r[tn]&=-129}return r}function xD(t,e){if(!(e[tn]&256)){let n=e[ar];e[Fm]&&cG(e[Fm]),n.destroyNode&&q_(t,e,n,3,null,null),ESe(e)}}function vF(t,e){if(!(e[tn]&256)){e[tn]&=-129,e[tn]|=256,RSe(t,e),TSe(t,e),e[an].type===1&&e[ar].destroy();let n=e[$_];if(n!==null&&Yl(e[Ai])){n!==e[Ai]&&$9(n,e);let r=e[Yc];r!==null&&r.detachView(t)}wSe(e)}}function TSe(t,e){let n=t.cleanup,r=e[M_];if(n!==null)for(let o=0;o<n.length-1;o+=2)if(typeof n[o]=="string"){let s=n[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[n[o+1]];n[o].call(s)}r!==null&&(e[M_]=null);let i=e[Mh];if(i!==null){e[Mh]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function RSe(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Um)){let o=n[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],l=o[s+1];$c(4,a,l);try{l.call(a)}finally{$c(5,a,l)}}else{$c(4,i,o);try{o.call(i)}finally{$c(5,i,o)}}}}}function G9(t,e,n){return z9(t,e.parent,n)}function z9(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[dd];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=t.data[r.directiveStart+i];if(o===qc.None||o===qc.Emulated)return null}return Xa(r,n)}}function jm(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Y9(t,e,n){t.appendChild(e,n)}function tz(t,e,n,r,i){r!==null?jm(t,e,n,r,i):Y9(t,e,n)}function DSe(t,e,n,r){t.removeChild(e,n,r)}function bD(t,e){return t.parentNode(e)}function ISe(t,e){return t.nextSibling(e)}function q9(t,e,n){return X9(t,e,n)}function K9(t,e,n){return t.type&40?Xa(t,n):null}var X9=K9,GF;function Z9(t,e){X9=t,GF=e}function TD(t,e,n,r){let i=G9(t,r,e),o=e[ar],s=r.parent||e[Qs],a=q9(s,r,e);if(i!=null)if(Array.isArray(n))for(let l=0;l<n.length;l++)tz(o,i,n[l],a,!1);else tz(o,i,n,a,!1);GF!==void 0&&GF(o,r,e,n,i)}function BR(t,e){if(e!==null){let n=e.type;if(n&3)return Xa(e,t);if(n&4)return zF(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return BR(t,r);{let i=t[e.index];return Yl(i)?zF(-1,i):qa(i)}}else{if(n&32)return eL(e,t)()||qa(t[e.index]);{let r=Q9(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=tL(t[wa]);return BR(i,r)}else return BR(t,e.next)}}}return null}function Q9(t,e){if(e!==null){let r=t[wa][Qs],i=e.projection;return r.projection[i]}return null}function zF(t,e){let n=Xo+t+1;if(n<e.length){let r=e[n],i=r[an].firstChild;if(i!==null)return BR(r,i)}return e[Lm]}function J9(t,e,n){let r=bD(t,e);r&&DSe(t,r,e,n)}function iL(t,e,n,r,i,o,s){for(;n!=null;){let a=r[n.index],l=n.type;if(s&&e===0&&(a&&Xc(qa(a),r),n.flags|=2),(n.flags&32)!==32)if(l&8)iL(t,e,n.child,r,i,o,!1),A0(e,t,i,a,o);else if(l&32){let c=eL(n,r),u;for(;u=c();)A0(e,t,i,u,o);A0(e,t,i,a,o)}else l&16?e7(t,e,r,n,i,o):A0(e,t,i,a,o);n=s?n.projectionNext:n.next}}function q_(t,e,n,r,i,o){iL(n,r,t.firstChild,e,i,o,!1)}function ASe(t,e,n){let r=e[ar],i=G9(t,n,e),o=n.parent||e[Qs],s=q9(o,n,e);e7(r,0,e,n,i,s)}function e7(t,e,n,r,i,o){let s=n[wa],l=s[Qs].projection[r.projection];if(Array.isArray(l))for(let c=0;c<l.length;c++){let u=l[c];A0(e,t,i,u,o)}else{let c=l,u=s[Ai];L9(r)&&(c.flags|=128),iL(t,e,c,u,i,o,!0)}}function MSe(t,e,n,r,i){let o=n[Lm],s=qa(n);o!==s&&A0(e,t,r,o,i);for(let a=Xo;a<n.length;a++){let l=n[a];q_(l[an],l,t,e,r,o)}}function OSe(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let o=r.indexOf("-")===-1?void 0:cd.DashCase;i==null?t.removeStyle(n,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=cd.Important),t.setStyle(n,r,i,o))}}function NSe(t,e,n){t.setAttribute(e,"style",n)}function t7(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function n7(t,e,n){let{mergedAttrs:r,classes:i,styles:o}=n;r!==null&&PF(t,e,r),i!==null&&t7(t,e,i),o!==null&&NSe(t,e,o)}var OR;function PSe(){if(OR===void 0&&(OR=null,va.trustedTypes))try{OR=va.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return OR}function oL(t){return PSe()?.createHTML(t)||t}var NR;function kSe(){if(NR===void 0&&(NR=null,va.trustedTypes))try{NR=va.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return NR}function nz(t){return kSe()?.createScriptURL(t)||t}var QR=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Tz})`}};function W0(t){return t instanceof QR?t.changingThisBreaksApplicationSecurity:t}function sL(t,e){let n=FSe(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${Tz})`)}return n===e}function FSe(t){return t instanceof QR&&t.getTypeName()||null}function LSe(t){let e=new qF(t);return HSe()?new YF(e):e}var YF=class{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{let n=new window.DOMParser().parseFromString(oL(e),"text/html").body;return n===null?this.inertDocumentHelper.getInertBodyElement(e):(n.removeChild(n.firstChild),n)}catch{return null}}},qF=class{constructor(e){this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(e){let n=this.inertDocument.createElement("template");return n.innerHTML=oL(e),n}};function HSe(){try{return!!new window.DOMParser().parseFromString(oL(""),"text/html")}catch{return!1}}var VSe=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function aL(t){return t=String(t),t.match(VSe)?t:"unsafe:"+t}function Fh(t){let e={};for(let n of t.split(","))e[n]=!0;return e}function K_(...t){let e={};for(let n of t)for(let r in n)n.hasOwnProperty(r)&&(e[r]=!0);return e}var BSe=Fh("area,br,col,hr,img,wbr"),r7=Fh("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),i7=Fh("rp,rt"),USe=K_(i7,r7),WSe=K_(r7,Fh("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),jSe=K_(i7,Fh("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),$Se=K_(BSe,WSe,jSe,USe),o7=Fh("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),GSe=Fh("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),zSe=Fh("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"),YSe=K_(o7,GSe,zSe);function qSe(t){return"content"in t&&KSe(t)?t.content:null}function KSe(t){return t.nodeType===Node.ELEMENT_NODE&&t.nodeName==="TEMPLATE"}var RD=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(RD||{});function XSe(t){let e=a7();return e?e.sanitize(RD.URL,t)||"":sL(t,"URL")?W0(t):aL(zc(t))}function ZSe(t){let e=a7();if(e)return nz(e.sanitize(RD.RESOURCE_URL,t)||"");if(sL(t,"ResourceURL"))return nz(W0(t));throw new Je(904,!1)}function QSe(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?ZSe:XSe}function s7(t,e,n){return QSe(e,n)(t)}function a7(){let t=nn();return t&&t[k0].sanitizer}var JSe="h",eEe="b";var tEe=(t,e,n)=>null;function lL(t,e,n=!1){return tEe(t,e,n)}var KF=class{},JR=class{};function nEe(t){let e=Error(`No component factory found for ${Ko(t)}.`);return e[rEe]=t,e}var rEe="ngComponent";var XF=class{resolveComponentFactory(e){throw nEe(e)}},DD=(()=>{let e=class e{};e.NULL=new XF;let t=e;return t})();function iEe(){return j0(xs(),nn())}function j0(t,e){return new Mi(Xa(t,e))}var Mi=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=iEe;let t=e;return t})();function oEe(t){return t instanceof Mi?t.nativeElement:t}var $m=class{},fd=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>sEe();let t=e;return t})();function sEe(){let t=nn(),e=xs(),n=kh(e.index,t);return(Oh(n)?n:t)[ar]}var aEe=(()=>{let e=class e{};e.\u0275prov=ht({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Gm=class{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}},lEe=new Gm("17.0.5"),wF={};function l7(t){return cL(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function cEe(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function cL(t){return t!==null&&(typeof t=="function"||typeof t=="object")}var ZF=class{constructor(){}supports(e){return l7(e)}create(e){return new QF(e)}},uEe=(t,e)=>e,QF=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||uEe}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,o=null;for(;n||r;){let s=!r||n&&n.currentIndex<rz(r,i,o)?n:r,a=rz(s,i,o),l=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(n=n._next,s.previousIndex==null)i++;else{o||(o=[]);let c=a-i,u=l-i;if(c!=u){for(let h=0;h<c;h++){let f=h<o.length?o[h]:o[h]=0,p=f+h;u<=p&&p<c&&(o[h]=f+1)}let d=s.previousIndex;o[d]=u-c}}a!==l&&e(s,a,l)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!l7(e))throw new Je(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,o,s;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)o=e[a],s=this._trackByFn(a,o),n===null||!Object.is(n.trackById,s)?(n=this._mismatch(n,o,s,a),r=!0):(r&&(n=this._verifyReinsertion(n,o,s,a)),Object.is(n.item,o)||this._addIdentityChange(n,o)),n=n._next}else i=0,cEe(e,a=>{s=this._trackByFn(i,a),n===null||!Object.is(n.trackById,s)?(n=this._mismatch(n,a,s,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,s,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let o;return e===null?o=this._itTail:(o=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,o,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,o,i)):e=this._addAfter(new JF(n,r),o,i)),e}_verifyReinsertion(e,n,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?e=this._reinsertAfter(o,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,o=e._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new eD),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new eD),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},JF=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},e2=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},eD=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new e2,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function rz(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}var t2=class{constructor(){}supports(e){return e instanceof Map||cL(e)}create(){return new n2}},n2=class{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(e){let n;for(n=this._mapHead;n!==null;n=n._next)e(n)}forEachPreviousItem(e){let n;for(n=this._previousMapHead;n!==null;n=n._nextPrevious)e(n)}forEachChangedItem(e){let n;for(n=this._changesHead;n!==null;n=n._nextChanged)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}diff(e){if(!e)e=new Map;else if(!(e instanceof Map||cL(e)))throw new Je(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(n&&n.key===i)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{let o=this._getOrCreateRecordForKey(i,r);n=this._insertBeforeOrAppend(n,o)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;r!==null;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,n){if(e){let r=e._prev;return n._next=e,n._prev=r,e._prev=n,r&&(r._next=n),e===this._mapHead&&(this._mapHead=n),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(e,n){if(this._records.has(e)){let i=this._records.get(e);this._maybeAddToChanges(i,n);let o=i._prev,s=i._next;return o&&(o._next=s),s&&(s._prev=o),i._next=null,i._prev=null,i}let r=new r2(e);return this._records.set(e,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;e!==null;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;e!=null;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,n){Object.is(n,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=n,this._addToChanges(e))}_addToAdditions(e){this._additionsHead===null?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){this._changesHead===null?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,n){e instanceof Map?e.forEach(n):Object.keys(e).forEach(r=>n(e[r],r))}},r2=class{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}};function iz(){return new uL([new ZF])}var uL=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let o=i.factories.slice();r=r.concat(o)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||iz()),deps:[[e,new Y2,new SD]]}}find(r){let i=this.factories.find(o=>o.supports(r));if(i!=null)return i;throw new Je(901,!1)}};e.\u0275prov=ht({token:e,providedIn:"root",factory:iz});let t=e;return t})();function oz(){return new dL([new t2])}var dL=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i){let o=i.factories.slice();r=r.concat(o)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||oz()),deps:[[e,new Y2,new SD]]}}find(r){let i=this.factories.find(o=>o.supports(r));if(i)return i;throw new Je(901,!1)}};e.\u0275prov=ht({token:e,providedIn:"root",factory:oz});let t=e;return t})();function tD(t,e,n,r,i=!1){for(;n!==null;){let o=e[n.index];o!==null&&r.push(qa(o)),Yl(o)&&dEe(o,r);let s=n.type;if(s&8)tD(t,e,n.child,r);else if(s&32){let a=eL(n,e),l;for(;l=a();)r.push(l)}else if(s&16){let a=Q9(e,n);if(Array.isArray(a))r.push(...a);else{let l=tL(e[wa]);tD(l[an],l,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function dEe(t,e){for(let n=Xo;n<t.length;n++){let r=t[n],i=r[an].firstChild;i!==null&&tD(r[an],r,i,e)}t[Lm]!==t[dd]&&e.push(t[Lm])}var c7=[];function hEe(t){return t[Fm]??fEe(t)}function fEe(t){let e=c7.pop()??Object.create(pEe);return e.lView=t,e}function mEe(t){t.lView[Fm]!==t&&(t.lView=null,c7.push(t))}var pEe=ft(Ee({},sG),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{vD(t.lView)},consumerOnSignalRead(){this.lView[Fm]=this}}),gEe="ngOriginalError";function yF(t){return t[gEe]}var ud=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&yF(e);for(;n&&yF(n);)n=yF(n);return n||null}};var u7=!1,vEe=new Ut("",{providedIn:"root",factory:()=>u7});var Qo={};function Te(t){d7(Wr(),nn(),Zc()+t,!1)}function d7(t,e,n,r){if(!r)if((e[tn]&3)===3){let o=t.preOrderCheckHooks;o!==null&&FR(e,o,n)}else{let o=t.preOrderHooks;o!==null&&LR(e,o,0,n)}Bm(n)}function je(t,e=On.Default){let n=nn();if(n===null)return kt(t,e);let r=xs();return _9(r,n,Cs(t),e)}function wEe(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Bm(~i);else{let o=i,s=n[++r],a=n[++r];R1e(s,o);let l=e[o];a(2,l)}}}finally{Bm(-1)}}function ID(t,e,n,r,i,o,s,a,l,c,u){let d=e.blueprint.slice();return d[dd]=i,d[tn]=r|4|128|8,(c!==null||t&&t[tn]&2048)&&(d[tn]|=2048),Qz(d),d[Ai]=d[B0]=t,d[Ao]=n,d[k0]=s||t&&t[k0],d[ar]=a||t&&t[ar],d[P0]=l||t&&t[P0]||null,d[Qs]=o,d[fD]=gSe(),d[A_]=u,d[zz]=c,d[wa]=e.type==2?t[wa]:d,d}function $0(t,e,n,r,i){let o=t.data[e];if(o===null)o=hL(t,e,n,r,i),T1e()&&(o.flags|=32);else if(o.type&64){o.type=n,o.value=r,o.attrs=i;let s=N_();o.injectorIndex=s===null?-1:s.injectorIndex}return Kc(o,!0),o}function hL(t,e,n,r,i){let o=i9(),s=L2(),a=s?o:o&&o.parent,l=t.data[e]=xEe(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=l),o!==null&&(s?o.child==null&&l.parent!==null&&(o.child=l):o.next===null&&(o.next=l,l.prev=o)),l}function X_(t,e,n,r){if(n===0)return-1;let i=e.length;for(let o=0;o<n;o++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function h7(t,e,n,r,i){let o=Zc(),s=r&2;try{Bm(-1),s&&e.length>zi&&d7(t,e,zi,!1),$c(s?2:0,i),n(r,i)}finally{Bm(o),$c(s?3:1,i)}}function fL(t,e,n){if(P2(e)){let r=Do(null);try{let i=e.directiveStart,o=e.directiveEnd;for(let s=i;s<o;s++){let a=t.data[s];a.contentQueries&&a.contentQueries(1,n[s],s)}}finally{Do(r)}}}function mL(t,e,n){n9()&&(AEe(t,e,n,Xa(n,e)),(n.flags&64)===64&&p7(t,e,n))}function pL(t,e,n=Xa){let r=e.localNames;if(r!==null){let i=e.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?n(e,t):t[s];t[i++]=a}}}function f7(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=gL(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function gL(t,e,n,r,i,o,s,a,l,c,u){let d=zi+r,h=d+i,f=yEe(d,h),p=typeof c=="function"?c():c;return f[an]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1,ssrId:u}}function yEe(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Qo);return n}function _Ee(t,e,n,r){let o=r.get(vEe,u7)||n===qc.ShadowDom,s=t.selectRootElement(e,o);return CEe(s),s}function CEe(t){SEe(t)}var SEe=t=>null;function EEe(t,e,n,r){let i=y7(e);i.push(n),t.firstCreatePass&&_7(t).push(r,i.length-1)}function xEe(t,e,n,r,i,o){let s=e?e.injectorIndex:-1,a=0;return r9()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function sz(t,e,n,r){for(let i in t)if(t.hasOwnProperty(i)){n=n===null?{}:n;let o=t[i];r===null?az(n,e,i,o):r.hasOwnProperty(i)&&az(n,e,r[i],o)}return n}function az(t,e,n,r){t.hasOwnProperty(n)?t[n].push(e,r):t[n]=[e,r]}function bEe(t,e,n){let r=e.directiveStart,i=e.directiveEnd,o=t.data,s=e.attrs,a=[],l=null,c=null;for(let u=r;u<i;u++){let d=o[u],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;l=sz(d.inputs,u,l,f),c=sz(d.outputs,u,c,p);let g=l!==null&&s!==null&&!Hz(e)?BEe(l,u,s):null;a.push(g)}l!==null&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=c}function TEe(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function Z_(t,e,n,r,i,o,s,a){let l=Xa(e,n),c=e.inputs,u;!a&&c!=null&&(u=c[r])?(yL(t,n,u,r,i),mD(e)&&REe(n,e.index)):e.type&3?(r=TEe(r),i=s!=null?s(i,e.value||"",r):i,o.setProperty(l,r,i)):e.type&12}function REe(t,e){let n=kh(e,t);n[tn]&16||(n[tn]|=64)}function vL(t,e,n,r){if(n9()){let i=r===null?null:{"":-1},o=OEe(t,n),s,a;o===null?s=a=null:[s,a]=o,s!==null&&m7(t,e,n,s,i,a),i&&NEe(n,r,i)}n.mergedAttrs=I_(n.mergedAttrs,n.attrs)}function m7(t,e,n,r,i,o){for(let c=0;c<r.length;c++)HF(KR(n,e),t,r[c].type);kEe(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let u=r[c];u.providersResolver&&u.providersResolver(u)}let s=!1,a=!1,l=X_(t,e,r.length,null);for(let c=0;c<r.length;c++){let u=r[c];n.mergedAttrs=I_(n.mergedAttrs,u.hostAttrs),FEe(t,n,e,l,u),PEe(l,u,i),u.contentQueries!==null&&(n.flags|=4),(u.hostBindings!==null||u.hostAttrs!==null||u.hostVars!==0)&&(n.flags|=64);let d=u.type.prototype;!s&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),s=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),l++}bEe(t,n,o)}function DEe(t,e,n,r,i){let o=i.hostBindings;if(o){let s=t.hostBindingOpCodes;s===null&&(s=t.hostBindingOpCodes=[]);let a=~e.index;IEe(s)!=a&&s.push(a),s.push(n,r,o)}}function IEe(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function AEe(t,e,n,r){let i=n.directiveStart,o=n.directiveEnd;mD(n)&&LEe(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||KR(n,e),Xc(r,e);let s=n.initialInputs;for(let a=i;a<o;a++){let l=t.data[a],c=Wm(e,t,a,n);if(Xc(c,e),s!==null&&VEe(e,a-i,c,l,n,s),Nh(l)){let u=kh(n.index,e);u[Ao]=Wm(e,t,a,n)}}}function p7(t,e,n){let r=n.directiveStart,i=n.directiveEnd,o=n.index,s=D1e();try{Bm(o);for(let a=r;a<i;a++){let l=t.data[a],c=e[a];FF(a),(l.hostBindings!==null||l.hostVars!==0||l.hostAttrs!==null)&&MEe(l,c)}}finally{Bm(-1),FF(s)}}function MEe(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function OEe(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let o=0;o<n.length;o++){let s=n[o];if(Vz(e,s.selectors,!1))if(r||(r=[]),Nh(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let l=a.length;i2(t,e,l)}else r.unshift(s),i2(t,e,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function i2(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function NEe(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let o=n[e[i+1]];if(o==null)throw new Je(-301,!1);r.push(e[i],o)}}}function PEe(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Nh(e)&&(n[""]=t)}}function kEe(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function FEe(t,e,n,r,i){t.data[r]=i;let o=i.factory||(i.factory=Hm(i.type,!0)),s=new Um(o,Nh(i),je);t.blueprint[r]=s,n[r]=s,DEe(t,e,r,X_(t,n,i.hostVars,Qo),i)}function LEe(t,e,n){let r=Xa(e,t),i=f7(n),o=t[k0].rendererFactory,s=16;n.signals?s=4096:n.onPush&&(s=64);let a=AD(t,ID(t,i,null,s,r,e,null,o.createRenderer(r,n),null,null,null));t[e.index]=a}function HEe(t,e,n,r,i,o){let s=Xa(t,e);wL(e[ar],s,o,t.value,n,r,i)}function wL(t,e,n,r,i,o,s){if(o==null)t.removeAttribute(e,i,n);else{let a=s==null?zc(o):s(o,r||"",i);t.setAttribute(e,i,a,n)}}function VEe(t,e,n,r,i,o){let s=o[e];if(s!==null)for(let a=0;a<s.length;){let l=s[a++],c=s[a++],u=s[a++];g7(r,n,l,c,u)}}function g7(t,e,n,r,i){let o=Do(null);try{let s=t.inputTransforms;s!==null&&s.hasOwnProperty(r)&&(i=s[r].call(e,i)),t.setInput!==null?t.setInput(e,i,n,r):e[r]=i}finally{Do(o)}}function BEe(t,e,n){let r=null,i=0;for(;i<n.length;){let o=n[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(t.hasOwnProperty(o)){r===null&&(r=[]);let s=t[o];for(let a=0;a<s.length;a+=2)if(s[a]===e){r.push(o,s[a+1],n[i+1]);break}}i+=2}return r}function v7(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function w7(t,e){let n=t.contentQueries;if(n!==null){let r=Do(null);try{for(let i=0;i<n.length;i+=2){let o=n[i],s=n[i+1];if(s!==-1){let a=t.data[s];U2(o),a.contentQueries(2,e[s],s)}}}finally{Do(r)}}}function AD(t,e){return t[O_]?t[qG][zl]=e:t[O_]=e,t[qG]=e,e}function o2(t,e,n){U2(0);let r=Do(null);try{e(t,n)}finally{Do(r)}}function y7(t){return t[M_]||(t[M_]=[])}function _7(t){return t.cleanup||(t.cleanup=[])}function C7(t,e){let n=t[P0],r=n?n.get(ud,null):null;r&&r.handleError(e)}function yL(t,e,n,r,i){for(let o=0;o<n.length;){let s=n[o++],a=n[o++],l=e[s],c=t.data[s];g7(c,l,r,a,i)}}function _L(t,e,n){let r=gD(e,t);W9(t[ar],r,n)}var UEe=100;function WEe(t,e=!0){let n=t[k0],r=n.rendererFactory,i=n.afterRenderEventManager,o=!1;o||(r.begin?.(),i?.begin());try{let s=t[an],a=t[Ao];S7(s,t,s.template,a),jEe(t)}catch(s){throw e&&C7(t,s),s}finally{o||(r.end?.(),n.inlineEffectRunner?.flush(),i?.end())}}function jEe(t){let e=0;for(;Jz(t);){if(e===UEe)throw new Je(103,!1);e++,b7(t,1)}}function S7(t,e,n,r){let i=e[tn];if((i&256)===256)return;let o=!1;!o&&e[k0].inlineEffectRunner?.flush(),W2(e);let s=null,a=null;!o&&$Ee(t)&&(a=hEe(e),s=aG(a));try{Qz(e),b1e(t.bindingStartIndex),n!==null&&h7(t,e,n,2,r);let l=(i&3)===3;if(!o)if(l){let d=t.preOrderCheckHooks;d!==null&&FR(e,d,null)}else{let d=t.preOrderHooks;d!==null&&LR(e,d,0,null),fF(e,0)}if(GEe(e),E7(e,0),t.contentQueries!==null&&w7(t,e),!o)if(l){let d=t.contentCheckHooks;d!==null&&FR(e,d)}else{let d=t.contentHooks;d!==null&&LR(e,d,1),fF(e,1)}wEe(t,e);let c=t.components;c!==null&&T7(e,c,0);let u=t.viewQuery;if(u!==null&&o2(2,u,r),!o)if(l){let d=t.viewCheckHooks;d!==null&&FR(e,d)}else{let d=t.viewHooks;d!==null&&LR(e,d,2),fF(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[hF]){for(let d of e[hF])d();e[hF]=null}o||(e[tn]&=-73)}catch(l){throw vD(e),l}finally{a!==null&&(lG(a,s),mEe(a)),j2()}}function $Ee(t){return t.type!==2}function E7(t,e){for(let n=V9(t);n!==null;n=B9(n)){n[tn]&=~L0.HasChildViewsToRefresh;for(let r=Xo;r<n.length;r++){let i=n[r];x7(i,e)}}}function GEe(t){for(let e=V9(t);e!==null;e=B9(e)){if(!(e[tn]&L0.HasTransplantedViews))continue;let n=e[F0];for(let r=0;r<n.length;r++){let i=n[r],o=i[Ai];g1e(i)}}}function zEe(t,e,n){let r=kh(e,t);x7(r,n)}function x7(t,e){F2(t)&&b7(t,e)}function b7(t,e){let r=t[an],i=t[tn],o=t[Fm],s=!!(e===0&&i&16);if(s||=!!(i&64&&e===0),s||=!!(i&1024),s||=!!(o?.dirty&&Uk(o)),o&&(o.dirty=!1),t[tn]&=-9217,s)S7(r,t,r.template,t[Ao]);else if(i&8192){E7(t,1);let a=r.components;a!==null&&T7(t,a,1)}}function T7(t,e,n){for(let r=0;r<e.length;r++)zEe(t,e[r],n)}function CL(t){for(;t;){t[tn]|=64;let e=tL(t);if(l1e(t)&&!e)return t;t=e}return null}var zm=class{get rootNodes(){let e=this._lView,n=e[an];return tD(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ao]}set context(e){this._lView[Ao]=e}get destroyed(){return(this._lView[tn]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Ai];if(Yl(e)){let n=e[GR],r=n?n.indexOf(this):-1;r>-1&&(k_(e,r),XR(n,r))}this._attachedToViewContainer=!1}xD(this._lView[an],this._lView)}onDestroy(e){t9(this._lView,e)}markForCheck(){CL(this._cdRefInjectingView||this._lView)}detach(){this._lView[tn]&=-129}reattach(){e9(this._lView),this._lView[tn]|=128}detectChanges(){WEe(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Je(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,SSe(this._lView[an],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Je(902,!1);this._appRef=e}},Za=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=YEe;let t=e;return t})();function YEe(t){return qEe(xs(),nn(),(t&16)===16)}function qEe(t,e,n){if(mD(t)&&!n){let r=kh(t.index,e);return new zm(r,r)}else if(t.type&47){let r=e[wa];return new zm(r,e)}return null}var Q_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=KEe,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),s2=class extends Q_{constructor(e){super(),this._lView=e}onDestroy(e){return t9(this._lView,e),()=>w1e(this._lView,e)}};function KEe(){return new s2(nn())}var lz=new Set;function J_(t){lz.has(t)||(lz.add(t),performance?.mark?.("mark_use_counter",{detail:{feature:t}}))}var a2=class extends Ur{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,o=n||(()=>null),s=r;if(e&&typeof e=="object"){let l=e;i=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=_F(o),i&&(i=_F(i)),s&&(s=_F(s)));let a=super.subscribe({next:i,error:o,complete:s});return e instanceof Ii&&e.add(a),a}};function _F(t){return e=>{setTimeout(t,void 0,e)}}var hr=a2;function cz(...t){}function XEe(){let t=typeof va.requestAnimationFrame=="function",e=va[t?"requestAnimationFrame":"setTimeout"],n=va[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var nr=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new hr(!1),this.onMicrotaskEmpty=new hr(!1),this.onStable=new hr(!1),this.onError=new hr(!1),typeof Zone>"u")throw new Je(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=XEe().nativeRequestAnimationFrame,JEe(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new Je(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new Je(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,e,ZEe,cz,cz);try{return o.runTask(s,n,r)}finally{o.cancelTask(s)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},ZEe={};function SL(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function QEe(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(va,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,l2(t),t.isCheckStableRunning=!0,SL(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),l2(t))}function JEe(t){let e=()=>{QEe(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,o,s,a)=>{if(exe(a))return n.invokeTask(i,o,s,a);try{return uz(t),n.invokeTask(i,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),dz(t)}},onInvoke:(n,r,i,o,s,a,l)=>{try{return uz(t),n.invoke(i,o,s,a,l)}finally{t.shouldCoalesceRunChangeDetection&&e(),dz(t)}},onHasTask:(n,r,i,o)=>{n.hasTask(i,o),r===i&&(o.change=="microTask"?(t._hasPendingMicrotasks=o.microTask,l2(t),SL(t)):o.change=="macroTask"&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(n,r,i,o)=>(n.handleError(i,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}function l2(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function uz(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function dz(t){t._nesting--,SL(t)}var R7=new Ut("",{providedIn:"root",factory:D7});function D7(){let t=qe(nr),e=!0,n=new en(i=>{e=t.isStable&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks,t.runOutsideAngular(()=>{i.next(e),i.complete()})}),r=new en(i=>{let o;t.runOutsideAngular(()=>{o=t.onStable.subscribe(()=>{nr.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!t.hasPendingMacrotasks&&!t.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});let s=t.onUnstable.subscribe(()=>{nr.assertInAngularZone(),e&&(e=!1,t.runOutsideAngular(()=>{i.next(!1)}))});return()=>{o.unsubscribe(),s.unsubscribe()}});return TR(n,r.pipe(IR()))}function exe(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var txe=(()=>{let e=class e{constructor(){this.renderDepth=0,this.handler=null,this.internalCallbacks=[]}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){if(this.renderDepth--,this.renderDepth===0){for(let r of this.internalCallbacks)r();this.internalCallbacks.length=0,this.handler?.execute()}}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=ht({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function nxe(t,e){let n=kh(e,t),r=n[an];rxe(r,n);let i=n[dd];i!==null&&n[A_]===null&&(n[A_]=lL(i,n[P0])),EL(r,n,n[Ao])}function rxe(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function EL(t,e,n){W2(e);try{let r=t.viewQuery;r!==null&&o2(1,r,n);let i=t.template;i!==null&&h7(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&w7(t,e),t.staticViewQueries&&o2(2,t.viewQuery,n);let o=t.components;o!==null&&ixe(e,o)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[tn]&=-5,j2()}}function ixe(t,e){for(let n=0;n<e.length;n++)nxe(t,e[n])}function nD(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,o=0;if(e!==null)for(let s=0;s<e.length;s++){let a=e[s];if(typeof a=="number")o=a;else if(o==1)i=AF(i,a);else if(o==2){let l=a,c=e[++s];r=AF(r,l+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var rD=class extends DD{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=km(e);return new F_(n,this.ngModule)}};function hz(t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let r=t[n];e.push({propName:r,templateName:n})}return e}function oxe(t){let e=t.toLowerCase();return e==="svg"?h1e:e==="math"?f1e:null}var c2=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=hD(r);let i=this.injector.get(e,wF,r);return i!==wF||n===wF?i:this.parentInjector.get(e,n,r)}},F_=class extends JR{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=hz(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return hz(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=r1e(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let o=i instanceof Es?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let s=o?new c2(e,o):e,a=s.get($m,null);if(a===null)throw new Je(407,!1);let l=s.get(aEe,null),c=s.get(txe,null),u={rendererFactory:a,sanitizer:l,inlineEffectRunner:null,afterRenderEventManager:c},d=a.createRenderer(null,this.componentDef),h=this.componentDef.selectors[0][0]||"div",f=r?_Ee(d,r,this.componentDef.encapsulation,s):rL(d,h,oxe(h)),p=4608,g=this.componentDef.onPush?576:528,w=this.componentDef.signals?p:g,_=null;f!==null&&(_=lL(f,s,!0));let S=gL(0,null,null,1,0,null,null,null,null,null,null),x=ID(null,S,null,w,null,null,u,d,s,null,_);W2(x);let P,k;try{let b=this.componentDef,C,N=null;b.findHostDirectiveDefs?(C=[],N=new Map,b.findHostDirectiveDefs(b,C,N),C.push(b)):C=[b];let B=sxe(x,f),Y=axe(B,f,b,C,x,u,d);k=k2(S,zi),f&&uxe(d,b,f,r),n!==void 0&&dxe(k,this.ngContentSelectors,n),P=cxe(Y,b,C,N,x,[hxe]),EL(S,x,null)}finally{j2()}return new u2(this.componentType,P,j0(k,x),x,k)}},u2=class extends KF{constructor(e,n,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new zm(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let o=this._rootLView;yL(o[an],o,i,e,n),this.previousInputValues.set(e,n);let s=kh(this._tNode.index,o);CL(s)}}get injector(){return new Pm(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function sxe(t,e){let n=t[an],r=zi;return t[r]=e,$0(n,r,2,"#host",null)}function axe(t,e,n,r,i,o,s){let a=i[an];lxe(r,t,e,s);let l=null;e!==null&&(l=lL(e,i[P0]));let c=o.rendererFactory.createRenderer(e,n),u=16;n.signals?u=4096:n.onPush&&(u=64);let d=ID(i,f7(n),null,u,i[t.index],t,o,c,null,null,l);return a.firstCreatePass&&i2(a,t,r.length-1),AD(i,d),i[t.index]=d}function lxe(t,e,n,r){for(let i of t)e.mergedAttrs=I_(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(nD(e,e.mergedAttrs,!0),n!==null&&n7(r,n,e))}function cxe(t,e,n,r,i,o){let s=xs(),a=i[an],l=Xa(s,i);m7(a,i,s,n,null,r);for(let u=0;u<n.length;u++){let d=s.directiveStart+u,h=Wm(i,a,d,s);Xc(h,i)}p7(a,i,s),l&&Xc(l,i);let c=Wm(i,a,s.directiveStart+s.componentOffset,s);if(t[Ao]=i[Ao]=c,o!==null)for(let u of o)u(c,e);return fL(a,s,t),c}function uxe(t,e,n,r){if(r)PF(t,n,["ng-version",lEe.full]);else{let{attrs:i,classes:o}=i1e(e.selectors[0]);i&&PF(t,n,i),o&&o.length>0&&t7(t,n,o.join(" "))}}function dxe(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let o=n[i];r.push(o!=null?Array.from(o):null)}}function hxe(){let t=xs();CD(nn()[an],t)}function fxe(t){return Object.getPrototypeOf(t.prototype).constructor}function qi(t){let e=fxe(t.type),n=!0,r=[t];for(;e;){let i;if(Nh(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Je(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let s=t;s.inputs=PR(t.inputs),s.inputTransforms=PR(t.inputTransforms),s.declaredInputs=PR(t.declaredInputs),s.outputs=PR(t.outputs);let a=i.hostBindings;a&&vxe(t,a);let l=i.viewQuery,c=i.contentQueries;if(l&&pxe(t,l),c&&gxe(t,c),AR(t.inputs,i.inputs),AR(t.declaredInputs,i.declaredInputs),AR(t.outputs,i.outputs),i.inputTransforms!==null&&(s.inputTransforms===null&&(s.inputTransforms={}),AR(s.inputTransforms,i.inputTransforms)),Nh(i)&&i.data.animation){let u=t.data;u.animation=(u.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(t),a===qi&&(n=!1)}}e=Object.getPrototypeOf(e)}mxe(r)}function mxe(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=I_(i.hostAttrs,n=I_(n,i.hostAttrs))}}function PR(t){return t===N0?{}:t===Ss?[]:t}function pxe(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function gxe(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,o)=>{e(r,i,o),n(r,i,o)}:t.contentQueries=e}function vxe(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function xL(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[2]&&(n[r]=i[2])}t.inputTransforms=n}function I7(t,e,n){return t[e]=n}function wxe(t,e){return t[e]}function ya(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function A7(t,e,n,r){let i=ya(t,e,n);return ya(t,e+1,r)||i}function yxe(t,e,n,r,i){let o=A7(t,e,n,r);return ya(t,e+2,i)||o}function Js(t,e,n,r){let i=nn(),o=qm();if(ya(i,o,e)){let s=Wr(),a=G_();HEe(a,i,t,e,n,r)}return Js}function M7(t,e,n,r){return ya(t,qm(),n)?e+zc(n)+r:Qo}function O7(t,e,n,r,i,o){let s=B2(),a=A7(t,s,n,i);return wD(2),a?e+zc(n)+r+zc(i)+o:Qo}function _xe(t,e,n,r,i,o,s,a){let l=B2(),c=yxe(t,l,n,i,s);return wD(3),c?e+zc(n)+r+zc(i)+o+zc(s)+a:Qo}function kR(t,e){return t<<17|e<<2}function Ym(t){return t>>17&32767}function Cxe(t){return(t&2)==2}function Sxe(t,e){return t&131071|e<<17}function d2(t){return t|2}function V0(t){return(t&131068)>>2}function CF(t,e){return t&-131069|e<<2}function Exe(t){return(t&1)===1}function h2(t){return t|1}function xxe(t,e,n,r,i,o){let s=o?e.classBindings:e.styleBindings,a=Ym(s),l=V0(s);t[r]=n;let c=!1,u;if(Array.isArray(n)){let d=n;u=d[1],(u===null||z_(d,u)>0)&&(c=!0)}else u=n;if(i)if(l!==0){let h=Ym(t[a+1]);t[r+1]=kR(h,a),h!==0&&(t[h+1]=CF(t[h+1],r)),t[a+1]=Sxe(t[a+1],r)}else t[r+1]=kR(a,0),a!==0&&(t[a+1]=CF(t[a+1],r)),a=r;else t[r+1]=kR(l,0),a===0?a=r:t[l+1]=CF(t[l+1],r),l=r;c&&(t[r+1]=d2(t[r+1])),fz(t,u,r,!0,o),fz(t,u,r,!1,o),bxe(e,u,t,r,o),s=kR(a,l),o?e.classBindings=s:e.styleBindings=s}function bxe(t,e,n,r,i){let o=i?t.residualClasses:t.residualStyles;o!=null&&typeof e=="string"&&z_(o,e)>=0&&(n[r+1]=h2(n[r+1]))}function fz(t,e,n,r,i){let o=t[n+1],s=e===null,a=r?Ym(o):V0(o),l=!1;for(;a!==0&&(l===!1||s);){let c=t[a],u=t[a+1];Txe(c,e)&&(l=!0,t[a+1]=r?h2(u):d2(u)),a=r?Ym(u):V0(u)}l&&(t[n+1]=r?d2(o):h2(o))}function Txe(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?z_(t,e)>=0:!1}var Gl={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Rxe(t){return t.substring(Gl.key,Gl.keyEnd)}function Dxe(t){return Ixe(t),N7(t,P7(t,0,Gl.textEnd))}function N7(t,e){let n=Gl.textEnd;return n===e?-1:(e=Gl.keyEnd=Axe(t,Gl.key=e,n),P7(t,e,n))}function Ixe(t){Gl.key=0,Gl.keyEnd=0,Gl.value=0,Gl.valueEnd=0,Gl.textEnd=t.length}function P7(t,e,n){for(;e<n&&t.charCodeAt(e)<=32;)e++;return e}function Axe(t,e,n){for(;e<n&&t.charCodeAt(e)>32;)e++;return e}function lt(t,e,n){let r=nn(),i=qm();if(ya(r,i,e)){let o=Wr(),s=G_();Z_(o,s,r,t,e,r[ar],n,!1)}return lt}function f2(t,e,n,r,i){let o=e.inputs,s=i?"class":"style";yL(t,n,o[s],s,r)}function Xr(t,e){return Oxe(t,e,null,!0),Xr}function eC(t){Nxe(Vxe,Mxe,t,!0)}function Mxe(t,e){for(let n=Dxe(e);n>=0;n=N7(e,n))z2(t,Rxe(e),!0)}function Oxe(t,e,n,r){let i=nn(),o=Wr(),s=wD(2);if(o.firstUpdatePass&&F7(o,t,s,r),e!==Qo&&ya(i,s,e)){let a=o.data[Zc()];L7(o,a,i,i[ar],t,i[s+1]=Uxe(e,n),r,s)}}function Nxe(t,e,n,r){let i=Wr(),o=wD(2);i.firstUpdatePass&&F7(i,null,o,r);let s=nn();if(n!==Qo&&ya(s,o,n)){let a=i.data[Zc()];if(H7(a,r)&&!k7(i,o)){let l=r?a.classesWithoutHost:a.stylesWithoutHost;l!==null&&(n=AF(l,n||"")),f2(i,a,s,n,r)}else Bxe(i,a,s,s[ar],s[o+1],s[o+1]=Hxe(t,e,n),r,o)}}function k7(t,e){return e>=t.expandoStartIndex}function F7(t,e,n,r){let i=t.data;if(i[n+1]===null){let o=i[Zc()],s=k7(t,n);H7(o,r)&&e===null&&!s&&(e=!1),e=Pxe(i,o,e,r),xxe(i,o,e,n,s,r)}}function Pxe(t,e,n,r){let i=I1e(t),o=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=SF(null,t,e,n,r),n=L_(n,e.attrs,r),o=null);else{let s=e.directiveStylingLast;if(s===-1||t[s]!==i)if(n=SF(i,t,e,n,r),o===null){let l=kxe(t,e,r);l!==void 0&&Array.isArray(l)&&(l=SF(null,t,e,l[1],r),l=L_(l,e.attrs,r),Fxe(t,e,r,l))}else o=Lxe(t,e,r)}return o!==void 0&&(r?e.residualClasses=o:e.residualStyles=o),n}function kxe(t,e,n){let r=n?e.classBindings:e.styleBindings;if(V0(r)!==0)return t[Ym(r)]}function Fxe(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Ym(i)]=r}function Lxe(t,e,n){let r,i=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<i;o++){let s=t[o].hostAttrs;r=L_(r,s,n)}return L_(r,e.attrs,n)}function SF(t,e,n,r,i){let o=null,s=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<s&&(o=e[a],r=L_(r,o.hostAttrs,i),o!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function L_(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let o=0;o<e.length;o++){let s=e[o];typeof s=="number"?i=s:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),z2(t,s,n?!0:e[++o]))}return t===void 0?null:t}function Hxe(t,e,n){if(n==null||n==="")return Ss;let r=[],i=W0(n);if(Array.isArray(i))for(let o=0;o<i.length;o++)t(r,i[o],!0);else if(typeof i=="object")for(let o in i)i.hasOwnProperty(o)&&t(r,o,i[o]);else typeof i=="string"&&e(r,i);return r}function Vxe(t,e,n){let r=String(e);r!==""&&!r.includes(" ")&&z2(t,r,n)}function Bxe(t,e,n,r,i,o,s,a){i===Qo&&(i=Ss);let l=0,c=0,u=0<i.length?i[0]:null,d=0<o.length?o[0]:null;for(;u!==null||d!==null;){let h=l<i.length?i[l+1]:void 0,f=c<o.length?o[c+1]:void 0,p=null,g;u===d?(l+=2,c+=2,h!==f&&(p=d,g=f)):d===null||u!==null&&u<d?(l+=2,p=u):(c+=2,p=d,g=f),p!==null&&L7(t,e,n,r,p,g,s,a),u=l<i.length?i[l]:null,d=c<o.length?o[c]:null}}function L7(t,e,n,r,i,o,s,a){if(!(e.type&3))return;let l=t.data,c=l[a+1],u=Exe(c)?mz(l,e,n,i,V0(c),s):void 0;if(!iD(u)){iD(o)||Cxe(c)&&(o=mz(l,null,n,i,a,s));let d=gD(Zc(),n);OSe(r,s,d,i,o)}}function mz(t,e,n,r,i,o){let s=e===null,a;for(;i>0;){let l=t[i],c=Array.isArray(l),u=c?l[1]:l,d=u===null,h=n[i+1];h===Qo&&(h=d?Ss:void 0);let f=d?pF(h,r):u===r?h:void 0;if(c&&!iD(f)&&(f=pF(l,r)),iD(f)&&(a=f,s))return a;let p=t[i+1];i=s?Ym(p):V0(p)}if(e!==null){let l=o?e.residualClasses:e.residualStyles;l!=null&&(a=pF(l,r))}return a}function iD(t){return t!==void 0}function Uxe(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Ko(W0(t)))),t}function H7(t,e){return(t.flags&(e?8:16))!==0}var fmt=new RegExp(`^(\\d+)*(${eEe}|${JSe})*(.*)`);var Wxe=(t,e)=>null;function H_(t,e){return Wxe(t,e)}var m2=class{destroy(e){}updateValue(e,n){}swap(e,n){let r=Math.min(e,n),i=Math.max(e,n),o=this.detach(i);if(i-r>1){let s=this.detach(r);this.attach(r,o),this.attach(i,s)}else this.attach(r,o)}move(e,n){this.attach(n,this.detach(e))}};function EF(t,e,n,r,i){return t===n&&Object.is(e,r)?1:Object.is(i(t,e),i(n,r))?-1:0}function jxe(t,e,n){let r,i,o=0,s=t.length-1;if(Array.isArray(e)){let a=e.length-1;for(;o<=s&&o<=a;){let l=t.at(o),c=e[o],u=EF(o,l,o,c,n);if(u!==0){u<0&&t.updateValue(o,c),o++;continue}let d=t.at(s),h=e[a],f=EF(s,d,a,h,n);if(f!==0){f<0&&t.updateValue(s,h),s--,a--;continue}let p=n(o,l),g=n(s,d),w=n(o,c);if(Object.is(w,g)){let _=n(a,h);Object.is(_,p)?(t.swap(o,s),t.updateValue(s,h),a--,s--):t.move(s,o),t.updateValue(o,c),o++;continue}if(r??=new oD,i??=gz(t,o,s,n),p2(t,r,o,w))t.updateValue(o,c),o++,s++;else if(i.has(w))r.set(p,t.detach(o)),s--;else{let _=t.create(o,e[o]);t.attach(o,_),o++,s++}}for(;o<=a;)pz(t,r,n,o,e[o]),o++}else if(e!=null){let a=e[Symbol.iterator](),l=a.next();for(;!l.done&&o<=s;){let c=t.at(o),u=l.value,d=EF(o,c,o,u,n);if(d!==0)d<0&&t.updateValue(o,u),o++,l=a.next();else{r??=new oD,i??=gz(t,o,s,n);let h=n(o,u);if(p2(t,r,o,h))t.updateValue(o,u),o++,s++,l=a.next();else if(!i.has(h))t.attach(o,t.create(o,u)),o++,s++,l=a.next();else{let f=n(o,c);r.set(f,t.detach(o)),s--}}}for(;!l.done;)pz(t,r,n,t.length,l.value),l=a.next()}for(;o<=s;)t.destroy(t.detach(s--));r?.forEach(a=>{t.destroy(a)})}function p2(t,e,n,r){return e!==void 0&&e.has(r)?(t.attach(n,e.get(r)),e.delete(r),!0):!1}function pz(t,e,n,r,i){if(p2(t,e,r,n(r,i)))t.updateValue(r,i);else{let o=t.create(r,i);t.attach(r,o)}}function gz(t,e,n,r){let i=new Set;for(let o=e;o<=n;o++)i.add(r(o,t.at(o)));return i}var oD=class{constructor(){this.map=new Map}has(e){let n=this.map.get(e);return n!==void 0&&n.length>0}delete(e){let n=this.map.get(e);return n!==void 0?(n.shift(),!0):!1}get(e){let n=this.map.get(e);return n!==void 0&&n.length>0?n[0]:void 0}set(e,n){if(!this.map.has(e)){this.map.set(e,[n]);return}this.map.get(e)?.push(n)}forEach(e){for(let[n,r]of this.map)for(let i of r)e(i,n)}};function MD(t,e,n,r){let i=e.tView,s=t[tn]&4096?4096:16,a=ID(t,i,n,s,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),l=t[e.index];a[$_]=l;let c=t[Yc];return c!==null&&(a[Yc]=c.createEmbeddedView(i)),EL(i,a,n),a}function V7(t,e){let n=Xo+e;if(n<t.length)return t[n]}function V_(t,e){return!e||L9(t)}function OD(t,e,n,r=!0){let i=e[an];if(xSe(i,e,t,n),r){let o=zF(n,t),s=e[ar],a=bD(s,t[Lm]);a!==null&&CSe(i,t[Qs],s,e,a,o)}}function B7(t,e){let n=k_(t,e);return n!==void 0&&xD(n[an],n),n}var Kl=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=$xe;let t=e;return t})();function $xe(){let t=xs();return W7(t,nn())}var Gxe=Kl,U7=class extends Gxe{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return j0(this._hostTNode,this._hostLView)}get injector(){return new Pm(this._hostTNode,this._hostLView)}get parentInjector(){let e=$2(this._hostTNode,this._hostLView);if(m9(e)){let n=YR(e,this._hostLView),r=zR(e),i=n[an].data[r+8];return new Pm(i,n)}else return new Pm(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=vz(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-Xo}createEmbeddedView(e,n,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=H_(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},o,s);return this.insertImpl(a,i,V_(this._hostTNode,s)),a}createComponent(e,n,r,i,o){let s=e&&!q1e(e),a;if(s)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,o=p.environmentInjector||p.ngModuleRef}let l=s?e:new F_(km(e)),c=r||this.parentInjector;if(!o&&l.ngModule==null){let g=(s?c:this.parentInjector).get(Es,null);g&&(o=g)}let u=km(l.componentType??{}),d=H_(this._lContainer,u?.id??null),h=d?.firstChild??null,f=l.create(c,i,h,o);return this.insertImpl(f.hostView,a,V_(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(p1e(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let l=i[Ai],c=new U7(l,l[Qs],l[Ai]);c.detach(c.indexOf(e))}}let o=this._adjustIndex(n),s=this._lContainer;return OD(s,i,o,r),e.attachToViewContainerRef(),x9(xF(s),o,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=vz(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=k_(this._lContainer,n);r&&(XR(xF(this._lContainer),n),xD(r[an],r))}detach(e){let n=this._adjustIndex(e,-1),r=k_(this._lContainer,n);return r&&XR(xF(this._lContainer),n)!=null?new zm(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function vz(t){return t[GR]}function xF(t){return t[GR]||(t[GR]=[])}function W7(t,e){let n,r=e[t.index];return Yl(r)?n=r:(n=v7(r,e,null,t),e[t.index]=n,AD(e,n)),Yxe(n,e,t,r),new U7(n,t,e)}function zxe(t,e){let n=t[ar],r=n.createComment(""),i=Xa(e,t),o=bD(n,i);return jm(n,o,r,ISe(n,i),!1),r}var Yxe=Xxe,qxe=(t,e,n)=>!1;function Kxe(t,e,n){return qxe(t,e,n)}function Xxe(t,e,n,r){if(t[Lm])return;let i;n.type&8?i=qa(r):i=zxe(e,n),t[Lm]=i}function Zxe(t,e,n,r,i,o,s,a,l){let c=e.consts,u=$0(e,t,4,s||null,Vm(c,a));vL(e,n,u,Vm(c,l)),CD(e,u);let d=u.tView=gL(2,u,r,i,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,u),d.queries=e.queries.embeddedTView(u)),u}function rn(t,e,n,r,i,o,s,a){let l=nn(),c=Wr(),u=t+zi,d=c.firstCreatePass?Zxe(u,c,l,e,n,r,i,o,s):c.data[u];Kc(d,!1);let h=Qxe(c,l,d,t);yD()&&TD(c,l,h,d),Xc(h,l);let f=v7(h,l,h,d);return l[u]=f,AD(l,f),Kxe(f,d,l),pD(d)&&mL(c,l,d),s!=null&&pL(l,d,a),rn}var Qxe=Jxe;function Jxe(t,e,n,r){return _D(!0),e[ar].createComment("")}function rr(t,e,n){J_("NgControlFlow");let r=nn(),i=qm(),o=y2(r,zi+t),s=0;if(ya(r,i,e)){let a=Do(null);try{if(B7(o,s),e!==-1){let l=_2(r[an],zi+e),c=H_(o,l.tView.ssrId),u=MD(r,l,n,{dehydratedView:c});OD(o,u,s,V_(l,c))}}finally{Do(a)}}else{let a=V7(o,s);a!==void 0&&(a[Ao]=n)}}var g2=class{constructor(e,n,r){this.lContainer=e,this.$implicit=n,this.$index=r}get $count(){return this.lContainer.length-Xo}};function Mr(t){return t}function tC(t,e){return e}var v2=class{constructor(e,n,r){this.hasEmptyBlock=e,this.trackByFn=n,this.liveCollection=r}};function Gn(t,e,n,r,i,o,s,a,l,c,u){J_("NgControlFlow");let d=l!==void 0,h=nn(),f=a?s.bind(h[wa][Ao]):s,p=new v2(d,f);h[zi+t]=p,rn(t+1,e,n,r,i,o),d&&rn(t+2,l,c,u)}var w2=class extends m2{constructor(e,n,r){super(),this.lContainer=e,this.hostLView=n,this.templateTNode=r,this.needsIndexUpdate=!1}get length(){return this.lContainer.length-Xo}at(e){return this.getLView(e)[Ao].$implicit}attach(e,n){let r=n[A_];this.needsIndexUpdate||=e!==this.length,OD(this.lContainer,n,e,V_(this.templateTNode,r))}detach(e){return this.needsIndexUpdate||=e!==this.length-1,ebe(this.lContainer,e)}create(e,n){let r=H_(this.lContainer,this.templateTNode.tView.ssrId);return MD(this.hostLView,this.templateTNode,new g2(this.lContainer,n,e),{dehydratedView:r})}destroy(e){xD(e[an],e)}updateValue(e,n){this.getLView(e)[Ao].$implicit=n}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[Ao].$index=e}getLView(e){return tbe(this.lContainer,e)}};function zn(t){let e=Do(null),n=Zc();try{let r=nn(),i=r[an],o=r[n];if(o.liveCollection===void 0){let a=n+1,l=y2(r,a),c=_2(i,a);o.liveCollection=new w2(l,r,c)}else o.liveCollection.reset();let s=o.liveCollection;if(jxe(s,t,o.trackByFn),s.updateIndexes(),o.hasEmptyBlock){let a=qm(),l=s.length===0;if(ya(r,a,l)){let c=n+2,u=y2(r,c);if(l){let d=_2(i,c),h=H_(u,d.tView.ssrId),f=MD(r,d,void 0,{dehydratedView:h});OD(u,f,0,V_(d,h))}else B7(u,0)}}}finally{Do(e)}}function y2(t,e){return t[e]}function ebe(t,e){return k_(t,e)}function tbe(t,e){return V7(t,e)}function _2(t,e){return k2(t,e)}function nbe(t,e,n,r,i,o){let s=e.consts,a=Vm(s,i),l=$0(e,t,2,r,a);return vL(e,n,l,Vm(s,o)),l.attrs!==null&&nD(l,l.attrs,!1),l.mergedAttrs!==null&&nD(l,l.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,l),l}function W(t,e,n,r){let i=nn(),o=Wr(),s=zi+t,a=i[ar],l=o.firstCreatePass?nbe(s,o,i,e,n,r):o.data[s],c=rbe(o,i,l,a,e,t);i[s]=c;let u=pD(l);return Kc(l,!0),n7(a,c,l),(l.flags&32)!==32&&yD()&&TD(o,i,c,l),y1e()===0&&Xc(c,i),_1e(),u&&(mL(o,i,l),fL(o,l,i)),r!==null&&pL(i,l),W}function V(){let t=xs();L2()?H2():(t=t.parent,Kc(t,!1));let e=t;S1e(e)&&E1e(),C1e();let n=Wr();return n.firstCreatePass&&(CD(n,t),P2(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&F1e(e)&&f2(n,e,nn(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&L1e(e)&&f2(n,e,nn(),e.stylesWithoutHost,!1),V}function at(t,e,n,r){return W(t,e,n,r),V(),at}var rbe=(t,e,n,r,i,o)=>(_D(!0),rL(r,i,O1e()));function ibe(t,e,n,r,i){let o=e.consts,s=Vm(o,r),a=$0(e,t,8,"ng-container",s);s!==null&&nD(a,s,!0);let l=Vm(o,i);return vL(e,n,a,l),e.queries!==null&&e.queries.elementStart(e,a),a}function ea(t,e,n){let r=nn(),i=Wr(),o=t+zi,s=i.firstCreatePass?ibe(o,i,r,e,n):i.data[o];Kc(s,!0);let a=obe(i,r,s,t);return r[o]=a,yD()&&TD(i,r,a,s),Xc(a,r),pD(s)&&(mL(i,r,s),fL(i,s,r)),n!=null&&pL(r,s),ea}function ta(){let t=xs(),e=Wr();return L2()?H2():(t=t.parent,Kc(t,!1)),e.firstCreatePass&&(CD(e,t),P2(t)&&e.queries.elementEnd(t)),ta}var obe=(t,e,n,r)=>(_D(!0),j9(e[ar],""));function Fn(){return nn()}function G0(t,e,n){let r=nn(),i=qm();if(ya(r,i,e)){let o=Wr(),s=G_();Z_(o,s,r,t,e,r[ar],n,!0)}return G0}var Nm=void 0;function sbe(t){let e=t,n=Math.floor(Math.abs(t)),r=t.toString().replace(/^[^.]*\.?/,"").length;return n===1&&r===0?1:5}var abe=["en",[["a","p"],["AM","PM"],Nm],[["AM","PM"],Nm,Nm],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Nm,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Nm,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Nm,"{1} 'at' {0}",Nm],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",sbe],bF={};function nC(t){let e=lbe(t),n=wz(e);if(n)return n;let r=e.split("-")[0];if(n=wz(r),n)return n;if(r==="en")return abe;throw new Je(701,!1)}function j7(t){return nC(t)[md.PluralCase]}function wz(t){return t in bF||(bF[t]=va.ng&&va.ng.common&&va.ng.common.locales&&va.ng.common.locales[t]),bF[t]}var md=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(md||{});function lbe(t){return t.toLowerCase().replace(/_/g,"-")}var cbe=["zero","one","two","few","many"];function ube(t,e){let n=j7(e)(parseInt(t,10)),r=cbe[n];return r!==void 0?r:"other"}var sD="en-US";var $7={marker:"element"},G7={marker:"ICU"},ld=function(t){return t[t.SHIFT=2]="SHIFT",t[t.APPEND_EAGERLY=1]="APPEND_EAGERLY",t[t.COMMENT=2]="COMMENT",t}(ld||{}),z7=sD;function dbe(t){kCe(t,"Expected localeId to be defined"),typeof t=="string"&&(z7=t.toLowerCase().replace(/_/g,"-"))}function hbe(){return z7}function Y7(t,e,n){let r=e.insertBeforeIndex,i=Array.isArray(r)?r[0]:r;return i===null?K9(t,e,n):qa(n[i])}function q7(t,e,n,r,i){let o=e.insertBeforeIndex;if(Array.isArray(o)){let s=r,a=null;if(e.type&3||(a=s,s=i),s!==null&&e.componentOffset===-1)for(let l=1;l<o.length;l++){let c=n[o[l]];jm(t,s,c,a,!1)}}}function K7(t,e){if(t.push(e),t.length>1)for(let n=t.length-2;n>=0;n--){let r=t[n];X7(r)||fbe(r,e)&&mbe(r)===null&&pbe(r,e.index)}}function X7(t){return!(t.type&64)}function fbe(t,e){return X7(e)||t.index>e.index}function mbe(t){let e=t.insertBeforeIndex;return Array.isArray(e)?e[0]:e}function pbe(t,e){let n=t.insertBeforeIndex;Array.isArray(n)?n[0]=e:(Z9(Y7,q7),t.insertBeforeIndex=e)}function b_(t,e){let n=t.data[e];return n===null||typeof n=="string"?null:n.hasOwnProperty("currentCaseLViewIndex")?n:n.value}function gbe(t,e,n){let r=t.data[e];r===null?t.data[e]=n:r.value=n}function vbe(t,e){let n=t.insertBeforeIndex;n===null?(Z9(Y7,q7),n=t.insertBeforeIndex=[null,e]):(PCe(Array.isArray(n),!0,"Expecting array here"),n.push(e))}function wbe(t,e,n){let r=hL(t,n,64,null,null);return K7(e,r),r}function ND(t,e){let n=e[t.currentCaseLViewIndex];return n===null?n:n<0?~n:n}function ybe(t){return t>>>17}function _be(t){return(t&131070)>>>1}function Cbe(t,e,n){return t|e<<17|n<<1}var B_=0,T_=0;function Sbe(t){t&&(B_=B_|1<<Math.min(T_,31)),T_++}function Ebe(t,e,n){if(T_>0){let r=t.data[n],i=Array.isArray(r)?r:r.update,o=B2()-T_-1;Q7(t,e,i,o,B_)}B_=0,T_=0}function xbe(t,e,n,r){let i=t[ar];for(let o=0;o<e.length;o++){let s=e[o++],a=e[o],l=(s&ld.COMMENT)===ld.COMMENT,c=(s&ld.APPEND_EAGERLY)===ld.APPEND_EAGERLY,u=s>>>ld.SHIFT,d=t[u];d===null&&(d=t[u]=l?i.createComment(a):nL(i,a)),c&&n!==null&&jm(i,n,d,r,!1)}}function Z7(t,e,n,r){let i=n[ar],o=null,s;for(let a=0;a<e.length;a++){let l=e[a];if(typeof l=="string"){let c=e[++a];n[c]===null&&(n[c]=nL(i,l))}else if(typeof l=="number")switch(l&1){case 0:let c=ybe(l);o===null&&(o=c,s=bD(i,r));let u,d;if(c===o?(u=r,d=s):(u=null,d=qa(n[c])),d!==null){let g=_be(l),w=n[g];jm(i,d,w,u,!1);let _=b_(t,g);if(_!==null&&typeof _=="object"){let S=ND(_,n);S!==null&&Z7(t,_.create[S],n,n[_.anchorIdx])}}break;case 1:let h=l>>>1,f=e[++a],p=e[++a];wL(i,gD(h,n),null,null,f,p,null);break;default:}else switch(l){case G7:let c=e[++a],u=e[++a];if(n[u]===null){let f=n[u]=j9(i,c);Xc(f,n)}break;case $7:let d=e[++a],h=e[++a];if(n[h]===null){let f=n[h]=rL(i,d,null);Xc(f,n)}break;default:}}}function Q7(t,e,n,r,i){for(let o=0;o<n.length;o++){let s=n[o],a=n[++o];if(s&i){let l="";for(let c=o+1;c<=o+a;c++){let u=n[c];if(typeof u=="string")l+=u;else if(typeof u=="number")if(u<0)l+=zc(e[r-u]);else{let d=u>>>2;switch(u&3){case 1:let h=n[++c],f=n[++c],p=t.data[d];typeof p=="string"?wL(e[ar],e[d],null,p,h,l,f):Z_(t,p,e,h,l,e[ar],f,!1);break;case 0:let g=e[d];g!==null&&W9(e[ar],g,l);break;case 2:bbe(t,b_(t,d),e,l);break;case 3:yz(t,b_(t,d),r,e);break}}}}else{let l=n[o+1];if(l>0&&(l&3)===3){let c=l>>>2,u=b_(t,c);e[u.currentCaseLViewIndex]<0&&yz(t,u,r,e)}}o+=a}}function yz(t,e,n,r){let i=r[e.currentCaseLViewIndex];if(i!==null){let o=B_;i<0&&(i=r[e.currentCaseLViewIndex]=~i,o=-1),Q7(t,r,e.update[i],n,o)}}function bbe(t,e,n,r){let i=Tbe(e,r);if(ND(e,n)!==i&&(J7(t,e,n),n[e.currentCaseLViewIndex]=i===null?null:~i,i!==null)){let s=n[e.anchorIdx];s&&Z7(t,e.create[i],n,s)}}function J7(t,e,n){let r=ND(e,n);if(r!==null){let i=e.remove[r];for(let o=0;o<i.length;o++){let s=i[o];if(s>0){let a=gD(s,n);a!==null&&J9(n[ar],a)}else J7(t,b_(t,~s),n)}}}function Tbe(t,e){let n=t.cases.indexOf(e);if(n===-1)switch(t.type){case 1:{let r=ube(e,hbe());n=t.cases.indexOf(r),n===-1&&r!=="other"&&(n=t.cases.indexOf("other"));break}case 0:{n=t.cases.indexOf("other");break}}return n===-1?null:n}function Rbe(){let t=[],e=-1,n,r;function i(a,l){for(n=l;t.length;)t.pop();return o(a.value,l),s}function o(a,l){e=0;let c=ND(a,l);c!==null?r=a.remove[c]:r=Ss}function s(){if(e<r.length){let a=r[e++];if(a>0)return n[a];{t.push(e,r);let l=~a,c=n[an].data[l];return o(c,n),s()}}else return t.length===0?null:(r=t.pop(),e=t.pop(),s())}return i}var aD=/(\d+):?\d*/gi;var Dbe=/(\d+)/,eY=/^\s*(\d+:?\d*)\s*,\s*(select|plural)\s*,/,R_="\uFFFD",Ibe=/\/?\*(\d+:\d+)/gi,Abe=/(\/?[#*]\d+):?\d*/gi,Mbe=/\uE500/g;function Obe(t){return t.replace(Mbe," ")}function Nbe(t,e,n,r,i,o){let s=N_(),a=[],l=[],c=[[]];i=Fbe(i,o);let u=Obe(i).split(Abe);for(let d=0;d<u.length;d++){let h=u[d];if(d&1){let f=h.charCodeAt(0)===47,p=h.charCodeAt(f?1:0),g=zi+Number.parseInt(h.substring(f?2:1));if(f)c.shift(),Kc(N_(),!1);else{let w=wbe(t,c[0],g);c.unshift([]),Kc(w,!0)}}else{let f=C2(h);for(let p=0;p<f.length;p++){let g=f[p];if(p&1){let w=g;if(typeof w!="object")throw new Error(`Unable to parse ICU expression in "${i}" message.`);let S=tY(t,s,c[0],n,a,"",!0).index;rY(t,n,l,e,w,S)}else{let w=g;w!==""&&Pbe(t,s,c[0],a,l,n,w)}}}}t.data[r]={create:a,update:l}}function tY(t,e,n,r,i,o,s){let a=X_(t,r,1,null),l=a<<ld.SHIFT,c=N_();e===c&&(c=null),c===null&&(l|=ld.APPEND_EAGERLY),s&&(l|=ld.COMMENT,ySe(Rbe)),i.push(l,o===null?"":o);let u=hL(t,a,s?32:1,o===null?"":o,null);K7(n,u);let d=u.index;return Kc(u,!1),c!==null&&e!==c&&vbe(c,d),u}function Pbe(t,e,n,r,i,o,s){let a=s.match(aD),l=tY(t,e,n,o,r,a?null:s,!1);a&&UR(i,s,l.index,null,0,null)}function UR(t,e,n,r,i,o){let s=t.length,a=s+1;t.push(null,null);let l=s+2,c=e.split(aD),u=0;for(let d=0;d<c.length;d++){let h=c[d];if(d&1){let f=i+parseInt(h,10);t.push(-1-f),u=u|nY(f)}else h!==""&&t.push(h)}return t.push(n<<2|(r?1:0)),r&&t.push(r,o),t[s]=u,t[a]=t.length-l,u}function nY(t){return 1<<Math.min(t,31)}function kbe(t){return t===-1}function _z(t){let e,n="",r=0,i=!1,o;for(;(e=Ibe.exec(t))!==null;)i?e[0]===`${R_}/*${o}${R_}`&&(r=e.index,i=!1):(n+=t.substring(r,e.index+e[0].length),o=e[1],i=!0);return n+=t.slice(r),n}function Fbe(t,e){if(kbe(e))return _z(t);{let n=t.indexOf(`:${e}${R_}`)+2+e.toString().length,r=t.search(new RegExp(`${R_}\\/\\*\\d+:${e}${R_}`));return _z(t.substring(n,r))}}function rY(t,e,n,r,i,o){let s=0,a={type:i.type,currentCaseLViewIndex:X_(t,e,1,null),anchorIdx:o,cases:[],create:[],remove:[],update:[]};Bbe(n,i,o),gbe(t,o,a);let l=i.values;for(let c=0;c<l.length;c++){let u=l[c],d=[];for(let h=0;h<u.length;h++){let f=u[h];if(typeof f!="string"){let p=d.push(f)-1;u[h]=`<!--\uFFFD${p}\uFFFD-->`}}s=Hbe(t,a,e,n,r,i.cases[c],u.join(""),d)|s}s&&Ube(n,s,o)}function Lbe(t){let e=[],n=[],r=1,i=0;t=t.replace(eY,function(s,a,l){return l==="select"?r=0:r=1,i=parseInt(a.slice(1),10),""});let o=C2(t);for(let s=0;s<o.length;){let a=o[s++].trim();r===1&&(a=a.replace(/\s*(?:=)?(\w+)\s*/,"$1")),a.length&&e.push(a);let l=C2(o[s++]);e.length>n.length&&n.push(l)}return{type:r,mainBinding:i,cases:e,values:n}}function C2(t){if(!t)return[];let e=0,n=[],r=[],i=/[{}]/g;i.lastIndex=0;let o;for(;o=i.exec(t);){let a=o.index;if(o[0]=="}"){if(n.pop(),n.length==0){let l=t.substring(e,a);eY.test(l)?r.push(Lbe(l)):r.push(l),e=a+1}}else{if(n.length==0){let l=t.substring(e,a);r.push(l),e=a+1}n.push("{")}}let s=t.substring(e);return r.push(s),r}function Hbe(t,e,n,r,i,o,s,a){let l=[],c=[],u=[];e.cases.push(o),e.create.push(l),e.remove.push(c),e.update.push(u);let h=LSe(k9()).getInertBodyElement(s),f=qSe(h)||h;return f?iY(t,e,n,r,l,c,u,f,i,a,0):0}function iY(t,e,n,r,i,o,s,a,l,c,u){let d=0,h=a.firstChild;for(;h;){let f=X_(t,n,1,null);switch(h.nodeType){case Node.ELEMENT_NODE:let p=h,g=p.tagName.toLowerCase();if($Se.hasOwnProperty(g)){TF(i,$7,g,l,f),t.data[f]=g;let x=p.attributes;for(let P=0;P<x.length;P++){let k=x.item(P),b=k.name.toLowerCase();!!k.value.match(aD)?YSe.hasOwnProperty(b)&&(o7[b]?UR(s,k.value,f,k.name,0,aL):UR(s,k.value,f,k.name,0,null)):Wbe(i,f,k)}d=iY(t,e,n,r,i,o,s,h,f,c,u+1)|d,Cz(o,f,u)}break;case Node.TEXT_NODE:let w=h.textContent||"",_=w.match(aD);TF(i,null,_?"":w,l,f),Cz(o,f,u),_&&(d=UR(s,w,f,null,0,null)|d);break;case Node.COMMENT_NODE:let S=Dbe.exec(h.textContent||"");if(S){let x=parseInt(S[1],10),P=c[x];TF(i,G7,"",l,f),rY(t,n,r,l,P,f),Vbe(o,f,u)}break}h=h.nextSibling}return d}function Cz(t,e,n){n===0&&t.push(e)}function Vbe(t,e,n){n===0&&(t.push(~e),t.push(e))}function Bbe(t,e,n){t.push(nY(e.mainBinding),2,-1-e.mainBinding,n<<2|2)}function Ube(t,e,n){t.push(e,1,n<<2|3)}function TF(t,e,n,r,i){e!==null&&t.push(e),t.push(n,i,Cbe(0,r,i))}function Wbe(t,e,n){t.push(e<<1|1,n.name,n.value)}function jbe(t,e,n=-1){let r=Wr(),i=nn(),o=zi+t,s=Vm(r.consts,e),a=N_();if(r.firstCreatePass&&Nbe(r,a===null?0:a.index,i,o,s,n),r.type===2){let h=i[wa];h[tn]|=32}else i[tn]|=32;let l=r.data[o],c=a===i[Qs]?null:a,u=z9(r,c,i),d=a&&a.type&8?i[a.index]:null;xbe(i,l.create,u,d),o9(!0)}function $be(){o9(!1)}function Lh(t,e,n){jbe(t,e,n),$be()}function bL(t){let e=nn();return Sbe(ya(e,qm(),t)),bL}function oY(t){Ebe(Wr(),nn(),t+zi)}function Xm(t){return!!t&&typeof t.then=="function"}function sY(t){return!!t&&typeof t.subscribe=="function"}function Ue(t,e,n,r){let i=nn(),o=Wr(),s=xs();return zbe(o,i,i[ar],s,t,e,r),Ue}function Gbe(t,e,n,r){let i=t.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===n&&i[o+1]===r){let a=e[M_],l=i[o+2];return a.length>l?a[l]:null}typeof s=="string"&&(o+=2)}return null}function zbe(t,e,n,r,i,o,s){let a=pD(r),c=t.firstCreatePass&&_7(t),u=e[Ao],d=y7(e),h=!0;if(r.type&3||s){let g=Xa(r,e),w=s?s(g):g,_=d.length,S=s?P=>s(qa(P[r.index])):r.index,x=null;if(!s&&a&&(x=Gbe(t,e,i,r.index)),x!==null){let P=x.__ngLastListenerFn__||x;P.__ngNextListenerFn__=o,x.__ngLastListenerFn__=o,h=!1}else{o=Ez(r,e,u,o,!1);let P=n.listen(w,i,o);d.push(o,P),c&&c.push(i,S,_,_+1)}}else o=Ez(r,e,u,o,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let w=0;w<g;w+=2){let _=p[w],S=p[w+1],k=e[_][S].subscribe(o),b=d.length;d.push(o,k),c&&c.push(i,r.index,b,-(b+1))}}}function Sz(t,e,n,r){try{return $c(6,e,n),n(r)!==!1}catch(i){return C7(t,i),!1}finally{$c(7,e,n)}}function Ez(t,e,n,r,i){return function o(s){if(s===Function)return r;let a=t.componentOffset>-1?kh(t.index,e):e;CL(a);let l=Sz(e,n,r,s),c=o.__ngNextListenerFn__;for(;c;)l=Sz(e,n,c,s)&&l,c=c.__ngNextListenerFn__;return i&&l===!1&&s.preventDefault(),l}}function Le(t=1){return M1e(t)}function Ybe(t,e){let n=null,r=QCe(t);for(let i=0;i<e.length;i++){let o=e[i];if(o==="*"){n=i;continue}if(r===null?Vz(t,o,!0):t1e(r,o))return i}return n}function TL(t){let e=nn()[wa][Qs];if(!e.projection){let n=t?t.length:1,r=e.projection=b9(n,null),i=r.slice(),o=e.child;for(;o!==null;){let s=t?Ybe(o,t):0;s!==null&&(i[s]?i[s].projectionNext=o:r[s]=o,i[s]=o),o=o.next}}}function RL(t,e=0,n){let r=nn(),i=Wr(),o=$0(i,zi+t,16,null,n||null);o.projection===null&&(o.projection=e),H2(),(!r[A_]||r9())&&(o.flags&32)!==32&&ASe(i,r,o)}function Oi(t,e,n){return aY(t,"",e,"",n),Oi}function aY(t,e,n,r,i){let o=nn(),s=M7(o,e,n,r);if(s!==Qo){let a=Wr(),l=G_();Z_(a,l,o,t,s,o[ar],i,!1)}return aY}function Jo(t,e,n,r,i,o,s){let a=nn(),l=O7(a,e,n,r,i,o);if(l!==Qo){let c=Wr(),u=G_();Z_(c,u,a,t,l,a[ar],s,!1)}return Jo}function qbe(t,e,n,r){n>=t.data.length&&(t.data[n]=null,t.blueprint[n]=null),e[n]=r}function rC(t){let e=x1e();return Zz(e,zi+t)}function re(t,e=""){let n=nn(),r=Wr(),i=t+zi,o=r.firstCreatePass?$0(r,i,1,e,null):r.data[i],s=Kbe(r,n,o,e,t);n[i]=s,yD()&&TD(r,n,s,o),Kc(o,!1)}var Kbe=(t,e,n,r,i)=>(_D(!0),nL(e[ar],r));function Hn(t){return Ki("",t,""),Hn}function Ki(t,e,n){let r=nn(),i=M7(r,t,e,n);return i!==Qo&&_L(r,Zc(),i),Ki}function z0(t,e,n,r,i){let o=nn(),s=O7(o,t,e,n,r,i);return s!==Qo&&_L(o,Zc(),s),z0}function DL(t,e,n,r,i,o,s){let a=nn(),l=_xe(a,t,e,n,r,i,o,s);return l!==Qo&&_L(a,Zc(),l),DL}function Xbe(t,e,n){let r=Wr();if(r.firstCreatePass){let i=Nh(t);S2(n,r.data,r.blueprint,i,!0),S2(e,r.data,r.blueprint,i,!1)}}function S2(t,e,n,r,i){if(t=Cs(t),Array.isArray(t))for(let o=0;o<t.length;o++)S2(t[o],e,n,r,i);else{let o=Wr(),s=nn(),a=xs(),l=H0(t)?t:Cs(t.provide),c=M9(t),u=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(H0(t)||!t.multi){let f=new Um(c,i,je),p=DF(l,e,i?u:u+h,d);p===-1?(HF(KR(a,s),o,l),RF(o,t,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),s.push(f)):(n[p]=f,s[p]=f)}else{let f=DF(l,e,u+h,d),p=DF(l,e,u,u+h),g=f>=0&&n[f],w=p>=0&&n[p];if(i&&!w||!i&&!g){HF(KR(a,s),o,l);let _=Jbe(i?Qbe:Zbe,n.length,i,r,c);!i&&w&&(n[p].providerFactory=_),RF(o,t,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(_),s.push(_)}else{let _=lY(n[i?p:f],c,!i&&r);RF(o,t,f>-1?f:p,_)}!i&&r&&w&&n[p].componentProviders++}}}function RF(t,e,n,r){let i=H0(e),o=rSe(e);if(i||o){let l=(o?Cs(e.useClass):e).prototype.ngOnDestroy;if(l){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let u=c.indexOf(n);u===-1?c.push(n,[r,l]):c[u+1].push(r,l)}else c.push(n,l)}}}function lY(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function DF(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function Zbe(t,e,n,r){return E2(this.multi,[])}function Qbe(t,e,n,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=Wm(n,n[an],this.providerFactory.index,r);o=a.slice(0,s),E2(i,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],E2(i,o);return o}function E2(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function Jbe(t,e,n,r,i){let o=new Um(t,n,je);return o.multi=[],o.index=e,o.componentProviders=0,lY(o,i,r&&!n),o}function ao(t,e=[]){return n=>{n.providersResolver=(r,i)=>Xbe(r,i?i(t):t,e)}}var Ph=class{},U_=class{};var x2=class extends Ph{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new rD(this);let i=jz(e);this._bootstrapComponents=F9(i.bootstrap),this._r3Injector=N9(e,n,[{provide:Ph,useValue:this},{provide:DD,useValue:this.componentFactoryResolver},...r],Ko(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},b2=class extends U_{constructor(e){super(),this.moduleType=e}create(e){return new x2(this.moduleType,e,[])}};var lD=class extends Ph{constructor(e){super(),this.componentFactoryResolver=new rD(this),this.instance=null;let n=new P_([...e.providers,{provide:Ph,useValue:this},{provide:DD,useValue:this.componentFactoryResolver}],e.parent||K2(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function IL(t,e,n=null){return new lD({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var eTe=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=D9(!1,r.type),o=i.length>0?IL([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,o)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=ht({token:e,providedIn:"environment",factory:()=>new e(kt(Es))});let t=e;return t})();function qt(t){J_("NgStandalone"),t.getStandaloneInjector=e=>e.get(eTe).getOrCreateStandaloneInjector(t)}function Ei(t,e,n){let r=V2()+t,i=nn();return i[r]===Qo?I7(i,r,n?e.call(n):e()):wxe(i,r)}function cY(t,e,n,r){return uY(nn(),V2(),t,e,n,r)}function tTe(t,e){let n=t[e];return n===Qo?void 0:n}function uY(t,e,n,r,i,o){let s=e+n;return ya(t,s,i)?I7(t,s+1,o?r.call(o,i):r(i)):tTe(t,s+1)}function Ts(t,e){let n=Wr(),r,i=t+zi;n.firstCreatePass?(r=nTe(e,n.pipeRegistry),n.data[i]=r,r.onDestroy&&(n.destroyHooks??=[]).push(i,r.onDestroy)):r=n.data[i];let o=r.factory||(r.factory=Hm(r.type,!0)),s,a=Zs(je);try{let l=qR(!1),c=o();return qR(l),qbe(n,nn(),i,c),c}finally{Zs(a)}}function nTe(t,e){if(e)for(let n=e.length-1;n>=0;n--){let r=e[n];if(t===r.name)return r}}function Rs(t,e,n){let r=t+zi,i=nn(),o=Zz(i,r);return rTe(i,r)?uY(i,V2(),e,o.transform,n,o):o.transform(n)}function rTe(t,e){return t[an].data[e].pure}function iTe(){return this._results[Symbol.iterator]()}var T2=class t{get changes(){return this._changes||(this._changes=new hr)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;let n=t.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=iTe)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;let r=X1e(e);(this._changesDetected=!K1e(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}},Ka=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=aTe;let t=e;return t})(),oTe=Ka,sTe=class extends oTe{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=MD(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new zm(i)}};function aTe(){return PD(xs(),nn())}function PD(t,e){return t.type&4?new sTe(e,t,j0(t,e)):null}var R2=class t{constructor(e){this.queryList=e,this.matches=null}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},D2=class t{constructor(e=[]){this.queries=e}createEmbeddedView(e){let n=e.queries;if(n!==null){let r=e.contentQueries!==null?e.contentQueries[0]:n.length,i=[];for(let o=0;o<r;o++){let s=n.getByIndex(o),a=this.queries[s.indexInDeclarationView];i.push(a.clone())}return new t(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)mY(e,n).matches!==null&&this.queries[n].setDirty()}},cD=class{constructor(e,n,r=null){this.predicate=e,this.flags=n,this.read=r}},I2=class t{constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){let i=n!==null?n.length:0,o=this.getByIndex(r).embeddedTView(e,i);o&&(o.indexInDeclarationView=r,n!==null?n.push(o):n=[o])}return n!==null?new t(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},A2=class t{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new t(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let n=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==n;)r=r.parent;return n===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let o=r[i];this.matchTNodeWithReadOption(e,n,lTe(n,o)),this.matchTNodeWithReadOption(e,n,HR(n,e,o,!1,!1))}else r===Ka?n.type&4&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,HR(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===Mi||i===Kl||i===Ka&&n.type&4)this.addMatch(n.index,-2);else{let o=HR(n,e,i,!1,!1);o!==null&&this.addMatch(n.index,o)}else this.addMatch(n.index,r)}}addMatch(e,n){this.matches===null?this.matches=[e,n]:this.matches.push(e,n)}};function lTe(t,e){let n=t.localNames;if(n!==null){for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1]}return null}function cTe(t,e){return t.type&11?j0(t,e):t.type&4?PD(t,e):null}function uTe(t,e,n,r){return n===-1?cTe(e,t):n===-2?dTe(t,e,r):Wm(t,t[an],n,e)}function dTe(t,e,n){if(n===Mi)return j0(e,t);if(n===Ka)return PD(e,t);if(n===Kl)return W7(e,t)}function dY(t,e,n,r){let i=e[Yc].queries[r];if(i.matches===null){let o=t.data,s=n.matches,a=[];for(let l=0;l<s.length;l+=2){let c=s[l];if(c<0)a.push(null);else{let u=o[c];a.push(uTe(e,u,s[l+1],n.metadata.read))}}i.matches=a}return i.matches}function M2(t,e,n,r){let i=t.queries.getByIndex(n),o=i.matches;if(o!==null){let s=dY(t,e,i,n);for(let a=0;a<o.length;a+=2){let l=o[a];if(l>0)r.push(s[a/2]);else{let c=o[a+1],u=e[-l];for(let d=Xo;d<u.length;d++){let h=u[d];h[$_]===h[Ai]&&M2(h[an],h,c,r)}if(u[F0]!==null){let d=u[F0];for(let h=0;h<d.length;h++){let f=d[h];M2(f[an],f,c,r)}}}}}return r}function pd(t){let e=nn(),n=Wr(),r=s9();U2(r+1);let i=mY(n,r);if(t.dirty&&m1e(e)===((i.metadata.flags&2)===2)){if(i.matches===null)t.reset([]);else{let o=i.crossesNgTemplate?M2(n,e,r,[]):dY(n,e,i,r);t.reset(o,oEe),t.notifyOnChanges()}return!0}return!1}function kD(t,e,n){let r=Wr();r.firstCreatePass&&(fY(r,new cD(t,e,n),-1),(e&2)===2&&(r.staticViewQueries=!0)),hY(r,nn(),e)}function Y0(t,e,n,r){let i=Wr();if(i.firstCreatePass){let o=xs();fY(i,new cD(e,n,r),o.index),fTe(i,t),(n&2)===2&&(i.staticContentQueries=!0)}hY(i,nn(),n)}function gd(){return hTe(nn(),s9())}function hTe(t,e){return t[Yc].queries[e].queryList}function hY(t,e,n){let r=new T2((n&4)===4);EEe(t,e,r,r.destroy),e[Yc]===null&&(e[Yc]=new D2),e[Yc].queries.push(new R2(r))}function fY(t,e,n){t.queries===null&&(t.queries=new I2),t.queries.track(new A2(e,n))}function fTe(t,e){let n=t.contentQueries||(t.contentQueries=[]),r=n.length?n[n.length-1]:-1;e!==r&&n.push(t.queries.length-1,e)}function mY(t,e){return t.queries.getByIndex(e)}function AL(t,e){return PD(t,e)}var pY=new Ut("Application Initializer"),gY=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=qe(pY,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let o of this.appInits){let s=o();if(Xm(s))r.push(s);else if(sY(s)){let a=new Promise((l,c)=>{s.subscribe({complete:l,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(o=>{this.reject(o)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),FD=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function mTe(){return typeof $localize<"u"&&$localize.locale||sD}var q0=new Ut("LocaleId",{providedIn:"root",factory:()=>qe(q0,On.Optional|On.SkipSelf)||mTe()});var K0=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new io(!1)}add(){this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),O2=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},ML=(()=>{let e=class e{compileModuleSync(r){return new b2(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),o=jz(r),s=F9(o.declarations).reduce((a,l)=>{let c=km(l);return c&&a.push(new F_(c)),a},[]);return new O2(i,s)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var vY=new Ut("");var WR=null;var wY=new Ut("PlatformDestroyListeners"),LD=new Ut("appBootstrapListener");function pTe(){uG(()=>{throw new Je(600,!1)})}function gTe(t){return t.isBoundToModule}function vTe(t=[]){if(WR)return WR;let e=yTe(t);return WR=e,pTe(),wTe(e),e}function wTe(t){t.get(Z2,null)?.forEach(n=>n())}function yY(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,i=vTe(r),o=[bTe(),...n||[]],a=new lD({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,l=a.get(nr);return l.run(()=>{a.resolveInjectorInitializers();let c=a.get(ud,null),u;l.runOutsideAngular(()=>{u=l.onError.subscribe({next:f=>{c.handleError(f)}})});let d=()=>a.destroy(),h=i.get(wY);return h.add(d),a.onDestroy(()=>{u.unsubscribe(),h.delete(d)}),CTe(c,l,()=>{let f=a.get(gY);return f.runInitializers(),f.donePromise.then(()=>{let p=a.get(q0,sD);dbe(p||sD);let g=a.get(Jc);return e!==void 0&&g.bootstrap(e),g})})})}catch(e){return Promise.reject(e)}}function yTe(t=[],e){return Qc.create({name:e,providers:[{provide:ED,useValue:"platform"},{provide:wY,useValue:new Set([()=>WR=null])},...t]})}function _Te(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}function CTe(t,e,n){try{let r=n();return Xm(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var Jc=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=qe(_Y),this.zoneIsStable=qe(R7),this.componentTypes=[],this.components=[],this.isStable=qe(K0).hasPendingTasks.pipe(qo(r=>r?Wt(!1):this.zoneIsStable),S_(),IR()),this._injector=qe(Es)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let o=r instanceof JR;if(!this._injector.get(gY).done){let p="Cannot bootstrap as there are still asynchronous initializers running."+(!o&&Wz(r)?"":" Bootstrap components in the `ngDoBootstrap` method of the root module.");throw new Je(405,!1)}let a;o?a=r:a=this._injector.get(DD).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let l=gTe(a)?void 0:this._injector.get(Ph),c=i||a.selector,u=a.create(Qc.NULL,[],c,l),d=u.location.nativeElement,h=u.injector.get(vY,null);return h?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),IF(this.components,u),h?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new Je(101,!1);try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;IF(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(LD,[]);[...this._bootstrapListeners,...i].forEach(o=>o(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>IF(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new Je(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function IF(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var _Y=new Ut("",{providedIn:"root",factory:()=>qe(ud).handleError.bind(void 0)});function STe(){let t=qe(nr),e=qe(ud);return n=>t.runOutsideAngular(()=>e.handleError(n))}var ETe=(()=>{let e=class e{constructor(){this.zone=qe(nr),this.applicationRef=qe(Jc)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function xTe(t){return[{provide:nr,useFactory:t},{provide:Y_,multi:!0,useFactory:()=>{let e=qe(ETe,{optional:!0});return()=>e.initialize()}},{provide:_Y,useFactory:STe},{provide:R7,useFactory:D7}]}function bTe(t){let e=xTe(()=>new nr(_Te(t)));return U0([[],e])}function Hh(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}var PL=null;function wd(){return PL}function DY(t){PL||(PL=t)}var HD=class{},ci=new Ut("DocumentToken"),LL=(()=>{let e=class e{historyGo(r){throw new Error("Not implemented")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>qe(DTe))(),providedIn:"platform"});let t=e;return t})();var DTe=(()=>{let e=class e extends LL{constructor(){super(),this._doc=qe(ci),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return wd().getBaseHref(this._doc)}onPopState(r){let i=wd().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=wd().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,o){this._history.pushState(r,i,o)}replaceState(r,i,o){this._history.replaceState(r,i,o)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>new e)(),providedIn:"platform"});let t=e;return t})();function HL(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function CY(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function vd(t){return t&&t[0]!=="?"?"?"+t:t}var yd=(()=>{let e=class e{historyGo(r){throw new Error("Not implemented")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>qe(AY))(),providedIn:"root"});let t=e;return t})(),IY=new Ut("appBaseHref"),AY=(()=>{let e=class e extends yd{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??qe(ci).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return HL(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+vd(this._platformLocation.search),o=this._platformLocation.hash;return o&&r?`${i}${o}`:i}pushState(r,i,o,s){let a=this.prepareExternalUrl(o+vd(s));this._platformLocation.pushState(r,i,a)}replaceState(r,i,o,s){let a=this.prepareExternalUrl(o+vd(s));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(kt(LL),kt(IY,8))},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),VL=(()=>{let e=class e extends yd{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash;return i==null&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=HL(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,o,s){let a=this.prepareExternalUrl(o+vd(s));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,o,s){let a=this.prepareExternalUrl(o+vd(s));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(kt(LL),kt(IY,8))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),sC=(()=>{let e=class e{constructor(r){this._subject=new hr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=MTe(CY(SY(i))),this._locationStrategy.onPopState(o=>{this._subject.emit({url:this.path(!0),pop:!0,state:o.state,type:o.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+vd(i))}normalize(r){return e.stripTrailingSlash(ATe(this._basePath,SY(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",o=null){this._locationStrategy.pushState(o,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+vd(i)),o)}replaceState(r,i="",o=null){this._locationStrategy.replaceState(o,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+vd(i)),o)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(o=>o(r,i))}subscribe(r,i,o){return this._subject.subscribe({next:r,error:i,complete:o})}};e.normalizeQueryParams=vd,e.joinWithSlash=HL,e.stripTrailingSlash=CY,e.\u0275fac=function(i){return new(i||e)(kt(yd))},e.\u0275prov=ht({token:e,factory:()=>ITe(),providedIn:"root"});let t=e;return t})();function ITe(){return new sC(kt(yd))}function ATe(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function SY(t){return t.replace(/\/index.html$/,"")}function MTe(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}var MY=function(t){return t[t.Decimal=0]="Decimal",t[t.Percent=1]="Percent",t[t.Currency=2]="Currency",t[t.Scientific=3]="Scientific",t}(MY||{});var BL=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(BL||{}),UL=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(UL||{});var eu=function(t){return t[t.Decimal=0]="Decimal",t[t.Group=1]="Group",t[t.List=2]="List",t[t.PercentSign=3]="PercentSign",t[t.PlusSign=4]="PlusSign",t[t.MinusSign=5]="MinusSign",t[t.Exponential=6]="Exponential",t[t.SuperscriptingExponent=7]="SuperscriptingExponent",t[t.PerMille=8]="PerMille",t[t.Infinity=9]="Infinity",t[t.NaN=10]="NaN",t[t.TimeSeparator=11]="TimeSeparator",t[t.CurrencyDecimal=12]="CurrencyDecimal",t[t.CurrencyGroup=13]="CurrencyGroup",t}(eu||{});function OY(t,e,n){let r=nC(t),i=[r[md.DayPeriodsFormat],r[md.DayPeriodsStandalone]],o=EY(i,e);return EY(o,n)}function iC(t,e){let n=nC(t),r=n[md.NumberSymbols][e];if(typeof r>"u"){if(e===eu.CurrencyDecimal)return n[md.NumberSymbols][eu.Decimal];if(e===eu.CurrencyGroup)return n[md.NumberSymbols][eu.Group]}return r}function OTe(t,e){return nC(t)[md.NumberFormats][e]}function EY(t,e){for(let n=e;n>-1;n--)if(typeof t[n]<"u")return t[n];throw new Error("Locale data API: locale data undefined")}var NTe=/^(\d+)?\.((\d+)(-(\d+))?)?$/,xY=22,VD=".",oC="0",PTe=";",kTe=",",OL="#";function FTe(t,e,n,r,i,o,s=!1){let a="",l=!1;if(!isFinite(t))a=iC(n,eu.Infinity);else{let c=BTe(t);s&&(c=VTe(c));let u=e.minInt,d=e.minFrac,h=e.maxFrac;if(o){let S=o.match(NTe);if(S===null)throw new Error(`${o} is not a valid digit info`);let x=S[1],P=S[3],k=S[5];x!=null&&(u=NL(x)),P!=null&&(d=NL(P)),k!=null?h=NL(k):P!=null&&d>h&&(h=d)}UTe(c,d,h);let f=c.digits,p=c.integerLen,g=c.exponent,w=[];for(l=f.every(S=>!S);p<u;p++)f.unshift(0);for(;p<0;p++)f.unshift(0);p>0?w=f.splice(p,f.length):(w=f,f=[0]);let _=[];for(f.length>=e.lgSize&&_.unshift(f.splice(-e.lgSize,f.length).join(""));f.length>e.gSize;)_.unshift(f.splice(-e.gSize,f.length).join(""));f.length&&_.unshift(f.join("")),a=_.join(iC(n,r)),w.length&&(a+=iC(n,i)+w.join("")),g&&(a+=iC(n,eu.Exponential)+"+"+g)}return t<0&&!l?a=e.negPre+a+e.negSuf:a=e.posPre+a+e.posSuf,a}function LTe(t,e,n){let r=OTe(e,MY.Decimal),i=HTe(r,iC(e,eu.MinusSign));return FTe(t,i,e,eu.Group,eu.Decimal,n)}function HTe(t,e="-"){let n={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},r=t.split(PTe),i=r[0],o=r[1],s=i.indexOf(VD)!==-1?i.split(VD):[i.substring(0,i.lastIndexOf(oC)+1),i.substring(i.lastIndexOf(oC)+1)],a=s[0],l=s[1]||"";n.posPre=a.substring(0,a.indexOf(OL));for(let u=0;u<l.length;u++){let d=l.charAt(u);d===oC?n.minFrac=n.maxFrac=u+1:d===OL?n.maxFrac=u+1:n.posSuf+=d}let c=a.split(kTe);if(n.gSize=c[1]?c[1].length:0,n.lgSize=c[2]||c[1]?(c[2]||c[1]).length:0,o){let u=i.length-n.posPre.length-n.posSuf.length,d=o.indexOf(OL);n.negPre=o.substring(0,d).replace(/'/g,""),n.negSuf=o.slice(d+u).replace(/'/g,"")}else n.negPre=e+n.posPre,n.negSuf=n.posSuf;return n}function VTe(t){if(t.digits[0]===0)return t;let e=t.digits.length-t.integerLen;return t.exponent?t.exponent+=2:(e===0?t.digits.push(0,0):e===1&&t.digits.push(0),t.integerLen+=2),t}function BTe(t){let e=Math.abs(t)+"",n=0,r,i,o,s,a;for((i=e.indexOf(VD))>-1&&(e=e.replace(VD,"")),(o=e.search(/e/i))>0?(i<0&&(i=o),i+=+e.slice(o+1),e=e.substring(0,o)):i<0&&(i=e.length),o=0;e.charAt(o)===oC;o++);if(o===(a=e.length))r=[0],i=1;else{for(a--;e.charAt(a)===oC;)a--;for(i-=o,r=[],s=0;o<=a;o++,s++)r[s]=Number(e.charAt(o))}return i>xY&&(r=r.splice(0,xY-1),n=i-1,i=1),{digits:r,exponent:n,integerLen:i}}function UTe(t,e,n){if(e>n)throw new Error(`The minimum number of digits after fraction (${e}) is higher than the maximum (${n}).`);let r=t.digits,i=r.length-t.integerLen,o=Math.min(Math.max(e,i),n),s=o+t.integerLen,a=r[s];if(s>0){r.splice(Math.max(t.integerLen,s));for(let d=s;d<r.length;d++)r[d]=0}else{i=Math.max(0,i),t.integerLen=1,r.length=Math.max(1,s=o+1),r[0]=0;for(let d=1;d<s;d++)r[d]=0}if(a>=5)if(s-1<0){for(let d=0;d>s;d--)r.unshift(0),t.integerLen++;r.unshift(1),t.integerLen++}else r[s-1]++;for(;i<Math.max(0,o);i++)r.push(0);let l=o!==0,c=e+t.integerLen,u=r.reduceRight(function(d,h,f,p){return h=h+d,p[f]=h<10?h:h-10,l&&(p[f]===0&&f>=c?p.pop():l=!1),h>=10?1:0},0);u&&(r.unshift(u),t.integerLen++)}function NL(t){let e=parseInt(t);if(isNaN(e))throw new Error("Invalid integer literal when parsing "+t);return e}function BD(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,o]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(o)}return null}var kL=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},NY=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,o){this._viewContainer=r,this._template=i,this._differs=o,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(!1)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((o,s,a)=>{if(o.previousIndex==null)i.createEmbeddedView(this._template,new kL(o.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(s===null?void 0:s);else if(s!==null){let l=i.get(s);i.move(l,a),bY(l,o)}});for(let o=0,s=i.length;o<s;o++){let l=i.get(o).context;l.index=o,l.count=s,l.ngForOf=this._ngForOf}r.forEachIdentityChange(o=>{let s=i.get(o.currentIndex);bY(s,o)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(je(Kl),je(Ka),je(uL))},e.\u0275dir=kn({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function bY(t,e){t.context.$implicit=e.item}var PY=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new FL,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){TY("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){TY("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(je(Kl),je(Ka))},e.\u0275dir=kn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),FL=class{constructor(){this.$implicit=null,this.ngIf=null}};function TY(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Ko(e)}'.`)}var UD=(()=>{let e=class e{constructor(r){this._viewContainerRef=r,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(r){if(this._shouldRecreateView(r)){let i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet){this._viewRef=null;return}let o=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,o,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(r){return!!r.ngTemplateOutlet||!!r.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(r,i,o)=>this.ngTemplateOutletContext?Reflect.set(this.ngTemplateOutletContext,i,o):!1,get:(r,i,o)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,o)}})}};e.\u0275fac=function(i){return new(i||e)(je(Kl))},e.\u0275dir=kn({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Yi]});let t=e;return t})();function kY(t,e){return new Je(2100,!1)}var Vh=(()=>{let e=class e{transform(r){if(r==null)return null;if(typeof r!="string")throw kY(e,r);return r.toUpperCase()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=j_({name:"uppercase",type:e,pure:!0,standalone:!0});let t=e;return t})();var FY=(()=>{let e=class e{transform(r){return JSON.stringify(r,null,2)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275pipe=j_({name:"json",type:e,pure:!1,standalone:!0});let t=e;return t})();function WTe(t,e){return{key:t,value:e}}var LY=(()=>{let e=class e{constructor(r){this.differs=r,this.keyValues=[],this.compareFn=RY}transform(r,i=RY){if(!r||!(r instanceof Map)&&typeof r!="object")return null;this.differ||(this.differ=this.differs.find(r).create());let o=this.differ.diff(r),s=i!==this.compareFn;return o&&(this.keyValues=[],o.forEachItem(a=>{this.keyValues.push(WTe(a.key,a.currentValue))})),(o||s)&&(this.keyValues.sort(i),this.compareFn=i),this.keyValues}};e.\u0275fac=function(i){return new(i||e)(je(dL,16))},e.\u0275pipe=j_({name:"keyvalue",type:e,pure:!1,standalone:!0});let t=e;return t})();function RY(t,e){let n=t.key,r=e.key;if(n===r)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(n===null)return 1;if(r===null)return-1;if(typeof n=="string"&&typeof r=="string")return n<r?-1:1;if(typeof n=="number"&&typeof r=="number")return n-r;if(typeof n=="boolean"&&typeof r=="boolean")return n<r?-1:1;let i=String(n),o=String(r);return i==o?0:i<o?-1:1}var WD=(()=>{let e=class e{constructor(r){this._locale=r}transform(r,i,o){if(!jTe(r))return null;o=o||this._locale;try{let s=$Te(r);return LTe(s,o,i)}catch(s){throw kY(e,s.message)}}};e.\u0275fac=function(i){return new(i||e)(je(q0,16))},e.\u0275pipe=j_({name:"number",type:e,pure:!0,standalone:!0});let t=e;return t})();function jTe(t){return!(t==null||t===""||t!==t)}function $Te(t){if(typeof t=="string"&&!isNaN(Number(t)-parseFloat(t)))return Number(t);if(typeof t!="number")throw new Error(`${t} is not a number`);return t}var Mo=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({});let t=e;return t})(),WL="browser",GTe="server";function jL(t){return t===WL}function $L(t){return t===GTe}var X0=class{};var lC=class{},cC=class{},_d=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),o=i.toLowerCase(),s=n.slice(r+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let o=e.value;if(!o)this.headers.delete(n),this.normalizedNames.delete(n);else{let s=this.headers.get(n);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,s)}break}}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(o=>o.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var YL=class{encodeKey(e){return HY(e)}encodeValue(e){return HY(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function qTe(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let o=i.indexOf("="),[s,a]=o==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,o)),e.decodeValue(i.slice(o+1))],l=n.get(s)||[];l.push(a),n.set(s,l)}),n}var KTe=/%(\d[a-f0-9])/gi,XTe={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function HY(t){return encodeURIComponent(t).replace(KTe,(e,n)=>XTe[n]??e)}function jD(t){return`${t}`}var Wh=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new YL,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=qTe(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let r=e.fromObject[n],i=Array.isArray(r)?r.map(jD):[jD(r)];this.map.set(n,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(o=>{n.push({param:r,value:o,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(jD(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(jD(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var qL=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function ZTe(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function VY(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function BY(t){return typeof Blob<"u"&&t instanceof Blob}function UY(t){return typeof FormData<"u"&&t instanceof FormData}function QTe(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var aC=class t{constructor(e,n,r,i){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let o;if(ZTe(this.method)||i?(this.body=r!==void 0?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers||(this.headers=new _d),this.context||(this.context=new qL),!this.params)this.params=new Wh,this.urlWithParams=n;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),l=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+l+s}}}serializeBody(){return this.body===null?null:VY(this.body)||BY(this.body)||UY(this.body)||QTe(this.body)||typeof this.body=="string"?this.body:this.body instanceof Wh?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||UY(this.body)?null:BY(this.body)?this.body.type||null:VY(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Wh?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,o=e.body!==void 0?e.body:this.body,s=e.withCredentials!==void 0?e.withCredentials:this.withCredentials,a=e.reportProgress!==void 0?e.reportProgress:this.reportProgress,l=e.headers||this.headers,c=e.params||this.params,u=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),l)),e.setParams&&(c=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),c)),new t(n,r,o,{params:c,headers:l,context:u,reportProgress:a,responseType:i,withCredentials:s})}},tu=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(tu||{}),uC=class{constructor(e,n=200,r="OK"){this.headers=e.headers||new _d,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},$D=class t extends uC{constructor(e={}){super(e),this.type=tu.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},dC=class t extends uC{constructor(e={}){super(e),this.type=tu.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Uh=class extends uC{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}};function GL(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var ZL=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,o={}){let s;if(r instanceof aC)s=r;else{let c;o.headers instanceof _d?c=o.headers:c=new _d(o.headers);let u;o.params&&(o.params instanceof Wh?u=o.params:u=new Wh({fromObject:o.params})),s=new aC(r,i,o.body!==void 0?o.body:null,{headers:c,context:o.context,params:u,reportProgress:o.reportProgress,responseType:o.responseType||"json",withCredentials:o.withCredentials,transferCache:o.transferCache})}let a=Wt(s).pipe(Dh(c=>this.handler.handle(c)));if(r instanceof aC||o.observe==="events")return a;let l=a.pipe(Gi(c=>c instanceof dC));switch(o.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return l.pipe(dn(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return l.pipe(dn(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return l.pipe(dn(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return l.pipe(dn(c=>c.body))}case"response":return l;default:throw new Error(`Unreachable: unhandled observe type ${o.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new Wh().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,o={}){return this.request("PATCH",r,GL(o,i))}post(r,i,o={}){return this.request("POST",r,GL(o,i))}put(r,i,o={}){return this.request("PUT",r,GL(o,i))}};e.\u0275fac=function(i){return new(i||e)(kt(lC))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),JTe=/^\)\]\}',?\n/,eRe="X-Request-URL";function WY(t){if(t.url)return t.url;let e=eRe.toLocaleLowerCase();return t.headers.get(e)}var zL=(()=>{let e=class e{constructor(){this.fetchImpl=qe(KL,{optional:!0})?.fetch??fetch.bind(globalThis),this.ngZone=qe(nr)}handle(r){return new en(i=>{let o=new AbortController;return this.doRequest(r,o.signal,i).then(XL,s=>i.error(new Uh({error:s}))),()=>o.abort()})}doRequest(r,i,o){return Vk(this,null,function*(){let s=this.createRequestInit(r),a;try{let p=this.fetchImpl(r.urlWithParams,Ee({signal:i},s));tRe(p),o.next({type:tu.Sent}),a=yield p}catch(p){o.error(new Uh({error:p,status:p.status??0,statusText:p.statusText,url:r.urlWithParams,headers:p.headers}));return}let l=new _d(a.headers),c=a.statusText,u=WY(a)??r.urlWithParams,d=a.status,h=null;if(r.reportProgress&&o.next(new $D({headers:l,status:d,statusText:c,url:u})),a.body){let p=a.headers.get("content-length"),g=[],w=a.body.getReader(),_=0,S,x,P=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>Vk(this,null,function*(){for(;;){let{done:b,value:C}=yield w.read();if(b)break;if(g.push(C),_+=C.length,r.reportProgress){x=r.responseType==="text"?(x??"")+(S??=new TextDecoder).decode(C,{stream:!0}):void 0;let N=()=>o.next({type:tu.DownloadProgress,total:p?+p:void 0,loaded:_,partialText:x});P?P.run(N):N()}}}));let k=this.concatChunks(g,_);try{let b=a.headers.get("Content-Type")??"";h=this.parseBody(r,k,b)}catch(b){o.error(new Uh({error:b,headers:new _d(a.headers),status:a.status,statusText:a.statusText,url:WY(a)??r.urlWithParams}));return}}d===0&&(d=h?200:0),d>=200&&d<300?(o.next(new dC({body:h,headers:l,status:d,statusText:c,url:u})),o.complete()):o.error(new Uh({error:h,headers:l,status:d,statusText:c,url:u}))})}parseBody(r,i,o){switch(r.responseType){case"json":let s=new TextDecoder().decode(i).replace(JTe,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(i);case"blob":return new Blob([i],{type:o});case"arraybuffer":return i.buffer}}createRequestInit(r){let i={},o=r.withCredentials?"include":void 0;if(r.headers.forEach((s,a)=>i[s]=a.join(",")),i.Accept??="application/json, text/plain, */*",!i["Content-Type"]){let s=r.detectContentTypeHeader();s!==null&&(i["Content-Type"]=s)}return{body:r.serializeBody(),method:r.method,headers:i,credentials:o}}concatChunks(r,i){let o=new Uint8Array(i),s=0;for(let a of r)o.set(a,s),s+=a.length;return o}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),KL=class{};function XL(){}function tRe(t){t.then(XL,XL)}function zY(t,e){return e(t)}function nRe(t,e){return(n,r)=>e.intercept(n,{handle:i=>t(i,r)})}function rRe(t,e,n){return(r,i)=>hd(n,()=>e(r,o=>t(o,i)))}var QL=new Ut(""),JL=new Ut(""),iRe=new Ut(""),YY=new Ut("");function oRe(){let t=null;return(e,n)=>{t===null&&(t=(qe(QL,{optional:!0})??[]).reduceRight(nRe,zY));let r=qe(K0),i=r.add();return t(e,n).pipe(ad(()=>r.remove(i)))}}var jY=(()=>{let e=class e extends lC{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=qe(K0);let o=qe(YY,{optional:!0});this.backend=o??r}handle(r){if(this.chain===null){let o=Array.from(new Set([...this.injector.get(JL),...this.injector.get(iRe,[])]));this.chain=o.reduceRight((s,a)=>rRe(s,a,this.injector),zY)}let i=this.pendingTasks.add();return this.chain(r,o=>this.backend.handle(o)).pipe(ad(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(kt(cC),kt(Es))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})();var sRe=/^\)\]\}',?\n/;function aRe(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var $Y=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new Je(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Nr(i.\u0275loadImpl()):Wt(null)).pipe(qo(()=>new en(s=>{let a=i.build();if(a.open(r.method,r.urlWithParams),r.withCredentials&&(a.withCredentials=!0),r.headers.forEach((w,_)=>a.setRequestHeader(w,_.join(","))),r.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let w=r.detectContentTypeHeader();w!==null&&a.setRequestHeader("Content-Type",w)}if(r.responseType){let w=r.responseType.toLowerCase();a.responseType=w!=="json"?w:"text"}let l=r.serializeBody(),c=null,u=()=>{if(c!==null)return c;let w=a.statusText||"OK",_=new _d(a.getAllResponseHeaders()),S=aRe(a)||r.url;return c=new $D({headers:_,status:a.status,statusText:w,url:S}),c},d=()=>{let{headers:w,status:_,statusText:S,url:x}=u(),P=null;_!==204&&(P=typeof a.response>"u"?a.responseText:a.response),_===0&&(_=P?200:0);let k=_>=200&&_<300;if(r.responseType==="json"&&typeof P=="string"){let b=P;P=P.replace(sRe,"");try{P=P!==""?JSON.parse(P):null}catch(C){P=b,k&&(k=!1,P={error:C,text:P})}}k?(s.next(new dC({body:P,headers:w,status:_,statusText:S,url:x||void 0})),s.complete()):s.error(new Uh({error:P,headers:w,status:_,statusText:S,url:x||void 0}))},h=w=>{let{url:_}=u(),S=new Uh({error:w,status:a.status||0,statusText:a.statusText||"Unknown Error",url:_||void 0});s.error(S)},f=!1,p=w=>{f||(s.next(u()),f=!0);let _={type:tu.DownloadProgress,loaded:w.loaded};w.lengthComputable&&(_.total=w.total),r.responseType==="text"&&a.responseText&&(_.partialText=a.responseText),s.next(_)},g=w=>{let _={type:tu.UploadProgress,loaded:w.loaded};w.lengthComputable&&(_.total=w.total),s.next(_)};return a.addEventListener("load",d),a.addEventListener("error",h),a.addEventListener("timeout",h),a.addEventListener("abort",h),r.reportProgress&&(a.addEventListener("progress",p),l!==null&&a.upload&&a.upload.addEventListener("progress",g)),a.send(l),s.next({type:tu.Sent}),()=>{a.removeEventListener("error",h),a.removeEventListener("abort",h),a.removeEventListener("load",d),a.removeEventListener("timeout",h),r.reportProgress&&(a.removeEventListener("progress",p),l!==null&&a.upload&&a.upload.removeEventListener("progress",g)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(kt(X0))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),qY=new Ut("XSRF_ENABLED"),lRe="XSRF-TOKEN",cRe=new Ut("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>lRe}),uRe="X-XSRF-TOKEN",dRe=new Ut("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>uRe}),GD=class{},hRe=(()=>{let e=class e{constructor(r,i,o){this.doc=r,this.platform=i,this.cookieName=o,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=BD(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(kt(ci),kt(ql),kt(cRe))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})();function fRe(t,e){let n=t.url.toLowerCase();if(!qe(qY)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let r=qe(GD).getToken(),i=qe(dRe);return r!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,r)})),e(t)}var eH=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(eH||{});function KY(t,e){return{\u0275kind:t,\u0275providers:e}}function XY(...t){let e=[ZL,$Y,jY,{provide:lC,useExisting:jY},{provide:cC,useExisting:$Y},{provide:JL,useValue:fRe,multi:!0},{provide:qY,useValue:!0},{provide:GD,useClass:hRe}];for(let n of t)e.push(...n.\u0275providers);return U0(e)}var GY=new Ut("LEGACY_INTERCEPTOR_FN");function ZY(){return KY(eH.LegacyInterceptors,[{provide:GY,useFactory:oRe},{provide:JL,useExisting:GY,multi:!0}])}function QY(){return KY(eH.Fetch,[zL,{provide:cC,useExisting:zL},{provide:YY,useExisting:zL}])}var rH=class extends HD{constructor(){super(...arguments),this.supportsDOMEvents=!0}},iH=class t extends rH{static makeCurrent(){DY(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=pRe();return n==null?null:gRe(n)}resetBaseElement(){hC=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return BD(document.cookie,e)}},hC=null;function pRe(){return hC=hC||document.querySelector("base"),hC?hC.getAttribute("href"):null}function gRe(t){return new URL(t,"http://a").pathname}var vRe=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),oH=new Ut("EventManagerPlugins"),tq=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(o=>{o.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,o){return this._findPluginFor(i).addEventListener(r,i,o)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(s=>s.supports(r)),!i)throw new Je(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(kt(oH),kt(nr))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),zD=class{constructor(e){this._doc=e}},tH="ng-app-id",nq=(()=>{let e=class e{constructor(r,i,o,s={}){this.doc=r,this.appId=i,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=$L(s),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(o=>o.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${tH}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(o=>{o.textContent!=null&&i.set(o.textContent,o)}),i}return null}changeUsageCount(r,i){let o=this.styleRef;if(o.has(r)){let s=o.get(r);return s.usage+=i,s.usage}return o.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let o=this.styleNodesInDOM,s=o?.get(i);if(s?.parentNode===r)return o.delete(i),s.removeAttribute(tH),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(tH,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let o=this.getStyleElement(r,i),s=this.styleRef,a=s.get(i)?.elements;a?a.push(o):s.set(i,{elements:[o],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(kt(ci),kt(X2),kt(J2,8),kt(ql))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),nH={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},aH=/%COMP%/g,rq="%COMP%",wRe=`_nghost-${rq}`,yRe=`_ngcontent-${rq}`,_Re=!0,CRe=new Ut("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>_Re});function SRe(t){return yRe.replace(aH,t)}function ERe(t){return wRe.replace(aH,t)}function iq(t,e){return e.map(n=>n.replace(aH,t))}var YD=(()=>{let e=class e{constructor(r,i,o,s,a,l,c,u=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=l,this.ngZone=c,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=$L(l),this.defaultRenderer=new fC(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===qc.ShadowDom&&(i=ft(Ee({},i),{encapsulation:qc.Emulated}));let o=this.getOrCreateRenderer(r,i);return o instanceof qD?o.applyToHost(r):o instanceof mC&&o.applyStyles(),o}getOrCreateRenderer(r,i){let o=this.rendererByCompId,s=o.get(i.id);if(!s){let a=this.doc,l=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case qc.Emulated:s=new qD(c,u,i,this.appId,d,a,l,h);break;case qc.ShadowDom:return new sH(c,u,r,i,a,l,this.nonce,h);default:s=new mC(c,u,i,d,a,l,h);break}o.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(kt(tq),kt(nq),kt(X2),kt(CRe),kt(ci),kt(ql),kt(nr),kt(J2))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),fC=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(nH[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(JY(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(JY(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new Je(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let o=nH[i];o?e.setAttributeNS(o,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=nH[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(cd.DashCase|cd.Important)?e.style.setProperty(n,r,i&cd.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&cd.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=wd().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function JY(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var sH=class extends fC{constructor(e,n,r,i,o,s,a,l){super(e,o,s,l),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=iq(i.id,i.styles);for(let u of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=u,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},mC=class extends fC{constructor(e,n,r,i,o,s,a,l){super(e,o,s,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=l?iq(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},qD=class extends mC{constructor(e,n,r,i,o,s,a,l){let c=i+"-"+r.id;super(e,n,r,o,s,a,l,c),this.contentAttr=SRe(c),this.hostAttr=ERe(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},xRe=(()=>{let e=class e extends zD{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,o){return r.addEventListener(i,o,!1),()=>this.removeEventListener(r,i,o)}removeEventListener(r,i,o){return r.removeEventListener(i,o)}};e.\u0275fac=function(i){return new(i||e)(kt(ci))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),eq=["alt","control","meta","shift"],bRe={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},TRe={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},RRe=(()=>{let e=class e extends zD{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,o){let s=e.parseEventName(i),a=e.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>wd().onAndCancel(r,s.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),o=i.shift();if(i.length===0||!(o==="keydown"||o==="keyup"))return null;let s=e._normalizeKey(i.pop()),a="",l=i.indexOf("code");if(l>-1&&(i.splice(l,1),a="code."),eq.forEach(u=>{let d=i.indexOf(u);d>-1&&(i.splice(d,1),a+=u+".")}),a+=s,i.length!=0||s.length===0)return null;let c={};return c.domEventName=o,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let o=bRe[r.key]||r.key,s="";return i.indexOf("code.")>-1&&(o=r.code,s="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),eq.forEach(a=>{if(a!==o){let l=TRe[a];l(r)&&(s+=a+".")}}),s+=o,s===i)}static eventCallback(r,i,o){return s=>{e.matchEventFullKeyCode(s,r)&&o.runGuarded(()=>i(s))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(kt(ci))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})();function oq(t,e){return yY(Ee({rootComponent:t},DRe(e)))}function DRe(t){return{appProviders:[...NRe,...t?.providers??[]],platformProviders:ORe}}function IRe(){iH.makeCurrent()}function ARe(){return new ud}function MRe(){return P9(document),document}var ORe=[{provide:ql,useValue:WL},{provide:Z2,useValue:IRe,multi:!0},{provide:ci,useFactory:MRe,deps:[]}];var NRe=[{provide:ED,useValue:"root"},{provide:ud,useFactory:ARe,deps:[]},{provide:oH,useClass:xRe,multi:!0,deps:[ci,nr,ql]},{provide:oH,useClass:RRe,multi:!0,deps:[ci]},YD,nq,tq,{provide:$m,useExisting:YD},{provide:X0,useClass:vRe,deps:[]},[]];function PRe(){return new lH(kt(ci))}var lH=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(kt(ci))},e.\u0275prov=ht({token:e,factory:function(i){let o=null;return i?o=new i:o=PRe(),o},providedIn:"root"});let t=e;return t})();var yn="primary",IC=Symbol("RouteTitle"),fH=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function tv(t){return new fH(t)}function FRe(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=t[o];if(s.startsWith(":"))i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function LRe(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!nu(t[n],e[n]))return!1;return!0}function nu(t,e){let n=t?mH(t):void 0,r=e?mH(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let o=0;o<n.length;o++)if(i=n[o],!hq(t[i],e[i]))return!1;return!0}function mH(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function hq(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,o)=>r[o]===i)}else return t===e}function fq(t){return t.length>0?t[t.length-1]:null}function zh(t){return nF(t)?t:Xm(t)?Nr(Promise.resolve(t)):Wt(t)}var HRe={exact:pq,subset:gq},mq={exact:VRe,subset:BRe,ignored:()=>!0};function sq(t,e,n){return HRe[n.paths](t.root,e.root,n.matrixParams)&&mq[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function VRe(t,e){return nu(t,e)}function pq(t,e,n){if(!Qm(t.segments,e.segments)||!ZD(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!pq(t.children[r],e.children[r],n))return!1;return!0}function BRe(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>hq(t[n],e[n]))}function gq(t,e,n){return vq(t,e,e.segments,n)}function vq(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Qm(i,n)||e.hasChildren()||!ZD(i,n,r))}else if(t.segments.length===n.length){if(!Qm(t.segments,n)||!ZD(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!gq(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),o=n.slice(t.segments.length);return!Qm(t.segments,i)||!ZD(t.segments,i,r)||!t.children[yn]?!1:vq(t.children[yn],e,o,r)}}function ZD(t,e,n){return e.every((r,i)=>mq[n](t[i].parameters,r.parameters))}var jh=class{constructor(e=new lr([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tv(this.queryParams)),this._queryParamMap}toString(){return jRe.serialize(this)}},lr=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return QD(this)}},Zm=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap||(this._parameterMap=tv(this.parameters)),this._parameterMap}toString(){return yq(this)}};function URe(t,e){return Qm(t,e)&&t.every((n,r)=>nu(n.parameters,e[r].parameters))}function Qm(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function WRe(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===yn&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==yn&&(n=n.concat(e(i,r)))}),n}var VH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>new eI)(),providedIn:"root"});let t=e;return t})(),eI=class{parse(e){let n=new gH(e);return new jh(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${pC(e.root,!0)}`,r=zRe(e.queryParams),i=typeof e.fragment=="string"?`#${$Re(e.fragment)}`:"";return`${n}${r}${i}`}},jRe=new eI;function QD(t){return t.segments.map(e=>yq(e)).join("/")}function pC(t,e){if(!t.hasChildren())return QD(t);if(e){let n=t.children[yn]?pC(t.children[yn],!1):"",r=[];return Object.entries(t.children).forEach(([i,o])=>{i!==yn&&r.push(`${i}:${pC(o,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=WRe(t,(r,i)=>i===yn?[pC(t.children[yn],!1)]:[`${i}:${pC(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[yn]!=null?`${QD(t)}/${n[0]}`:`${QD(t)}/(${n.join("//")})`}}function wq(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function KD(t){return wq(t).replace(/%3B/gi,";")}function $Re(t){return encodeURI(t)}function pH(t){return wq(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function JD(t){return decodeURIComponent(t)}function aq(t){return JD(t.replace(/\+/g,"%20"))}function yq(t){return`${pH(t.path)}${GRe(t.parameters)}`}function GRe(t){return Object.keys(t).map(e=>`;${pH(e)}=${pH(t[e])}`).join("")}function zRe(t){let e=Object.keys(t).map(n=>{let r=t[n];return Array.isArray(r)?r.map(i=>`${KD(n)}=${KD(i)}`).join("&"):`${KD(n)}=${KD(r)}`}).filter(n=>!!n);return e.length?`?${e.join("&")}`:""}var YRe=/^[^\/()?;#]+/;function cH(t){let e=t.match(YRe);return e?e[0]:""}var qRe=/^[^\/()?;=#]+/;function KRe(t){let e=t.match(qRe);return e?e[0]:""}var XRe=/^[^=?&#]+/;function ZRe(t){let e=t.match(XRe);return e?e[0]:""}var QRe=/^[^&#]+/;function JRe(t){let e=t.match(QRe);return e?e[0]:""}var gH=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new lr([],{}):new lr([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[yn]=new lr(e,n)),r}parseSegment(){let e=cH(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Je(4009,!1);return this.capture(e),new Zm(JD(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=KRe(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=cH(this.remaining);i&&(r=i,this.capture(r))}e[JD(n)]=JD(r)}parseQueryParam(e){let n=ZRe(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let s=JRe(this.remaining);s&&(r=s,this.capture(r))}let i=aq(n),o=aq(r);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=cH(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Je(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=yn);let s=this.parseChildren();n[o]=Object.keys(s).length===1?s[yn]:new lr([],s),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Je(4011,!1)}};function _q(t){return t.segments.length>0?new lr([],{[yn]:t}):t}function Cq(t){let e={};for(let r of Object.keys(t.children)){let i=t.children[r],o=Cq(i);if(r===yn&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[r]=o)}let n=new lr(t.segments,e);return eDe(n)}function eDe(t){if(t.numberOfChildren===1&&t.children[yn]){let e=t.children[yn];return new lr(t.segments.concat(e.segments),e.children)}return t}function nv(t){return t instanceof jh}function tDe(t,e,n=null,r=null){let i=Sq(t);return Eq(i,e,n,r)}function Sq(t){let e;function n(o){let s={};for(let l of o.children){let c=n(l);s[l.outlet]=c}let a=new lr(o.url,s);return o===t&&(e=a),a}let r=n(t.root),i=_q(r);return e??i}function Eq(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return uH(i,i,i,n,r);let o=nDe(e);if(o.toRoot())return uH(i,i,new lr([],{}),n,r);let s=rDe(o,i,t),a=s.processChildren?wC(s.segmentGroup,s.index,o.commands):bq(s.segmentGroup,s.index,o.commands);return uH(i,s.segmentGroup,a,n,r)}function tI(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function CC(t){return typeof t=="object"&&t!=null&&t.outlets}function uH(t,e,n,r,i){let o={};r&&Object.entries(r).forEach(([l,c])=>{o[l]=Array.isArray(c)?c.map(u=>`${u}`):`${c}`});let s;t===e?s=n:s=xq(t,e,n);let a=_q(Cq(s));return new jh(a,o,i)}function xq(t,e,n){let r={};return Object.entries(t.children).forEach(([i,o])=>{o===e?r[i]=n:r[i]=xq(o,e,n)}),new lr(t.segments,r)}var nI=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&tI(r[0]))throw new Je(4003,!1);let i=r.find(CC);if(i&&i!==fq(r))throw new Je(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function nDe(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new nI(!0,0,t);let e=0,n=!1,r=t.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([l,c])=>{a[l]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,l)=>{l==0&&a==="."||(l==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new nI(n,e,r)}var J0=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function rDe(t,e,n){if(t.isAbsolute)return new J0(e,!0,0);if(!n)return new J0(e,!1,NaN);if(n.parent===null)return new J0(n,!0,0);let r=tI(t.commands[0])?0:1,i=n.segments.length-1+r;return iDe(n,i,t.numberOfDoubleDots)}function iDe(t,e,n){let r=t,i=e,o=n;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Je(4005,!1);i=r.segments.length}return new J0(r,!1,i-o)}function oDe(t){return CC(t[0])?t[0].outlets:{[yn]:t}}function bq(t,e,n){if(t||(t=new lr([],{})),t.segments.length===0&&t.hasChildren())return wC(t,e,n);let r=sDe(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let o=new lr(t.segments.slice(0,r.pathIndex),{});return o.children[yn]=new lr(t.segments.slice(r.pathIndex),t.children),wC(o,0,i)}else return r.match&&i.length===0?new lr(t.segments,{}):r.match&&!t.hasChildren()?vH(t,e,n):r.match?wC(t,0,i):vH(t,e,n)}function wC(t,e,n){if(n.length===0)return new lr(t.segments,{});{let r=oDe(n),i={};if(Object.keys(r).some(o=>o!==yn)&&t.children[yn]&&t.numberOfChildren===1&&t.children[yn].segments.length===0){let o=wC(t.children[yn],e,n);return new lr(t.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=bq(t.children[o],e,s))}),Object.entries(t.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new lr(t.segments,i)}}function sDe(t,e,n){let r=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return o;let s=t.segments[i],a=n[r];if(CC(a))break;let l=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&l===void 0)break;if(l&&c&&typeof c=="object"&&c.outlets===void 0){if(!cq(l,c,s))return o;r+=2}else{if(!cq(l,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function vH(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let o=n[i];if(CC(o)){let l=aDe(o.outlets);return new lr(r,l)}if(i===0&&tI(n[0])){let l=t.segments[e];r.push(new Zm(l.path,lq(n[0]))),i++;continue}let s=CC(o)?o.outlets[yn]:`${o}`,a=i<n.length-1?n[i+1]:null;s&&a&&tI(a)?(r.push(new Zm(s,lq(a))),i+=2):(r.push(new Zm(s,{})),i++)}return new lr(r,{})}function aDe(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=vH(new lr([],{}),0,r))}),e}function lq(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function cq(t,e,n){return t==n.path&&nu(e,n.parameters)}var yC="imperative",Qa=class{constructor(e,n){this.id=e,this.url=n}},SC=class extends Qa{constructor(e,n,r="imperative",i=null){super(e,n),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},$h=class extends Qa{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Gh=class extends Qa{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Jm=class extends Qa{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=16}},EC=class extends Qa{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},rI=class extends Qa{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},wH=class extends Qa{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yH=class extends Qa{constructor(e,n,r,i,o){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},_H=class extends Qa{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},CH=class extends Qa{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},SH=class{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},EH=class{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},xH=class{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},bH=class{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},TH=class{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},RH=class{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var xC=class{},bC=class{constructor(e){this.url=e}};var DH=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new cI,this.attachRef=null}},cI=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let o=this.getOrCreateContext(r);o.outlet=i,this.contexts.set(r,o)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new DH,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),iI=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=IH(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=IH(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=AH(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return AH(e,this._root).map(n=>n.value)}};function IH(t,e){if(t===e.value)return e;for(let n of e.children){let r=IH(t,n);if(r)return r}return null}function AH(t,e){if(t===e.value)return[e];for(let n of e.children){let r=AH(t,n);if(r.length)return r.unshift(e),r}return[]}var _a=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Q0(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var oI=class extends iI{constructor(e,n){super(e),this.snapshot=n,UH(this,e)}toString(){return this.snapshot.toString()}};function Tq(t,e){let n=lDe(t,e),r=new io([new Zm("",{})]),i=new io({}),o=new io({}),s=new io({}),a=new io(""),l=new Xl(r,i,s,a,o,yn,e,n.root);return l.snapshot=n.root,new oI(new _a(l,[]),n)}function lDe(t,e){let n={},r={},i={},o="",s=new TC([],n,i,o,r,yn,e,null,{});return new sI("",new _a(s,[]))}var Xl=class{constructor(e,n,r,i,o,s,a,l){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(dn(c=>c[IC]))??Wt(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(dn(e=>tv(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(dn(e=>tv(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function BH(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:Ee(Ee({},e.params),t.params),data:Ee(Ee({},e.data),t.data),resolve:Ee(Ee(Ee(Ee({},t.data),e.data),i?.data),t._resolvedData)}:r={params:t.params,data:t.data,resolve:Ee(Ee({},t.data),t._resolvedData??{})},i&&Dq(i)&&(r.resolve[IC]=i.title),r}var TC=class{get title(){return this.data?.[IC]}constructor(e,n,r,i,o,s,a,l,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=l,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=tv(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=tv(this.queryParams)),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},sI=class extends iI{constructor(e,n){super(n),this.url=e,UH(this,n)}toString(){return Rq(this._root)}};function UH(t,e){e.value._routerState=t,e.children.forEach(n=>UH(t,n))}function Rq(t){let e=t.children.length>0?` { ${t.children.map(Rq).join(", ")} } `:"";return`${t.value}${e}`}function dH(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,nu(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),nu(e.params,n.params)||t.paramsSubject.next(n.params),LRe(e.url,n.url)||t.urlSubject.next(n.url),nu(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function MH(t,e){let n=nu(t.params,e.params)&&URe(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||MH(t.parent,e.parent))}function Dq(t){return typeof t.title=="string"||t.title===null}var ep=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=yn,this.activateEvents=new hr,this.deactivateEvents=new hr,this.attachEvents=new hr,this.detachEvents=new hr,this.parentContexts=qe(cI),this.location=qe(Kl),this.changeDetector=qe(Za),this.environmentInjector=qe(Es),this.inputBinder=qe(WH,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:o}=r.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Je(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Je(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Je(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new Je(4013,!1);this._activatedRoute=r;let o=this.location,a=r.snapshot.component,l=this.parentContexts.getOrCreateContext(this.name).children,c=new OH(r,l,o.injector);this.activated=o.createComponent(a,{index:o.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=kn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Yi]});let t=e;return t})(),OH=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Xl?this.route:e===cI?this.childContexts:this.parent.get(e,n)}},WH=new Ut("");function cDe(t,e,n){let r=RC(t,e._root,n?n._root:void 0);return new oI(r,e)}function RC(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=uDe(t,e,n);return new _a(r,i)}else{if(t.shouldAttach(e.value)){let o=t.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>RC(t,a)),s}}let r=dDe(e.value),i=e.children.map(o=>RC(t,o));return new _a(r,i)}}function uDe(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return RC(t,r,i);return RC(t,r)})}function dDe(t){return new Xl(new io(t.url),new io(t.params),new io(t.queryParams),new io(t.fragment),new io(t.data),t.outlet,t.component,t)}var Iq="ngNavigationCancelingError";function Aq(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=nv(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Mq(!1,0,e);return i.url=n,i.navigationBehaviorOptions=r,i}function Mq(t,e,n){let r=new Error("NavigationCancelingError: "+(t||""));return r[Iq]=!0,r.cancellationCode=e,n&&(r.url=n),r}function hDe(t){return Oq(t)&&nv(t.url)}function Oq(t){return t&&t[Iq]}var fDe=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["ng-component"]],standalone:!0,features:[qt],decls:1,vars:0,template:function(i,o){i&1&&at(0,"router-outlet")},dependencies:[ep],encapsulation:2});let t=e;return t})();function mDe(t,e){return t.providers&&!t._injector&&(t._injector=IL(t.providers,e,`Route: ${t.path}`)),t._injector??e}function jH(t){let e=t.children&&t.children.map(jH),n=e?ft(Ee({},t),{children:e}):Ee({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==yn&&(n.component=fDe),n}function ru(t){return t.outlet||yn}function pDe(t,e){let n=t.filter(r=>ru(r)===e);return n.push(...t.filter(r=>ru(r)!==e)),n}function AC(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var gDe=(t,e,n,r)=>dn(i=>(new NH(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),NH=class{constructor(e,n,r,i,o){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),dH(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Q0(n);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(e,n,r){let i=e.value,o=n?n.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(e,n,s.children)}else this.deactivateChildRoutes(e,n,r);else o&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,o=Q0(e);for(let s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,o=Q0(e);for(let s of Object.keys(o))this.deactivateRouteAndItsChildren(o[s],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Q0(n);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new RH(o.value.snapshot))}),e.children.length&&this.forwardEvent(new bH(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,o=n?n.value:null;if(dH(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,s.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),dH(a.route.value),this.activateChildRoutes(e,null,s.children)}else{let a=AC(i.snapshot);s.attachRef=null,s.route=i,s.injector=a,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}}else this.activateChildRoutes(e,null,r)}},aI=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ev=class{constructor(e,n){this.component=e,this.route=n}};function vDe(t,e,n){let r=t._root,i=e?e._root:null;return gC(r,i,n,[r.value])}function wDe(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function iv(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!Dz(t)?t:e.get(t):r}function gC(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=Q0(e);return t.children.forEach(s=>{yDe(s,o[s.value.outlet],n,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>_C(a,n.getContext(s),i)),i}function yDe(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=t.value,s=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let l=_De(s,o,o.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new aI(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?gC(t,e,a?a.children:null,r,i):gC(t,e,n,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ev(a.outlet.component,s))}else s&&_C(e,a,i),i.canActivateChecks.push(new aI(r)),o.component?gC(t,null,a?a.children:null,r,i):gC(t,null,n,r,i);return i}function _De(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Qm(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Qm(t.url,e.url)||!nu(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!MH(t,e)||!nu(t.queryParams,e.queryParams);case"paramsChange":default:return!MH(t,e)}}function _C(t,e,n){let r=Q0(t),i=t.value;Object.entries(r).forEach(([o,s])=>{i.component?e?_C(s,e.children.getContext(o),n):_C(s,null,n):_C(s,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ev(e.outlet.component,i)):n.canDeactivateChecks.push(new ev(null,i)):n.canDeactivateChecks.push(new ev(null,i))}function MC(t){return typeof t=="function"}function CDe(t){return typeof t=="boolean"}function SDe(t){return t&&MC(t.canLoad)}function EDe(t){return t&&MC(t.canActivate)}function xDe(t){return t&&MC(t.canActivateChild)}function bDe(t){return t&&MC(t.canDeactivate)}function TDe(t){return t&&MC(t.canMatch)}function Nq(t){return t instanceof sd||t?.name==="EmptyError"}var XD=Symbol("INITIAL_VALUE");function rv(){return qo(t=>w_(t.map(e=>e.pipe(_s(1),E_(XD)))).pipe(dn(e=>{for(let n of e)if(n!==!0){if(n===XD)return XD;if(n===!1||n instanceof jh)return n}return!0}),Gi(e=>e!==XD),_s(1)))}function RDe(t,e){return Pr(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=n;return s.length===0&&o.length===0?Wt(ft(Ee({},n),{guardsResult:!0})):DDe(s,r,i,t).pipe(Pr(a=>a&&CDe(a)?IDe(r,o,t,e):Wt(a)),dn(a=>ft(Ee({},n),{guardsResult:a})))})}function DDe(t,e,n,r){return Nr(t).pipe(Pr(i=>PDe(i.component,i.route,n,e,r)),jc(i=>i!==!0,!0))}function IDe(t,e,n,r){return Nr(e).pipe(Dh(i=>Wc(MDe(i.route.parent,r),ADe(i.route,r),NDe(t,i.path,n),ODe(t,i.route,n))),jc(i=>i!==!0,!0))}function ADe(t,e){return t!==null&&e&&e(new TH(t)),Wt(!0)}function MDe(t,e){return t!==null&&e&&e(new xH(t)),Wt(!0)}function ODe(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return Wt(!0);let i=r.map(o=>bR(()=>{let s=AC(e)??n,a=iv(o,s),l=EDe(a)?a.canActivate(e,t):hd(s,()=>a(e,t));return zh(l).pipe(jc())}));return Wt(i).pipe(rv())}function NDe(t,e,n){let r=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>wDe(s)).filter(s=>s!==null).map(s=>bR(()=>{let a=s.guards.map(l=>{let c=AC(s.node)??n,u=iv(l,c),d=xDe(u)?u.canActivateChild(r,t):hd(c,()=>u(r,t));return zh(d).pipe(jc())});return Wt(a).pipe(rv())}));return Wt(o).pipe(rv())}function PDe(t,e,n,r,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return Wt(!0);let s=o.map(a=>{let l=AC(e)??i,c=iv(a,l),u=bDe(c)?c.canDeactivate(t,e,n,r):hd(l,()=>c(t,e,n,r));return zh(u).pipe(jc())});return Wt(s).pipe(rv())}function kDe(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return Wt(!0);let o=i.map(s=>{let a=iv(s,t),l=SDe(a)?a.canLoad(e,n):hd(t,()=>a(e,n));return zh(l)});return Wt(o).pipe(rv(),Pq(r))}function Pq(t){return Kk(kr(e=>{if(nv(e))throw Aq(t,e)}),dn(e=>e===!0))}function FDe(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return Wt(!0);let o=i.map(s=>{let a=iv(s,t),l=TDe(a)?a.canMatch(e,n):hd(t,()=>a(e,n));return zh(l)});return Wt(o).pipe(rv(),Pq(r))}var DC=class{constructor(e){this.segmentGroup=e||null}},lI=class extends Error{constructor(e){super(),this.urlTree=e}};function Z0(t){return b0(new DC(t))}function LDe(t){return b0(new Je(4e3,!1))}function HDe(t){return b0(Mq(!1,3))}var PH=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}noMatchError(e){return new Je(4002,!1)}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Wt(r);if(i.numberOfChildren>1||!i.children[yn])return LDe(e.redirectTo);i=i.children[yn]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new lI(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let o=this.createSegmentGroup(e,n.root,r,i);return new jh(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o.startsWith(":")){let a=o.substring(1);r[i]=n[a]}else r[i]=o}),r}createSegmentGroup(e,n,r,i){let o=this.createSegments(e,n.segments,r,i),s={};return Object.entries(n.children).forEach(([a,l])=>{s[a]=this.createSegmentGroup(e,l,r,i)}),new lr(o,s)}createSegments(e,n,r,i){return n.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,i):this.findOrReturn(o,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new Je(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},kH={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function VDe(t,e,n,r,i){let o=$H(t,e,n);return o.matched?(r=mDe(e,r),FDe(r,e,n,i).pipe(dn(s=>s===!0?o:Ee({},kH)))):Wt(o)}function $H(t,e,n){if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?Ee({},kH):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||FRe)(n,t,e);if(!i)return Ee({},kH);let o={};Object.entries(i.posParams??{}).forEach(([a,l])=>{o[a]=l.path});let s=i.consumed.length>0?Ee(Ee({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function uq(t,e,n,r){return n.length>0&&WDe(t,n,r)?{segmentGroup:new lr(e,UDe(r,new lr(n,t.children))),slicedSegments:[]}:n.length===0&&jDe(t,n,r)?{segmentGroup:new lr(t.segments,BDe(t,e,n,r,t.children)),slicedSegments:n}:{segmentGroup:new lr(t.segments,t.children),slicedSegments:n}}function BDe(t,e,n,r,i){let o={};for(let s of r)if(uI(t,n,s)&&!i[ru(s)]){let a=new lr([],{});o[ru(s)]=a}return Ee(Ee({},i),o)}function UDe(t,e){let n={};n[yn]=e;for(let r of t)if(r.path===""&&ru(r)!==yn){let i=new lr([],{});n[ru(r)]=i}return n}function WDe(t,e,n){return n.some(r=>uI(t,e,r)&&ru(r)!==yn)}function jDe(t,e,n){return n.some(r=>uI(t,e,r))}function uI(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function $De(t,e,n,r){return ru(t)!==r&&(r===yn||!uI(e,n,t))?!1:t.path==="**"?!0:$H(e,t,n).matched}function GDe(t,e,n){return e.length===0&&!t.children[n]}var FH=class{};function zDe(t,e,n,r,i,o,s="emptyOnly"){return new LH(t,e,n,r,i,s,o).recognize()}var YDe=31,LH=class{constructor(e,n,r,i,o,s,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new PH(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Je(4002,!1)}recognize(){let e=uq(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(dn(n=>{let r=new TC([],Object.freeze({}),Object.freeze(Ee({},this.urlTree.queryParams)),this.urlTree.fragment,{},yn,this.rootComponentType,null,{}),i=new _a(r,n),o=new sI("",i),s=tDe(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),this.inheritParamsAndData(o._root,null),{state:o,tree:s}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,yn).pipe(Rh(r=>{if(r instanceof lI)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof DC?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=BH(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(o=>this.inheritParamsAndData(o,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(dn(o=>o instanceof _a?[o]:[]))}processChildren(e,n,r){let i=[];for(let o of Object.keys(r.children))o==="primary"?i.unshift(o):i.push(o);return Nr(i).pipe(Dh(o=>{let s=r.children[o],a=pDe(n,o);return this.processSegmentGroup(e,a,s,o)}),lF((o,s)=>(o.push(...s),o)),Ih(null),aF(),Pr(o=>{if(o===null)return Z0(r);let s=kq(o);return qDe(s),Wt(s)}))}processSegment(e,n,r,i,o,s){return Nr(n).pipe(Dh(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,o,s).pipe(Rh(l=>{if(l instanceof DC)return Wt(null);throw l}))),jc(a=>!!a),Rh(a=>{if(Nq(a))return GDe(r,i,o)?Wt(new FH):Z0(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,o,s,a){return $De(r,i,o,s)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,o,s):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,o,s):Z0(i):Z0(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,o,s){let{matched:a,consumedSegments:l,positionalParamSegments:c,remainingSegments:u}=i.path==="**"?dq(o):$H(n,i,o);if(!a)return Z0(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>YDe&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(l,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(Pr(h=>this.processSegment(e,r,n,h.concat(u),s,!1)))}matchSegmentAgainstRoute(e,n,r,i,o){let s;return r.path==="**"?(s=Wt(dq(i)),n.children={}):s=VDe(n,r,i,e,this.urlSerializer),s.pipe(qo(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(qo(({routes:l})=>{let c=r._loadedInjector??e,{consumedSegments:u,remainingSegments:d,parameters:h}=a,f=new TC(u,h,Object.freeze(Ee({},this.urlTree.queryParams)),this.urlTree.fragment,XDe(r),ru(r),r.component??r._loadedComponent??null,r,ZDe(r)),{segmentGroup:p,slicedSegments:g}=uq(n,u,d,l);if(g.length===0&&p.hasChildren())return this.processChildren(c,l,p).pipe(dn(_=>_===null?null:new _a(f,_)));if(l.length===0&&g.length===0)return Wt(new _a(f,[]));let w=ru(r)===o;return this.processSegment(c,l,p,g,w?yn:o,!0).pipe(dn(_=>new _a(f,_ instanceof _a?[_]:[])))}))):Z0(n)))}getChildConfig(e,n,r){return n.children?Wt({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?Wt({routes:n._loadedRoutes,injector:n._loadedInjector}):kDe(e,n,r,this.urlSerializer).pipe(Pr(i=>i?this.configLoader.loadChildren(e,n).pipe(kr(o=>{n._loadedRoutes=o.routes,n._loadedInjector=o.injector})):HDe(n))):Wt({routes:[],injector:e})}};function qDe(t){t.sort((e,n)=>e.value.outlet===yn?-1:n.value.outlet===yn?1:e.value.outlet.localeCompare(n.value.outlet))}function KDe(t){let e=t.value.routeConfig;return e&&e.path===""}function kq(t){let e=[],n=new Set;for(let r of t){if(!KDe(r)){e.push(r);continue}let i=e.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=kq(r.children);e.push(new _a(r.value,i))}return e.filter(r=>!n.has(r))}function XDe(t){return t.data||{}}function ZDe(t){return t.resolve||{}}function dq(t){return{matched:!0,parameters:t.length>0?fq(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function QDe(t,e,n,r,i,o){return Pr(s=>zDe(t,e,n,r,s.extractedUrl,i,o).pipe(dn(({state:a,tree:l})=>ft(Ee({},s),{targetSnapshot:a,urlAfterRedirects:l}))))}function JDe(t,e){return Pr(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return Wt(n);let o=new Set(i.map(l=>l.route)),s=new Set;for(let l of o)if(!s.has(l))for(let c of Fq(l))s.add(c);let a=0;return Nr(s).pipe(Dh(l=>o.has(l)?eIe(l,r,t,e):(l.data=BH(l,l.parent,t).resolve,Wt(void 0))),kr(()=>a++),R0(1),Pr(l=>a===s.size?Wt(n):Yo))})}function Fq(t){let e=t.children.map(n=>Fq(n)).flat();return[t,...e]}function eIe(t,e,n,r){let i=t.routeConfig,o=t._resolve;return i?.title!==void 0&&!Dq(i)&&(o[IC]=i.title),tIe(o,t,e,r).pipe(dn(s=>(t._resolvedData=s,t.data=BH(t,t.parent,n).resolve,null)))}function tIe(t,e,n,r){let i=mH(t);if(i.length===0)return Wt({});let o={};return Nr(i).pipe(Pr(s=>nIe(t[s],e,n,r).pipe(jc(),kr(a=>{o[s]=a}))),R0(1),C_(o),Rh(s=>Nq(s)?Yo:b0(s)))}function nIe(t,e,n,r){let i=AC(e)??r,o=iv(t,i),s=o.resolve?o.resolve(e,n):hd(i,()=>o(e,n));return zh(s)}function hH(t){return qo(e=>{let n=t(e);return n?Nr(n).pipe(dn(()=>e)):Wt(e)})}var Lq=(()=>{let e=class e{buildTitle(r){let i,o=r.root;for(;o!==void 0;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(s=>s.outlet===yn);return i}getResolvedTitleForRoute(r){return r.data[IC]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>qe(rIe))(),providedIn:"root"});let t=e;return t})(),rIe=(()=>{let e=class e extends Lq{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(kt(lH))},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),GH=new Ut("",{providedIn:"root",factory:()=>({})}),zH=new Ut("ROUTES"),iIe=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=qe(ML)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Wt(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=zh(r.loadComponent()).pipe(dn(Hq),kr(s=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=s}),ad(()=>{this.componentLoaders.delete(r)})),o=new C0(i,()=>new Ur).pipe(_0());return this.componentLoaders.set(r,o),o}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Wt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=oIe(i,this.compiler,r,this.onLoadEndListener).pipe(ad(()=>{this.childrenLoaders.delete(i)})),a=new C0(s,()=>new Ur).pipe(_0());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function oIe(t,e,n,r){return zh(t.loadChildren()).pipe(dn(Hq),Pr(i=>i instanceof U_||Array.isArray(i)?Wt(i):Nr(e.compileModuleAsync(i))),dn(i=>{r&&r(t);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(n).injector,s=o.get(zH,[],{optional:!0,self:!0}).flat()),{routes:s.map(jH),injector:o}}))}function sIe(t){return t&&typeof t=="object"&&"default"in t}function Hq(t){return sIe(t)?t.default:t}var YH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>qe(aIe))(),providedIn:"root"});let t=e;return t})(),aIe=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),lIe=new Ut("");var cIe=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ur,this.transitionAbortSubject=new Ur,this.configLoader=qe(iIe),this.environmentInjector=qe(Es),this.urlSerializer=qe(VH),this.rootContexts=qe(cI),this.location=qe(sC),this.inputBindingEnabled=qe(WH,{optional:!0})!==null,this.titleStrategy=qe(Lq),this.options=qe(GH,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=qe(YH),this.createViewTransition=qe(lIe,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Wt(void 0),this.rootComponentType=null;let r=o=>this.events.next(new SH(o)),i=o=>this.events.next(new EH(o));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ft(Ee(Ee({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,o){return this.transitions=new io({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:yC,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Gi(s=>s.id!==0),dn(s=>ft(Ee({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),qo(s=>{this.currentTransition=s;let a=!1,l=!1;return Wt(s).pipe(kr(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ft(Ee({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),qo(c=>{let u=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!u&&d!=="reload"){let h="";return this.events.next(new Jm(c.id,this.urlSerializer.serialize(c.rawUrl),h,0)),c.resolve(null),Yo}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Wt(c).pipe(qo(h=>{let f=this.transitions?.getValue();return this.events.next(new SC(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?Yo:Promise.resolve(h)}),QDe(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),kr(h=>{s.targetSnapshot=h.targetSnapshot,s.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ft(Ee({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new rI(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(u&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:w}=c,_=new SC(h,this.urlSerializer.serialize(f),p,g);this.events.next(_);let S=Tq(f,this.rootComponentType).snapshot;return this.currentTransition=s=ft(Ee({},c),{targetSnapshot:S,urlAfterRedirects:f,extras:ft(Ee({},w),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,Wt(s)}else{let h="";return this.events.next(new Jm(c.id,this.urlSerializer.serialize(c.extractedUrl),h,1)),c.resolve(null),Yo}}),kr(c=>{let u=new wH(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(u)}),dn(c=>(this.currentTransition=s=ft(Ee({},c),{guards:vDe(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),RDe(this.environmentInjector,c=>this.events.next(c)),kr(c=>{if(s.guardsResult=c.guardsResult,nv(c.guardsResult))throw Aq(this.urlSerializer,c.guardsResult);let u=new yH(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(u)}),Gi(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",3),!1)),hH(c=>{if(c.guards.canActivateChecks.length)return Wt(c).pipe(kr(u=>{let d=new _H(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),qo(u=>{let d=!1;return Wt(u).pipe(JDe(this.paramsInheritanceStrategy,this.environmentInjector),kr({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",2)}}))}),kr(u=>{let d=new CH(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),hH(c=>{let u=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(kr(f=>{d.component=f}),dn(()=>{})));for(let f of d.children)h.push(...u(f));return h};return w_(u(c.targetSnapshot.root)).pipe(Ih(),_s(1))}),hH(()=>this.afterPreactivation()),qo(()=>{let{currentSnapshot:c,targetSnapshot:u}=s,d=this.createViewTransition?.(this.environmentInjector,c.root,u.root);return d?Nr(d).pipe(dn(()=>s)):Wt(s)}),dn(c=>{let u=cDe(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=ft(Ee({},c),{targetRouterState:u}),this.currentNavigation.targetRouterState=u,s}),kr(()=>{this.events.next(new xC)}),gDe(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),_s(1),kr({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new $h(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),Ya(this.transitionAbortSubject.pipe(kr(c=>{throw c}))),ad(()=>{if(!a&&!l){let c="";this.cancelNavigationTransition(s,c,1)}this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),Rh(c=>{if(l=!0,Oq(c))this.events.next(new Gh(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),hDe(c)?this.events.next(new bC(c.url)):s.resolve(!1);else{this.events.next(new EC(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0));try{s.resolve(r.errorHandler(c))}catch(u){s.reject(u)}}return Yo}))}))}cancelNavigationTransition(r,i,o){let s=new Gh(r.id,this.urlSerializer.serialize(r.extractedUrl),i,o);this.events.next(s),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function uIe(t){return t!==yC}var dIe=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>qe(hIe))(),providedIn:"root"});let t=e;return t})(),HH=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},hIe=(()=>{let e=class e extends HH{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Vq=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>qe(fIe))(),providedIn:"root"});let t=e;return t})(),fIe=(()=>{let e=class e extends Vq{constructor(){super(...arguments),this.location=qe(sC),this.urlSerializer=qe(VH),this.options=qe(GH,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=qe(YH),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new jh,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Tq(this.currentUrlTree,null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof SC)this.stateMemento=this.createStateMemento();else if(r instanceof Jm)this.rawUrlTree=i.initialUrl;else if(r instanceof rI){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let o=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(o,i)}}else r instanceof xC?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Gh&&(r.code===3||r.code===2)?this.restoreHistory(i):r instanceof EC?this.restoreHistory(i,!0):r instanceof $h&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let o=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl){let s=this.browserPageId,a=Ee(Ee({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(o,"",a)}else{let s=Ee(Ee({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(o,"",s)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,s=this.currentPageId-o;s!==0?this.location.historyGo(s):this.currentUrlTree===r.finalUrl&&s===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),vC=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(vC||{});function mIe(t,e){t.events.pipe(Gi(n=>n instanceof $h||n instanceof Gh||n instanceof EC||n instanceof Jm),dn(n=>n instanceof $h||n instanceof Jm?vC.COMPLETE:(n instanceof Gh?n.code===0||n.code===1:!1)?vC.REDIRECTING:vC.FAILED),Gi(n=>n!==vC.REDIRECTING),_s(1)).subscribe(()=>{e()})}function pIe(t){throw t}var gIe={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},vIe={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ds=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=qe(FD),this.stateManager=qe(Vq),this.options=qe(GH,{optional:!0})||{},this.pendingTasks=qe(K0),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=qe(cIe),this.urlSerializer=qe(VH),this.location=qe(sC),this.urlHandlingStrategy=qe(YH),this._events=new Ur,this.errorHandler=this.options.errorHandler||pIe,this.navigated=!1,this.routeReuseStrategy=qe(dIe),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=qe(zH,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!qe(WH,{optional:!0}),this.eventsSubscription=new Ii,this.isNgZoneEnabled=qe(nr)instanceof nr&&nr.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let o=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(o!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof Gh&&i.code!==0&&i.code!==1)this.navigated=!0;else if(i instanceof $h)this.navigated=!0;else if(i instanceof bC){let a=this.urlHandlingStrategy.merge(i.url,o.currentRawUrl),l={skipLocationChange:o.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||uIe(o.source)};this.scheduleNavigation(a,yC,null,l,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}yIe(i)&&this._events.next(i)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),yC,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription||(this.nonRouterCurrentEntryChangeSubscription=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)}))}navigateToSyncWithBrowser(r,i,o){let s={replaceUrl:!0},a=o?.navigationId?o:null;if(o){let c=Ee({},o);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let l=this.parseUrl(r);this.scheduleNavigation(l,i,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(jH),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:o,queryParams:s,fragment:a,queryParamsHandling:l,preserveFragment:c}=i,u=c?this.currentUrlTree.fragment:a,d=null;switch(l){case"merge":d=Ee(Ee({},this.currentUrlTree.queryParams),s);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=o?o.snapshot:this.routerState.snapshot.root;h=Sq(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return Eq(h,r,d,u??null)}navigateByUrl(r,i={skipLocationChange:!1}){let o=nv(r)?r:this.parseUrl(r),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,yC,null,i)}navigate(r,i={skipLocationChange:!1}){return wIe(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let o;if(i===!0?o=Ee({},gIe):i===!1?o=Ee({},vIe):o=i,nv(r))return sq(this.currentUrlTree,r,o);let s=this.parseUrl(r);return sq(this.currentUrlTree,s,o)}removeEmptyProps(r){return Object.keys(r).reduce((i,o)=>{let s=r[o];return s!=null&&(i[o]=s),i},{})}scheduleNavigation(r,i,o,s,a){if(this.disposed)return Promise.resolve(!1);let l,c,u;a?(l=a.resolve,c=a.reject,u=a.promise):u=new Promise((h,f)=>{l=h,c=f});let d=this.pendingTasks.add();return mIe(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:s,resolve:l,reject:c,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function wIe(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new Je(4008,!1)}function yIe(t){return!(t instanceof xC)&&!(t instanceof bC)}var ov=(()=>{let e=class e{constructor(r,i,o,s,a,l){this.router=r,this.route=i,this.tabIndexAttribute=o,this.renderer=s,this.el=a,this.locationStrategy=l,this.href=null,this.commands=null,this.onChanges=new Ur,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let c=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=r.events.subscribe(u=>{u instanceof $h&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,o,s,a){if(this.urlTree===null||this.isAnchorElement&&(r!==0||i||o||s||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state};return this.router.navigateByUrl(this.urlTree,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=this.urlTree!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;let r=this.href===null?null:s7(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(r,i){let o=this.renderer,s=this.el.nativeElement;i!==null?o.setAttribute(s,r,i):o.removeAttribute(s,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(je(Ds),je(Xl),Km("tabindex"),je(fd),je(Mi),je(yd))},e.\u0275dir=kn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,o){i&1&&Ue("click",function(a){return o.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Js("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",Hh],skipLocationChange:["skipLocationChange","skipLocationChange",Hh],replaceUrl:["replaceUrl","replaceUrl",Hh],routerLink:"routerLink"},standalone:!0,features:[xL,Yi]});let t=e;return t})();var _Ie=new Ut("");function Bq(t,...e){return U0([{provide:zH,multi:!0,useValue:t},[],{provide:Xl,useFactory:CIe,deps:[Ds]},{provide:LD,multi:!0,useFactory:SIe},e.map(n=>n.\u0275providers)])}function CIe(t){return t.routerState.root}function SIe(){let t=qe(Qc);return e=>{let n=t.get(Jc);if(e!==n.components[0])return;let r=t.get(Ds),i=t.get(EIe);t.get(xIe)===1&&r.initialNavigation(),t.get(bIe,null,On.Optional)?.setUpPreloading(),t.get(_Ie,null,On.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var EIe=new Ut("",{factory:()=>new Ur}),xIe=new Ut("",{providedIn:"root",factory:()=>1});var bIe=new Ut("");var Uq=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-home-page"]],standalone:!0,features:[qt],decls:6,vars:0,consts:[[1,"home"],[1,"heading","text-light"],[1,"title"]],template:function(i,o){i&1&&(W(0,"div",0)(1,"div",1)(2,"div",2),re(3,"Block Management System"),V(),W(4,"h4"),re(5,"Lumding Division, Northeast Frontier Railway."),V()()())},styles:['.home[_ngcontent-%COMP%]{background-image:url("./media/home-Y6FYMUEN.jpg");height:94.6svh;background-repeat:no-repeat;background-size:cover}.heading[_ngcontent-%COMP%]{position:absolute;top:217px;left:116px}.title[_ngcontent-%COMP%]{font-size:40px}']});let t=e;return t})();var Zq=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=o=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(je(fd),je(Mi))},e.\u0275dir=kn({type:e});let t=e;return t})(),PC=(()=>{let e=class e extends Zq{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275dir=kn({type:e,features:[qi]});let t=e;return t})(),Sd=new Ut("NgValueAccessor"),TIe={provide:Sd,useExisting:Zo(()=>kC),multi:!0},kC=(()=>{let e=class e extends PC{writeValue(r){this.setProperty("checked",r)}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275dir=kn({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,o){i&1&&Ue("change",function(a){return o.onChange(a.target.checked)})("blur",function(){return o.onTouched()})},features:[ao([TIe]),qi]});let t=e;return t})(),RIe={provide:Sd,useExisting:Zo(()=>iu),multi:!0};function DIe(){let t=wd()?wd().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var IIe=new Ut("CompositionEventMode"),iu=(()=>{let e=class e extends Zq{constructor(r,i,o){super(r,i),this._compositionMode=o,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!DIe())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(je(fd),je(Mi),je(IIe,8))},e.\u0275dir=kn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,o){i&1&&Ue("input",function(a){return o._handleInput(a.target.value)})("blur",function(){return o.onTouched()})("compositionstart",function(){return o._compositionStart()})("compositionend",function(a){return o._compositionEnd(a.target.value)})},features:[ao([RIe]),qi]});let t=e;return t})();function qh(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function Qq(t){return t!=null&&typeof t.length=="number"}var np=new Ut("NgValidators"),FC=new Ut("NgAsyncValidators"),AIe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Cd=class{static min(e){return MIe(e)}static max(e){return OIe(e)}static required(e){return Jq(e)}static requiredTrue(e){return NIe(e)}static email(e){return PIe(e)}static minLength(e){return kIe(e)}static maxLength(e){return FIe(e)}static pattern(e){return LIe(e)}static nullValidator(e){return hI(e)}static compose(e){return oK(e)}static composeAsync(e){return aK(e)}};function MIe(t){return e=>{if(qh(e.value)||qh(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function OIe(t){return e=>{if(qh(e.value)||qh(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function Jq(t){return qh(t.value)?{required:!0}:null}function NIe(t){return t.value===!0?null:{required:!0}}function PIe(t){return qh(t.value)||AIe.test(t.value)?null:{email:!0}}function kIe(t){return e=>qh(e.value)||!Qq(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function FIe(t){return e=>Qq(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function LIe(t){if(!t)return hI;let e,n;return typeof t=="string"?(n="",t.charAt(0)!=="^"&&(n+="^"),n+=t,t.charAt(t.length-1)!=="$"&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),r=>{if(qh(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}function hI(t){return null}function eK(t){return t!=null}function tK(t){return Xm(t)?Nr(t):t}function nK(t){let e={};return t.forEach(n=>{e=n!=null?Ee(Ee({},e),n):e}),Object.keys(e).length===0?null:e}function rK(t,e){return e.map(n=>n(t))}function HIe(t){return!t.validate}function iK(t){return t.map(e=>HIe(e)?e:n=>e.validate(n))}function oK(t){if(!t)return null;let e=t.filter(eK);return e.length==0?null:function(n){return nK(rK(n,e))}}function sK(t){return t!=null?oK(iK(t)):null}function aK(t){if(!t)return null;let e=t.filter(eK);return e.length==0?null:function(n){let r=rK(n,e).map(tK);return rF(r).pipe(dn(nK))}}function lK(t){return t!=null?aK(iK(t)):null}function Wq(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function cK(t){return t._rawValidators}function uK(t){return t._rawAsyncValidators}function qH(t){return t?Array.isArray(t)?t:[t]:[]}function fI(t,e){return Array.isArray(t)?t.includes(e):t===e}function jq(t,e){let n=qH(e);return qH(t).forEach(i=>{fI(n,i)||n.push(i)}),n}function $q(t,e){return qH(e).filter(n=>!fI(t,n))}var mI=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=sK(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=lK(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Ca=class extends mI{get formDirective(){return null}get path(){return null}},tp=class extends mI{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},pI=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},VIe={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Jpt=ft(Ee({},VIe),{"[class.ng-submitted]":"isSubmitted"}),ou=(()=>{let e=class e extends pI{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(je(tp,2))},e.\u0275dir=kn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,o){i&2&&Xr("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)},features:[qi]});let t=e;return t})(),Xh=(()=>{let e=class e extends pI{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(je(Ca,10))},e.\u0275dir=kn({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,o){i&2&&Xr("ng-untouched",o.isUntouched)("ng-touched",o.isTouched)("ng-pristine",o.isPristine)("ng-dirty",o.isDirty)("ng-valid",o.isValid)("ng-invalid",o.isInvalid)("ng-pending",o.isPending)("ng-submitted",o.isSubmitted)},features:[qi]});let t=e;return t})();var OC="VALID",dI="INVALID",sv="PENDING",NC="DISABLED";function QH(t){return(wI(t)?t.validators:t)||null}function BIe(t){return Array.isArray(t)?sK(t):t||null}function JH(t,e){return(wI(e)?e.asyncValidators:t)||null}function UIe(t){return Array.isArray(t)?lK(t):t||null}function wI(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function dK(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new Je(1e3,"");if(!r[n])throw new Je(1001,"")}function hK(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new Je(1002,"")})}var av=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===OC}get invalid(){return this.status===dI}get pending(){return this.status==sv}get disabled(){return this.status===NC}get enabled(){return this.status!==NC}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(jq(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(jq(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators($q(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators($q(e,this._rawAsyncValidators))}hasValidator(e){return fI(this._rawValidators,e)}hasAsyncValidator(e){return fI(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=sv,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=NC,this.errors=null,this._forEachChild(r=>{r.disable(ft(Ee({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ft(Ee({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=OC,this._forEachChild(r=>{r.enable(ft(Ee({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ft(Ee({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===OC||this.status===sv)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?NC:OC}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=sv,this._hasOwnPendingAsyncValidator=!0;let n=tK(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new hr,this.statusChanges=new hr}_calculateStatus(){return this._allControlsDisabled()?NC:this.errors?dI:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(sv)?sv:this._anyControlsHaveStatus(dI)?dI:OC}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){wI(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=BIe(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=UIe(this._rawAsyncValidators)}},Kh=class extends av{constructor(e,n,r){super(QH(n),JH(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){hK(this,!0,e),Object.keys(e).forEach(r=>{dK(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,o)=>{r=n(r,i,o)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var KH=class extends Kh{};var yI=new Ut("CallSetDisabledState",{providedIn:"root",factory:()=>_I}),_I="always";function CI(t,e){return[...e.path,t]}function XH(t,e,n=_I){eV(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),jIe(t,e),GIe(t,e),$Ie(t,e),WIe(t,e)}function Gq(t,e,n=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),vI(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function gI(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function WIe(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function eV(t,e){let n=cK(t);e.validator!==null?t.setValidators(Wq(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=uK(t);e.asyncValidator!==null?t.setAsyncValidators(Wq(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();gI(e._rawValidators,i),gI(e._rawAsyncValidators,i)}function vI(t,e){let n=!1;if(t!==null){if(e.validator!==null){let i=cK(t);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==e.validator);o.length!==i.length&&(n=!0,t.setValidators(o))}}if(e.asyncValidator!==null){let i=uK(t);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==e.asyncValidator);o.length!==i.length&&(n=!0,t.setAsyncValidators(o))}}}let r=()=>{};return gI(e._rawValidators,r),gI(e._rawAsyncValidators,r),n}function jIe(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&fK(t,e)})}function $Ie(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&fK(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function fK(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function GIe(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function zIe(t,e){t==null,eV(t,e)}function YIe(t,e){return vI(t,e)}function mK(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function qIe(t){return Object.getPrototypeOf(t.constructor)===PC}function KIe(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function pK(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(o=>{o.constructor===iu?n=o:qIe(o)?r=o:i=o}),i||r||n||null}function XIe(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function zq(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function Yq(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var Is=class extends av{constructor(e=null,n,r){super(QH(n),JH(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),wI(n)&&(n.nonNullable||n.initialValueIsDefault)&&(Yq(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){zq(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){zq(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Yq(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var ZIe=t=>t instanceof Is,QIe=(()=>{let e=class e extends Ca{ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return CI(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275dir=kn({type:e,features:[qi]});let t=e;return t})();var JIe={provide:tp,useExisting:Zo(()=>LC)},qq=(()=>Promise.resolve())(),LC=(()=>{let e=class e extends tp{constructor(r,i,o,s,a,l){super(),this._changeDetectorRef=a,this.callSetDisabledState=l,this.control=new Is,this._registered=!1,this.name="",this.update=new hr,this._parent=r,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=pK(this,s)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),mK(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){XH(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){qq.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,o=i!==0&&Hh(i);qq.then(()=>{o&&!this.control.disabled?this.control.disable():!o&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?CI(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(je(Ca,9),je(np,10),je(FC,10),je(Sd,10),je(Za,8),je(yI,8))},e.\u0275dir=kn({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ao([JIe]),qi,Yi]});let t=e;return t})(),SI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=kn({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),eAe={provide:Sd,useExisting:Zo(()=>HC),multi:!0},HC=(()=>{let e=class e extends PC{writeValue(r){let i=r??"";this.setProperty("value",i)}registerOnChange(r){this.onChange=i=>{r(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275dir=kn({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,o){i&1&&Ue("input",function(a){return o.onChange(a.target.value)})("blur",function(){return o.onTouched()})},features:[ao([eAe]),qi]});let t=e;return t})();var tAe=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({});let t=e;return t})();var gK=new Ut("NgModelWithFormControlWarning");var nAe={provide:Ca,useExisting:Zo(()=>Zh)},Zh=(()=>{let e=class e extends Ca{constructor(r,i,o){super(),this.callSetDisabledState=o,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new hr,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(vI(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return XH(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){Gq(r.control||null,r,!1),XIe(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,KIe(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,o=this.form.get(r.path);i!==o&&(Gq(i||null,r),ZIe(o)&&(XH(o,r,this.callSetDisabledState),r.control=o))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);zIe(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&YIe(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){eV(this.form,this),this._oldForm&&vI(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(je(np,10),je(FC,10),je(yI,8))},e.\u0275dir=kn({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,o){i&1&&Ue("submit",function(a){return o.onSubmit(a)})("reset",function(){return o.onReset()})},inputs:{form:["formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ao([nAe]),qi,Yi]});let t=e;return t})(),rAe={provide:Ca,useExisting:Zo(()=>EI)},EI=(()=>{let e=class e extends QIe{constructor(r,i,o){super(),this.name=null,this._parent=r,this._setValidators(i),this._setAsyncValidators(o)}_checkParentType(){vK(this._parent)}};e.\u0275fac=function(i){return new(i||e)(je(Ca,13),je(np,10),je(FC,10))},e.\u0275dir=kn({type:e,selectors:[["","formGroupName",""]],inputs:{name:["formGroupName","name"]},features:[ao([rAe]),qi]});let t=e;return t})(),iAe={provide:Ca,useExisting:Zo(()=>xI)},xI=(()=>{let e=class e extends Ca{constructor(r,i,o){super(),this.name=null,this._parent=r,this._setValidators(i),this._setAsyncValidators(o)}ngOnInit(){this._checkParentType(),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return CI(this.name==null?this.name:this.name.toString(),this._parent)}_checkParentType(){vK(this._parent)}};e.\u0275fac=function(i){return new(i||e)(je(Ca,13),je(np,10),je(FC,10))},e.\u0275dir=kn({type:e,selectors:[["","formArrayName",""]],inputs:{name:["formArrayName","name"]},features:[ao([iAe]),qi]});let t=e;return t})();function vK(t){return!(t instanceof EI)&&!(t instanceof Zh)&&!(t instanceof xI)}var oAe={provide:tp,useExisting:Zo(()=>rp)},rp=(()=>{let e=class e extends tp{set isDisabled(r){}constructor(r,i,o,s,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new hr,this._ngModelWarningSent=!1,this._parent=r,this._setValidators(i),this._setAsyncValidators(o),this.valueAccessor=pK(this,s)}ngOnChanges(r){this._added||this._setUpControl(),mK(r,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}get path(){return CI(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(je(Ca,13),je(np,10),je(FC,10),je(Sd,10),je(gK,8))},e.\u0275dir=kn({type:e,selectors:[["","formControlName",""]],inputs:{name:["formControlName","name"],isDisabled:["disabled","isDisabled"],model:["ngModel","model"]},outputs:{update:"ngModelChange"},features:[ao([oAe]),qi,Yi]});let t=e;return t})(),sAe={provide:Sd,useExisting:Zo(()=>su),multi:!0};function wK(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function aAe(t){return t.split(":")[0]}var su=(()=>{let e=class e extends PC{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),o=wK(i,r);this.setProperty("value",o)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=aAe(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275dir=kn({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,o){i&1&&Ue("change",function(a){return o.onChange(a.target.value)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},features:[ao([sAe]),qi]});let t=e;return t})(),Qh=(()=>{let e=class e{constructor(r,i,o){this._element=r,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(wK(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(je(Mi),je(fd),je(su,9))},e.\u0275dir=kn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),lAe={provide:Sd,useExisting:Zo(()=>yK),multi:!0};function Kq(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function cAe(t){return t.split(":")[0]}var yK=(()=>{let e=class e extends PC{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let o=r.map(s=>this._getOptionId(s));i=(s,a)=>{s._setSelected(o.indexOf(a.toString())>-1)}}else i=(o,s)=>{o._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let o=[],s=i.selectedOptions;if(s!==void 0){let a=s;for(let l=0;l<a.length;l++){let c=a[l],u=this._getOptionValue(c.value);o.push(u)}}else{let a=i.options;for(let l=0;l<a.length;l++){let c=a[l];if(c.selected){let u=this._getOptionValue(c.value);o.push(u)}}}this.value=o,r(o)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=cAe(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275dir=kn({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,o){i&1&&Ue("change",function(a){return o.onChange(a.target)})("blur",function(){return o.onTouched()})},inputs:{compareWith:"compareWith"},features:[ao([lAe]),qi]});let t=e;return t})(),Jh=(()=>{let e=class e{constructor(r,i,o){this._element=r,this._renderer=i,this._select=o,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(Kq(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(Kq(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(je(Mi),je(fd),je(yK,9))},e.\u0275dir=kn({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var uAe=(()=>{let e=class e{constructor(){this._validator=hI}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):hI,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=kn({type:e,features:[Yi]});let t=e;return t})();var dAe={provide:np,useExisting:Zo(()=>ip),multi:!0};var ip=(()=>{let e=class e extends uAe{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Hh,this.createValidator=r=>Jq}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275dir=kn({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,o){i&2&&Js("required",o._enabled?"":null)},inputs:{required:"required"},features:[ao([dAe]),qi]});let t=e;return t})();var _K=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({imports:[tAe]});let t=e;return t})(),ZH=class extends av{constructor(e,n,r){super(QH(n),JH(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,n={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(e,n,r={}){this.controls.splice(e,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,n={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(e,n,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),n&&(this.controls.splice(i,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,n={}){hK(this,!1,e),e.forEach((r,i)=>{dK(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e=[],n={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((n,r)=>r._syncPendingControls()?!0:n,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((n,r)=>{e(n,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(n=>n.enabled&&e(n))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Xq(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var CK=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let r=new e;return r.useNonNullable=!0,r}group(r,i=null){let o=this._reduceControls(r),s={};return Xq(i)?s=i:i!==null&&(s.validators=i.validator,s.asyncValidators=i.asyncValidator),new Kh(o,s)}record(r,i=null){let o=this._reduceControls(r);return new KH(o,i)}control(r,i,o){let s={};return this.useNonNullable?(Xq(i)?s=i:(s.validators=i,s.asyncValidators=o),new Is(r,ft(Ee({},s),{nonNullable:!0}))):new Is(r,i,o)}array(r,i,o){let s=r.map(a=>this._createControl(a));return new ZH(s,i,o)}_reduceControls(r){let i={};return Object.keys(r).forEach(o=>{i[o]=this._createControl(r[o])}),i}_createControl(r){if(r instanceof Is)return r;if(r instanceof av)return r;if(Array.isArray(r)){let i=r[0],o=r.length>1?r[1]:null,s=r.length>2?r[2]:null;return this.control(i,o,s)}else return this.control(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var lv=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:yI,useValue:r.callSetDisabledState??_I}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({imports:[_K]});let t=e;return t})(),ef=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:gK,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:yI,useValue:r.callSetDisabledState??_I}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({imports:[_K]});let t=e;return t})();var ui=(()=>{let e=class e{constructor(r){this.httpClient=r,this.API_HOST="https://raillmg-server.onrender.com/api",this.isLoading$=new Ur}loginUser(r,i){return this.httpClient.get(`${this.API_HOST}/users?username=${r}&password=${i}`)}getAllUser(){return this.httpClient.get(`${this.API_HOST}/users/allUsers`)}deleteUser(r){return this.httpClient.delete(`${this.API_HOST}/users/${r}`)}updateUser(r,i){return this.httpClient.patch(`${this.API_HOST}/users/${r}`,i)}register(r){return this.httpClient.post(this.API_HOST+"/users",r)}getAllMachineRoll(r){return this.httpClient.get(`${this.API_HOST}/${r}`)}getRailDetails(r){return this.httpClient.get(`${this.API_HOST}/railDetails/${r}`)}getAllRailDetails(r){return this.httpClient.get(`${this.API_HOST}/${r}`)}addRailDetails(r,i){return this.httpClient.post(`${this.API_HOST}/${r}`,i)}updateRailDetails(r,i,o){return this.httpClient.patch(`${this.API_HOST}/${r}/${i}`,o)}deleteRailDetails(r,i){return this.httpClient.delete(`${this.API_HOST}/${r}/${i}`)}};e.\u0275fac=function(i){return new(i||e)(kt(ZL))},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ni=(()=>{let e=class e{constructor(r){this.platform=r,this.KEY_USER="user",this.isUserLoggedIn=new Ur}getUser(){return jL(this.platform)?JSON.parse(localStorage.getItem(this.KEY_USER)):{}}setUser(r){this.isUserLoggedIn.next(!0),localStorage.setItem(this.KEY_USER,JSON.stringify(r))}removeUser(){this.isUserLoggedIn.next(!1),localStorage.removeItem(this.KEY_USER)}};e.\u0275fac=function(i){return new(i||e)(kt(ql))},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var SK=(()=>{let e=class e{constructor(r,i,o){this.service=r,this.ls=i,this.router=o}ngOnInit(){this.registerForm=new Kh({username:new Is(null,Cd.required),password:new Is(null,Cd.required),designation:new Is(null,Cd.required),department:new Is(null,Cd.required)})}onRegister(){this.registerForm.valid&&this.service.register(this.registerForm.value).subscribe(r=>{this.ls.setUser(r),this.router.navigate(["/lmg"])})}};e.\u0275fac=function(i){return new(i||e)(je(ui),je(Ni),je(Ds))},e.\u0275cmp=jt({type:e,selectors:[["app-register"]],standalone:!0,features:[qt],decls:52,vars:1,consts:[[1,"vh-100",2,"background-color","rgb(244, 244, 244)"],[1,"container","h-100"],[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-5"],[1,"card","shadow-2-strong",2,"border-radius","1rem"],[1,"text-center","pt-5"],[1,"card-body","p-5"],[1,"mb-5","text-center"],[3,"formGroup"],[1,"form-group","mt-3","mb-3"],["for","usename"],["type","text","id","username","placeholder","Enter User Name","formControlName","username",1,"form-control"],["for","password"],["type","password","id","password","placeholder","Password","formControlName","password",1,"form-control"],["for","designation"],["type","text","id","designation","placeholder","Enter DESIGNATION","formControlName","designation",1,"form-control"],["formControlName","department",1,"form-select"],["value","null","disabled","","selected",""],["value","OPERATING"],["value","CONSTRUCTION"],["value","ENGINEERING"],["value","RE"],["value","RVNL"],["value","SIGNAL"],["value","Telecom"],["value","TRD"],["type","submit",1,"btn","btn-primary","w-100","btn-lg","mt-2",3,"click"],[1,"text-center","mt-2","user-footer"],["type","button","routerLink","/login",1,"btn","btn-link"]],template:function(i,o){i&1&&(W(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),re(6,"LUMDING DIVISION"),V(),W(7,"div",6)(8,"h3",7),re(9,"Register"),V(),W(10,"form",8)(11,"div",9)(12,"label",10),re(13,"User Name"),V(),at(14,"input",11),V(),W(15,"div",9)(16,"label",12),re(17,"Password"),V(),at(18,"input",13),V(),W(19,"div",9)(20,"label",14),re(21,"Designation"),V(),at(22,"input",15),V(),W(23,"div",9)(24,"label"),re(25,"Department"),V(),W(26,"select",16)(27,"option",17),re(28," Select Department "),V(),W(29,"option",18),re(30,"OPERATING"),V(),W(31,"option",19),re(32,"CONSTRUCTION"),V(),W(33,"option",20),re(34,"ENGINEERING"),V(),W(35,"option",21),re(36,"RE"),V(),W(37,"option",22),re(38,"RVNL"),V(),W(39,"option",23),re(40,"SIGNAL"),V(),W(41,"option",24),re(42,"Telecom"),V(),W(43,"option",25),re(44,"TRD"),V()()(),W(45,"button",26),Ue("click",function(){return o.onRegister()}),re(46," Register "),V()(),W(47,"div",27)(48,"span"),re(49,"Already have an account?"),V(),W(50,"button",28),re(51," Login "),V()()()()()()()()),i&2&&(Te(10),lt("formGroup",o.registerForm))},dependencies:[ov,ef,SI,Qh,Jh,iu,su,ou,Xh,Zh,rp]});let t=e;return t})();var lo=(()=>{let e=class e{constructor(){this.toasts=[]}remove(r){this.toasts=this.toasts.filter(i=>i!==r)}clear(){this.toasts.splice(0,this.toasts.length)}showSuccess(r){this.toasts.push({template:r,classname:"bg-success text-light",delay:5e3})}showDanger(r){this.toasts.push({template:r,classname:"bg-danger text-light",delay:5e3})}showWarning(r){this.toasts.push({template:r,classname:"bg-warning text-success",delay:5e3})}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var EK=(()=>{let e=class e{constructor(r,i,o,s){this.service=r,this.ls=i,this.toastService=o,this.router=s}ngOnInit(){this.userForm=new Kh({username:new Is(null),password:new Is(null),newPassword:new Is(null),conformPassword:new Is(null)})}onLogin(){this.service.isLoading$.next(!0),this.service.loginUser(this.userForm.value.username,this.userForm.value.password).subscribe({next:r=>{this.ls.setUser(r),this.router.navigate(["/lmg"])},error:r=>{this.service.isLoading$.next(!1),this.toastService.showDanger("failed to login")}})}resetPassword(){if(!this.userForm.valid){this.toastService.showWarning("fill all details");return}if(this.userForm.value.conformPassword!==this.userForm.value.newPassword){this.toastService.showDanger("CONFORM PASSWORD INCORRECT");return}this.service.isLoading$.next(!0),this.service.loginUser(this.userForm.value.username,this.userForm.value.password).subscribe({next:r=>{let i={password:this.userForm.value.newPassword};this.service.updateUser(r._id,i).subscribe(o=>{this.toastService.showSuccess("successfully RESET"),this.userForm.reset()})},error:r=>{this.service.isLoading$.next(!1),this.toastService.showDanger("no user found")}})}};e.\u0275fac=function(i){return new(i||e)(je(ui),je(Ni),je(lo),je(Ds))},e.\u0275cmp=jt({type:e,selectors:[["app-login"]],standalone:!0,features:[qt],decls:59,vars:2,consts:[[1,"vh-100",2,"background-color","rgb(244, 244, 244)"],[1,"container","py-5","h-100"],[1,"row","d-flex","justify-content-center","align-items-center","h-100"],[1,"col-12","col-md-8","col-lg-6","col-xl-5"],[1,"card","shadow-2-strong",2,"border-radius","1rem"],[1,"text-center","pt-5"],[1,"card-body","p-5"],[1,"mb-5","text-center"],["ngNativeValidate","",3,"formGroup","submit"],[1,"form-group","mt-3","mb-3"],["for","usename"],["type","text","id","username","placeholder","Enter User Name","formControlName","username","required","",1,"form-control"],["for","password"],["type","password","id","password","placeholder","Password","formControlName","password","required","",1,"form-control"],["type","submit",1,"btn","btn-primary","w-100","btn-lg","mt-5"],[1,"text-center","mt-2","user-footer"],["type","button","data-bs-toggle","modal","data-bs-target","#exampleModal",1,"btn","btn-link"],["id","exampleModal","tabindex","-1","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,""],[1,"mt-3"],["type","text","placeholder","ENTER USER NAME","formControlName","username","required","",1,"form-control"],["type","text","placeholder","ENTER OLD PASSWORD","formControlName","password","required","",1,"form-control"],["type","text","placeholder","ENTER NEW PASSWORD","formControlName","newPassword","required","",1,"form-control"],["type","password","placeholder","ENTER CONFORM PASSWORD","formControlName","conformPassword","required","",1,"form-control"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary"],["type","submit",1,"btn","btn-primary"]],template:function(i,o){i&1&&(W(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h1",5),re(6,"LUMDING DIVISION"),V(),W(7,"div",6)(8,"h3",7),re(9,"Log in"),V(),W(10,"form",8),Ue("submit",function(){return o.onLogin()}),W(11,"div",9)(12,"label",10),re(13,"User Name"),V(),at(14,"input",11),V(),W(15,"div",9)(16,"label",12),re(17,"Password"),V(),at(18,"input",13),V(),W(19,"button",14),re(20," Login "),V()(),W(21,"div",15)(22,"button",16),re(23," Reset Password "),V()()()()()()()(),W(24,"div",17)(25,"div",18)(26,"div",19)(27,"div",20)(28,"h5",21),re(29,"Reset Password"),V(),at(30,"button",22),V(),W(31,"form",8),Ue("submit",function(){return o.resetPassword()}),W(32,"div",23)(33,"div",24)(34,"div",25)(35,"label",24)(36,"b"),re(37,"User Name :"),V()(),at(38,"input",26),V(),W(39,"div",25)(40,"label",24)(41,"b"),re(42,"Old Password :"),V()(),at(43,"input",27),V(),W(44,"div",25)(45,"label",24)(46,"b"),re(47,"New Password :"),V()(),at(48,"input",28),V(),W(49,"div",25)(50,"label",24)(51,"b"),re(52,"Conform Password :"),V()(),at(53,"input",29),V()()(),W(54,"div",30)(55,"button",31),re(56,"Close"),V(),W(57,"button",32),re(58,"submit"),V()()()()()()),i&2&&(Te(10),lt("formGroup",o.userForm),Te(21),lt("formGroup",o.userForm))},dependencies:[ef,iu,ou,Xh,ip,Zh,rp],styles:[".form-control[_ngcontent-%COMP%]{height:40px}"]});let t=e;return t})();function bI(t){t||(O9(bI),t=qe(Q_));let e=new en(n=>t.onDestroy(n.next.bind(n)));return n=>n.pipe(Ya(e))}var Pi="top",Oo="bottom",co="right",Xi="left",TI="auto",tf=[Pi,Oo,co,Xi],xd="start",op="end",xK="clippingParents",RI="viewport",uv="popper",bK="reference",tV=tf.reduce(function(t,e){return t.concat([e+"-"+xd,e+"-"+op])},[]),DI=[].concat(tf,[TI]).reduce(function(t,e){return t.concat([e,e+"-"+xd,e+"-"+op])},[]),hAe="beforeRead",fAe="read",mAe="afterRead",pAe="beforeMain",gAe="main",vAe="afterMain",wAe="beforeWrite",yAe="write",_Ae="afterWrite",TK=[hAe,fAe,mAe,pAe,gAe,vAe,wAe,yAe,_Ae];function uo(t){return t?(t.nodeName||"").toLowerCase():null}function jr(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function Ja(t){var e=jr(t).Element;return t instanceof e||t instanceof Element}function Zi(t){var e=jr(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function dv(t){if(typeof ShadowRoot>"u")return!1;var e=jr(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function CAe(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},i=e.attributes[n]||{},o=e.elements[n];!Zi(o)||!uo(o)||(Object.assign(o.style,r),Object.keys(i).forEach(function(s){var a=i[s];a===!1?o.removeAttribute(s):o.setAttribute(s,a===!0?"":a)}))})}function SAe(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var i=e.elements[r],o=e.attributes[r]||{},s=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),a=s.reduce(function(l,c){return l[c]="",l},{});!Zi(i)||!uo(i)||(Object.assign(i.style,a),Object.keys(o).forEach(function(l){i.removeAttribute(l)}))})}}var RK={name:"applyStyles",enabled:!0,phase:"write",fn:CAe,effect:SAe,requires:["computeStyles"]};function ho(t){return t.split("-")[0]}var Ql=Math.max,sp=Math.min,bd=Math.round;function hv(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function VC(){return!/^((?!chrome|android).)*safari/i.test(hv())}function el(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),i=1,o=1;e&&Zi(t)&&(i=t.offsetWidth>0&&bd(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&bd(r.height)/t.offsetHeight||1);var s=Ja(t)?jr(t):window,a=s.visualViewport,l=!VC()&&n,c=(r.left+(l&&a?a.offsetLeft:0))/i,u=(r.top+(l&&a?a.offsetTop:0))/o,d=r.width/i,h=r.height/o;return{width:d,height:h,top:u,right:c+d,bottom:u+h,left:c,x:c,y:u}}function ap(t){var e=el(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function BC(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&dv(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function As(t){return jr(t).getComputedStyle(t)}function nV(t){return["table","td","th"].indexOf(uo(t))>=0}function No(t){return((Ja(t)?t.ownerDocument:t.document)||window.document).documentElement}function Td(t){return uo(t)==="html"?t:t.assignedSlot||t.parentNode||(dv(t)?t.host:null)||No(t)}function DK(t){return!Zi(t)||As(t).position==="fixed"?null:t.offsetParent}function EAe(t){var e=/firefox/i.test(hv()),n=/Trident/i.test(hv());if(n&&Zi(t)){var r=As(t);if(r.position==="fixed")return null}var i=Td(t);for(dv(i)&&(i=i.host);Zi(i)&&["html","body"].indexOf(uo(i))<0;){var o=As(i);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return i;i=i.parentNode}return null}function Jl(t){for(var e=jr(t),n=DK(t);n&&nV(n)&&As(n).position==="static";)n=DK(n);return n&&(uo(n)==="html"||uo(n)==="body"&&As(n).position==="static")?e:n||EAe(t)||e}function lp(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function cp(t,e,n){return Ql(t,sp(e,n))}function IK(t,e,n){var r=cp(t,e,n);return r>n?n:r}function UC(){return{top:0,right:0,bottom:0,left:0}}function WC(t){return Object.assign({},UC(),t)}function jC(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var xAe=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,WC(typeof e!="number"?e:jC(e,tf))};function bAe(t){var e,n=t.state,r=t.name,i=t.options,o=n.elements.arrow,s=n.modifiersData.popperOffsets,a=ho(n.placement),l=lp(a),c=[Xi,co].indexOf(a)>=0,u=c?"height":"width";if(!(!o||!s)){var d=xAe(i.padding,n),h=ap(o),f=l==="y"?Pi:Xi,p=l==="y"?Oo:co,g=n.rects.reference[u]+n.rects.reference[l]-s[l]-n.rects.popper[u],w=s[l]-n.rects.reference[l],_=Jl(o),S=_?l==="y"?_.clientHeight||0:_.clientWidth||0:0,x=g/2-w/2,P=d[f],k=S-h[u]-d[p],b=S/2-h[u]/2+x,C=cp(P,b,k),N=l;n.modifiersData[r]=(e={},e[N]=C,e.centerOffset=C-b,e)}}function TAe(t){var e=t.state,n=t.options,r=n.element,i=r===void 0?"[data-popper-arrow]":r;i!=null&&(typeof i=="string"&&(i=e.elements.popper.querySelector(i),!i)||BC(e.elements.popper,i)&&(e.elements.arrow=i))}var rV={name:"arrow",enabled:!0,phase:"main",fn:bAe,effect:TAe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function tl(t){return t.split("-")[1]}var RAe={top:"auto",right:"auto",bottom:"auto",left:"auto"};function DAe(t,e){var n=t.x,r=t.y,i=e.devicePixelRatio||1;return{x:bd(n*i)/i||0,y:bd(r*i)/i||0}}function AK(t){var e,n=t.popper,r=t.popperRect,i=t.placement,o=t.variation,s=t.offsets,a=t.position,l=t.gpuAcceleration,c=t.adaptive,u=t.roundOffsets,d=t.isFixed,h=s.x,f=h===void 0?0:h,p=s.y,g=p===void 0?0:p,w=typeof u=="function"?u({x:f,y:g}):{x:f,y:g};f=w.x,g=w.y;var _=s.hasOwnProperty("x"),S=s.hasOwnProperty("y"),x=Xi,P=Pi,k=window;if(c){var b=Jl(n),C="clientHeight",N="clientWidth";if(b===jr(n)&&(b=No(n),As(b).position!=="static"&&a==="absolute"&&(C="scrollHeight",N="scrollWidth")),b=b,i===Pi||(i===Xi||i===co)&&o===op){P=Oo;var B=d&&b===k&&k.visualViewport?k.visualViewport.height:b[C];g-=B-r.height,g*=l?1:-1}if(i===Xi||(i===Pi||i===Oo)&&o===op){x=co;var Y=d&&b===k&&k.visualViewport?k.visualViewport.width:b[N];f-=Y-r.width,f*=l?1:-1}}var ee=Object.assign({position:a},c&&RAe),te=u===!0?DAe({x:f,y:g},jr(n)):{x:f,y:g};if(f=te.x,g=te.y,l){var Ce;return Object.assign({},ee,(Ce={},Ce[P]=S?"0":"",Ce[x]=_?"0":"",Ce.transform=(k.devicePixelRatio||1)<=1?"translate("+f+"px, "+g+"px)":"translate3d("+f+"px, "+g+"px, 0)",Ce))}return Object.assign({},ee,(e={},e[P]=S?g+"px":"",e[x]=_?f+"px":"",e.transform="",e))}function IAe(t){var e=t.state,n=t.options,r=n.gpuAcceleration,i=r===void 0?!0:r,o=n.adaptive,s=o===void 0?!0:o,a=n.roundOffsets,l=a===void 0?!0:a,c={placement:ho(e.placement),variation:tl(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:i,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,AK(Object.assign({},c,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:s,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,AK(Object.assign({},c,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var MK={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:IAe,data:{}};var II={passive:!0};function AAe(t){var e=t.state,n=t.instance,r=t.options,i=r.scroll,o=i===void 0?!0:i,s=r.resize,a=s===void 0?!0:s,l=jr(e.elements.popper),c=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&c.forEach(function(u){u.addEventListener("scroll",n.update,II)}),a&&l.addEventListener("resize",n.update,II),function(){o&&c.forEach(function(u){u.removeEventListener("scroll",n.update,II)}),a&&l.removeEventListener("resize",n.update,II)}}var OK={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:AAe,data:{}};var MAe={left:"right",right:"left",bottom:"top",top:"bottom"};function fv(t){return t.replace(/left|right|bottom|top/g,function(e){return MAe[e]})}var OAe={start:"end",end:"start"};function AI(t){return t.replace(/start|end/g,function(e){return OAe[e]})}function up(t){var e=jr(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function dp(t){return el(No(t)).left+up(t).scrollLeft}function iV(t,e){var n=jr(t),r=No(t),i=n.visualViewport,o=r.clientWidth,s=r.clientHeight,a=0,l=0;if(i){o=i.width,s=i.height;var c=VC();(c||!c&&e==="fixed")&&(a=i.offsetLeft,l=i.offsetTop)}return{width:o,height:s,x:a+dp(t),y:l}}function oV(t){var e,n=No(t),r=up(t),i=(e=t.ownerDocument)==null?void 0:e.body,o=Ql(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),s=Ql(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+dp(t),l=-r.scrollTop;return As(i||n).direction==="rtl"&&(a+=Ql(n.clientWidth,i?i.clientWidth:0)-o),{width:o,height:s,x:a,y:l}}function hp(t){var e=As(t),n=e.overflow,r=e.overflowX,i=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function MI(t){return["html","body","#document"].indexOf(uo(t))>=0?t.ownerDocument.body:Zi(t)&&hp(t)?t:MI(Td(t))}function nf(t,e){var n;e===void 0&&(e=[]);var r=MI(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=jr(r),s=i?[o].concat(o.visualViewport||[],hp(r)?r:[]):r,a=e.concat(s);return i?a:a.concat(nf(Td(s)))}function mv(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function NAe(t,e){var n=el(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function NK(t,e,n){return e===RI?mv(iV(t,n)):Ja(e)?NAe(e,n):mv(oV(No(t)))}function PAe(t){var e=nf(Td(t)),n=["absolute","fixed"].indexOf(As(t).position)>=0,r=n&&Zi(t)?Jl(t):t;return Ja(r)?e.filter(function(i){return Ja(i)&&BC(i,r)&&uo(i)!=="body"}):[]}function sV(t,e,n,r){var i=e==="clippingParents"?PAe(t):[].concat(e),o=[].concat(i,[n]),s=o[0],a=o.reduce(function(l,c){var u=NK(t,c,r);return l.top=Ql(u.top,l.top),l.right=sp(u.right,l.right),l.bottom=sp(u.bottom,l.bottom),l.left=Ql(u.left,l.left),l},NK(t,s,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function $C(t){var e=t.reference,n=t.element,r=t.placement,i=r?ho(r):null,o=r?tl(r):null,s=e.x+e.width/2-n.width/2,a=e.y+e.height/2-n.height/2,l;switch(i){case Pi:l={x:s,y:e.y-n.height};break;case Oo:l={x:s,y:e.y+e.height};break;case co:l={x:e.x+e.width,y:a};break;case Xi:l={x:e.x-n.width,y:a};break;default:l={x:e.x,y:e.y}}var c=i?lp(i):null;if(c!=null){var u=c==="y"?"height":"width";switch(o){case xd:l[c]=l[c]-(e[u]/2-n[u]/2);break;case op:l[c]=l[c]+(e[u]/2-n[u]/2);break;default:}}return l}function rf(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=r===void 0?t.placement:r,o=n.strategy,s=o===void 0?t.strategy:o,a=n.boundary,l=a===void 0?xK:a,c=n.rootBoundary,u=c===void 0?RI:c,d=n.elementContext,h=d===void 0?uv:d,f=n.altBoundary,p=f===void 0?!1:f,g=n.padding,w=g===void 0?0:g,_=WC(typeof w!="number"?w:jC(w,tf)),S=h===uv?bK:uv,x=t.rects.popper,P=t.elements[p?S:h],k=sV(Ja(P)?P:P.contextElement||No(t.elements.popper),l,u,s),b=el(t.elements.reference),C=$C({reference:b,element:x,strategy:"absolute",placement:i}),N=mv(Object.assign({},x,C)),B=h===uv?N:b,Y={top:k.top-B.top+_.top,bottom:B.bottom-k.bottom+_.bottom,left:k.left-B.left+_.left,right:B.right-k.right+_.right},ee=t.modifiersData.offset;if(h===uv&&ee){var te=ee[i];Object.keys(Y).forEach(function(Ce){var Re=[co,Oo].indexOf(Ce)>=0?1:-1,_e=[Pi,Oo].indexOf(Ce)>=0?"y":"x";Y[Ce]+=te[_e]*Re})}return Y}function aV(t,e){e===void 0&&(e={});var n=e,r=n.placement,i=n.boundary,o=n.rootBoundary,s=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=l===void 0?DI:l,u=tl(r),d=u?a?tV:tV.filter(function(p){return tl(p)===u}):tf,h=d.filter(function(p){return c.indexOf(p)>=0});h.length===0&&(h=d);var f=h.reduce(function(p,g){return p[g]=rf(t,{placement:g,boundary:i,rootBoundary:o,padding:s})[ho(g)],p},{});return Object.keys(f).sort(function(p,g){return f[p]-f[g]})}function kAe(t){if(ho(t)===TI)return[];var e=fv(t);return[AI(t),e,AI(e)]}function FAe(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,a=s===void 0?!0:s,l=n.fallbackPlacements,c=n.padding,u=n.boundary,d=n.rootBoundary,h=n.altBoundary,f=n.flipVariations,p=f===void 0?!0:f,g=n.allowedAutoPlacements,w=e.options.placement,_=ho(w),S=_===w,x=l||(S||!p?[fv(w)]:kAe(w)),P=[w].concat(x).reduce(function(O,U){return O.concat(ho(U)===TI?aV(e,{placement:U,boundary:u,rootBoundary:d,padding:c,flipVariations:p,allowedAutoPlacements:g}):U)},[]),k=e.rects.reference,b=e.rects.popper,C=new Map,N=!0,B=P[0],Y=0;Y<P.length;Y++){var ee=P[Y],te=ho(ee),Ce=tl(ee)===xd,Re=[Pi,Oo].indexOf(te)>=0,_e=Re?"width":"height",L=rf(e,{placement:ee,boundary:u,rootBoundary:d,altBoundary:h,padding:c}),M=Re?Ce?co:Xi:Ce?Oo:Pi;k[_e]>b[_e]&&(M=fv(M));var q=fv(M),y=[];if(o&&y.push(L[te]<=0),a&&y.push(L[M]<=0,L[q]<=0),y.every(function(O){return O})){B=ee,N=!1;break}C.set(ee,y)}if(N)for(var E=p?3:1,R=function(U){var ie=P.find(function(ue){var fe=C.get(ue);if(fe)return fe.slice(0,U).every(function(de){return de})});if(ie)return B=ie,"break"},D=E;D>0;D--){var A=R(D);if(A==="break")break}e.placement!==B&&(e.modifiersData[r]._skip=!0,e.placement=B,e.reset=!0)}}var lV={name:"flip",enabled:!0,phase:"main",fn:FAe,requiresIfExists:["offset"],data:{_skip:!1}};function LAe(t,e,n){var r=ho(t),i=[Xi,Pi].indexOf(r)>=0?-1:1,o=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,s=o[0],a=o[1];return s=s||0,a=(a||0)*i,[Xi,co].indexOf(r)>=0?{x:a,y:s}:{x:s,y:a}}function HAe(t){var e=t.state,n=t.options,r=t.name,i=n.offset,o=i===void 0?[0,0]:i,s=DI.reduce(function(u,d){return u[d]=LAe(d,e.rects,o),u},{}),a=s[e.placement],l=a.x,c=a.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=c),e.modifiersData[r]=s}var cV={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:HAe};function VAe(t){var e=t.state,n=t.name;e.modifiersData[n]=$C({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var PK={name:"popperOffsets",enabled:!0,phase:"read",fn:VAe,data:{}};function uV(t){return t==="x"?"y":"x"}function BAe(t){var e=t.state,n=t.options,r=t.name,i=n.mainAxis,o=i===void 0?!0:i,s=n.altAxis,a=s===void 0?!1:s,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,d=n.padding,h=n.tether,f=h===void 0?!0:h,p=n.tetherOffset,g=p===void 0?0:p,w=rf(e,{boundary:l,rootBoundary:c,padding:d,altBoundary:u}),_=ho(e.placement),S=tl(e.placement),x=!S,P=lp(_),k=uV(P),b=e.modifiersData.popperOffsets,C=e.rects.reference,N=e.rects.popper,B=typeof g=="function"?g(Object.assign({},e.rects,{placement:e.placement})):g,Y=typeof B=="number"?{mainAxis:B,altAxis:B}:Object.assign({mainAxis:0,altAxis:0},B),ee=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,te={x:0,y:0};if(b){if(o){var Ce,Re=P==="y"?Pi:Xi,_e=P==="y"?Oo:co,L=P==="y"?"height":"width",M=b[P],q=M+w[Re],y=M-w[_e],E=f?-N[L]/2:0,R=S===xd?C[L]:N[L],D=S===xd?-N[L]:-C[L],A=e.elements.arrow,O=f&&A?ap(A):{width:0,height:0},U=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:UC(),ie=U[Re],ue=U[_e],fe=cp(0,C[L],O[L]),de=x?C[L]/2-E-fe-ie-Y.mainAxis:R-fe-ie-Y.mainAxis,ye=x?-C[L]/2+E+fe+ue+Y.mainAxis:D+fe+ue+Y.mainAxis,Pe=e.elements.arrow&&Jl(e.elements.arrow),F=Pe?P==="y"?Pe.clientTop||0:Pe.clientLeft||0:0,Ke=(Ce=ee?.[P])!=null?Ce:0,$e=M+de-Ke-F,rt=M+ye-Ke,Ye=cp(f?sp(q,$e):q,M,f?Ql(y,rt):y);b[P]=Ye,te[P]=Ye-M}if(a){var Me,j=P==="x"?Pi:Xi,z=P==="x"?Oo:co,J=b[k],pe=k==="y"?"height":"width",he=J+w[j],me=J-w[z],ve=[Pi,Xi].indexOf(_)!==-1,ne=(Me=ee?.[k])!=null?Me:0,ce=ve?he:J-C[pe]-N[pe]-ne+Y.altAxis,oe=ve?J+C[pe]+N[pe]-ne-Y.altAxis:me,ge=f&&ve?IK(ce,J,oe):cp(f?ce:he,J,f?oe:me);b[k]=ge,te[k]=ge-J}e.modifiersData[r]=te}}var dV={name:"preventOverflow",enabled:!0,phase:"main",fn:BAe,requiresIfExists:["offset"]};function hV(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function fV(t){return t===jr(t)||!Zi(t)?up(t):hV(t)}function UAe(t){var e=t.getBoundingClientRect(),n=bd(e.width)/t.offsetWidth||1,r=bd(e.height)/t.offsetHeight||1;return n!==1||r!==1}function mV(t,e,n){n===void 0&&(n=!1);var r=Zi(e),i=Zi(e)&&UAe(e),o=No(e),s=el(t,i,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&((uo(e)!=="body"||hp(o))&&(a=fV(e)),Zi(e)?(l=el(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):o&&(l.x=dp(o))),{x:s.left+a.scrollLeft-l.x,y:s.top+a.scrollTop-l.y,width:s.width,height:s.height}}function WAe(t){var e=new Map,n=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function i(o){n.add(o.name);var s=[].concat(o.requires||[],o.requiresIfExists||[]);s.forEach(function(a){if(!n.has(a)){var l=e.get(a);l&&i(l)}}),r.push(o)}return t.forEach(function(o){n.has(o.name)||i(o)}),r}function pV(t){var e=WAe(t);return TK.reduce(function(n,r){return n.concat(e.filter(function(i){return i.phase===r}))},[])}function gV(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function vV(t){var e=t.reduce(function(n,r){var i=n[r.name];return n[r.name]=i?Object.assign({},i,r,{options:Object.assign({},i.options,r.options),data:Object.assign({},i.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var kK={placement:"bottom",modifiers:[],strategy:"absolute"};function FK(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function LK(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,i=e.defaultOptions,o=i===void 0?kK:i;return function(a,l,c){c===void 0&&(c=o);var u={placement:"bottom",orderedModifiers:[],options:Object.assign({},kK,o),modifiersData:{},elements:{reference:a,popper:l},attributes:{},styles:{}},d=[],h=!1,f={state:u,setOptions:function(_){var S=typeof _=="function"?_(u.options):_;g(),u.options=Object.assign({},o,u.options,S),u.scrollParents={reference:Ja(a)?nf(a):a.contextElement?nf(a.contextElement):[],popper:nf(l)};var x=pV(vV([].concat(r,u.options.modifiers)));return u.orderedModifiers=x.filter(function(P){return P.enabled}),p(),f.update()},forceUpdate:function(){if(!h){var _=u.elements,S=_.reference,x=_.popper;if(FK(S,x)){u.rects={reference:mV(S,Jl(x),u.options.strategy==="fixed"),popper:ap(x)},u.reset=!1,u.placement=u.options.placement,u.orderedModifiers.forEach(function(Y){return u.modifiersData[Y.name]=Object.assign({},Y.data)});for(var P=0;P<u.orderedModifiers.length;P++){if(u.reset===!0){u.reset=!1,P=-1;continue}var k=u.orderedModifiers[P],b=k.fn,C=k.options,N=C===void 0?{}:C,B=k.name;typeof b=="function"&&(u=b({state:u,options:N,name:B,instance:f})||u)}}}},update:gV(function(){return new Promise(function(w){f.forceUpdate(),w(u)})}),destroy:function(){g(),h=!0}};if(!FK(a,l))return f;f.setOptions(c).then(function(w){!h&&c.onFirstUpdate&&c.onFirstUpdate(w)});function p(){u.orderedModifiers.forEach(function(w){var _=w.name,S=w.options,x=S===void 0?{}:S,P=w.effect;if(typeof P=="function"){var k=P({state:u,name:_,instance:f,options:x}),b=function(){};d.push(k||b)}})}function g(){d.forEach(function(w){return w()}),d=[]}return f}}var jAe=[OK,PK,MK,RK],wV=LK({defaultModifiers:jAe});var $K=["*"];var $Ae=t=>({$implicit:t});var GAe=["ngbNavOutlet",""];function zAe(t,e){}function YAe(t,e){if(t&1&&(W(0,"div",0),rn(1,zAe,0,0,"ng-template",1),V()),t&2){let n=Le().$implicit,r=Le();lt("item",n)("nav",r.nav)("role",r.paneRole),Te(1),lt("ngTemplateOutlet",(n.contentTpl==null?null:n.contentTpl.templateRef)||null)("ngTemplateOutletContext",cY(5,$Ae,n.active||r.isPanelTransitioning(n)))}}function qAe(t,e){if(t&1&&rn(0,YAe,2,7,"div",0),t&2){let n=e.$implicit,r=Le();rr(0,n.isPanelInDom()||r.isPanelTransitioning(n)?0:-1)}}function KAe(t,e){if(t&1&&re(0),t&2){let n=Le(2);Hn(n.title)}}function XAe(t,e){}function ZAe(t,e){if(t&1&&(W(0,"h3",3),rn(1,KAe,1,1,"ng-template",null,4,AL)(3,XAe,0,0,"ng-template",5),V()),t&2){let n=rC(2),r=Le();Te(3),lt("ngTemplateOutlet",r.isTitleTemplate()?r.title:n)("ngTemplateOutletContext",r.context)}}function QAe(t,e){if(t&1){let n=Fn();W(0,"button",8),Ue("click",function(){mt(n);let i=Le();return pt(i.changeHour(i.hourStep))}),at(1,"span",9),W(2,"span",10),Lh(3,11),V()()}if(t&2){let n=Le();Xr("btn-sm",n.isSmallSize)("btn-lg",n.isLargeSize)("disabled",n.disabled),lt("disabled",n.disabled)}}function JAe(t,e){if(t&1){let n=Fn();W(0,"button",8),Ue("click",function(){mt(n);let i=Le();return pt(i.changeHour(-i.hourStep))}),at(1,"span",12),W(2,"span",10),Lh(3,13),V()()}if(t&2){let n=Le();Xr("btn-sm",n.isSmallSize)("btn-lg",n.isLargeSize)("disabled",n.disabled),lt("disabled",n.disabled)}}function eMe(t,e){if(t&1){let n=Fn();W(0,"button",8),Ue("click",function(){mt(n);let i=Le();return pt(i.changeMinute(i.minuteStep))}),at(1,"span",9),W(2,"span",10),Lh(3,14),V()()}if(t&2){let n=Le();Xr("btn-sm",n.isSmallSize)("btn-lg",n.isLargeSize)("disabled",n.disabled),lt("disabled",n.disabled)}}function tMe(t,e){if(t&1){let n=Fn();W(0,"button",8),Ue("click",function(){mt(n);let i=Le();return pt(i.changeMinute(-i.minuteStep))}),at(1,"span",12),W(2,"span",10),Lh(3,15),V()()}if(t&2){let n=Le();Xr("btn-sm",n.isSmallSize)("btn-lg",n.isLargeSize)("disabled",n.disabled),lt("disabled",n.disabled)}}function nMe(t,e){if(t&1){let n=Fn();W(0,"button",8),Ue("click",function(){mt(n);let i=Le(2);return pt(i.changeSecond(i.secondStep))}),at(1,"span",9),W(2,"span",10),Lh(3,18),V()()}if(t&2){let n=Le(2);Xr("btn-sm",n.isSmallSize)("btn-lg",n.isLargeSize)("disabled",n.disabled),lt("disabled",n.disabled)}}function rMe(t,e){if(t&1){let n=Fn();W(0,"button",8),Ue("click",function(){mt(n);let i=Le(2);return pt(i.changeSecond(-i.secondStep))}),at(1,"span",12),W(2,"span",10),Lh(3,19),V()()}if(t&2){let n=Le(2);Xr("btn-sm",n.isSmallSize)("btn-lg",n.isLargeSize)("disabled",n.disabled),lt("disabled",n.disabled)}}function iMe(t,e){if(t&1){let n=Fn();W(0,"div",5),re(1,":"),V(),W(2,"div",16),rn(3,nMe,4,7,"button",3),W(4,"input",17),Ue("change",function(i){mt(n);let o=Le();return pt(o.updateSecond(i.target.value))})("blur",function(){mt(n);let i=Le();return pt(i.handleBlur())})("input",function(i){mt(n);let o=Le();return pt(o.formatInput(i.target))})("keydown.ArrowUp",function(i){mt(n);let o=Le();return o.changeSecond(o.secondStep),pt(i.preventDefault())})("keydown.ArrowDown",function(i){mt(n);let o=Le();return o.changeSecond(-o.secondStep),pt(i.preventDefault())}),V(),rn(5,rMe,4,7,"button",3),V()}if(t&2){let n=Le();Te(3),rr(3,n.spinners?3:-1),Te(1),Xr("form-control-sm",n.isSmallSize)("form-control-lg",n.isLargeSize),lt("value",n.formatMinSec(n.model==null?null:n.model.second))("readOnly",n.readonlyInputs)("disabled",n.disabled),Te(1),rr(5,n.spinners?5:-1)}}function oMe(t,e){if(t&1&&(ea(0),Lh(1,22),ta()),t&2){let n=Le(2);Te(1),bL(n.i18n.getAfternoonPeriod()),oY(1)}}function sMe(t,e){if(t&1&&(ea(0),re(1),ta()),t&2){let n=Le(2);Te(1),Hn(n.i18n.getMorningPeriod())}}function aMe(t,e){if(t&1){let n=Fn();at(0,"div",5),W(1,"div",20)(2,"button",21),Ue("click",function(){mt(n);let i=Le();return pt(i.toggleMeridian())}),rn(3,oMe,2,1,"ng-container")(4,sMe,2,1),V()()}if(t&2){let n=Le();Te(2),Xr("btn-sm",n.isSmallSize)("btn-lg",n.isLargeSize)("disabled",n.disabled),lt("disabled",n.disabled),Te(1),rr(3,n.model&&n.model.hour>=12?3:4)}}function lMe(t,e){if(t&1&&(W(0,"strong",3),re(1),V()),t&2){let n=Le();Te(1),Hn(n.header)}}function cMe(t,e){}function uMe(t,e){if(t&1){let n=Fn();W(0,"div",4),rn(1,cMe,0,0,"ng-template",5),W(2,"button",6),Ue("click",function(){mt(n);let i=Le();return pt(i.hide())}),V()()}if(t&2){let n=Le(),r=rC(1);Te(1),lt("ngTemplateOutlet",n.contentHeaderTpl||r)}}function dMe(t,e){if(t&1&&(W(0,"span"),re(1),V()),t&2){let n=Le().$implicit,r=Le();eC(r.highlightClass),Te(1),Hn(n)}}function hMe(t,e){if(t&1&&(ea(0),re(1),ta()),t&2){let n=Le().$implicit;Te(1),Hn(n)}}function fMe(t,e){if(t&1&&rn(0,dMe,2,4,"span",0)(1,hMe,2,1),t&2){let n=e.$index;rr(0,n%2!==0?0:1)}}var GK={animation:!0,transitionTimerDelayMs:5},_V=(()=>{let e=class e{constructor(){this.animation=GK.animation}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function mMe(t){let{transitionDelay:e,transitionDuration:n}=window.getComputedStyle(t),r=parseFloat(e),i=parseFloat(n);return(r+i)*1e3}function fp(t){return parseInt(`${t}`,10)}function HK(t){return t!=null?`${t}`:""}function pMe(t){return typeof t=="string"}function ec(t){return!isNaN(fp(t))}function Rd(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}function kI(t){return t!=null}function OI(t){return ec(t)?`0${t}`.slice(-2):""}function gMe(t){return t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function vMe(t,e){return!e||typeof t.closest>"u"?null:t.closest(e)}function zK(t){return(t||document.body).getBoundingClientRect()}function wMe(t){return e=>new en(n=>{let r=s=>t.run(()=>n.next(s)),i=s=>t.run(()=>n.error(s)),o=()=>t.run(()=>n.complete());return e.subscribe({next:r,error:i,complete:o})})}function VK(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}var yMe=()=>{},{transitionTimerDelayMs:_Me}=GK,NI=new Map,pv=(t,e,n,r)=>{let i=r.context||{},o=NI.get(e);if(o)switch(r.runningTransition){case"continue":return Yo;case"stop":t.run(()=>o.transition$.complete()),i=Object.assign(o.context,i),NI.delete(e)}let s=n(e,r.animation,i)||yMe;if(!r.animation||window.getComputedStyle(e).transitionProperty==="none")return t.run(()=>s()),Wt(void 0).pipe(wMe(t));let a=new Ur,l=new Ur,c=a.pipe(sF(!0));NI.set(e,{transition$:a,complete:()=>{l.next(),l.complete()},context:i});let u=mMe(e);return t.runOutsideAngular(()=>{let d=Th(e,"transitionend").pipe(Ya(c),Gi(({target:f})=>f===e)),h=__(u+_Me).pipe(Ya(c));RR(h,d,l).pipe(Ya(c)).subscribe(()=>{NI.delete(e),t.run(()=>{s(),a.next(),a.complete()})})}),a.asObservable()};var of=function(t){return t[t.Tab=9]="Tab",t[t.Enter=13]="Enter",t[t.Escape=27]="Escape",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.ArrowLeft=37]="ArrowLeft",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowRight=39]="ArrowRight",t[t.ArrowDown=40]="ArrowDown",t}(of||{});var PI=(t,e)=>e?e.some(n=>n.contains(t)):!1,BK=(t,e)=>!e||vMe(t,e)!=null,CMe=(()=>{let t=()=>/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2,e=()=>/Android/.test(navigator.userAgent);return typeof navigator<"u"?!!navigator.userAgent&&(t()||e()):!1})(),SMe=t=>CMe?()=>setTimeout(()=>t(),100):t;function EMe(t,e,n,r,i,o,s,a){n&&t.runOutsideAngular(SMe(()=>{let l=h=>{let f=h.target;return h.button===2||PI(f,s)?!1:n==="inside"?PI(f,o)&&BK(f,a):n==="outside"?!PI(f,o):BK(f,a)||!PI(f,o)},c=Th(e,"keydown").pipe(Ya(i),Gi(h=>h.which===of.Escape),kr(h=>h.preventDefault())),u=Th(e,"mousedown").pipe(dn(l),Ya(i)),d=Th(e,"mouseup").pipe(dF(u),Gi(([h,f])=>f),oF(0),Ya(i));RR([c.pipe(dn(h=>0)),d.pipe(dn(h=>1))]).subscribe(h=>t.run(()=>r(h)))}))}var jyt=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");var xMe=(()=>{let e=class e{constructor(){this._element=qe(ci).documentElement}isRTL(){return(this._element.getAttribute("dir")||"").toLowerCase()==="rtl"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),bMe=/\s+/,TMe=/  +/gi,RMe={top:["top"],bottom:["bottom"],start:["left","right"],left:["left"],end:["right","left"],right:["right"],"top-start":["top-start","top-end"],"top-left":["top-start"],"top-end":["top-end","top-start"],"top-right":["top-end"],"bottom-start":["bottom-start","bottom-end"],"bottom-left":["bottom-start"],"bottom-end":["bottom-end","bottom-start"],"bottom-right":["bottom-end"],"start-top":["left-start","right-start"],"left-top":["left-start"],"start-bottom":["left-end","right-end"],"left-bottom":["left-end"],"end-top":["right-start","left-start"],"right-top":["right-start"],"end-bottom":["right-end","left-end"],"right-bottom":["right-end"]};function DMe(t,e){let[n,r]=RMe[t];return e&&r||n}var IMe=/^left/,AMe=/^right/,MMe=/^start/,OMe=/^end/;function NMe(t,e){let[n,r]=e.split("-"),i=n.replace(IMe,"start").replace(AMe,"end"),o=[i];if(r){let s=r;(n==="left"||n==="right")&&(s=s.replace(MMe,"top").replace(OMe,"bottom")),o.push(`${i}-${s}`)}return t&&(o=o.map(s=>`${t}-${s}`)),o.join(" ")}function UK({placement:t,baseClass:e},n){let r=Array.isArray(t)?t:t.split(bMe),i=["top","bottom","start","end","top-start","top-end","bottom-start","bottom-end","start-top","start-bottom","end-top","end-bottom"],o=r.findIndex(c=>c==="auto");o>=0&&i.forEach(function(c){r.find(u=>u.search("^"+c)!==-1)==null&&r.splice(o++,1,c)});let s=r.map(c=>DMe(c,n.isRTL()));return{placement:s.shift(),modifiers:[{name:"bootstrapClasses",enabled:!!e,phase:"write",fn({state:c}){let u=new RegExp(e+"(-[a-z]+)*","gi"),d=c.elements.popper,h=c.placement,f=d.className;f=f.replace(u,""),f+=` ${NMe(e,h)}`,f=f.trim().replace(TMe," "),d.className=f}},lV,dV,rV,{enabled:!0,name:"flip",options:{fallbackPlacements:s}},{enabled:!0,name:"preventOverflow",phase:"main",fn:function(){}}]}}function WK(t){return t}function PMe(){let t=qe(xMe),e=null;return{createPopper(n){if(!e){let i=(n.updatePopperOptions||WK)(UK(n,t));e=wV(n.hostElement,n.targetElement,i)}},update(){e&&e.update()},setOptions(n){if(e){let i=(n.updatePopperOptions||WK)(UK(n,t));e.setOptions(i)}},destroy(){e&&(e.destroy(),e=null)}}}function kMe(t){return e=>(e.modifiers.push(cV,{name:"offset",options:{offset:()=>t}}),e)}var $yt=new Date(1882,10,12),Gyt=new Date(2174,10,25);var zyt=1e3*60*60*24;var CV=1080,FMe=24*CV,LMe=12*CV+793,Yyt=29*FMe+LMe,qyt=11*CV+204;var GC=class{constructor(e,n,r){this.nodes=e,this.viewRef=n,this.componentRef=r}},yV=class{constructor(e){this._componentType=e,this._windowRef=null,this._contentRef=null,this._document=qe(ci),this._applicationRef=qe(Jc),this._injector=qe(Qc),this._viewContainerRef=qe(Kl),this._ngZone=qe(nr)}open(e,n,r=!1){this._windowRef||(this._contentRef=this._getContentRef(e,n),this._windowRef=this._viewContainerRef.createComponent(this._componentType,{injector:this._injector,projectableNodes:this._contentRef.nodes}));let{nativeElement:i}=this._windowRef.location,o=this._ngZone.onStable.pipe(_s(1),Pr(()=>pv(this._ngZone,i,({classList:s})=>s.add("show"),{animation:r,runningTransition:"continue"})));return{windowRef:this._windowRef,transition$:o}}close(e=!1){return this._windowRef?pv(this._ngZone,this._windowRef.location.nativeElement,({classList:n})=>n.remove("show"),{animation:e,runningTransition:"stop"}).pipe(kr(()=>{this._windowRef&&(this._viewContainerRef.remove(this._viewContainerRef.indexOf(this._windowRef.hostView)),this._windowRef=null),this._contentRef?.viewRef&&(this._applicationRef.detachView(this._contentRef.viewRef),this._contentRef.viewRef.destroy(),this._contentRef=null)})):Wt(void 0)}_getContentRef(e,n){if(e)if(e instanceof Ka){let r=e.createEmbeddedView(n);return this._applicationRef.attachView(r),new GC([r.rootNodes],r)}else return new GC([[this._document.createTextNode(`${e}`)]]);else return new GC([])}};var HMe=(()=>{let e=class e{constructor(){this._ngbConfig=qe(_V),this.destroyOnHide=!0,this.orientation="horizontal",this.roles="tablist",this.keyboard=!0}get animation(){return this._animation??this._ngbConfig.animation}set animation(r){this._animation=r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),YK=t=>kI(t)&&t!=="",VMe=0,SV=(()=>{let e=class e{constructor(){this.templateRef=qe(Ka)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=kn({type:e,selectors:[["ng-template","ngbNavContent",""]],standalone:!0});let t=e;return t})();var LI=(()=>{let e=class e{constructor(){this._nav=qe(HI),this._nativeElement=qe(Mi).nativeElement,this.disabled=!1,this.shown=new hr,this.hidden=new hr}ngAfterContentChecked(){this.contentTpl=this.contentTpls.first}ngOnInit(){kI(this.domId)||(this.domId=`ngb-nav-${VMe++}`)}get active(){return this._nav.activeId===this.id}get id(){return YK(this._id)?this._id:this.domId}get panelDomId(){return`${this.domId}-panel`}isPanelInDom(){return(kI(this.destroyOnHide)?!this.destroyOnHide:!this._nav.destroyOnHide)||this.active}isNgContainer(){return this._nativeElement.nodeType===Node.COMMENT_NODE}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=kn({type:e,selectors:[["","ngbNavItem",""]],contentQueries:function(i,o,s){if(i&1&&Y0(s,SV,4),i&2){let a;pd(a=gd())&&(o.contentTpls=a)}},hostVars:2,hostBindings:function(i,o){i&2&&Xr("nav-item",!0)},inputs:{destroyOnHide:"destroyOnHide",disabled:"disabled",domId:"domId",_id:["ngbNavItem","_id"]},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbNavItem"],standalone:!0});let t=e;return t})(),HI=(()=>{let e=class e{constructor(r){this.role=r,this._config=qe(HMe),this._cd=qe(Za),this._document=qe(ci),this._nativeElement=qe(Mi).nativeElement,this.destroyRef=qe(Q_),this._navigatingWithKeyboard=!1,this.activeIdChange=new hr,this.animation=this._config.animation,this.destroyOnHide=this._config.destroyOnHide,this.orientation=this._config.orientation,this.roles=this._config.roles,this.keyboard=this._config.keyboard,this.shown=new hr,this.hidden=new hr,this.navItemChange$=new Ur,this.navChange=new hr}click(r){r.disabled||this._updateActiveId(r.id)}onFocusout({relatedTarget:r}){this._nativeElement.contains(r)||(this._navigatingWithKeyboard=!1)}onKeyDown(r){if(this.roles!=="tablist"||!this.keyboard)return;let i=r.which,o=this.links.filter(l=>!l.navItem.disabled),{length:s}=o,a=-1;if(o.forEach((l,c)=>{l.nativeElement===this._document.activeElement&&(a=c)}),s){switch(i){case of.ArrowUp:case of.ArrowLeft:a=(a-1+s)%s;break;case of.ArrowRight:case of.ArrowDown:a=(a+1)%s;break;case of.Home:a=0;break;case of.End:a=s-1;break}this.keyboard==="changeWithArrows"&&this.select(o[a].navItem.id),o[a].nativeElement.focus(),this._navigatingWithKeyboard=!0,r.preventDefault()}}select(r){this._updateActiveId(r,!1)}ngAfterContentInit(){if(!kI(this.activeId)){let r=this.items.first?this.items.first.id:null;YK(r)&&(this._updateActiveId(r,!1),this._cd.detectChanges())}this.items.changes.pipe(bI(this.destroyRef)).subscribe(()=>this._notifyItemChanged(this.activeId))}ngOnChanges({activeId:r}){r&&!r.firstChange&&this._notifyItemChanged(r.currentValue)}_updateActiveId(r,i=!0){if(this.activeId!==r){let o=!1;i&&this.navChange.emit({activeId:this.activeId,nextId:r,preventDefault:()=>{o=!0}}),o||(this.activeId=r,this.activeIdChange.emit(r),this._notifyItemChanged(r))}}_notifyItemChanged(r){this.navItemChange$.next(this._getItemById(r))}_getItemById(r){return this.items&&this.items.find(i=>i.id===r)||null}};e.\u0275fac=function(i){return new(i||e)(Km("role"))},e.\u0275dir=kn({type:e,selectors:[["","ngbNav",""]],contentQueries:function(i,o,s){if(i&1&&(Y0(s,LI,4),Y0(s,VI,5)),i&2){let a;pd(a=gd())&&(o.items=a),pd(a=gd())&&(o.links=a)}},hostVars:6,hostBindings:function(i,o){i&1&&Ue("keydown.arrowLeft",function(a){return o.onKeyDown(a)})("keydown.arrowRight",function(a){return o.onKeyDown(a)})("keydown.arrowDown",function(a){return o.onKeyDown(a)})("keydown.arrowUp",function(a){return o.onKeyDown(a)})("keydown.Home",function(a){return o.onKeyDown(a)})("keydown.End",function(a){return o.onKeyDown(a)})("focusout",function(a){return o.onFocusout(a)}),i&2&&(Js("aria-orientation",o.orientation==="vertical"&&o.roles==="tablist"?"vertical":void 0)("role",o.role?o.role:o.roles?"tablist":void 0),Xr("nav",!0)("flex-column",o.orientation==="vertical"))},inputs:{activeId:"activeId",animation:"animation",destroyOnHide:"destroyOnHide",orientation:"orientation",roles:"roles",keyboard:"keyboard"},outputs:{activeIdChange:"activeIdChange",shown:"shown",hidden:"hidden",navChange:"navChange"},exportAs:["ngbNav"],standalone:!0,features:[Yi]});let t=e;return t})(),VI=(()=>{let e=class e{constructor(r){this.role=r,this.navItem=qe(LI),this.nav=qe(HI),this.nativeElement=qe(Mi).nativeElement}get tabindex(){return this.nav.keyboard===!1?this.navItem.disabled?-1:void 0:this.nav._navigatingWithKeyboard||this.navItem.disabled||!this.navItem.active?-1:void 0}};e.\u0275fac=function(i){return new(i||e)(Km("role"))},e.\u0275dir=kn({type:e,selectors:[["","ngbNavLink",""]],hostVars:14,hostBindings:function(i,o){i&2&&(G0("id",o.navItem.domId),Js("role",o.role?o.role:o.nav.roles?"tab":void 0)("tabindex",o.tabindex)("aria-controls",o.navItem.isPanelInDom()?o.navItem.panelDomId:null)("aria-selected",o.navItem.active)("aria-disabled",o.navItem.disabled),Xr("nav-link",!0)("nav-item",o.navItem.isNgContainer())("active",o.navItem.active)("disabled",o.navItem.disabled))},standalone:!0});let t=e;return t})(),qK=(()=>{let e=class e extends VI{};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275dir=kn({type:e,selectors:[["button","ngbNavLink",""]],hostAttrs:["type","button"],hostVars:1,hostBindings:function(i,o){i&1&&Ue("click",function(){return o.nav.click(o.navItem)}),i&2&&G0("disabled",o.navItem.disabled)},standalone:!0,features:[qi]});let t=e;return t})();var BMe=({classList:t})=>(t.remove("show"),()=>t.remove("active")),UMe=(t,e)=>{e&&zK(t),t.classList.add("show")},jK=(()=>{let e=class e{constructor(){this.nativeElement=qe(Mi).nativeElement}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=kn({type:e,selectors:[["","ngbNavPane",""]],hostAttrs:[1,"tab-pane"],hostVars:5,hostBindings:function(i,o){i&2&&(G0("id",o.item.panelDomId),Js("role",o.role?o.role:o.nav.roles?"tabpanel":void 0)("aria-labelledby",o.item.domId),Xr("fade",o.nav.animation))},inputs:{item:"item",nav:"nav",role:"role"},standalone:!0});let t=e;return t})(),KK=(()=>{let e=class e{constructor(){this._cd=qe(Za),this._ngZone=qe(nr),this._activePane=null}isPanelTransitioning(r){return this._activePane?.item===r}ngAfterViewInit(){this._updateActivePane(),this.nav.navItemChange$.pipe(bI(this.nav.destroyRef),E_(this._activePane?.item||null),S_(),uF(1)).subscribe(r=>{let i={animation:this.nav.animation,runningTransition:"stop"};this._cd.detectChanges(),this._activePane?pv(this._ngZone,this._activePane.nativeElement,BMe,i).subscribe(()=>{let o=this._activePane?.item;this._activePane=this._getPaneForItem(r),this._cd.markForCheck(),this._activePane&&(this._activePane.nativeElement.classList.add("active"),pv(this._ngZone,this._activePane.nativeElement,UMe,i).subscribe(()=>{r&&(r.shown.emit(),this.nav.shown.emit(r.id))})),o&&(o.hidden.emit(),this.nav.hidden.emit(o.id))}):this._updateActivePane()})}_updateActivePane(){this._activePane=this._getActivePane(),this._activePane?.nativeElement.classList.add("show"),this._activePane?.nativeElement.classList.add("active")}_getPaneForItem(r){return this._panes&&this._panes.find(i=>i.item===r)||null}_getActivePane(){return this._panes&&this._panes.find(r=>r.item.active)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["","ngbNavOutlet",""]],viewQuery:function(i,o){if(i&1&&kD(jK,5),i&2){let s;pd(s=gd())&&(o._panes=s)}},hostVars:2,hostBindings:function(i,o){i&2&&Xr("tab-content",!0)},inputs:{paneRole:"paneRole",nav:["ngbNavOutlet","nav"]},standalone:!0,features:[qt],attrs:GAe,decls:2,vars:0,consts:[["ngbNavPane","",3,"item","nav","role"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,o){i&1&&Gn(0,qAe,1,1,null,null,tC),i&2&&zn(o.nav.items)},dependencies:[jK,UD],encapsulation:2,changeDetection:0});let t=e;return t})();var XK=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({});let t=e;return t})();var WMe={hover:["mouseenter","mouseleave"],focus:["focusin","focusout"]};function jMe(t){let e=(t||"").trim();if(e.length===0)return[];let n=e.split(/\s+/).map(i=>i.split(":")).map(i=>WMe[i[0]]||i),r=n.filter(i=>i.includes("manual"));if(r.length>1)throw"Triggers parse error: only one manual trigger is allowed";if(r.length===1&&n.length>1)throw"Triggers parse error: manual trigger can't be mixed with other triggers";return r.length?[]:n}function $Me(t,e,n,r,i,o=0,s=0){let a=jMe(e);if(a.length===0)return()=>{};let l=new Set,c=[],u;function d(f,p){t.addEventListener(f,p),c.push(()=>t.removeEventListener(f,p))}function h(f,p){clearTimeout(u),p>0?u=setTimeout(f,p):f()}for(let[f,p]of a)p?(d(f,()=>{l.add(f),h(()=>l.size>0&&r(),o)}),d(p,()=>{l.delete(f),h(()=>l.size===0&&i(),s)})):d(f,()=>n()?h(i,s):h(r,o));return()=>c.forEach(f=>f())}var GMe=(()=>{let e=class e{constructor(){this._ngbConfig=qe(_V),this.autoClose=!0,this.placement="auto",this.popperOptions=r=>r,this.triggers="click",this.disablePopover=!1,this.openDelay=0,this.closeDelay=0}get animation(){return this._animation??this._ngbConfig.animation}set animation(r){this._animation=r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),zMe=0,YMe=(()=>{let e=class e{isTitleTemplate(){return this.title instanceof Ka}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["ngb-popover-window"]],hostAttrs:["role","tooltip",2,"position","absolute"],hostVars:5,hostBindings:function(i,o){i&2&&(G0("id",o.id),eC("popover"+(o.popoverClass?" "+o.popoverClass:"")),Xr("fade",o.animation))},inputs:{animation:"animation",title:"title",id:"id",popoverClass:"popoverClass",context:"context"},standalone:!0,features:[qt],ngContentSelectors:$K,decls:4,vars:1,consts:[["data-popper-arrow","",1,"popover-arrow"],["class","popover-header"],[1,"popover-body"],[1,"popover-header"],["simpleTitle",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,o){i&1&&(TL(),at(0,"div",0),rn(1,ZAe,4,2,"h3",1),W(2,"div",2),RL(3),V()),i&2&&(Te(1),rr(1,o.title?1:-1))},dependencies:[UD],encapsulation:2,changeDetection:0});let t=e;return t})(),ZK=(()=>{let e=class e{constructor(){this._config=qe(GMe),this.animation=this._config.animation,this.autoClose=this._config.autoClose,this.placement=this._config.placement,this.popperOptions=this._config.popperOptions,this.triggers=this._config.triggers,this.container=this._config.container,this.disablePopover=this._config.disablePopover,this.popoverClass=this._config.popoverClass,this.openDelay=this._config.openDelay,this.closeDelay=this._config.closeDelay,this.shown=new hr,this.hidden=new hr,this._nativeElement=qe(Mi).nativeElement,this._ngZone=qe(nr),this._document=qe(ci),this._changeDetector=qe(Za),this._ngbPopoverWindowId=`ngb-popover-${zMe++}`,this._popupService=new yV(YMe),this._windowRef=null,this._positioning=PMe()}open(r){if(!this._windowRef&&!this._isDisabled()){let{windowRef:i,transition$:o}=this._popupService.open(this.ngbPopover,r??this.popoverContext,this.animation);this._windowRef=i,this._windowRef.setInput("animation",this.animation),this._windowRef.setInput("title",this.popoverTitle),this._windowRef.setInput("context",r??this.popoverContext),this._windowRef.setInput("popoverClass",this.popoverClass),this._windowRef.setInput("id",this._ngbPopoverWindowId),this._getPositionTargetElement().setAttribute("aria-describedby",this._ngbPopoverWindowId),this.container==="body"&&this._document.body.appendChild(this._windowRef.location.nativeElement),this._windowRef.changeDetectorRef.detectChanges(),this._windowRef.changeDetectorRef.markForCheck(),this._ngZone.runOutsideAngular(()=>{this._positioning.createPopper({hostElement:this._getPositionTargetElement(),targetElement:this._windowRef.location.nativeElement,placement:this.placement,appendToBody:this.container==="body",baseClass:"bs-popover",updatePopperOptions:s=>this.popperOptions(kMe([0,8])(s))}),Promise.resolve().then(()=>{this._positioning.update(),this._zoneSubscription=this._ngZone.onStable.subscribe(()=>this._positioning.update())})}),EMe(this._ngZone,this._document,this.autoClose,()=>this.close(),this.hidden,[this._windowRef.location.nativeElement]),o.subscribe(()=>this.shown.emit())}}close(r=this.animation){this._windowRef&&(this._getPositionTargetElement().removeAttribute("aria-describedby"),this._popupService.close(r).subscribe(()=>{this._windowRef=null,this._positioning.destroy(),this._zoneSubscription?.unsubscribe(),this.hidden.emit(),this._changeDetector.markForCheck()}))}toggle(){this._windowRef?this.close():this.open()}isOpen(){return this._windowRef!=null}ngOnInit(){this._unregisterListenersFn=$Me(this._nativeElement,this.triggers,this.isOpen.bind(this),this.open.bind(this),this.close.bind(this),+this.openDelay,+this.closeDelay)}ngOnChanges({ngbPopover:r,popoverTitle:i,disablePopover:o,popoverClass:s}){s&&this.isOpen()&&this._windowRef.setInput("popoverClass",s.currentValue),(r||i||o)&&this._isDisabled()&&this.close()}ngOnDestroy(){this.close(!1),this._unregisterListenersFn?.()}_isDisabled(){return this.disablePopover?!0:!this.ngbPopover&&!this.popoverTitle}_getPositionTargetElement(){return(pMe(this.positionTarget)?this._document.querySelector(this.positionTarget):this.positionTarget)||this._nativeElement}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=kn({type:e,selectors:[["","ngbPopover",""]],inputs:{animation:"animation",autoClose:"autoClose",ngbPopover:"ngbPopover",popoverTitle:"popoverTitle",placement:"placement",popperOptions:"popperOptions",triggers:"triggers",positionTarget:"positionTarget",container:"container",disablePopover:"disablePopover",popoverClass:"popoverClass",popoverContext:"popoverContext",openDelay:"openDelay",closeDelay:"closeDelay"},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbPopover"],standalone:!0,features:[Yi]});let t=e;return t})(),QK=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({});let t=e;return t})();var FI=class{constructor(e,n,r){this.hour=fp(e),this.minute=fp(n),this.second=fp(r)}changeHour(e=1){this.updateHour((isNaN(this.hour)?0:this.hour)+e)}updateHour(e){ec(e)?this.hour=(e<0?24+e:e)%24:this.hour=NaN}changeMinute(e=1){this.updateMinute((isNaN(this.minute)?0:this.minute)+e)}updateMinute(e){ec(e)?(this.minute=e%60<0?60+e%60:e%60,this.changeHour(Math.floor(e/60))):this.minute=NaN}changeSecond(e=1){this.updateSecond((isNaN(this.second)?0:this.second)+e)}updateSecond(e){ec(e)?(this.second=e<0?60+e%60:e%60,this.changeMinute(Math.floor(e/60))):this.second=NaN}isValid(e=!0){return ec(this.hour)&&ec(this.minute)&&(e?ec(this.second):!0)}toString(){return`${this.hour||0}:${this.minute||0}:${this.second||0}`}},qMe=(()=>{let e=class e{constructor(){this.meridian=!1,this.spinners=!0,this.seconds=!1,this.hourStep=1,this.minuteStep=1,this.secondStep=1,this.disabled=!1,this.readonlyInputs=!1,this.size="medium"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function KMe(){return new XMe}var JK=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>KMe(),providedIn:"root"});let t=e;return t})(),XMe=(()=>{let e=class e extends JK{fromModel(r){return r&&Rd(r.hour)&&Rd(r.minute)?{hour:r.hour,minute:r.minute,second:Rd(r.second)?r.second:null}:null}toModel(r){return r&&Rd(r.hour)&&Rd(r.minute)?{hour:r.hour,minute:r.minute,second:Rd(r.second)?r.second:null}:null}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),eX=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:()=>(()=>new ZMe)(),providedIn:"root"});let t=e;return t})(),ZMe=(()=>{let e=class e extends eX{constructor(){super(...arguments),this._periods=OY(qe(q0),BL.Standalone,UL.Narrow)}getMorningPeriod(){return this._periods[0]}getAfternoonPeriod(){return this._periods[1]}};e.\u0275fac=(()=>{let r;return function(o){return(r||(r=bs(e)))(o||e)}})(),e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),QMe=/[^0-9]/g,tX=(()=>{let e=class e{set hourStep(r){this._hourStep=Rd(r)?r:this._config.hourStep}get hourStep(){return this._hourStep}set minuteStep(r){this._minuteStep=Rd(r)?r:this._config.minuteStep}get minuteStep(){return this._minuteStep}set secondStep(r){this._secondStep=Rd(r)?r:this._config.secondStep}get secondStep(){return this._secondStep}constructor(r,i,o,s){this._config=r,this._ngbTimeAdapter=i,this._cd=o,this.i18n=s,this.onChange=a=>{},this.onTouched=()=>{},this.meridian=r.meridian,this.spinners=r.spinners,this.seconds=r.seconds,this.hourStep=r.hourStep,this.minuteStep=r.minuteStep,this.secondStep=r.secondStep,this.disabled=r.disabled,this.readonlyInputs=r.readonlyInputs,this.size=r.size}writeValue(r){let i=this._ngbTimeAdapter.fromModel(r);this.model=i?new FI(i.hour,i.minute,i.second):new FI,!this.seconds&&(!i||!ec(i.second))&&(this.model.second=0),this._cd.markForCheck()}registerOnChange(r){this.onChange=r}registerOnTouched(r){this.onTouched=r}setDisabledState(r){this.disabled=r}changeHour(r){this.model?.changeHour(r),this.propagateModelChange()}changeMinute(r){this.model?.changeMinute(r),this.propagateModelChange()}changeSecond(r){this.model?.changeSecond(r),this.propagateModelChange()}updateHour(r){let i=this.model?this.model.hour>=12:!1,o=fp(r);this.meridian&&(i&&o<12||!i&&o===12)?this.model?.updateHour(o+12):this.model?.updateHour(o),this.propagateModelChange()}updateMinute(r){this.model?.updateMinute(fp(r)),this.propagateModelChange()}updateSecond(r){this.model?.updateSecond(fp(r)),this.propagateModelChange()}toggleMeridian(){this.meridian&&this.changeHour(12)}formatInput(r){r.value=r.value.replace(QMe,"")}formatHour(r){return ec(r)?this.meridian?OI(r%12===0?12:r%12):OI(r%24):OI(NaN)}formatMinSec(r){return OI(ec(r)?r:NaN)}handleBlur(){this.onTouched()}get isSmallSize(){return this.size==="small"}get isLargeSize(){return this.size==="large"}ngOnChanges(r){r.seconds&&!this.seconds&&this.model&&!ec(this.model.second)&&(this.model.second=0,this.propagateModelChange(!1))}propagateModelChange(r=!0){r&&this.onTouched(),this.model?.isValid(this.seconds)?this.onChange(this._ngbTimeAdapter.toModel({hour:this.model.hour,minute:this.model.minute,second:this.model.second})):this.onChange(this._ngbTimeAdapter.toModel(null))}};e.\u0275fac=function(i){return new(i||e)(je(qMe),je(JK),je(Za),je(eX))},e.\u0275cmp=jt({type:e,selectors:[["ngb-timepicker"]],inputs:{meridian:"meridian",spinners:"spinners",seconds:"seconds",hourStep:"hourStep",minuteStep:"minuteStep",secondStep:"secondStep",readonlyInputs:"readonlyInputs",size:"size"},exportAs:["ngbTimepicker"],standalone:!0,features:[ao([{provide:Sd,useExisting:Zo(()=>e),multi:!0}]),Yi,qt],decls:14,vars:23,consts:()=>{let r;r=$localize`:@@ngb.timepicker.HH:HH`;let i;i=$localize`:@@ngb.timepicker.hours:Hours`;let o;o=$localize`:@@ngb.timepicker.MM:MM`;let s;s=$localize`:@@ngb.timepicker.minutes:Minutes`;let a;a=$localize`:@@ngb.timepicker.increment-hours:Increment hours`;let l;l=$localize`:@@ngb.timepicker.decrement-hours:Decrement hours`;let c;c=$localize`:@@ngb.timepicker.increment-minutes:Increment minutes`;let u;u=$localize`:@@ngb.timepicker.decrement-minutes:Decrement minutes`;let d;d=$localize`:@@ngb.timepicker.SS:SS`;let h;h=$localize`:@@ngb.timepicker.seconds:Seconds`;let f;f=$localize`:@@ngb.timepicker.increment-seconds:Increment seconds`;let p;p=$localize`:@@ngb.timepicker.decrement-seconds:Decrement seconds`;let g;return g=$localize`:@@ngb.timepicker.PM:${"\uFFFD0\uFFFD"}:INTERPOLATION:`,[[3,"disabled"],[1,"ngb-tp"],[1,"ngb-tp-input-container","ngb-tp-hour"],["tabindex","-1","type","button","class","btn btn-link",3,"btn-sm","btn-lg","disabled"],["type","text","maxlength","2","inputmode","numeric","placeholder",r,"aria-label",i,1,"ngb-tp-input","form-control",3,"value","readOnly","disabled","change","blur","input","keydown.ArrowUp","keydown.ArrowDown"],[1,"ngb-tp-spacer"],[1,"ngb-tp-input-container","ngb-tp-minute"],["type","text","maxlength","2","inputmode","numeric","placeholder",o,"aria-label",s,1,"ngb-tp-input","form-control",3,"value","readOnly","disabled","change","blur","input","keydown.ArrowUp","keydown.ArrowDown"],["tabindex","-1","type","button",1,"btn","btn-link",3,"disabled","click"],[1,"chevron","ngb-tp-chevron"],[1,"visually-hidden"],a,[1,"chevron","ngb-tp-chevron","bottom"],l,c,u,[1,"ngb-tp-input-container","ngb-tp-second"],["type","text","maxlength","2","inputmode","numeric","placeholder",d,"aria-label",h,1,"ngb-tp-input","form-control",3,"value","readOnly","disabled","change","blur","input","keydown.ArrowUp","keydown.ArrowDown"],f,p,[1,"ngb-tp-meridian"],["type","button",1,"btn","btn-outline-primary",3,"disabled","click"],g]},template:function(i,o){i&1&&(W(0,"fieldset",0)(1,"div",1)(2,"div",2),rn(3,QAe,4,7,"button",3),W(4,"input",4),Ue("change",function(a){return o.updateHour(a.target.value)})("blur",function(){return o.handleBlur()})("input",function(a){return o.formatInput(a.target)})("keydown.ArrowUp",function(a){return o.changeHour(o.hourStep),a.preventDefault()})("keydown.ArrowDown",function(a){return o.changeHour(-o.hourStep),a.preventDefault()}),V(),rn(5,JAe,4,7,"button",3),V(),W(6,"div",5),re(7,":"),V(),W(8,"div",6),rn(9,eMe,4,7,"button",3),W(10,"input",7),Ue("change",function(a){return o.updateMinute(a.target.value)})("blur",function(){return o.handleBlur()})("input",function(a){return o.formatInput(a.target)})("keydown.ArrowUp",function(a){return o.changeMinute(o.minuteStep),a.preventDefault()})("keydown.ArrowDown",function(a){return o.changeMinute(-o.minuteStep),a.preventDefault()}),V(),rn(11,tMe,4,7,"button",3),V(),rn(12,iMe,6,9)(13,aMe,5,8),V()()),i&2&&(Xr("disabled",o.disabled),lt("disabled",o.disabled),Te(3),rr(3,o.spinners?3:-1),Te(1),Xr("form-control-sm",o.isSmallSize)("form-control-lg",o.isLargeSize),lt("value",o.formatHour(o.model==null?null:o.model.hour))("readOnly",o.readonlyInputs)("disabled",o.disabled),Te(1),rr(5,o.spinners?5:-1),Te(4),rr(9,o.spinners?9:-1),Te(1),Xr("form-control-sm",o.isSmallSize)("form-control-lg",o.isLargeSize),lt("value",o.formatMinSec(o.model==null?null:o.model.minute))("readOnly",o.readonlyInputs)("disabled",o.disabled),Te(1),rr(11,o.spinners?11:-1),Te(1),rr(12,o.seconds?12:-1),Te(1),rr(13,o.meridian?13:-1))},styles:[`ngb-timepicker{font-size:1rem}.ngb-tp{display:flex;align-items:center}.ngb-tp-input-container{width:4em}.ngb-tp-chevron:before{border-style:solid;border-width:.29em .29em 0 0;content:"";display:inline-block;height:.69em;left:.05em;position:relative;top:.15em;transform:rotate(-45deg);vertical-align:middle;width:.69em}.ngb-tp-chevron.bottom:before{top:-.3em;transform:rotate(135deg)}.ngb-tp-input{text-align:center}.ngb-tp-hour,.ngb-tp-minute,.ngb-tp-second,.ngb-tp-meridian{display:flex;flex-direction:column;align-items:center;justify-content:space-around}.ngb-tp-spacer{width:1em;text-align:center}
`],encapsulation:2});let t=e;return t})(),nX=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({});let t=e;return t})(),JMe=(()=>{let e=class e{constructor(){this._ngbConfig=qe(_V),this.autohide=!0,this.delay=5e3,this.ariaLive="polite"}get animation(){return this._animation??this._ngbConfig.animation}set animation(r){this._animation=r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),eOe=(t,e)=>{let{classList:n}=t;if(e)n.add("fade");else{n.add("show");return}return zK(t),n.add("show","showing"),()=>{n.remove("showing")}},tOe=({classList:t})=>(t.add("showing"),()=>{t.remove("show","showing")}),nOe=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=kn({type:e,selectors:[["","ngbToastHeader",""]],standalone:!0});let t=e;return t})(),rX=(()=>{let e=class e{constructor(r){this.ariaLive=r,this._config=qe(JMe),this._zone=qe(nr),this._element=qe(Mi),this.animation=this._config.animation,this.delay=this._config.delay,this.autohide=this._config.autohide,this.contentHeaderTpl=null,this.shown=new hr,this.hidden=new hr,this.ariaLive??=this._config.ariaLive}ngAfterContentInit(){this._zone.onStable.asObservable().pipe(_s(1)).subscribe(()=>{this._init(),this.show()})}ngOnChanges(r){"autohide"in r&&(this._clearTimeout(),this._init())}hide(){this._clearTimeout();let r=pv(this._zone,this._element.nativeElement,tOe,{animation:this.animation,runningTransition:"stop"});return r.subscribe(()=>{this.hidden.emit()}),r}show(){let r=pv(this._zone,this._element.nativeElement,eOe,{animation:this.animation,runningTransition:"continue"});return r.subscribe(()=>{this.shown.emit()}),r}_init(){this.autohide&&!this._timeoutID&&(this._timeoutID=setTimeout(()=>this.hide(),this.delay))}_clearTimeout(){this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)}};e.\u0275fac=function(i){return new(i||e)(Km("aria-live"))},e.\u0275cmp=jt({type:e,selectors:[["ngb-toast"]],contentQueries:function(i,o,s){if(i&1&&Y0(s,nOe,7,Ka),i&2){let a;pd(a=gd())&&(o.contentHeaderTpl=a.first)}},hostAttrs:["role","alert","aria-atomic","true",1,"toast"],hostVars:3,hostBindings:function(i,o){i&2&&(Js("aria-live",o.ariaLive),Xr("fade",o.animation))},inputs:{animation:"animation",delay:"delay",autohide:"autohide",header:"header"},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbToast"],standalone:!0,features:[Yi,qt],ngContentSelectors:$K,decls:5,vars:1,consts:()=>{let r;return r=$localize`:@@ngb.toast.close-aria:Close`,[["headerTpl",""],["class","toast-header"],[1,"toast-body"],[1,"me-auto"],[1,"toast-header"],[3,"ngTemplateOutlet"],["type","button","aria-label",r,1,"btn-close",3,"click"]]},template:function(i,o){i&1&&(TL(),rn(0,lMe,2,1,"ng-template",null,0,AL)(2,uMe,3,1,"div",1),W(3,"div",2),RL(4),V()),i&2&&(Te(2),rr(2,o.contentHeaderTpl||o.header?2:-1))},dependencies:[UD],styles:[`ngb-toast{display:block}ngb-toast .toast-header .close{margin-left:auto;margin-bottom:.25rem}
`],encapsulation:2});let t=e;return t})(),iX=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=so({type:e}),e.\u0275inj=oo({});let t=e;return t})();var oX=(()=>{let e=class e{constructor(){this.highlightClass="ngb-highlight",this.accentSensitive=!0}ngOnChanges(r){!this.accentSensitive&&!String.prototype.normalize&&(console.warn("The `accentSensitive` input in `ngb-highlight` cannot be set to `false` in a browser that does not implement the `String.normalize` function. You will have to include a polyfill in your application to use this feature in the current browser."),this.accentSensitive=!0);let i=HK(this.result),o=Array.isArray(this.term)?this.term:[this.term],s=u=>this.accentSensitive?u:VK(u),a=o.map(u=>gMe(s(HK(u)))).filter(u=>u),l=this.accentSensitive?i:VK(i),c=a.length?l.split(new RegExp(`(${a.join("|")})`,"gmi")):[i];if(this.accentSensitive)this.parts=c;else{let u=0;this.parts=c.map(d=>i.substring(u,u+=d.length))}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["ngb-highlight"]],inputs:{highlightClass:"highlightClass",result:"result",term:"term",accentSensitive:"accentSensitive"},standalone:!0,features:[Yi,qt],decls:2,vars:0,consts:[[3,"class"]],template:function(i,o){i&1&&Gn(0,fMe,2,1,null,null,tC),i&2&&zn(o.parts)},styles:[`.ngb-highlight{font-weight:700}
`],encapsulation:2,changeDetection:0});let t=e;return t})(),Kyt=new Ut("live announcer delay",{providedIn:"root",factory:()=>100});var Dd=class extends Error{},BI=class extends Dd{constructor(e){super(`Invalid DateTime: ${e.toMessage()}`)}},UI=class extends Dd{constructor(e){super(`Invalid Interval: ${e.toMessage()}`)}},WI=class extends Dd{constructor(e){super(`Invalid Duration: ${e.toMessage()}`)}},tc=class extends Dd{},gv=class extends Dd{constructor(e){super(`Invalid unit ${e}`)}},ki=class extends Dd{},nc=class extends Dd{constructor(){super("Zone is an abstract class")}};var yt="numeric",rc="short",Sa="long",sf={year:yt,month:yt,day:yt},zC={year:yt,month:rc,day:yt},xV={year:yt,month:rc,day:yt,weekday:rc},YC={year:yt,month:Sa,day:yt},qC={year:yt,month:Sa,day:yt,weekday:Sa},KC={hour:yt,minute:yt},XC={hour:yt,minute:yt,second:yt},ZC={hour:yt,minute:yt,second:yt,timeZoneName:rc},QC={hour:yt,minute:yt,second:yt,timeZoneName:Sa},JC={hour:yt,minute:yt,hourCycle:"h23"},e1={hour:yt,minute:yt,second:yt,hourCycle:"h23"},t1={hour:yt,minute:yt,second:yt,hourCycle:"h23",timeZoneName:rc},n1={hour:yt,minute:yt,second:yt,hourCycle:"h23",timeZoneName:Sa},r1={year:yt,month:yt,day:yt,hour:yt,minute:yt},i1={year:yt,month:yt,day:yt,hour:yt,minute:yt,second:yt},o1={year:yt,month:rc,day:yt,hour:yt,minute:yt},s1={year:yt,month:rc,day:yt,hour:yt,minute:yt,second:yt},bV={year:yt,month:rc,day:yt,weekday:rc,hour:yt,minute:yt},a1={year:yt,month:Sa,day:yt,hour:yt,minute:yt,timeZoneName:rc},l1={year:yt,month:Sa,day:yt,hour:yt,minute:yt,second:yt,timeZoneName:rc},c1={year:yt,month:Sa,day:yt,weekday:Sa,hour:yt,minute:yt,timeZoneName:Sa},u1={year:yt,month:Sa,day:yt,weekday:Sa,hour:yt,minute:yt,second:yt,timeZoneName:Sa};var Ea=class{get type(){throw new nc}get name(){throw new nc}get ianaName(){return this.name}get isUniversal(){throw new nc}offsetName(e,n){throw new nc}formatOffset(e,n){throw new nc}offset(e){throw new nc}equals(e){throw new nc}get isValid(){throw new nc}};var TV=null,mp=class t extends Ea{static get instance(){return TV===null&&(TV=new t),TV}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(e,{format:n,locale:r}){return $I(e,n,r)}formatOffset(e,n){return af(this.offset(e),n)}offset(e){return-new Date(e).getTimezoneOffset()}equals(e){return e.type==="system"}get isValid(){return!0}};var zI={};function rOe(t){return zI[t]||(zI[t]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),zI[t]}var iOe={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function oOe(t,e){let n=t.format(e).replace(/\u200E/g,""),r=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(n),[,i,o,s,a,l,c,u]=r;return[s,i,o,a,l,c,u]}function sOe(t,e){let n=t.formatToParts(e),r=[];for(let i=0;i<n.length;i++){let{type:o,value:s}=n[i],a=iOe[o];o==="era"?r[a]=s:zt(a)||(r[a]=parseInt(s,10))}return r}var GI={},Ms=class t extends Ea{static create(e){return GI[e]||(GI[e]=new t(e)),GI[e]}static resetCache(){GI={},zI={}}static isValidSpecifier(e){return this.isValidZone(e)}static isValidZone(e){if(!e)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:e}).format(),!0}catch{return!1}}constructor(e){super(),this.zoneName=e,this.valid=t.isValidZone(e)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(e,{format:n,locale:r}){return $I(e,n,r,this.name)}formatOffset(e,n){return af(this.offset(e),n)}offset(e){let n=new Date(e);if(isNaN(n))return NaN;let r=rOe(this.name),[i,o,s,a,l,c,u]=r.formatToParts?sOe(r,n):oOe(r,n);a==="BC"&&(i=-Math.abs(i)+1);let h=vv({year:i,month:o,day:s,hour:l===24?0:l,minute:c,second:u,millisecond:0}),f=+n,p=f%1e3;return f-=p>=0?p:1e3+p,(h-f)/(60*1e3)}equals(e){return e.type==="iana"&&e.name===this.name}get isValid(){return this.valid}};var sX={};function aOe(t,e={}){let n=JSON.stringify([t,e]),r=sX[n];return r||(r=new Intl.ListFormat(t,e),sX[n]=r),r}var RV={};function DV(t,e={}){let n=JSON.stringify([t,e]),r=RV[n];return r||(r=new Intl.DateTimeFormat(t,e),RV[n]=r),r}var IV={};function lOe(t,e={}){let n=JSON.stringify([t,e]),r=IV[n];return r||(r=new Intl.NumberFormat(t,e),IV[n]=r),r}var AV={};function cOe(t,e={}){let s=e,{base:n}=s,r=tr(s,["base"]),i=JSON.stringify([t,r]),o=AV[i];return o||(o=new Intl.RelativeTimeFormat(t,e),AV[i]=o),o}var d1=null;function uOe(){return d1||(d1=new Intl.DateTimeFormat().resolvedOptions().locale,d1)}var aX={};function dOe(t){let e=aX[t];if(!e){let n=new Intl.Locale(t);e="getWeekInfo"in n?n.getWeekInfo():n.weekInfo,aX[t]=e}return e}function hOe(t){let e=t.indexOf("-x-");e!==-1&&(t=t.substring(0,e));let n=t.indexOf("-u-");if(n===-1)return[t];{let r,i;try{r=DV(t).resolvedOptions(),i=t}catch{let l=t.substring(0,n);r=DV(l).resolvedOptions(),i=l}let{numberingSystem:o,calendar:s}=r;return[i,o,s]}}function fOe(t,e,n){return(n||e)&&(t.includes("-u-")||(t+="-u"),n&&(t+=`-ca-${n}`),e&&(t+=`-nu-${e}`)),t}function mOe(t){let e=[];for(let n=1;n<=12;n++){let r=ln.utc(2009,n,1);e.push(t(r))}return e}function pOe(t){let e=[];for(let n=1;n<=7;n++){let r=ln.utc(2016,11,13+n);e.push(t(r))}return e}function YI(t,e,n,r){let i=t.listingMode();return i==="error"?null:i==="en"?n(e):r(e)}function gOe(t){return t.numberingSystem&&t.numberingSystem!=="latn"?!1:t.numberingSystem==="latn"||!t.locale||t.locale.startsWith("en")||new Intl.DateTimeFormat(t.intl).resolvedOptions().numberingSystem==="latn"}var MV=class{constructor(e,n,r){this.padTo=r.padTo||0,this.floor=r.floor||!1;let a=r,{padTo:i,floor:o}=a,s=tr(a,["padTo","floor"]);if(!n||Object.keys(s).length>0){let l=Ee({useGrouping:!1},r);r.padTo>0&&(l.minimumIntegerDigits=r.padTo),this.inf=lOe(e,l)}}format(e){if(this.inf){let n=this.floor?Math.floor(e):e;return this.inf.format(n)}else{let n=this.floor?Math.floor(e):wv(e,3);return Zr(n,this.padTo)}}},OV=class{constructor(e,n,r){this.opts=r,this.originalZone=void 0;let i;if(this.opts.timeZone)this.dt=e;else if(e.zone.type==="fixed"){let s=-1*(e.offset/60),a=s>=0?`Etc/GMT+${s}`:`Etc/GMT${s}`;e.offset!==0&&Ms.create(a).valid?(i=a,this.dt=e):(i="UTC",this.dt=e.offset===0?e:e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone)}else e.zone.type==="system"?this.dt=e:e.zone.type==="iana"?(this.dt=e,i=e.zone.name):(i="UTC",this.dt=e.setZone("UTC").plus({minutes:e.offset}),this.originalZone=e.zone);let o=Ee({},this.opts);o.timeZone=o.timeZone||i,this.dtf=DV(n,o)}format(){return this.originalZone?this.formatToParts().map(({value:e})=>e).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){let e=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?e.map(n=>{if(n.type==="timeZoneName"){let r=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return ft(Ee({},n),{value:r})}else return n}):e}resolvedOptions(){return this.dtf.resolvedOptions()}},NV=class{constructor(e,n,r){this.opts=Ee({style:"long"},r),!n&&qI()&&(this.rtf=cOe(e,r))}format(e,n){return this.rtf?this.rtf.format(e,n):lX(n,e,this.opts.numeric,this.opts.style!=="long")}formatToParts(e,n){return this.rtf?this.rtf.formatToParts(e,n):[]}},vOe={firstDay:1,minimalDays:4,weekend:[6,7]},fr=class t{static fromOpts(e){return t.create(e.locale,e.numberingSystem,e.outputCalendar,e.weekSettings,e.defaultToEN)}static create(e,n,r,i,o=!1){let s=e||cr.defaultLocale,a=s||(o?"en-US":uOe()),l=n||cr.defaultNumberingSystem,c=r||cr.defaultOutputCalendar,u=h1(i)||cr.defaultWeekSettings;return new t(a,l,c,u,s)}static resetCache(){d1=null,RV={},IV={},AV={}}static fromObject({locale:e,numberingSystem:n,outputCalendar:r,weekSettings:i}={}){return t.create(e,n,r,i)}constructor(e,n,r,i,o){let[s,a,l]=hOe(e);this.locale=s,this.numberingSystem=n||a||null,this.outputCalendar=r||l||null,this.weekSettings=i,this.intl=fOe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=o,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=gOe(this)),this.fastNumbersCached}listingMode(){let e=this.isEnglish(),n=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return e&&n?"en":"intl"}clone(e){return!e||Object.getOwnPropertyNames(e).length===0?this:t.create(e.locale||this.specifiedLocale,e.numberingSystem||this.numberingSystem,e.outputCalendar||this.outputCalendar,h1(e.weekSettings)||this.weekSettings,e.defaultToEN||!1)}redefaultToEN(e={}){return this.clone(ft(Ee({},e),{defaultToEN:!0}))}redefaultToSystem(e={}){return this.clone(ft(Ee({},e),{defaultToEN:!1}))}months(e,n=!1){return YI(this,e,PV,()=>{let r=n?{month:e,day:"numeric"}:{month:e},i=n?"format":"standalone";return this.monthsCache[i][e]||(this.monthsCache[i][e]=mOe(o=>this.extract(o,r,"month"))),this.monthsCache[i][e]})}weekdays(e,n=!1){return YI(this,e,kV,()=>{let r=n?{weekday:e,year:"numeric",month:"long",day:"numeric"}:{weekday:e},i=n?"format":"standalone";return this.weekdaysCache[i][e]||(this.weekdaysCache[i][e]=pOe(o=>this.extract(o,r,"weekday"))),this.weekdaysCache[i][e]})}meridiems(){return YI(this,void 0,()=>FV,()=>{if(!this.meridiemCache){let e={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[ln.utc(2016,11,13,9),ln.utc(2016,11,13,19)].map(n=>this.extract(n,e,"dayperiod"))}return this.meridiemCache})}eras(e){return YI(this,e,LV,()=>{let n={era:e};return this.eraCache[e]||(this.eraCache[e]=[ln.utc(-40,1,1),ln.utc(2017,1,1)].map(r=>this.extract(r,n,"era"))),this.eraCache[e]})}extract(e,n,r){let i=this.dtFormatter(e,n),o=i.formatToParts(),s=o.find(a=>a.type.toLowerCase()===r);return s?s.value:null}numberFormatter(e={}){return new MV(this.intl,e.forceSimple||this.fastNumbers,e)}dtFormatter(e,n={}){return new OV(e,this.intl,n)}relFormatter(e={}){return new NV(this.intl,this.isEnglish(),e)}listFormatter(e={}){return aOe(this.intl,e)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:KI()?dOe(this.locale):vOe}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(e){return this.locale===e.locale&&this.numberingSystem===e.numberingSystem&&this.outputCalendar===e.outputCalendar}};var VV=null,Po=class t extends Ea{static get utcInstance(){return VV===null&&(VV=new t(0)),VV}static instance(e){return e===0?t.utcInstance:new t(e)}static parseSpecifier(e){if(e){let n=e.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(n)return new t(pp(n[1],n[2]))}return null}constructor(e){super(),this.fixed=e}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${af(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${af(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(e,n){return af(this.fixed,n)}get isUniversal(){return!0}offset(){return this.fixed}equals(e){return e.type==="fixed"&&e.fixed===this.fixed}get isValid(){return!0}};var f1=class extends Ea{constructor(e){super(),this.zoneName=e}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}};function ic(t,e){let n;if(zt(t)||t===null)return e;if(t instanceof Ea)return t;if(cX(t)){let r=t.toLowerCase();return r==="default"?e:r==="local"||r==="system"?mp.instance:r==="utc"||r==="gmt"?Po.utcInstance:Po.parseSpecifier(r)||Ms.create(t)}else return lu(t)?Po.instance(t):typeof t=="object"&&"offset"in t&&typeof t.offset=="function"?t:new f1(t)}var uX=()=>Date.now(),dX="system",hX=null,fX=null,mX=null,pX=60,gX,vX=null,cr=class{static get now(){return uX}static set now(e){uX=e}static set defaultZone(e){dX=e}static get defaultZone(){return ic(dX,mp.instance)}static get defaultLocale(){return hX}static set defaultLocale(e){hX=e}static get defaultNumberingSystem(){return fX}static set defaultNumberingSystem(e){fX=e}static get defaultOutputCalendar(){return mX}static set defaultOutputCalendar(e){mX=e}static get defaultWeekSettings(){return vX}static set defaultWeekSettings(e){vX=h1(e)}static get twoDigitCutoffYear(){return pX}static set twoDigitCutoffYear(e){pX=e%100}static get throwOnInvalid(){return gX}static set throwOnInvalid(e){gX=e}static resetCaches(){fr.resetCache(),Ms.resetCache()}};var ko=class{constructor(e,n){this.reason=e,this.explanation=n}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}};var wX=[0,31,59,90,120,151,181,212,243,273,304,334],yX=[0,31,60,91,121,152,182,213,244,274,305,335];function nl(t,e){return new ko("unit out of range",`you specified ${e} (of type ${typeof e}) as a ${t}, which is invalid`)}function XI(t,e,n){let r=new Date(Date.UTC(t,e-1,n));t<100&&t>=0&&r.setUTCFullYear(r.getUTCFullYear()-1900);let i=r.getUTCDay();return i===0?7:i}function _X(t,e,n){return n+(vp(t)?yX:wX)[e-1]}function CX(t,e){let n=vp(t)?yX:wX,r=n.findIndex(o=>o<e),i=e-n[r];return{month:r+1,day:i}}function ZI(t,e){return(t-e+7)%7+1}function m1(t,e=4,n=1){let{year:r,month:i,day:o}=t,s=_X(r,i,o),a=ZI(XI(r,i,o),n),l=Math.floor((s-a+14-e)/7),c;return l<1?(c=r-1,l=gp(c,e,n)):l>gp(r,e,n)?(c=r+1,l=1):c=r,Ee({weekYear:c,weekNumber:l,weekday:a},g1(t))}function BV(t,e=4,n=1){let{weekYear:r,weekNumber:i,weekday:o}=t,s=ZI(XI(r,1,e),n),a=lf(r),l=i*7+o-s-7+e,c;l<1?(c=r-1,l+=lf(c)):l>a?(c=r+1,l-=lf(r)):c=r;let{month:u,day:d}=CX(c,l);return Ee({year:c,month:u,day:d},g1(t))}function QI(t){let{year:e,month:n,day:r}=t,i=_X(e,n,r);return Ee({year:e,ordinal:i},g1(t))}function UV(t){let{year:e,ordinal:n}=t,{month:r,day:i}=CX(e,n);return Ee({year:e,month:r,day:i},g1(t))}function WV(t,e){if(!zt(t.localWeekday)||!zt(t.localWeekNumber)||!zt(t.localWeekYear)){if(!zt(t.weekday)||!zt(t.weekNumber)||!zt(t.weekYear))throw new tc("Cannot mix locale-based week fields with ISO-based week fields");return zt(t.localWeekday)||(t.weekday=t.localWeekday),zt(t.localWeekNumber)||(t.weekNumber=t.localWeekNumber),zt(t.localWeekYear)||(t.weekYear=t.localWeekYear),delete t.localWeekday,delete t.localWeekNumber,delete t.localWeekYear,{minDaysInFirstWeek:e.getMinDaysInFirstWeek(),startOfWeek:e.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function SX(t,e=4,n=1){let r=p1(t.weekYear),i=xa(t.weekNumber,1,gp(t.weekYear,e,n)),o=xa(t.weekday,1,7);return r?i?o?!1:nl("weekday",t.weekday):nl("week",t.weekNumber):nl("weekYear",t.weekYear)}function EX(t){let e=p1(t.year),n=xa(t.ordinal,1,lf(t.year));return e?n?!1:nl("ordinal",t.ordinal):nl("year",t.year)}function jV(t){let e=p1(t.year),n=xa(t.month,1,12),r=xa(t.day,1,yv(t.year,t.month));return e?n?r?!1:nl("day",t.day):nl("month",t.month):nl("year",t.year)}function $V(t){let{hour:e,minute:n,second:r,millisecond:i}=t,o=xa(e,0,23)||e===24&&n===0&&r===0&&i===0,s=xa(n,0,59),a=xa(r,0,59),l=xa(i,0,999);return o?s?a?l?!1:nl("millisecond",i):nl("second",r):nl("minute",n):nl("hour",e)}function zt(t){return typeof t>"u"}function lu(t){return typeof t=="number"}function p1(t){return typeof t=="number"&&t%1===0}function cX(t){return typeof t=="string"}function bX(t){return Object.prototype.toString.call(t)==="[object Date]"}function qI(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function KI(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function TX(t){return Array.isArray(t)?t:[t]}function GV(t,e,n){if(t.length!==0)return t.reduce((r,i)=>{let o=[e(i),i];return r&&n(r[0],o[0])===r[0]?r:o},null)[1]}function RX(t,e){return e.reduce((n,r)=>(n[r]=t[r],n),{})}function cf(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function h1(t){if(t==null)return null;if(typeof t!="object")throw new ki("Week settings must be an object");if(!xa(t.firstDay,1,7)||!xa(t.minimalDays,1,7)||!Array.isArray(t.weekend)||t.weekend.some(e=>!xa(e,1,7)))throw new ki("Invalid week settings");return{firstDay:t.firstDay,minimalDays:t.minimalDays,weekend:Array.from(t.weekend)}}function xa(t,e,n){return p1(t)&&t>=e&&t<=n}function wOe(t,e){return t-e*Math.floor(t/e)}function Zr(t,e=2){let n=t<0,r;return n?r="-"+(""+-t).padStart(e,"0"):r=(""+t).padStart(e,"0"),r}function Id(t){if(!(zt(t)||t===null||t===""))return parseInt(t,10)}function uf(t){if(!(zt(t)||t===null||t===""))return parseFloat(t)}function v1(t){if(!(zt(t)||t===null||t==="")){let e=parseFloat("0."+t)*1e3;return Math.floor(e)}}function wv(t,e,n=!1){let r=10**e;return(n?Math.trunc:Math.round)(t*r)/r}function vp(t){return t%4===0&&(t%100!==0||t%400===0)}function lf(t){return vp(t)?366:365}function yv(t,e){let n=wOe(e-1,12)+1,r=t+(e-n)/12;return n===2?vp(r)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][n-1]}function vv(t){let e=Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond);return t.year<100&&t.year>=0&&(e=new Date(e),e.setUTCFullYear(t.year,t.month-1,t.day)),+e}function xX(t,e,n){return-ZI(XI(t,1,e),n)+e-1}function gp(t,e=4,n=1){let r=xX(t,e,n),i=xX(t+1,e,n);return(lf(t)-r+i)/7}function w1(t){return t>99?t:t>cr.twoDigitCutoffYear?1900+t:2e3+t}function $I(t,e,n,r=null){let i=new Date(t),o={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};r&&(o.timeZone=r);let s=Ee({timeZoneName:e},o),a=new Intl.DateTimeFormat(n,s).formatToParts(i).find(l=>l.type.toLowerCase()==="timezonename");return a?a.value:null}function pp(t,e){let n=parseInt(t,10);Number.isNaN(n)&&(n=0);let r=parseInt(e,10)||0,i=n<0||Object.is(n,-0)?-r:r;return n*60+i}function zV(t){let e=Number(t);if(typeof t=="boolean"||t===""||Number.isNaN(e))throw new ki(`Invalid unit value ${t}`);return e}function _v(t,e){let n={};for(let r in t)if(cf(t,r)){let i=t[r];if(i==null)continue;n[e(r)]=zV(i)}return n}function af(t,e){let n=Math.trunc(Math.abs(t/60)),r=Math.trunc(Math.abs(t%60)),i=t>=0?"+":"-";switch(e){case"short":return`${i}${Zr(n,2)}:${Zr(r,2)}`;case"narrow":return`${i}${n}${r>0?`:${r}`:""}`;case"techie":return`${i}${Zr(n,2)}${Zr(r,2)}`;default:throw new RangeError(`Value format ${e} is out of range for property format`)}}function g1(t){return RX(t,["hour","minute","second","millisecond"])}var yOe=["January","February","March","April","May","June","July","August","September","October","November","December"],YV=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],_Oe=["J","F","M","A","M","J","J","A","S","O","N","D"];function PV(t){switch(t){case"narrow":return[..._Oe];case"short":return[...YV];case"long":return[...yOe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}var qV=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],KV=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],COe=["M","T","W","T","F","S","S"];function kV(t){switch(t){case"narrow":return[...COe];case"short":return[...KV];case"long":return[...qV];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}var FV=["AM","PM"],SOe=["Before Christ","Anno Domini"],EOe=["BC","AD"],xOe=["B","A"];function LV(t){switch(t){case"narrow":return[...xOe];case"short":return[...EOe];case"long":return[...SOe];default:return null}}function DX(t){return FV[t.hour<12?0:1]}function IX(t,e){return kV(e)[t.weekday-1]}function AX(t,e){return PV(e)[t.month-1]}function MX(t,e){return LV(e)[t.year<0?0:1]}function lX(t,e,n="always",r=!1){let i={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},o=["hours","minutes","seconds"].indexOf(t)===-1;if(n==="auto"&&o){let d=t==="days";switch(e){case 1:return d?"tomorrow":`next ${i[t][0]}`;case-1:return d?"yesterday":`last ${i[t][0]}`;case 0:return d?"today":`this ${i[t][0]}`;default:}}let s=Object.is(e,-0)||e<0,a=Math.abs(e),l=a===1,c=i[t],u=r?l?c[1]:c[2]||c[1]:l?i[t][0]:t;return s?`${a} ${u} ago`:`in ${a} ${u}`}function OX(t,e){let n="";for(let r of t)r.literal?n+=r.val:n+=e(r.val);return n}var bOe={D:sf,DD:zC,DDD:YC,DDDD:qC,t:KC,tt:XC,ttt:ZC,tttt:QC,T:JC,TT:e1,TTT:t1,TTTT:n1,f:r1,ff:o1,fff:a1,ffff:c1,F:i1,FF:s1,FFF:l1,FFFF:u1},Fo=class t{static create(e,n={}){return new t(e,n)}static parseFormat(e){let n=null,r="",i=!1,o=[];for(let s=0;s<e.length;s++){let a=e.charAt(s);a==="'"?(r.length>0&&o.push({literal:i||/^\s+$/.test(r),val:r}),n=null,r="",i=!i):i||a===n?r+=a:(r.length>0&&o.push({literal:/^\s+$/.test(r),val:r}),r=a,n=a)}return r.length>0&&o.push({literal:i||/^\s+$/.test(r),val:r}),o}static macroTokenToFormatOpts(e){return bOe[e]}constructor(e,n){this.opts=n,this.loc=e,this.systemLoc=null}formatWithSystemDefault(e,n){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(e,Ee(Ee({},this.opts),n)).format()}dtFormatter(e,n={}){return this.loc.dtFormatter(e,Ee(Ee({},this.opts),n))}formatDateTime(e,n){return this.dtFormatter(e,n).format()}formatDateTimeParts(e,n){return this.dtFormatter(e,n).formatToParts()}formatInterval(e,n){return this.dtFormatter(e.start,n).dtf.formatRange(e.start.toJSDate(),e.end.toJSDate())}resolvedOptions(e,n){return this.dtFormatter(e,n).resolvedOptions()}num(e,n=0){if(this.opts.forceSimple)return Zr(e,n);let r=Ee({},this.opts);return n>0&&(r.padTo=n),this.loc.numberFormatter(r).format(e)}formatDateTimeFromString(e,n){let r=this.loc.listingMode()==="en",i=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",o=(f,p)=>this.loc.extract(e,f,p),s=f=>e.isOffsetFixed&&e.offset===0&&f.allowZ?"Z":e.isValid?e.zone.formatOffset(e.ts,f.format):"",a=()=>r?DX(e):o({hour:"numeric",hourCycle:"h12"},"dayperiod"),l=(f,p)=>r?AX(e,f):o(p?{month:f}:{month:f,day:"numeric"},"month"),c=(f,p)=>r?IX(e,f):o(p?{weekday:f}:{weekday:f,month:"long",day:"numeric"},"weekday"),u=f=>{let p=t.macroTokenToFormatOpts(f);return p?this.formatWithSystemDefault(e,p):f},d=f=>r?MX(e,f):o({era:f},"era"),h=f=>{switch(f){case"S":return this.num(e.millisecond);case"u":case"SSS":return this.num(e.millisecond,3);case"s":return this.num(e.second);case"ss":return this.num(e.second,2);case"uu":return this.num(Math.floor(e.millisecond/10),2);case"uuu":return this.num(Math.floor(e.millisecond/100));case"m":return this.num(e.minute);case"mm":return this.num(e.minute,2);case"h":return this.num(e.hour%12===0?12:e.hour%12);case"hh":return this.num(e.hour%12===0?12:e.hour%12,2);case"H":return this.num(e.hour);case"HH":return this.num(e.hour,2);case"Z":return s({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return s({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return s({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return e.zone.offsetName(e.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return e.zone.offsetName(e.ts,{format:"long",locale:this.loc.locale});case"z":return e.zoneName;case"a":return a();case"d":return i?o({day:"numeric"},"day"):this.num(e.day);case"dd":return i?o({day:"2-digit"},"day"):this.num(e.day,2);case"c":return this.num(e.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(e.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return i?o({month:"numeric",day:"numeric"},"month"):this.num(e.month);case"LL":return i?o({month:"2-digit",day:"numeric"},"month"):this.num(e.month,2);case"LLL":return l("short",!0);case"LLLL":return l("long",!0);case"LLLLL":return l("narrow",!0);case"M":return i?o({month:"numeric"},"month"):this.num(e.month);case"MM":return i?o({month:"2-digit"},"month"):this.num(e.month,2);case"MMM":return l("short",!1);case"MMMM":return l("long",!1);case"MMMMM":return l("narrow",!1);case"y":return i?o({year:"numeric"},"year"):this.num(e.year);case"yy":return i?o({year:"2-digit"},"year"):this.num(e.year.toString().slice(-2),2);case"yyyy":return i?o({year:"numeric"},"year"):this.num(e.year,4);case"yyyyyy":return i?o({year:"numeric"},"year"):this.num(e.year,6);case"G":return d("short");case"GG":return d("long");case"GGGGG":return d("narrow");case"kk":return this.num(e.weekYear.toString().slice(-2),2);case"kkkk":return this.num(e.weekYear,4);case"W":return this.num(e.weekNumber);case"WW":return this.num(e.weekNumber,2);case"n":return this.num(e.localWeekNumber);case"nn":return this.num(e.localWeekNumber,2);case"ii":return this.num(e.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(e.localWeekYear,4);case"o":return this.num(e.ordinal);case"ooo":return this.num(e.ordinal,3);case"q":return this.num(e.quarter);case"qq":return this.num(e.quarter,2);case"X":return this.num(Math.floor(e.ts/1e3));case"x":return this.num(e.ts);default:return u(f)}};return OX(t.parseFormat(n),h)}formatDurationFromString(e,n){let r=l=>{switch(l[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},i=l=>c=>{let u=r(c);return u?this.num(l.get(u),c.length):c},o=t.parseFormat(n),s=o.reduce((l,{literal:c,val:u})=>c?l:l.concat(u),[]),a=e.shiftTo(...s.map(r).filter(l=>l));return OX(o,i(a))}};var PX=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Sv(...t){let e=t.reduce((n,r)=>n+r.source,"");return RegExp(`^${e}$`)}function Ev(...t){return e=>t.reduce(([n,r,i],o)=>{let[s,a,l]=o(e,i);return[Ee(Ee({},n),s),a||r,l]},[{},null,1]).slice(0,2)}function xv(t,...e){if(t==null)return[null,null];for(let[n,r]of e){let i=n.exec(t);if(i)return r(i)}return[null,null]}function kX(...t){return(e,n)=>{let r={},i;for(i=0;i<t.length;i++)r[t[i]]=Id(e[n+i]);return[r,null,n+i]}}var FX=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,TOe=`(?:${FX.source}?(?:\\[(${PX.source})\\])?)?`,XV=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,LX=RegExp(`${XV.source}${TOe}`),ZV=RegExp(`(?:T${LX.source})?`),ROe=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,DOe=/(\d{4})-?W(\d\d)(?:-?(\d))?/,IOe=/(\d{4})-?(\d{3})/,AOe=kX("weekYear","weekNumber","weekDay"),MOe=kX("year","ordinal"),OOe=/(\d{4})-(\d\d)-(\d\d)/,HX=RegExp(`${XV.source} ?(?:${FX.source}|(${PX.source}))?`),NOe=RegExp(`(?: ${HX.source})?`);function Cv(t,e,n){let r=t[e];return zt(r)?n:Id(r)}function POe(t,e){return[{year:Cv(t,e),month:Cv(t,e+1,1),day:Cv(t,e+2,1)},null,e+3]}function bv(t,e){return[{hours:Cv(t,e,0),minutes:Cv(t,e+1,0),seconds:Cv(t,e+2,0),milliseconds:v1(t[e+3])},null,e+4]}function y1(t,e){let n=!t[e]&&!t[e+1],r=pp(t[e+1],t[e+2]),i=n?null:Po.instance(r);return[{},i,e+3]}function _1(t,e){let n=t[e]?Ms.create(t[e]):null;return[{},n,e+1]}var kOe=RegExp(`^T?${XV.source}$`),FOe=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function LOe(t){let[e,n,r,i,o,s,a,l,c]=t,u=e[0]==="-",d=l&&l[0]==="-",h=(f,p=!1)=>f!==void 0&&(p||f&&u)?-f:f;return[{years:h(uf(n)),months:h(uf(r)),weeks:h(uf(i)),days:h(uf(o)),hours:h(uf(s)),minutes:h(uf(a)),seconds:h(uf(l),l==="-0"),milliseconds:h(v1(c),d)}]}var HOe={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function QV(t,e,n,r,i,o,s){let a={year:e.length===2?w1(Id(e)):Id(e),month:YV.indexOf(n)+1,day:Id(r),hour:Id(i),minute:Id(o)};return s&&(a.second=Id(s)),t&&(a.weekday=t.length>3?qV.indexOf(t)+1:KV.indexOf(t)+1),a}var VOe=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function BOe(t){let[,e,n,r,i,o,s,a,l,c,u,d]=t,h=QV(e,i,r,n,o,s,a),f;return l?f=HOe[l]:c?f=0:f=pp(u,d),[h,new Po(f)]}function UOe(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}var WOe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,jOe=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,$Oe=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function NX(t){let[,e,n,r,i,o,s,a]=t;return[QV(e,i,r,n,o,s,a),Po.utcInstance]}function GOe(t){let[,e,n,r,i,o,s,a]=t;return[QV(e,a,n,r,i,o,s),Po.utcInstance]}var zOe=Sv(ROe,ZV),YOe=Sv(DOe,ZV),qOe=Sv(IOe,ZV),KOe=Sv(LX),VX=Ev(POe,bv,y1,_1),XOe=Ev(AOe,bv,y1,_1),ZOe=Ev(MOe,bv,y1,_1),QOe=Ev(bv,y1,_1);function BX(t){return xv(t,[zOe,VX],[YOe,XOe],[qOe,ZOe],[KOe,QOe])}function UX(t){return xv(UOe(t),[VOe,BOe])}function WX(t){return xv(t,[WOe,NX],[jOe,NX],[$Oe,GOe])}function jX(t){return xv(t,[FOe,LOe])}var JOe=Ev(bv);function $X(t){return xv(t,[kOe,JOe])}var eNe=Sv(OOe,NOe),tNe=Sv(HX),nNe=Ev(bv,y1,_1);function GX(t){return xv(t,[eNe,VX],[tNe,nNe])}var zX="Invalid Duration",qX={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},rNe=Ee({years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3}},qX),rl=146097/400,Tv=146097/4800,iNe=Ee({years:{quarters:4,months:12,weeks:rl/7,days:rl,hours:rl*24,minutes:rl*24*60,seconds:rl*24*60*60,milliseconds:rl*24*60*60*1e3},quarters:{months:3,weeks:rl/28,days:rl/4,hours:rl*24/4,minutes:rl*24*60/4,seconds:rl*24*60*60/4,milliseconds:rl*24*60*60*1e3/4},months:{weeks:Tv/7,days:Tv,hours:Tv*24,minutes:Tv*24*60,seconds:Tv*24*60*60,milliseconds:Tv*24*60*60*1e3}},qX),wp=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],oNe=wp.slice(0).reverse();function df(t,e,n=!1){let r={values:n?e.values:Ee(Ee({},t.values),e.values||{}),loc:t.loc.clone(e.loc),conversionAccuracy:e.conversionAccuracy||t.conversionAccuracy,matrix:e.matrix||t.matrix};return new di(r)}function KX(t,e){let n=e.milliseconds??0;for(let r of oNe.slice(1))e[r]&&(n+=e[r]*t[r].milliseconds);return n}function YX(t,e){let n=KX(t,e)<0?-1:1;wp.reduceRight((r,i)=>{if(zt(e[i]))return r;if(r){let o=e[r]*n,s=t[i][r],a=Math.floor(o/s);e[i]+=a*n,e[r]-=a*s*n}return i},null),wp.reduce((r,i)=>{if(zt(e[i]))return r;if(r){let o=e[r]%1;e[r]-=o,e[i]+=o*t[r][i]}return i},null)}function sNe(t){let e={};for(let[n,r]of Object.entries(t))r!==0&&(e[n]=r);return e}var di=class t{constructor(e){let n=e.conversionAccuracy==="longterm"||!1,r=n?iNe:rNe;e.matrix&&(r=e.matrix),this.values=e.values,this.loc=e.loc||fr.create(),this.conversionAccuracy=n?"longterm":"casual",this.invalid=e.invalid||null,this.matrix=r,this.isLuxonDuration=!0}static fromMillis(e,n){return t.fromObject({milliseconds:e},n)}static fromObject(e,n={}){if(e==null||typeof e!="object")throw new ki(`Duration.fromObject: argument expected to be an object, got ${e===null?"null":typeof e}`);return new t({values:_v(e,t.normalizeUnit),loc:fr.fromObject(n),conversionAccuracy:n.conversionAccuracy,matrix:n.matrix})}static fromDurationLike(e){if(lu(e))return t.fromMillis(e);if(t.isDuration(e))return e;if(typeof e=="object")return t.fromObject(e);throw new ki(`Unknown duration argument ${e} of type ${typeof e}`)}static fromISO(e,n){let[r]=jX(e);return r?t.fromObject(r,n):t.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static fromISOTime(e,n){let[r]=$X(e);return r?t.fromObject(r,n):t.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static invalid(e,n=null){if(!e)throw new ki("need to specify a reason the Duration is invalid");let r=e instanceof ko?e:new ko(e,n);if(cr.throwOnInvalid)throw new WI(r);return new t({invalid:r})}static normalizeUnit(e){let n={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[e&&e.toLowerCase()];if(!n)throw new gv(e);return n}static isDuration(e){return e&&e.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(e,n={}){let r=ft(Ee({},n),{floor:n.round!==!1&&n.floor!==!1});return this.isValid?Fo.create(this.loc,r).formatDurationFromString(this,e):zX}toHuman(e={}){if(!this.isValid)return zX;let n=wp.map(r=>{let i=this.values[r];return zt(i)?null:this.loc.numberFormatter(ft(Ee({style:"unit",unitDisplay:"long"},e),{unit:r.slice(0,-1)})).format(i)}).filter(r=>r);return this.loc.listFormatter(Ee({type:"conjunction",style:e.listStyle||"narrow"},e)).format(n)}toObject(){return this.isValid?Ee({},this.values):{}}toISO(){if(!this.isValid)return null;let e="P";return this.years!==0&&(e+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(e+=this.months+this.quarters*3+"M"),this.weeks!==0&&(e+=this.weeks+"W"),this.days!==0&&(e+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(e+="T"),this.hours!==0&&(e+=this.hours+"H"),this.minutes!==0&&(e+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(e+=wv(this.seconds+this.milliseconds/1e3,3)+"S"),e==="P"&&(e+="T0S"),e}toISOTime(e={}){if(!this.isValid)return null;let n=this.toMillis();return n<0||n>=864e5?null:(e=ft(Ee({suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended"},e),{includeOffset:!1}),ln.fromMillis(n,{zone:"UTC"}).toISOTime(e))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?KX(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(e){if(!this.isValid)return this;let n=t.fromDurationLike(e),r={};for(let i of wp)(cf(n.values,i)||cf(this.values,i))&&(r[i]=n.get(i)+this.get(i));return df(this,{values:r},!0)}minus(e){if(!this.isValid)return this;let n=t.fromDurationLike(e);return this.plus(n.negate())}mapUnits(e){if(!this.isValid)return this;let n={};for(let r of Object.keys(this.values))n[r]=zV(e(this.values[r],r));return df(this,{values:n},!0)}get(e){return this[t.normalizeUnit(e)]}set(e){if(!this.isValid)return this;let n=Ee(Ee({},this.values),_v(e,t.normalizeUnit));return df(this,{values:n})}reconfigure({locale:e,numberingSystem:n,conversionAccuracy:r,matrix:i}={}){let s={loc:this.loc.clone({locale:e,numberingSystem:n}),matrix:i,conversionAccuracy:r};return df(this,s)}as(e){return this.isValid?this.shiftTo(e).get(e):NaN}normalize(){if(!this.isValid)return this;let e=this.toObject();return YX(this.matrix,e),df(this,{values:e},!0)}rescale(){if(!this.isValid)return this;let e=sNe(this.normalize().shiftToAll().toObject());return df(this,{values:e},!0)}shiftTo(...e){if(!this.isValid)return this;if(e.length===0)return this;e=e.map(s=>t.normalizeUnit(s));let n={},r={},i=this.toObject(),o;for(let s of wp)if(e.indexOf(s)>=0){o=s;let a=0;for(let c in r)a+=this.matrix[c][s]*r[c],r[c]=0;lu(i[s])&&(a+=i[s]);let l=Math.trunc(a);n[s]=l,r[s]=(a*1e3-l*1e3)/1e3}else lu(i[s])&&(r[s]=i[s]);for(let s in r)r[s]!==0&&(n[o]+=s===o?r[s]:r[s]/this.matrix[o][s]);return YX(this.matrix,n),df(this,{values:n},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;let e={};for(let n of Object.keys(this.values))e[n]=this.values[n]===0?0:-this.values[n];return df(this,{values:e},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(e){if(!this.isValid||!e.isValid||!this.loc.equals(e.loc))return!1;function n(r,i){return r===void 0||r===0?i===void 0||i===0:r===i}for(let r of wp)if(!n(this.values[r],e.values[r]))return!1;return!0}};var Rv="Invalid Interval";function aNe(t,e){return!t||!t.isValid?hf.invalid("missing or invalid start"):!e||!e.isValid?hf.invalid("missing or invalid end"):e<t?hf.invalid("end before start",`The end of an interval must be after its start, but you had start=${t.toISO()} and end=${e.toISO()}`):null}var hf=class t{constructor(e){this.s=e.start,this.e=e.end,this.invalid=e.invalid||null,this.isLuxonInterval=!0}static invalid(e,n=null){if(!e)throw new ki("need to specify a reason the Interval is invalid");let r=e instanceof ko?e:new ko(e,n);if(cr.throwOnInvalid)throw new UI(r);return new t({invalid:r})}static fromDateTimes(e,n){let r=Dv(e),i=Dv(n),o=aNe(r,i);return o??new t({start:r,end:i})}static after(e,n){let r=di.fromDurationLike(n),i=Dv(e);return t.fromDateTimes(i,i.plus(r))}static before(e,n){let r=di.fromDurationLike(n),i=Dv(e);return t.fromDateTimes(i.minus(r),i)}static fromISO(e,n){let[r,i]=(e||"").split("/",2);if(r&&i){let o,s;try{o=ln.fromISO(r,n),s=o.isValid}catch{s=!1}let a,l;try{a=ln.fromISO(i,n),l=a.isValid}catch{l=!1}if(s&&l)return t.fromDateTimes(o,a);if(s){let c=di.fromISO(i,n);if(c.isValid)return t.after(o,c)}else if(l){let c=di.fromISO(r,n);if(c.isValid)return t.before(a,c)}}return t.invalid("unparsable",`the input "${e}" can't be parsed as ISO 8601`)}static isInterval(e){return e&&e.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(e="milliseconds"){return this.isValid?this.toDuration(e).get(e):NaN}count(e="milliseconds",n){if(!this.isValid)return NaN;let r=this.start.startOf(e,n),i;return n?.useLocaleWeeks?i=this.end.reconfigure({locale:r.locale}):i=this.end,i=i.startOf(e,n),Math.floor(i.diff(r,e).get(e))+(i.valueOf()!==this.end.valueOf())}hasSame(e){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,e):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(e){return this.isValid?this.s>e:!1}isBefore(e){return this.isValid?this.e<=e:!1}contains(e){return this.isValid?this.s<=e&&this.e>e:!1}set({start:e,end:n}={}){return this.isValid?t.fromDateTimes(e||this.s,n||this.e):this}splitAt(...e){if(!this.isValid)return[];let n=e.map(Dv).filter(s=>this.contains(s)).sort((s,a)=>s.toMillis()-a.toMillis()),r=[],{s:i}=this,o=0;for(;i<this.e;){let s=n[o]||this.e,a=+s>+this.e?this.e:s;r.push(t.fromDateTimes(i,a)),i=a,o+=1}return r}splitBy(e){let n=di.fromDurationLike(e);if(!this.isValid||!n.isValid||n.as("milliseconds")===0)return[];let{s:r}=this,i=1,o,s=[];for(;r<this.e;){let a=this.start.plus(n.mapUnits(l=>l*i));o=+a>+this.e?this.e:a,s.push(t.fromDateTimes(r,o)),r=o,i+=1}return s}divideEqually(e){return this.isValid?this.splitBy(this.length()/e).slice(0,e):[]}overlaps(e){return this.e>e.s&&this.s<e.e}abutsStart(e){return this.isValid?+this.e==+e.s:!1}abutsEnd(e){return this.isValid?+e.e==+this.s:!1}engulfs(e){return this.isValid?this.s<=e.s&&this.e>=e.e:!1}equals(e){return!this.isValid||!e.isValid?!1:this.s.equals(e.s)&&this.e.equals(e.e)}intersection(e){if(!this.isValid)return this;let n=this.s>e.s?this.s:e.s,r=this.e<e.e?this.e:e.e;return n>=r?null:t.fromDateTimes(n,r)}union(e){if(!this.isValid)return this;let n=this.s<e.s?this.s:e.s,r=this.e>e.e?this.e:e.e;return t.fromDateTimes(n,r)}static merge(e){let[n,r]=e.sort((i,o)=>i.s-o.s).reduce(([i,o],s)=>o?o.overlaps(s)||o.abutsStart(s)?[i,o.union(s)]:[i.concat([o]),s]:[i,s],[[],null]);return r&&n.push(r),n}static xor(e){let n=null,r=0,i=[],o=e.map(l=>[{time:l.s,type:"s"},{time:l.e,type:"e"}]),s=Array.prototype.concat(...o),a=s.sort((l,c)=>l.time-c.time);for(let l of a)r+=l.type==="s"?1:-1,r===1?n=l.time:(n&&+n!=+l.time&&i.push(t.fromDateTimes(n,l.time)),n=null);return t.merge(i)}difference(...e){return t.xor([this].concat(e)).map(n=>this.intersection(n)).filter(n=>n&&!n.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} \u2013 ${this.e.toISO()})`:Rv}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(e=sf,n={}){return this.isValid?Fo.create(this.s.loc.clone(n),e).formatInterval(this):Rv}toISO(e){return this.isValid?`${this.s.toISO(e)}/${this.e.toISO(e)}`:Rv}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:Rv}toISOTime(e){return this.isValid?`${this.s.toISOTime(e)}/${this.e.toISOTime(e)}`:Rv}toFormat(e,{separator:n=" \u2013 "}={}){return this.isValid?`${this.s.toFormat(e)}${n}${this.e.toFormat(e)}`:Rv}toDuration(e,n){return this.isValid?this.e.diff(this.s,e,n):di.invalid(this.invalidReason)}mapEndpoints(e){return t.fromDateTimes(e(this.s),e(this.e))}};var ff=class{static hasDST(e=cr.defaultZone){let n=ln.now().setZone(e).set({month:12});return!e.isUniversal&&n.offset!==n.set({month:6}).offset}static isValidIANAZone(e){return Ms.isValidZone(e)}static normalizeZone(e){return ic(e,cr.defaultZone)}static getStartOfWeek({locale:e=null,locObj:n=null}={}){return(n||fr.create(e)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:e=null,locObj:n=null}={}){return(n||fr.create(e)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:e=null,locObj:n=null}={}){return(n||fr.create(e)).getWeekendDays().slice()}static months(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null,outputCalendar:o="gregory"}={}){return(i||fr.create(n,r,o)).months(e)}static monthsFormat(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null,outputCalendar:o="gregory"}={}){return(i||fr.create(n,r,o)).months(e,!0)}static weekdays(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null}={}){return(i||fr.create(n,r,null)).weekdays(e)}static weekdaysFormat(e="long",{locale:n=null,numberingSystem:r=null,locObj:i=null}={}){return(i||fr.create(n,r,null)).weekdays(e,!0)}static meridiems({locale:e=null}={}){return fr.create(e).meridiems()}static eras(e="short",{locale:n=null}={}){return fr.create(n,null,"gregory").eras(e)}static features(){return{relative:qI(),localeWeek:KI()}}};function XX(t,e){let n=i=>i.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),r=n(e)-n(t);return Math.floor(di.fromMillis(r).as("days"))}function lNe(t,e,n){let r=[["years",(l,c)=>c.year-l.year],["quarters",(l,c)=>c.quarter-l.quarter+(c.year-l.year)*4],["months",(l,c)=>c.month-l.month+(c.year-l.year)*12],["weeks",(l,c)=>{let u=XX(l,c);return(u-u%7)/7}],["days",XX]],i={},o=t,s,a;for(let[l,c]of r)n.indexOf(l)>=0&&(s=l,i[l]=c(t,e),a=o.plus(i),a>e?(i[l]--,t=o.plus(i),t>e&&(a=t,i[l]--,t=o.plus(i))):t=a);return[t,i,a,s]}function ZX(t,e,n,r){let[i,o,s,a]=lNe(t,e,n),l=e-i,c=n.filter(d=>["hours","minutes","seconds","milliseconds"].indexOf(d)>=0);c.length===0&&(s<e&&(s=i.plus({[a]:1})),s!==i&&(o[a]=(o[a]||0)+l/(s-i)));let u=di.fromObject(o,r);return c.length>0?di.fromMillis(l,r).shiftTo(...c).plus(u):u}var JV={arab:"[\u0660-\u0669]",arabext:"[\u06F0-\u06F9]",bali:"[\u1B50-\u1B59]",beng:"[\u09E6-\u09EF]",deva:"[\u0966-\u096F]",fullwide:"[\uFF10-\uFF19]",gujr:"[\u0AE6-\u0AEF]",hanidec:"[\u3007|\u4E00|\u4E8C|\u4E09|\u56DB|\u4E94|\u516D|\u4E03|\u516B|\u4E5D]",khmr:"[\u17E0-\u17E9]",knda:"[\u0CE6-\u0CEF]",laoo:"[\u0ED0-\u0ED9]",limb:"[\u1946-\u194F]",mlym:"[\u0D66-\u0D6F]",mong:"[\u1810-\u1819]",mymr:"[\u1040-\u1049]",orya:"[\u0B66-\u0B6F]",tamldec:"[\u0BE6-\u0BEF]",telu:"[\u0C66-\u0C6F]",thai:"[\u0E50-\u0E59]",tibt:"[\u0F20-\u0F29]",latn:"\\d"},QX={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},cNe=JV.hanidec.replace(/[\[|\]]/g,"").split("");function JX(t){let e=parseInt(t,10);if(isNaN(e)){e="";for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(t[n].search(JV.hanidec)!==-1)e+=cNe.indexOf(t[n]);else for(let i in QX){let[o,s]=QX[i];r>=o&&r<=s&&(e+=r-o)}}return parseInt(e,10)}else return e}function il({numberingSystem:t},e=""){return new RegExp(`${JV[t||"latn"]}${e}`)}var uNe="missing Intl.DateTimeFormat.formatToParts support";function ir(t,e=n=>n){return{regex:t,deser:([n])=>e(JX(n))}}var dNe=String.fromCharCode(160),nZ=`[ ${dNe}]`,rZ=new RegExp(nZ,"g");function hNe(t){return t.replace(/\./g,"\\.?").replace(rZ,nZ)}function eZ(t){return t.replace(/\./g,"").replace(rZ," ").toLowerCase()}function oc(t,e){return t===null?null:{regex:RegExp(t.map(hNe).join("|")),deser:([n])=>t.findIndex(r=>eZ(n)===eZ(r))+e}}function tZ(t,e){return{regex:t,deser:([,n,r])=>pp(n,r),groups:e}}function JI(t){return{regex:t,deser:([e])=>e}}function fNe(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function mNe(t,e){let n=il(e),r=il(e,"{2}"),i=il(e,"{3}"),o=il(e,"{4}"),s=il(e,"{6}"),a=il(e,"{1,2}"),l=il(e,"{1,3}"),c=il(e,"{1,6}"),u=il(e,"{1,9}"),d=il(e,"{2,4}"),h=il(e,"{4,6}"),f=w=>({regex:RegExp(fNe(w.val)),deser:([_])=>_,literal:!0}),g=(w=>{if(t.literal)return f(w);switch(w.val){case"G":return oc(e.eras("short"),0);case"GG":return oc(e.eras("long"),0);case"y":return ir(c);case"yy":return ir(d,w1);case"yyyy":return ir(o);case"yyyyy":return ir(h);case"yyyyyy":return ir(s);case"M":return ir(a);case"MM":return ir(r);case"MMM":return oc(e.months("short",!0),1);case"MMMM":return oc(e.months("long",!0),1);case"L":return ir(a);case"LL":return ir(r);case"LLL":return oc(e.months("short",!1),1);case"LLLL":return oc(e.months("long",!1),1);case"d":return ir(a);case"dd":return ir(r);case"o":return ir(l);case"ooo":return ir(i);case"HH":return ir(r);case"H":return ir(a);case"hh":return ir(r);case"h":return ir(a);case"mm":return ir(r);case"m":return ir(a);case"q":return ir(a);case"qq":return ir(r);case"s":return ir(a);case"ss":return ir(r);case"S":return ir(l);case"SSS":return ir(i);case"u":return JI(u);case"uu":return JI(a);case"uuu":return ir(n);case"a":return oc(e.meridiems(),0);case"kkkk":return ir(o);case"kk":return ir(d,w1);case"W":return ir(a);case"WW":return ir(r);case"E":case"c":return ir(n);case"EEE":return oc(e.weekdays("short",!1),1);case"EEEE":return oc(e.weekdays("long",!1),1);case"ccc":return oc(e.weekdays("short",!0),1);case"cccc":return oc(e.weekdays("long",!0),1);case"Z":case"ZZ":return tZ(new RegExp(`([+-]${a.source})(?::(${r.source}))?`),2);case"ZZZ":return tZ(new RegExp(`([+-]${a.source})(${r.source})?`),2);case"z":return JI(/[a-z_+-/]{1,256}?/i);case" ":return JI(/[^\S\n\r]/);default:return f(w)}})(t)||{invalidReason:uNe};return g.token=t,g}var pNe={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function gNe(t,e,n){let{type:r,value:i}=t;if(r==="literal"){let l=/^\s+$/.test(i);return{literal:!l,val:l?" ":i}}let o=e[r],s=r;r==="hour"&&(e.hour12!=null?s=e.hour12?"hour12":"hour24":e.hourCycle!=null?e.hourCycle==="h11"||e.hourCycle==="h12"?s="hour12":s="hour24":s=n.hour12?"hour12":"hour24");let a=pNe[s];if(typeof a=="object"&&(a=a[o]),a)return{literal:!1,val:a}}function vNe(t){return[`^${t.map(n=>n.regex).reduce((n,r)=>`${n}(${r.source})`,"")}$`,t]}function wNe(t,e,n){let r=t.match(e);if(r){let i={},o=1;for(let s in n)if(cf(n,s)){let a=n[s],l=a.groups?a.groups+1:1;!a.literal&&a.token&&(i[a.token.val[0]]=a.deser(r.slice(o,o+l))),o+=l}return[r,i]}else return[r,{}]}function yNe(t){let e=o=>{switch(o){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}},n=null,r;return zt(t.z)||(n=Ms.create(t.z)),zt(t.Z)||(n||(n=new Po(t.Z)),r=t.Z),zt(t.q)||(t.M=(t.q-1)*3+1),zt(t.h)||(t.h<12&&t.a===1?t.h+=12:t.h===12&&t.a===0&&(t.h=0)),t.G===0&&t.y&&(t.y=-t.y),zt(t.u)||(t.S=v1(t.u)),[Object.keys(t).reduce((o,s)=>{let a=e(s);return a&&(o[a]=t[s]),o},{}),n,r]}var eB=null;function _Ne(){return eB||(eB=ln.fromMillis(1555555555555)),eB}function CNe(t,e){if(t.literal)return t;let n=Fo.macroTokenToFormatOpts(t.val),r=rB(n,e);return r==null||r.includes(void 0)?t:r}function tB(t,e){return Array.prototype.concat(...t.map(n=>CNe(n,e)))}function nB(t,e,n){let r=tB(Fo.parseFormat(n),t),i=r.map(s=>mNe(s,t)),o=i.find(s=>s.invalidReason);if(o)return{input:e,tokens:r,invalidReason:o.invalidReason};{let[s,a]=vNe(i),l=RegExp(s,"i"),[c,u]=wNe(e,l,a),[d,h,f]=u?yNe(u):[null,null,void 0];if(cf(u,"a")&&cf(u,"H"))throw new tc("Can't include meridiem when specifying 24-hour format");return{input:e,tokens:r,regex:l,rawMatches:c,matches:u,result:d,zone:h,specificOffset:f}}}function iZ(t,e,n){let{result:r,zone:i,specificOffset:o,invalidReason:s}=nB(t,e,n);return[r,i,o,s]}function rB(t,e){if(!t)return null;let r=Fo.create(e,t).dtFormatter(_Ne()),i=r.formatToParts(),o=r.resolvedOptions();return i.map(s=>gNe(s,t,o))}var iB="Invalid DateTime",oZ=864e13;function eA(t){return new ko("unsupported zone",`the zone "${t.name}" is not supported`)}function oB(t){return t.weekData===null&&(t.weekData=m1(t.c)),t.weekData}function sB(t){return t.localWeekData===null&&(t.localWeekData=m1(t.c,t.loc.getMinDaysInFirstWeek(),t.loc.getStartOfWeek())),t.localWeekData}function yp(t,e){let n={ts:t.ts,zone:t.zone,c:t.c,o:t.o,loc:t.loc,invalid:t.invalid};return new ln(ft(Ee(Ee({},n),e),{old:n}))}function hZ(t,e,n){let r=t-e*60*1e3,i=n.offset(r);if(e===i)return[r,e];r-=(i-e)*60*1e3;let o=n.offset(r);return i===o?[r,i]:[t-Math.min(i,o)*60*1e3,Math.max(i,o)]}function tA(t,e){t+=e*60*1e3;let n=new Date(t);return{year:n.getUTCFullYear(),month:n.getUTCMonth()+1,day:n.getUTCDate(),hour:n.getUTCHours(),minute:n.getUTCMinutes(),second:n.getUTCSeconds(),millisecond:n.getUTCMilliseconds()}}function rA(t,e,n){return hZ(vv(t),e,n)}function sZ(t,e){let n=t.o,r=t.c.year+Math.trunc(e.years),i=t.c.month+Math.trunc(e.months)+Math.trunc(e.quarters)*3,o=ft(Ee({},t.c),{year:r,month:i,day:Math.min(t.c.day,yv(r,i))+Math.trunc(e.days)+Math.trunc(e.weeks)*7}),s=di.fromObject({years:e.years-Math.trunc(e.years),quarters:e.quarters-Math.trunc(e.quarters),months:e.months-Math.trunc(e.months),weeks:e.weeks-Math.trunc(e.weeks),days:e.days-Math.trunc(e.days),hours:e.hours,minutes:e.minutes,seconds:e.seconds,milliseconds:e.milliseconds}).as("milliseconds"),a=vv(o),[l,c]=hZ(a,n,t.zone);return s!==0&&(l+=s,c=t.zone.offset(l)),{ts:l,o:c}}function C1(t,e,n,r,i,o){let{setZone:s,zone:a}=n;if(t&&Object.keys(t).length!==0||e){let l=e||a,c=ln.fromObject(t,ft(Ee({},n),{zone:l,specificOffset:o}));return s?c:c.setZone(a)}else return ln.invalid(new ko("unparsable",`the input "${i}" can't be parsed as ${r}`))}function nA(t,e,n=!0){return t.isValid?Fo.create(fr.create("en-US"),{allowZ:n,forceSimple:!0}).formatDateTimeFromString(t,e):null}function aB(t,e){let n=t.c.year>9999||t.c.year<0,r="";return n&&t.c.year>=0&&(r+="+"),r+=Zr(t.c.year,n?6:4),e?(r+="-",r+=Zr(t.c.month),r+="-",r+=Zr(t.c.day)):(r+=Zr(t.c.month),r+=Zr(t.c.day)),r}function aZ(t,e,n,r,i,o){let s=Zr(t.c.hour);return e?(s+=":",s+=Zr(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!n)&&(s+=":")):s+=Zr(t.c.minute),(t.c.millisecond!==0||t.c.second!==0||!n)&&(s+=Zr(t.c.second),(t.c.millisecond!==0||!r)&&(s+=".",s+=Zr(t.c.millisecond,3))),i&&(t.isOffsetFixed&&t.offset===0&&!o?s+="Z":t.o<0?(s+="-",s+=Zr(Math.trunc(-t.o/60)),s+=":",s+=Zr(Math.trunc(-t.o%60))):(s+="+",s+=Zr(Math.trunc(t.o/60)),s+=":",s+=Zr(Math.trunc(t.o%60)))),o&&(s+="["+t.zone.ianaName+"]"),s}var fZ={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},SNe={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},ENe={ordinal:1,hour:0,minute:0,second:0,millisecond:0},mZ=["year","month","day","hour","minute","second","millisecond"],xNe=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],bNe=["year","ordinal","hour","minute","second","millisecond"];function TNe(t){let e={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[t.toLowerCase()];if(!e)throw new gv(t);return e}function lZ(t){switch(t.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return TNe(t)}}function cZ(t,e){let n=ic(e.zone,cr.defaultZone),r=fr.fromObject(e),i=cr.now(),o,s;if(zt(t.year))o=i;else{for(let c of mZ)zt(t[c])&&(t[c]=fZ[c]);let a=jV(t)||$V(t);if(a)return ln.invalid(a);let l=n.offset(i);[o,s]=rA(t,l,n)}return new ln({ts:o,zone:n,loc:r,o:s})}function uZ(t,e,n){let r=zt(n.round)?!0:n.round,i=(s,a)=>(s=wv(s,r||n.calendary?0:2,!0),e.loc.clone(n).relFormatter(n).format(s,a)),o=s=>n.calendary?e.hasSame(t,s)?0:e.startOf(s).diff(t.startOf(s),s).get(s):e.diff(t,s).get(s);if(n.unit)return i(o(n.unit),n.unit);for(let s of n.units){let a=o(s);if(Math.abs(a)>=1)return i(a,s)}return i(t>e?-0:0,n.units[n.units.length-1])}function dZ(t){let e={},n;return t.length>0&&typeof t[t.length-1]=="object"?(e=t[t.length-1],n=Array.from(t).slice(0,t.length-1)):n=Array.from(t),[e,n]}var ln=class t{constructor(e){let n=e.zone||cr.defaultZone,r=e.invalid||(Number.isNaN(e.ts)?new ko("invalid input"):null)||(n.isValid?null:eA(n));this.ts=zt(e.ts)?cr.now():e.ts;let i=null,o=null;if(!r)if(e.old&&e.old.ts===this.ts&&e.old.zone.equals(n))[i,o]=[e.old.c,e.old.o];else{let a=n.offset(this.ts);i=tA(this.ts,a),r=Number.isNaN(i.year)?new ko("invalid input"):null,i=r?null:i,o=r?null:a}this._zone=n,this.loc=e.loc||fr.create(),this.invalid=r,this.weekData=null,this.localWeekData=null,this.c=i,this.o=o,this.isLuxonDateTime=!0}static now(){return new t({})}static local(){let[e,n]=dZ(arguments),[r,i,o,s,a,l,c]=n;return cZ({year:r,month:i,day:o,hour:s,minute:a,second:l,millisecond:c},e)}static utc(){let[e,n]=dZ(arguments),[r,i,o,s,a,l,c]=n;return e.zone=Po.utcInstance,cZ({year:r,month:i,day:o,hour:s,minute:a,second:l,millisecond:c},e)}static fromJSDate(e,n={}){let r=bX(e)?e.valueOf():NaN;if(Number.isNaN(r))return t.invalid("invalid input");let i=ic(n.zone,cr.defaultZone);return i.isValid?new t({ts:r,zone:i,loc:fr.fromObject(n)}):t.invalid(eA(i))}static fromMillis(e,n={}){if(lu(e))return e<-oZ||e>oZ?t.invalid("Timestamp out of range"):new t({ts:e,zone:ic(n.zone,cr.defaultZone),loc:fr.fromObject(n)});throw new ki(`fromMillis requires a numerical input, but received a ${typeof e} with value ${e}`)}static fromSeconds(e,n={}){if(lu(e))return new t({ts:e*1e3,zone:ic(n.zone,cr.defaultZone),loc:fr.fromObject(n)});throw new ki("fromSeconds requires a numerical input")}static fromObject(e,n={}){e=e||{};let r=ic(n.zone,cr.defaultZone);if(!r.isValid)return t.invalid(eA(r));let i=fr.fromObject(n),o=_v(e,lZ),{minDaysInFirstWeek:s,startOfWeek:a}=WV(o,i),l=cr.now(),c=zt(n.specificOffset)?r.offset(l):n.specificOffset,u=!zt(o.ordinal),d=!zt(o.year),h=!zt(o.month)||!zt(o.day),f=d||h,p=o.weekYear||o.weekNumber;if((f||u)&&p)throw new tc("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(h&&u)throw new tc("Can't mix ordinal dates with month/day");let g=p||o.weekday&&!f,w,_,S=tA(l,c);g?(w=xNe,_=SNe,S=m1(S,s,a)):u?(w=bNe,_=ENe,S=QI(S)):(w=mZ,_=fZ);let x=!1;for(let Y of w){let ee=o[Y];zt(ee)?x?o[Y]=_[Y]:o[Y]=S[Y]:x=!0}let P=g?SX(o,s,a):u?EX(o):jV(o),k=P||$V(o);if(k)return t.invalid(k);let b=g?BV(o,s,a):u?UV(o):o,[C,N]=rA(b,c,r),B=new t({ts:C,zone:r,o:N,loc:i});return o.weekday&&f&&e.weekday!==B.weekday?t.invalid("mismatched weekday",`you can't specify both a weekday of ${o.weekday} and a date of ${B.toISO()}`):B}static fromISO(e,n={}){let[r,i]=BX(e);return C1(r,i,n,"ISO 8601",e)}static fromRFC2822(e,n={}){let[r,i]=UX(e);return C1(r,i,n,"RFC 2822",e)}static fromHTTP(e,n={}){let[r,i]=WX(e);return C1(r,i,n,"HTTP",n)}static fromFormat(e,n,r={}){if(zt(e)||zt(n))throw new ki("fromFormat requires an input string and a format");let{locale:i=null,numberingSystem:o=null}=r,s=fr.fromOpts({locale:i,numberingSystem:o,defaultToEN:!0}),[a,l,c,u]=iZ(s,e,n);return u?t.invalid(u):C1(a,l,r,`format ${n}`,e,c)}static fromString(e,n,r={}){return t.fromFormat(e,n,r)}static fromSQL(e,n={}){let[r,i]=GX(e);return C1(r,i,n,"SQL",e)}static invalid(e,n=null){if(!e)throw new ki("need to specify a reason the DateTime is invalid");let r=e instanceof ko?e:new ko(e,n);if(cr.throwOnInvalid)throw new BI(r);return new t({invalid:r})}static isDateTime(e){return e&&e.isLuxonDateTime||!1}static parseFormatForOpts(e,n={}){let r=rB(e,fr.fromObject(n));return r?r.map(i=>i?i.val:null).join(""):null}static expandFormat(e,n={}){return tB(Fo.parseFormat(e),fr.fromObject(n)).map(i=>i.val).join("")}get(e){return this[e]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?oB(this).weekYear:NaN}get weekNumber(){return this.isValid?oB(this).weekNumber:NaN}get weekday(){return this.isValid?oB(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?sB(this).weekday:NaN}get localWeekNumber(){return this.isValid?sB(this).weekNumber:NaN}get localWeekYear(){return this.isValid?sB(this).weekYear:NaN}get ordinal(){return this.isValid?QI(this.c).ordinal:NaN}get monthShort(){return this.isValid?ff.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?ff.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?ff.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?ff.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];let e=864e5,n=6e4,r=vv(this.c),i=this.zone.offset(r-e),o=this.zone.offset(r+e),s=this.zone.offset(r-i*n),a=this.zone.offset(r-o*n);if(s===a)return[this];let l=r-s*n,c=r-a*n,u=tA(l,s),d=tA(c,a);return u.hour===d.hour&&u.minute===d.minute&&u.second===d.second&&u.millisecond===d.millisecond?[yp(this,{ts:l}),yp(this,{ts:c})]:[this]}get isInLeapYear(){return vp(this.year)}get daysInMonth(){return yv(this.year,this.month)}get daysInYear(){return this.isValid?lf(this.year):NaN}get weeksInWeekYear(){return this.isValid?gp(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?gp(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(e={}){let{locale:n,numberingSystem:r,calendar:i}=Fo.create(this.loc.clone(e),e).resolvedOptions(this);return{locale:n,numberingSystem:r,outputCalendar:i}}toUTC(e=0,n={}){return this.setZone(Po.instance(e),n)}toLocal(){return this.setZone(cr.defaultZone)}setZone(e,{keepLocalTime:n=!1,keepCalendarTime:r=!1}={}){if(e=ic(e,cr.defaultZone),e.equals(this.zone))return this;if(e.isValid){let i=this.ts;if(n||r){let o=e.offset(this.ts),s=this.toObject();[i]=rA(s,o,e)}return yp(this,{ts:i,zone:e})}else return t.invalid(eA(e))}reconfigure({locale:e,numberingSystem:n,outputCalendar:r}={}){let i=this.loc.clone({locale:e,numberingSystem:n,outputCalendar:r});return yp(this,{loc:i})}setLocale(e){return this.reconfigure({locale:e})}set(e){if(!this.isValid)return this;let n=_v(e,lZ),{minDaysInFirstWeek:r,startOfWeek:i}=WV(n,this.loc),o=!zt(n.weekYear)||!zt(n.weekNumber)||!zt(n.weekday),s=!zt(n.ordinal),a=!zt(n.year),l=!zt(n.month)||!zt(n.day),c=a||l,u=n.weekYear||n.weekNumber;if((c||s)&&u)throw new tc("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(l&&s)throw new tc("Can't mix ordinal dates with month/day");let d;o?d=BV(Ee(Ee({},m1(this.c,r,i)),n),r,i):zt(n.ordinal)?(d=Ee(Ee({},this.toObject()),n),zt(n.day)&&(d.day=Math.min(yv(d.year,d.month),d.day))):d=UV(Ee(Ee({},QI(this.c)),n));let[h,f]=rA(d,this.o,this.zone);return yp(this,{ts:h,o:f})}plus(e){if(!this.isValid)return this;let n=di.fromDurationLike(e);return yp(this,sZ(this,n))}minus(e){if(!this.isValid)return this;let n=di.fromDurationLike(e).negate();return yp(this,sZ(this,n))}startOf(e,{useLocaleWeeks:n=!1}={}){if(!this.isValid)return this;let r={},i=di.normalizeUnit(e);switch(i){case"years":r.month=1;case"quarters":case"months":r.day=1;case"weeks":case"days":r.hour=0;case"hours":r.minute=0;case"minutes":r.second=0;case"seconds":r.millisecond=0;break;case"milliseconds":break}if(i==="weeks")if(n){let o=this.loc.getStartOfWeek(),{weekday:s}=this;s<o&&(r.weekNumber=this.weekNumber-1),r.weekday=o}else r.weekday=1;if(i==="quarters"){let o=Math.ceil(this.month/3);r.month=(o-1)*3+1}return this.set(r)}endOf(e,n){return this.isValid?this.plus({[e]:1}).startOf(e,n).minus(1):this}toFormat(e,n={}){return this.isValid?Fo.create(this.loc.redefaultToEN(n)).formatDateTimeFromString(this,e):iB}toLocaleString(e=sf,n={}){return this.isValid?Fo.create(this.loc.clone(n),e).formatDateTime(this):iB}toLocaleParts(e={}){return this.isValid?Fo.create(this.loc.clone(e),e).formatDateTimeParts(this):[]}toISO({format:e="extended",suppressSeconds:n=!1,suppressMilliseconds:r=!1,includeOffset:i=!0,extendedZone:o=!1}={}){if(!this.isValid)return null;let s=e==="extended",a=aB(this,s);return a+="T",a+=aZ(this,s,n,r,i,o),a}toISODate({format:e="extended"}={}){return this.isValid?aB(this,e==="extended"):null}toISOWeekDate(){return nA(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:e=!1,suppressSeconds:n=!1,includeOffset:r=!0,includePrefix:i=!1,extendedZone:o=!1,format:s="extended"}={}){return this.isValid?(i?"T":"")+aZ(this,s==="extended",n,e,r,o):null}toRFC2822(){return nA(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return nA(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?aB(this,!0):null}toSQLTime({includeOffset:e=!0,includeZone:n=!1,includeOffsetSpace:r=!0}={}){let i="HH:mm:ss.SSS";return(n||e)&&(r&&(i+=" "),n?i+="z":e&&(i+="ZZ")),nA(this,i,!0)}toSQL(e={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(e)}`:null}toString(){return this.isValid?this.toISO():iB}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(e={}){if(!this.isValid)return{};let n=Ee({},this.c);return e.includeConfig&&(n.outputCalendar=this.outputCalendar,n.numberingSystem=this.loc.numberingSystem,n.locale=this.loc.locale),n}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(e,n="milliseconds",r={}){if(!this.isValid||!e.isValid)return di.invalid("created by diffing an invalid DateTime");let i=Ee({locale:this.locale,numberingSystem:this.numberingSystem},r),o=TX(n).map(di.normalizeUnit),s=e.valueOf()>this.valueOf(),a=s?this:e,l=s?e:this,c=ZX(a,l,o,i);return s?c.negate():c}diffNow(e="milliseconds",n={}){return this.diff(t.now(),e,n)}until(e){return this.isValid?hf.fromDateTimes(this,e):this}hasSame(e,n,r){if(!this.isValid)return!1;let i=e.valueOf(),o=this.setZone(e.zone,{keepLocalTime:!0});return o.startOf(n,r)<=i&&i<=o.endOf(n,r)}equals(e){return this.isValid&&e.isValid&&this.valueOf()===e.valueOf()&&this.zone.equals(e.zone)&&this.loc.equals(e.loc)}toRelative(e={}){if(!this.isValid)return null;let n=e.base||t.fromObject({},{zone:this.zone}),r=e.padding?this<n?-e.padding:e.padding:0,i=["years","months","days","hours","minutes","seconds"],o=e.unit;return Array.isArray(e.unit)&&(i=e.unit,o=void 0),uZ(n,this.plus(r),ft(Ee({},e),{numeric:"always",units:i,unit:o}))}toRelativeCalendar(e={}){return this.isValid?uZ(e.base||t.fromObject({},{zone:this.zone}),this,ft(Ee({},e),{numeric:"auto",units:["years","months","days"],calendary:!0})):null}static min(...e){if(!e.every(t.isDateTime))throw new ki("min requires all arguments be DateTimes");return GV(e,n=>n.valueOf(),Math.min)}static max(...e){if(!e.every(t.isDateTime))throw new ki("max requires all arguments be DateTimes");return GV(e,n=>n.valueOf(),Math.max)}static fromFormatExplain(e,n,r={}){let{locale:i=null,numberingSystem:o=null}=r,s=fr.fromOpts({locale:i,numberingSystem:o,defaultToEN:!0});return nB(s,e,n)}static fromStringExplain(e,n,r={}){return t.fromFormatExplain(e,n,r)}static get DATE_SHORT(){return sf}static get DATE_MED(){return zC}static get DATE_MED_WITH_WEEKDAY(){return xV}static get DATE_FULL(){return YC}static get DATE_HUGE(){return qC}static get TIME_SIMPLE(){return KC}static get TIME_WITH_SECONDS(){return XC}static get TIME_WITH_SHORT_OFFSET(){return ZC}static get TIME_WITH_LONG_OFFSET(){return QC}static get TIME_24_SIMPLE(){return JC}static get TIME_24_WITH_SECONDS(){return e1}static get TIME_24_WITH_SHORT_OFFSET(){return t1}static get TIME_24_WITH_LONG_OFFSET(){return n1}static get DATETIME_SHORT(){return r1}static get DATETIME_SHORT_WITH_SECONDS(){return i1}static get DATETIME_MED(){return o1}static get DATETIME_MED_WITH_SECONDS(){return s1}static get DATETIME_MED_WITH_WEEKDAY(){return bV}static get DATETIME_FULL(){return a1}static get DATETIME_FULL_WITH_SECONDS(){return l1}static get DATETIME_HUGE(){return c1}static get DATETIME_HUGE_WITH_SECONDS(){return u1}};function Dv(t){if(ln.isDateTime(t))return t;if(t&&t.valueOf&&lu(t.valueOf()))return ln.fromJSDate(t);if(t&&typeof t=="object")return ln.fromObject(t);throw new ki(`Unknown datetime argument: ${t}, of type ${typeof t}`)}function RNe(t,e){t&1&&(W(0,"div",12)(1,"label"),re(2,"DEPARTMENT"),V(),W(3,"select",13)(4,"option",14),re(5,"CONSTRUCTION"),V(),W(6,"option",15),re(7,"ENGINEERING"),V(),W(8,"option",16),re(9,"S&T"),V(),W(10,"option",17),re(11,"ELECTRIC"),V(),W(12,"option",18),re(13,"RE"),V(),W(14,"option",19),re(15,"RVNL"),V(),W(16,"option",20),re(17,"SIGNAL"),V(),W(18,"option",21),re(19,"Telecom"),V(),W(20,"option",22),re(21,"TRD"),V()()())}function DNe(t,e){t&1&&(W(0,"div",23)(1,"label"),re(2,"DEPARTMENT"),V(),W(3,"select",13)(4,"option",14),re(5,"CONSTRUCTION"),V(),W(6,"option",15),re(7,"ENGINEERING"),V(),W(8,"option",16),re(9,"S&T"),V(),W(10,"option",17),re(11,"ELECTRIC"),V(),W(12,"option",18),re(13,"RE"),V(),W(14,"option",19),re(15,"RVNL"),V(),W(16,"option",20),re(17,"SIGNAL"),V(),W(18,"option",21),re(19,"Telecom"),V(),W(20,"option",22),re(21,"TRD"),V()()())}function INe(t,e){if(t&1&&(W(0,"option",68),re(1),V()),t&2){let n=e.$implicit;Oi("value",n.board),Te(1),Hn(n.board)}}function ANe(t,e){if(t&1&&(W(0,"option",68),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function MNe(t,e){if(t&1&&(W(0,"option",68),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function ONe(t,e){if(t&1&&(W(0,"option",68),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function NNe(t,e){if(t&1&&(W(0,"option",68),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function PNe(t,e){t&1&&(W(0,"option",69),re(1," Others "),V())}function kNe(t,e){if(t&1&&(W(0,"option",68),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function FNe(t,e){t&1&&(at(0,"input",70),W(1,"div",71),re(2,"*DD/MM/YYYY HH:MM to HH:MM DAY(Capital Letters) "),V())}function LNe(t,e){if(t&1&&(W(0,"option",68),re(1),V()),t&2){let n=e.$implicit;Oi("value",n.machine),Te(1),Hn(n.machine)}}function HNe(t,e){if(t&1){let n=Fn();W(0,"div",2)(1,"div",77)(2,"input",78),Ue("change",function(i){let s=mt(n).index,a=Le(2).index,l=Le();return pt(l.integratedBlock(i,a,s))}),V()(),W(3,"div",79)(4,"input",80),Ue("change",function(i){let s=mt(n).index,a=Le(2).index,l=Le();return pt(l.integratedSection(i,a,s))}),V()(),W(5,"div",79)(6,"input",81),Ue("change",function(i){let s=mt(n).index,a=Le(2).index,l=Le();return pt(l.integratedDuration(i,a,s))}),V()(),W(7,"div",82)(8,"button",83),Ue("click",function(){let o=mt(n).index,s=Le(2).index,a=Le();return pt(a.deleteIntegrated(s,o))}),re(9,"x"),V()()()}if(t&2){let n=Le(2).index;Js("data-index",n)}}function VNe(t,e){if(t&1){let n=Fn();W(0,"div",2)(1,"div",72),re(2,"BLOCK"),V(),W(3,"div",73),re(4,"STATION"),V(),W(5,"div",73),re(6,"DURATION"),V(),W(7,"div",74)(8,"button",75),Ue("click",function(){mt(n);let i=Le().index,o=Le();return pt(o.addIntegrated(i))}),re(9,"+"),V()()(),rn(10,HNe,10,1,"div",76)}if(t&2){let n=Le().index,r=Le();Te(10),lt("ngForOf",r.integrates[n])}}function BNe(t,e){t&1&&at(0,"input",84)}function UNe(t,e){t&1&&at(0,"input",85)}function WNe(t,e){if(t&1){let n=Fn();W(0,"div",2)(1,"div",86)(2,"input",87),Ue("change",function(i){let s=mt(n).index,a=Le(2).index,l=Le();return pt(l.cautionLength(i,a,s))}),V()(),W(3,"div",86)(4,"input",88),Ue("change",function(i){let s=mt(n).index,a=Le(2).index,l=Le();return pt(l.cautionSpeed(i,a,s))}),V()(),W(5,"div",74)(6,"button",83),Ue("click",function(){let o=mt(n).index,s=Le(2).index,a=Le();return pt(a.deleteCaution(s,o))}),re(7,"x"),V()()()}if(t&2){let n=Le(2).index;Js("data-index",n)}}function jNe(t,e){if(t&1){let n=Fn();W(0,"div",2)(1,"div",86),re(2,"Length"),V(),W(3,"div",86),re(4,"Speed"),V(),W(5,"div",74)(6,"button",75),Ue("click",function(){mt(n);let i=Le().index,o=Le();return pt(o.addCaution(i))}),re(7,"+"),V()()(),rn(8,WNe,8,1,"div",76)}if(t&2){let n=Le().index,r=Le();Te(8),lt("ngForOf",r.cautions[n])}}function $Ne(t,e){if(t&1){let n=Fn();ea(0),W(1,"div",24)(2,"h2",25)(3,"button",26),re(4),V(),W(5,"button",27),Ue("click",function(){let o=mt(n).index,s=Le();return pt(s.onDelete(o))}),re(6," Delete "),V()(),W(7,"div",28)(8,"div",29)(9,"div",30)(10,"div",31)(11,"div",32)(12,"div",23)(13,"label"),re(14,"BOARD"),V(),W(15,"select",33),Ue("change",function(i){let s=mt(n).index,a=Le();return pt(a.onBoardSelect(s,i))}),W(16,"option",34),re(17,"Select Board"),V(),Gn(18,INe,2,2,"option",68,Mr),V()()(),W(20,"div",32)(21,"div",23)(22,"label"),re(23,"SECTION"),V(),W(24,"select",35),Ue("change",function(i){let s=mt(n).index,a=Le();return pt(a.onSectionSelect(s,i))}),W(25,"option",34),re(26," SELECT SECTION "),V(),Gn(27,ANe,2,2,"option",68,Mr),V()()(),W(29,"div",32)(30,"div",23)(31,"label"),re(32,"YARD / STATION FROM"),V(),W(33,"select",36)(34,"option",34),re(35," SELECT STATION "),V(),Gn(36,MNe,2,2,"option",68,Mr),V()()(),W(38,"div",32)(39,"div",23)(40,"label"),re(41,"YARD / STATION TO"),V(),W(42,"select",37)(43,"option",34),re(44," SELECT STATION "),V(),Gn(45,ONe,2,2,"option",68,Mr),V()()(),W(47,"div",32)(48,"div",23)(49,"label"),re(50,"DIRECTION"),V(),W(51,"select",38)(52,"option",34),re(53," SELECT DIRECTION "),V(),Gn(54,NNe,2,2,"option",68,Mr),V()()(),W(56,"div",32)(57,"div",23)(58,"label"),re(59,"AVAILABLE SLOT"),V(),W(60,"select",39)(61,"option",34),re(62," SELECT AVAILABLE SLOT "),V(),rn(63,PNe,2,0,"option",40),Gn(64,kNe,2,2,"option",68,Mr),V(),rn(66,FNe,3,0),V()(),W(67,"div",32)(68,"div",23)(69,"label"),re(70,"SERIES"),V(),at(71,"input",41),V()(),W(72,"div",32)(73,"div",23)(74,"label"),re(75,"WHETHER NI WORK/PNI WORK OR NON-NI WORK"),V(),W(76,"select",42)(77,"option",43),re(78," NON NI "),V(),W(79,"option",44),re(80,"PNI"),V(),W(81,"option",45),re(82,"NI"),V()()()(),W(83,"div",32)(84,"div",23)(85,"label"),re(86,"MACHINE TYPE"),V(),W(87,"select",46)(88,"option",34),re(89," SELECT MACHINE "),V(),Gn(90,LNe,2,2,"option",68,Mr),V()()(),W(92,"div",32)(93,"div",23)(94,"label"),re(95,"TYPE OF WORK"),V(),at(96,"input",47),V()(),W(97,"div",32)(98,"div",23)(99,"label"),re(100,"QUANTUM"),V(),at(101,"input",48),V()(),W(102,"div",32)(103,"div",23)(104,"label"),re(105,"DEPUTED SUPERVISOR"),V(),at(106,"input",49),V()(),W(107,"div",32)(108,"div",23)(109,"label"),re(110,"KILOMETER"),V(),at(111,"input",50),V()(),W(112,"div",32)(113,"div",23)(114,"label"),re(115,"RESOURCES"),V(),at(116,"input",51),V()(),W(117,"div",32)(118,"div",23)(119,"label"),re(120,"BLOCK DEMAND MINUTES"),V(),at(121,"input",52),V()(),W(122,"div",32)(123,"div",23)(124,"label"),re(125,"TPC STAFF "),V(),W(126,"select",53)(127,"option",54),re(128," SELECT TPC STAFF "),V(),W(129,"option",55),re(130,"Yes"),V(),W(131,"option",56),re(132,"No"),V()()()(),W(133,"div",32)(134,"div",23)(135,"label"),re(136,"LINE NO."),V(),at(137,"input",57),V()(),W(138,"div",32)(139,"div",23)(140,"label"),re(141,"S&T STAFF"),V(),W(142,"select",58)(143,"option",34),re(144," SELECT S&T STAFF "),V(),W(145,"option",55),re(146,"Yes"),V(),W(147,"option",56),re(148,"No"),V()()()(),W(149,"div",32)(150,"div",23)(151,"label"),re(152,"REPERCUSSION/REMARKS"),V(),at(153,"input",59),V()(),W(154,"div",31)(155,"div",60)(156,"div",23),at(157,"input",61),W(158,"label"),re(159,"Integrated Block"),V(),rn(160,VNe,11,1),V()(),W(161,"div",62)(162,"div",23),at(163,"input",63),W(164,"label"),re(165,"LOCO REQUIRED"),V(),rn(166,BNe,1,0,"input",64),V()(),W(167,"div",32)(168,"div",23),at(169,"input",65),W(170,"label"),re(171,"CREW REQUIRED"),V(),rn(172,UNe,1,0,"input",66),V()(),W(173,"div",32)(174,"div",23),at(175,"input",67),W(176,"label"),re(177,"CAUTION REQUIRED"),V(),rn(178,jNe,9,1),V()()()()()()()(),ta()}if(t&2){let n=e.index,r=Le();Te(3),Js("data-bs-target","#collapse"+n)("aria-controls","collapse"+n),Te(1),z0(" ",r.department.value,"-",n+1," "),Te(3),lt("id","collapse"+n),Te(2),lt("formGroupName",n),Te(9),zn(r.boardList),Te(9),zn(r.sectionList[n]),Te(9),zn(r.railDetails[n].stations),Te(9),zn(r.railDetails[n].stations),Te(9),zn(r.railDetails[n].directions),Te(9),lt("ngIf",r.domain==="machineNonRolls"||r.domain==="maintenancesNonRolls"),Te(1),zn(r.availableSlots[r.machineFormArray.controls[n].get("section").value+"_"+r.machineFormArray.controls[n].get("direction").value]),Te(2),rr(66,r.machineFormArray.controls[n].get("availableSlot").value==="Avl_slot_other"?66:-1),Te(24),zn(r.machineType),Te(70),rr(160,r.machineFormArray.controls[n].get("integratedCheckbox").value?160:-1),Te(6),rr(166,r.machineFormArray.controls[n].get("locoCheckbox").value?166:-1),Te(6),rr(172,r.machineFormArray.controls[n].get("crewCheckbox").value?172:-1),Te(6),rr(178,r.machineFormArray.controls[n].get("cautionCheckbox").value?178:-1)}}var mf=(()=>{let e=class e{get machineFormArray(){return this.form.controls.machineFormArray}get department(){return this.form.controls.department}constructor(r,i,o,s){this.fb=r,this.service=i,this.toastService=o,this.ls=s,this.domainData={machineRolls:"MACHINE ROLLS",maintenanceRolls:"MAINTENANCE ROLLS",machineNonRolls:"MACHINE NON ROLLS",maintenanceNonRolls:"MAINTENANCE NON ROLLS"},this.userData={},this.availableSlots={},this.cautions=[],this.integrates=[],this.stations=[],this.sectionList=[],this.railDetails=[],this.dataSet=[]}ngOnInit(){this.userData=this.ls.getUser(),this.form=this.fb.group({department:this.fb.control({value:this.userData.department==="OPERATING"?"CONSTRUCTION":this.userData.department,disabled:this.userData.department!=="OPERATING"},Cd.required),machineFormArray:this.fb.array([])}),Promise.resolve().then(()=>{this.service.getAllRailDetails("machines").subscribe(r=>{this.machineType=r})}),Promise.resolve().then(()=>{this.service.getAllRailDetails("boards").subscribe(r=>{this.boardList=r})})}onBoardSelect(r,i){this.service.getAllRailDetails("railDetails?board="+i.target.value).subscribe(o=>{this.dataSet=o,this.sectionList[r]=o.map(s=>s.section)})}onSectionSelect(r,i){let o=this.dataSet.filter(s=>s.section===i.target.value);this.railDetails[r]=o[0],console.log("\u{1F680} ~ this.railDetails:",this.railDetails,r)}onSubmit(){if(console.log("hello"),this.machineFormArray.value.length===0||!this.form.valid){this.toastService.showWarning("Please fill all details");return}let r=[];for(let[i,o]of this.machineFormArray.value.entries()){let s=[];if(o.availableSlot==="Avl_slot_other"){if(!new RegExp("\\b([0-3][0-9]/[0-1][1-2]/\\d{4}) ([0-2][0-9]:[0-2][0-9]) to ([0-2][0-9]:[0-2][0-9]) (\\b(?:MONDAY|TUESDAY|WEDNESDAY|THURSDAY|FRIDAY|SATURDAY|SUNDAY)\\b)\\b").test(o.avlSlotOther)){this.toastService.showDanger("AVAILABLE SLOT ARE INCORRECT FORMAT");return}s=o.avlSlotOther.split(" ")}else s=o.availableSlot.split(" ");(!o.crewCheckbox||o.crew==null)&&(o.crew=0),(!o.locoCheckbox||o.loco==null)&&(o.loco=0),o.caution=this.cautions[i],o.integrated=this.integrates[i];let a=ln.now(),l=ln.fromFormat(s[1],"HH:mm"),u=ln.fromFormat(s[3],"HH:mm").diff(l,"minutes").minutes;r.push(ft(Ee({},o),{avl_start:s[1],avl_end:s[3],date:s[0],department:this.department.value,avl_duration:u,createdAt:new Date().toISOString(),createdBy:this.userData.username,updatedAt:new Date().toISOString(),updatedBy:this.userData.username,logs:[]}))}this.service.addRailDetails(this.domain,r).subscribe(i=>{for(let o=this.machineFormArray.length-1;o>=0;o--)this.machineFormArray.removeAt(o);this.userData.department==="OPERATING"&&this.form.get("department")?.enable(),this.toastService.showSuccess("successfully submitted")})}onAddNewForm(){this.form.get("department")?.disable(),this.sectionList.push([]),this.railDetails.push({_id:"",board:"",section:"",mps:0,slots:[],directions:[],stations:[]});let r=this.fb.group({board:[""],section:[""],stationTo:[""],stationFrom:[""],direction:[""],lineNo:[null],machine:[""],series:[null],typeOfWork:[null],dmd_duration:[null],availableSlot:[""],avlSlotOther:[""],quantum:[null],deputedSupervisor:[null],resources:[null],km:[null],ni:["NON NI"],yard:[null],remarks:[null],approval:[""],s_tStaff:[""],tpcStaff:[""],crew:[null],crewCheckbox:[!1],loco:[null],cautionCheckbox:[!1],caution:[{length:"",speed:0}],locoCheckbox:[!1],cancelTrainCheckbox:[!1],integratedCheckbox:[!1],integrated:[{block:"",section:"",duration:0}]});this.cautions.push([{length:"",speed:0}]),this.integrates.push([{block:"",section:"",duration:0}]),this.machineFormArray.push(r),r.controls.section.valueChanges.subscribe(s=>{this.prepareAvailableSlots(s,""),r.controls.direction.setValue("")}),r.controls.direction.valueChanges.subscribe(s=>{this.prepareAvailableSlots(r.controls.section.value,s)})}addCaution(r){this.cautions[r].push({length:"",speed:0})}addIntegrated(r){this.integrates[r].push({block:"",section:"",duration:0})}deleteCaution(r,i){this.cautions[r]=this.cautions[r].filter((o,s)=>i!=s)}deleteIntegrated(r,i){this.integrates[r]=this.integrates[r].filter((o,s)=>i!=s)}onDelete(r){this.machineFormArray.removeAt(r),this.railDetails.splice(r,1),this.sectionList.splice(r,1),this.machineFormArray.length===0&&this.userData.department==="OPERATING"&&this.form.get("department")?.enable()}cautionLength(r,i,o){this.cautions[i][o].length=r.target.value}cautionSpeed(r,i,o){this.cautions[i][o].speed=r.target.value}integratedBlock(r,i,o){this.integrates[i][o].block=r.target.value}integratedSection(r,i,o){this.integrates[i][o].section=r.target.value}integratedDuration(r,i,o){this.integrates[i][o].duration=r.target.value}prepareAvailableSlots(r,i){if(!r||!i||i==""||this.availableSlots[r+"_"+i])return;let o={};for(let c of this.railDetails)if(c.section==r){o=c;break}if(Object.keys(o).length==0){this.toastService.showWarning("SLOTS are not Available");return}let s=o.slots[i],a=ln.now(),l=[];for(let c=0;c<365;c++){for(let u in s)if(+a.weekday==+u||+a.weekday==7&&+u==0)for(let d of s[u])l.push(a.toFormat("dd/MM/yyyy")+" "+d);a=a.plus({days:1})}this.availableSlots[r+"_"+i]=l,o={}}};e.\u0275fac=function(i){return new(i||e)(je(CK),je(ui),je(lo),je(Ni))},e.\u0275cmp=jt({type:e,selectors:[["app-add-machine-const"]],inputs:{domain:"domain"},standalone:!0,features:[qt],decls:17,vars:4,consts:[[1,"container"],["ngNativeValidate","",3,"formGroup","submit"],[1,"row","text-center"],[1,"col"],[1,"row","align-items-center"],[1,"col-auto","me-auto"],["class","form-group mt-3 mb-3","ngbPopover","Delete/Close all added form for enable","triggers","mouseenter:mouseleave","popoverTitle","DEPARTMENT"],[1,"col-auto"],[1,"btn","btn-primary","btn-lg","me-2",3,"click"],["type","submit",1,"btn","btn-success","btn-lg","me-2"],["id","accordionPanelsStayOpenExample","formArrayName","machineFormArray",1,"accordion"],[4,"ngFor","ngForOf"],["ngbPopover","Delete/Close all added form for enable","triggers","mouseenter:mouseleave","popoverTitle","DEPARTMENT",1,"form-group","mt-3","mb-3"],["formControlName","department","placement","end",1,"form-select"],["value","CONSTRUCTION"],["value","ENGINEERING"],["value","S&T"],["value","ELECTRIC"],["value","RE"],["value","RVNL"],["value","SIGNAL"],["value","Telecom"],["value","TRD"],[1,"form-group","mt-3","mb-3"],[1,"accordion-item","mb-2"],[1,"accordion-header","d-flex"],["type","button","data-bs-toggle","collapse","aria-expanded","true",1,"accordion-button"],[1,"btn","btn-outline-danger","ms-2",3,"click"],[1,"accordion-collapse","collapse","show",3,"id"],[1,"accordion-body"],[3,"formGroupName"],[1,"row"],[1,"col-sm-6","col-md-3"],["formControlName","board","required","",1,"form-select",3,"change"],["value","","selected","","disabled",""],["formControlName","section","required","",1,"form-select",3,"change"],["formControlName","stationFrom",1,"form-select"],["formControlName","stationTo",1,"form-select"],["formControlName","direction","required","",1,"form-select"],["formControlName","availableSlot","required","",1,"form-select"],["value","Avl_slot_other",4,"ngIf"],["type","text","placeholder","ENTER SERIES","formControlName","series",1,"form-control"],["formControlName","ni",1,"form-select"],["value","NON NI","selected",""],["value","PNI"],["value","NI"],["formControlName","machine",1,"form-select"],["type","text","placeholder","ENTER TYPE OF WORK","formControlName","typeOfWork",1,"form-control"],["type","text","placeholder","ENTER QUANTUM","formControlName","quantum",1,"form-control"],["type","text","placeholder","ENTER DEPUTED SUPERVISOR","formControlName","deputedSupervisor",1,"form-control"],["type","text","placeholder","ENTER KM","formControlName","km",1,"form-control"],["type","text","placeholder","ENTER RESOURCES","formControlName","resources",1,"form-control"],["type","number","placeholder","ENTER BLOCK DEMAND MINUTES","formControlName","dmd_duration","required","",1,"form-control"],["formControlName","tpcStaff",1,"form-select"],["value","","disabled","","selected",""],["value","Yes"],["value","No"],["type","text","placeholder","ENTER LINE NUMBER","formControlName","lineNo",1,"form-control"],["formControlName","s_tStaff",1,"form-select"],["type","text","placeholder","ENTER REPERCUSSION/Remarks","formControlName","remarks",1,"form-control"],[1,"col-sm-6","col-md-4"],["type","checkbox","formControlName","integratedCheckbox"],[1,"col-sm-6","col-md-2"],["type","checkbox","formControlName","locoCheckbox"],["type","number","class","form-control","placeholder","ENTER NUMBER OF LOCO REQUIRED","formControlName","loco","required",""],["type","checkbox","formControlName","crewCheckbox"],["type","number","class","form-control","placeholder","ENTER NUMBER OF CREW REQUIRED","formControlName","crew","required",""],["type","checkbox","formControlName","cautionCheckbox"],[3,"value"],["value","Avl_slot_other"],["type","text","placeholder","ENTER AVAILABLE SLOT","formControlName","avlSlotOther",1,"form-control"],[1,"slotFormat"],[1,"col-4"],[1,"col-3"],[1,"col-2"],["type","button",1,"btn","btn-outline-primary",3,"click"],["class","row text-center",4,"ngFor","ngForOf"],[1,"col-4","p-0","pe-1"],["type","text","placeholder","ENTER BLOCK OF INTEGRATED","name","block","required","",1,"form-control",3,"change"],[1,"col-3","p-0","pe-1"],["type","text","placeholder","ENTER SECTION OF INTEGRATED","name","section","required","",1,"form-control",3,"change"],["type","number","placeholder","ENTER DURATION OF INTEGRATED","name","duration","required","",1,"form-control",3,"change"],[1,"col-2","p-0"],["type","button",1,"btn","btn-outline-danger",3,"click"],["type","number","placeholder","ENTER NUMBER OF LOCO REQUIRED","formControlName","loco","required","",1,"form-control"],["type","number","placeholder","ENTER NUMBER OF CREW REQUIRED","formControlName","crew","required","",1,"form-control"],[1,"col-5"],["type","text","placeholder","ENTER LENGTH OF CAUTION","name","length","required","",1,"form-control",3,"change"],["type","number","placeholder","ENTER SPEED OF CAUTION","name","speed","required","",1,"form-control",3,"change"]],template:function(i,o){i&1&&(W(0,"div",0)(1,"form",1),Ue("submit",function(){return o.onSubmit()}),W(2,"div",2)(3,"div",3)(4,"h3"),re(5),V()()(),W(6,"div",4)(7,"div",5),rn(8,RNe,22,0,"div",6)(9,DNe,22,0),V(),W(10,"div",7)(11,"button",8),Ue("click",function(){return o.onAddNewForm()}),re(12," Add "),V(),W(13,"button",9),re(14," Submit "),V()()(),W(15,"div",10),rn(16,$Ne,179,12,"ng-container",11),V()()()),i&2&&(Te(1),lt("formGroup",o.form),Te(4),Ki("DEMAND FOR ",o.domainData[o.domain]," BLOCK"),Te(3),rr(8,o.userData.department==="OPERATING"?8:9),Te(8),lt("ngForOf",o.machineFormArray.controls))},dependencies:[Mo,NY,PY,ef,Qh,Jh,iu,HC,kC,su,ou,Xh,ip,Zh,rp,EI,xI,QK,ZK,lv],styles:[".slotFormat[_ngcontent-%COMP%]{color:red}"]});let t=e;return t})();var pZ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-add-machine-roll"]],standalone:!0,features:[qt],decls:1,vars:0,consts:[["domain","machineRolls"]],template:function(i,o){i&1&&at(0,"app-add-machine-const",0)},dependencies:[mf]});let t=e;return t})();var gZ=(()=>{let e=class e{constructor(r,i){this.router=r,this.ls=i}canActivate(r,i){return this.ls.getUser()?!0:(this.router.navigate(["/login"]),!1)}};e.\u0275fac=function(i){return new(i||e)(kt(Ds),kt(Ni))},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var GNe=()=>["dashboard"],zNe=()=>["users-details"];function YNe(t,e){t&1&&(W(0,"li",13)(1,"a",12),re(2," Dashboard "),V()(),W(3,"li",13)(4,"a",12),re(5," Users Details "),V()()),t&2&&(Te(1),lt("routerLink",Ei(2,GNe)),Te(3),lt("routerLink",Ei(3,zNe)))}var qNe=()=>["demand","machine-roll"],KNe=()=>["demand","maintenance-roll"],XNe=()=>["demand","machine-non-roll"],ZNe=()=>["demand","maintenance-non-roll"],QNe=()=>["demand","machine-upload-file"],JNe=()=>["verify-demand"],ePe=()=>["report"],tPe=()=>["edit","machineRolls"],nPe=()=>["edit","machineNonRolls"],rPe=()=>["edit","maintenanceRolls"],iPe=()=>["edit","maintenanceNonRolls"],vZ=(()=>{let e=class e{constructor(r,i){this.ls=r,this.router=i,this.userData={}}ngOnInit(){this.userData=this.ls.getUser()}onLogout(){this.ls.removeUser(),this.router.navigate(["/login"])}};e.\u0275fac=function(i){return new(i||e)(je(Ni),je(Ds))},e.\u0275cmp=jt({type:e,selectors:[["app-navbar"]],standalone:!0,features:[qt],decls:68,vars:29,consts:[[1,"navbar","navbar-expand-lg","bg-body-tertiary","sticky-top","shadow"],[1,"container-fluid"],["routerLink","./",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarNavDropdown","aria-controls","navbarNavDropdown","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarNavDropdown",1,"collapse","navbar-collapse","navStyle","justify-content-between","h-25"],[1,"navbar-nav"],[1,"nav-item","dropdown"],["role","button","data-bs-toggle","dropdown","aria-expanded","false",1,"nav-link","dropdown-toggle","active"],[1,"dropdown-menu"],["data-bs-toggle","collapse","data-bs-target","#navbarNavDropdown",1,"dropdown-item",3,"routerLink"],["data-bs-toggle","collapse","data-bs-target","#navbarNavDropdown",1,"dropdown-item"],["role","button",1,"nav-link","active",3,"routerLink"],[1,"nav-item"],["role","button",1,"nav-link","active"],[1,""],[1,"btn","btn-outline-dark","rounded","ms-5",3,"click"]],template:function(i,o){i&1&&(W(0,"nav",0)(1,"div",1)(2,"a",2),re(3,"LMG DIVISION"),V(),W(4,"button",3),at(5,"span",4),V(),W(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),re(10," Demand "),V(),W(11,"ul",9)(12,"li")(13,"a",10),re(14,"Machine(Roll)"),V()(),W(15,"li")(16,"a",10),re(17,"maintenance(Roll)"),V()(),W(18,"li")(19,"a",10),re(20,"Machine(Non-Roll)"),V()(),W(21,"li")(22,"a",10),re(23,"maintenance(Non-Roll)"),V()(),W(24,"li")(25,"a",10),re(26,"Machine(Upload File)"),V()(),W(27,"li")(28,"a",11),re(29,"maintenance(Upload File)"),V()()()(),W(30,"li")(31,"a",12),re(32," Verify Demand "),V()(),W(33,"li",13)(34,"a",12),re(35," Report "),V()(),W(36,"li",7)(37,"a",8),re(38," Edit "),V(),W(39,"ul",9)(40,"li")(41,"a",10),re(42,"Machine Roll"),V()(),W(43,"li")(44,"a",10),re(45,"Machine Non Roll"),V()(),W(46,"li")(47,"a",10),re(48,"Maintenance Roll"),V()(),W(49,"li")(50,"a",10),re(51,"Maintenance Non Roll"),V()()()(),W(52,"li")(53,"a",14),re(54," Analytics "),V()(),rn(55,YNe,6,4),V(),W(56,"div",15)(57,"label"),re(58,"Name: "),W(59,"b"),re(60),Ts(61,"uppercase"),V(),re(62," Department: "),W(63,"b"),re(64),Ts(65,"uppercase"),V()(),W(66,"button",16),Ue("click",function(){return o.onLogout()}),re(67," Sign Out "),V()()()()()),i&2&&(Te(13),lt("routerLink",Ei(18,qNe)),Te(3),lt("routerLink",Ei(19,KNe)),Te(3),lt("routerLink",Ei(20,XNe)),Te(3),lt("routerLink",Ei(21,ZNe)),Te(3),lt("routerLink",Ei(22,QNe)),Te(6),lt("routerLink",Ei(23,JNe)),Te(3),lt("routerLink",Ei(24,ePe)),Te(7),lt("routerLink",Ei(25,tPe)),Te(3),lt("routerLink",Ei(26,nPe)),Te(3),lt("routerLink",Ei(27,rPe)),Te(3),lt("routerLink",Ei(28,iPe)),Te(5),rr(55,o.userData.department==="OPERATING"?55:-1),Te(5),Hn(Rs(61,14,o.userData.username)),Te(4),Ki(" ",Rs(65,16,o.userData.department),""))},dependencies:[Mo,Vh,ov],styles:[".nav-item[_ngcontent-%COMP%]{margin:0 2rem}@media only screen and (max-width: 999px){.nav-item[_ngcontent-%COMP%]{margin:2px 0}}"]});let t=e;return t})();var wZ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-lmg"]],standalone:!0,features:[qt],decls:2,vars:0,template:function(i,o){i&1&&at(0,"app-navbar")(1,"router-outlet")},dependencies:[vZ,ep]});let t=e;return t})();var yZ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-machine-non-roll"]],standalone:!0,features:[qt],decls:1,vars:0,consts:[["domain","machineNonRolls"]],template:function(i,o){i&1&&at(0,"app-add-machine-const",0)},dependencies:[mf]});let t=e;return t})();var _Z=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-maintenance-roll"]],standalone:!0,features:[qt],decls:1,vars:0,consts:[["domain","maintenanceRolls"]],template:function(i,o){i&1&&at(0,"app-add-machine-const",0)},dependencies:[mf]});let t=e;return t})();var CZ=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-maintenance-non-roll"]],standalone:!0,features:[qt],decls:1,vars:0,consts:[["domain","maintenanceNonRolls"]],template:function(i,o){i&1&&at(0,"app-add-machine-const",0)},dependencies:[mf]});let t=e;return t})();var k1={};k1.version="0.18.5";var fu=1200,Vv=1252,oPe=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],PB={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},kB=function(t){oPe.indexOf(t)!=-1&&(Vv=PB[0]=t)};function sPe(){kB(1252)}var ac=function(t){fu=t,kB(t)};function FB(){ac(1200),sPe()}function SB(t){for(var e=[],n=0,r=t.length;n<r;++n)e[n]=t.charCodeAt(n);return e}function aPe(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n)+(t.charCodeAt(2*n+1)<<8));return e.join("")}function AQ(t){for(var e=[],n=0;n<t.length>>1;++n)e[n]=String.fromCharCode(t.charCodeAt(2*n+1)+(t.charCodeAt(2*n)<<8));return e.join("")}var x1=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1);return e==255&&n==254?aPe(t.slice(2)):e==254&&n==255?AQ(t.slice(2)):e==65279?t.slice(1):t},iA=function(e){return String.fromCharCode(e)},SZ=function(e){return String.fromCharCode(e)},ur;var mi=null,S1=!0,gf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function F1(t){for(var e="",n=0,r=0,i=0,o=0,s=0,a=0,l=0,c=0;c<t.length;)n=t.charCodeAt(c++),o=n>>2,r=t.charCodeAt(c++),s=(n&3)<<4|r>>4,i=t.charCodeAt(c++),a=(r&15)<<2|i>>6,l=i&63,isNaN(r)?a=l=64:isNaN(i)&&(l=64),e+=gf.charAt(o)+gf.charAt(s)+gf.charAt(a)+gf.charAt(l);return e}function Da(t){var e="",n=0,r=0,i=0,o=0,s=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)o=gf.indexOf(t.charAt(c++)),s=gf.indexOf(t.charAt(c++)),n=o<<2|s>>4,e+=String.fromCharCode(n),a=gf.indexOf(t.charAt(c++)),r=(s&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(r)),l=gf.indexOf(t.charAt(c++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var In=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),kd=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function wf(t){return In?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function EZ(t){return In?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ta=function(e){return In?kd(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function DA(t){if(typeof ArrayBuffer>"u")return Ta(t);for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r!=t.length;++r)n[r]=t.charCodeAt(r)&255;return e}function Sf(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function lPe(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function LB(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return LB(new Uint8Array(t));for(var e=new Array(t.length),n=0;n<t.length;++n)e[n]=t[n];return e}var po=In?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:kd(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),i=0;for(e=0,n=0;e<t.length;n+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function cPe(t){for(var e=[],n=0,r=t.length+250,i=wf(t.length+255),o=0;o<t.length;++o){var s=t.charCodeAt(o);if(s<128)i[n++]=s;else if(s<2048)i[n++]=192|s>>6&31,i[n++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var a=t.charCodeAt(++o)&1023;i[n++]=240|s>>8&7,i[n++]=128|s>>2&63,i[n++]=128|a>>6&15|(s&3)<<4,i[n++]=128|a&63}else i[n++]=224|s>>12&15,i[n++]=128|s>>6&63,i[n++]=128|s&63;n>r&&(e.push(i.slice(0,n)),n=0,i=wf(65535),r=65530)}return e.push(i.slice(0,n)),po(e)}var os=/\u0000/g,b1=/[\u0001-\u0006]/g;function kv(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function lc(t,e){var n=""+t;return n.length>=e?n:hi("0",e-n.length)+n}function HB(t,e){var n=""+t;return n.length>=e?n:hi(" ",e-n.length)+n}function pA(t,e){var n=""+t;return n.length>=e?n:n+hi(" ",e-n.length)}function uPe(t,e){var n=""+Math.round(t);return n.length>=e?n:hi("0",e-n.length)+n}function dPe(t,e){var n=""+t;return n.length>=e?n:hi("0",e-n.length)+n}var xZ=Math.pow(2,32);function Iv(t,e){if(t>xZ||t<-xZ)return uPe(t,e);var n=Math.round(t);return dPe(n,e)}function gA(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var bZ=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],lB=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function hPe(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var Kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},TZ={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fPe={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vA(t,e,n){for(var r=t<0?-1:1,i=t*r,o=0,s=1,a=0,l=1,c=0,u=0,d=Math.floor(i);c<e&&(d=Math.floor(i),a=d*s+o,u=d*c+l,!(i-d<5e-8));)i=1/(i-d),o=s,s=a,l=c,c=u;if(u>e&&(c>e?(u=l,a=o):(u=c,a=s)),!n)return[0,r*a,u];var h=Math.floor(r*a/u);return[h,r*a-h*u,u]}function Cp(t,e,n){if(t>2958465||t<0)return null;var r=t|0,i=Math.floor(86400*(t-r)),o=0,s=[],a={D:r,T:i,u:86400*(t-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)s=n?[1317,10,29]:[1900,2,29],o=3;else if(r===0)s=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),r<60&&(o=(o+6)%7),n&&(o=yPe(l,s))}return a.y=s[0],a.m=s[1],a.d=s[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=o,a}var MQ=new Date(1899,11,31,0,0,0),mPe=MQ.getTime(),pPe=new Date(1900,2,1,0,0,0);function OQ(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=pPe&&(n+=24*60*60*1e3),(n-(mPe+(t.getTimezoneOffset()-MQ.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function VB(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gPe(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function vPe(t){var e=t<0?12:11,n=VB(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function wPe(t){var e=VB(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function L1(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=vPe(t):e===10?n=t.toFixed(10).substr(0,12):n=wPe(t),VB(gPe(n.toUpperCase()))}function Tp(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):L1(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return hl(14,OQ(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function yPe(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function _Pe(t,e,n,r){var i="",o=0,s=0,a=n.y,l,c=0;switch(t){case 98:a=n.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=n.m,c=e.length;break;case 3:return lB[n.m-1][1];case 5:return lB[n.m-1][0];default:return lB[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=n.d,c=e.length;break;case 3:return bZ[n.q][0];default:return bZ[n.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(n.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=n.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=n.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?lc(n.S,e.length):(r>=2?s=r===3?1e3:100:s=r===1?10:1,o=Math.round(s*(n.S+n.u)),o>=60*s&&(o=0),e==="s"?o===0?"0":""+o/s:(i=lc(o,2+r),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?lc(l,c):"";return u}function vf(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var NQ=/%/g;function CPe(t,e,n){var r=e.replace(NQ,""),i=e.length-r.length;return Md(t,r,n*Math.pow(10,2*i))+hi("%",i)}function SPe(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Md(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function PQ(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+PQ(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),n=(e/Math.pow(10,o)).toPrecision(r+1+(i+o)%i),n.indexOf("e")===-1){var s=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+o):n+="E+"+(s-o);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+o)%i)+"."+u.substr(o)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var kQ=/# (\?+)( ?)\/( ?)(\d+)/;function EPe(t,e,n){var r=parseInt(t[4],10),i=Math.round(e*r),o=Math.floor(i/r),s=i-o*r,a=r;return n+(o===0?"":""+o)+" "+(s===0?hi(" ",t[1].length+1+t[4].length):HB(s,t[1].length)+t[2]+"/"+t[3]+lc(a,t[4].length))}function xPe(t,e,n){return n+(e===0?"":""+e)+hi(" ",t[1].length+2+t[4].length)}var FQ=/^#*0*\.([0#]+)/,LQ=/\).*[0#]/,HQ=/\(###\) ###\\?-####/;function Os(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function RZ(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function DZ(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function bPe(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function TPe(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function sl(t,e,n){if(t.charCodeAt(0)===40&&!e.match(LQ)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?sl("n",r,n):"("+sl("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return SPe(t,e,n);if(e.indexOf("%")!==-1)return CPe(t,e,n);if(e.indexOf("E")!==-1)return PQ(e,n);if(e.charCodeAt(0)===36)return"$"+sl(t,e.substr(e.charAt(1)==" "?2:1),n);var i,o,s,a,l=Math.abs(n),c=n<0?"-":"";if(e.match(/^00+$/))return c+Iv(l,e.length);if(e.match(/^[#?]+$/))return i=Iv(n,0),i==="0"&&(i=""),i.length>e.length?i:Os(e.substr(0,e.length-i.length))+i;if(o=e.match(kQ))return EPe(o,l,c);if(e.match(/^#+0+$/))return c+Iv(l,e.length-e.indexOf("0"));if(o=e.match(FQ))return i=RZ(n,o[1].length).replace(/^([^\.]+)$/,"$1."+Os(o[1])).replace(/\.$/,"."+Os(o[1])).replace(/\.(\d*)$/,function(p,g){return"."+g+hi("0",Os(o[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return c+RZ(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return c+vf(Iv(l,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+sl(t,e,-n):vf(""+(Math.floor(n)+bPe(n,o[1].length)))+"."+lc(DZ(n,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return sl(t,e.replace(/^#,#*,/,""),n);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=kv(sl(t,e.replace(/[\\-]/g,""),n)),s=0,kv(kv(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return s<i.length?i.charAt(s++):p==="0"?"0":""}));if(e.match(HQ))return i=sl(t,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=vA(l,Math.pow(10,s)-1,!1),i=""+c,u=Md("n",o[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],u=pA(a[2],s),u.length<o[4].length&&(u=Os(o[4].substr(o[4].length-u.length))+u),i+=u,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),a=vA(l,Math.pow(10,s)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?HB(a[1],s)+o[2]+"/"+o[3]+pA(a[2],s):hi(" ",2*s+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=Iv(n,0),e.length<=i.length?i:Os(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var d=e.indexOf(".")-s,h=e.length-i.length-d;return Os(e.substr(0,d)+i+e.substr(e.length-h))}if(o=e.match(/^00,000\.([#0]*0)$/))return s=DZ(n,o[1].length),n<0?"-"+sl(t,e,-n):vf(TPe(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?lc(0,3-p.length):"")+p})+"."+lc(s,o[1].length);switch(e){case"###,##0.00":return sl(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var f=vf(Iv(l,0));return f!=="0"?c+f:"";case"###,###.00":return sl(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return sl(t,"#,##0.00",n).replace(/^0\./,".");default:}throw new Error("unsupported format |"+e+"|")}function RPe(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Md(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function DPe(t,e,n){var r=e.replace(NQ,""),i=e.length-r.length;return Md(t,r,n*Math.pow(10,2*i))+hi("%",i)}function VQ(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+VQ(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),n=(e/Math.pow(10,o)).toPrecision(r+1+(i+o)%i),!n.match(/[Ee]/)){var s=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+o):n+="E+"+(s-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+o)%i)+"."+u.substr(o)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function uu(t,e,n){if(t.charCodeAt(0)===40&&!e.match(LQ)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?uu("n",r,n):"("+uu("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return RPe(t,e,n);if(e.indexOf("%")!==-1)return DPe(t,e,n);if(e.indexOf("E")!==-1)return VQ(e,n);if(e.charCodeAt(0)===36)return"$"+uu(t,e.substr(e.charAt(1)==" "?2:1),n);var i,o,s,a,l=Math.abs(n),c=n<0?"-":"";if(e.match(/^00+$/))return c+lc(l,e.length);if(e.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>e.length?i:Os(e.substr(0,e.length-i.length))+i;if(o=e.match(kQ))return xPe(o,l,c);if(e.match(/^#+0+$/))return c+lc(l,e.length-e.indexOf("0"));if(o=e.match(FQ))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Os(o[1])).replace(/\.$/,"."+Os(o[1])),i=i.replace(/\.(\d*)$/,function(p,g){return"."+g+hi("0",Os(o[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return c+vf(""+l);if(o=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+uu(t,e,-n):vf(""+n)+"."+hi("0",o[1].length);if(o=e.match(/^#,#*,#0/))return uu(t,e.replace(/^#,#*,/,""),n);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=kv(uu(t,e.replace(/[\\-]/g,""),n)),s=0,kv(kv(e.replace(/\\/g,"")).replace(/[0#]/g,function(p){return s<i.length?i.charAt(s++):p==="0"?"0":""}));if(e.match(HQ))return i=uu(t,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=vA(l,Math.pow(10,s)-1,!1),i=""+c,u=Md("n",o[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],u=pA(a[2],s),u.length<o[4].length&&(u=Os(o[4].substr(o[4].length-u.length))+u),i+=u,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),a=vA(l,Math.pow(10,s)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?HB(a[1],s)+o[2]+"/"+o[3]+pA(a[2],s):hi(" ",2*s+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=""+n,e.length<=i.length?i:Os(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var d=e.indexOf(".")-s,h=e.length-i.length-d;return Os(e.substr(0,d)+i+e.substr(e.length-h))}if(o=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+uu(t,e,-n):vf(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?lc(0,3-p.length):"")+p})+"."+lc(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=vf(""+l);return f!=="0"?c+f:"";default:if(e.match(/\.[0#?]*$/))return uu(t,e.slice(0,e.lastIndexOf(".")),n)+Os(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Md(t,e,n){return(n|0)===n?uu(t,e,n):sl(t,e,n)}function IPe(t){for(var e=[],n=!1,r=0,i=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(i,r-i),i=r+1}if(e[e.length]=t.substr(i),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var BQ=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function jv(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":gA(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(BQ))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function APe(t,e,n,r){for(var i=[],o="",s=0,a="",l="t",c,u,d,h="H";s<t.length;)switch(a=t.charAt(s)){case"G":if(!gA(t,s))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";(d=t.charCodeAt(++s))!==34&&s<t.length;)o+=String.fromCharCode(d);i[i.length]={t:"t",v:o},++s;break;case"\\":var f=t.charAt(++s),p=f==="("||f===")"?f:"t";i[i.length]={t:p,v:f},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:e},++s;break;case"B":case"b":if(t.charAt(s+1)==="1"||t.charAt(s+1)==="2"){if(c==null&&(c=Cp(e,n,t.charAt(s+1)==="2"),c==null))return"";i[i.length]={t:"X",v:t.substr(s,2)},l=a,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Cp(e,n),c==null))return"";for(o=a;++s<t.length&&t.charAt(s).toLowerCase()===a;)o+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=h),i[i.length]={t:a,v:o},l=a;break;case"A":case"a":case"\u4E0A":var g={t:a,v:a};if(c==null&&(c=Cp(e,n)),t.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",h="h",s+=3):t.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",s+=5,h="h"):t.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(c!=null&&(g.v=c.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),g.t="T",s+=5,h="h"):(g.t="t",++s),c==null&&g.t==="T")return"";i[i.length]=g,l=a;break;case"[":for(o=a;t.charAt(s++)!=="]"&&s<t.length;)o+=t.charAt(s);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(BQ)){if(c==null&&(c=Cp(e,n),c==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},l=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",jv(t)||(i[i.length]={t:"t",v:o}));break;case".":if(c!=null){for(o=a;++s<t.length&&(a=t.charAt(s))==="0";)o+=a;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=a;++s<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(s))>-1;)o+=a;i[i.length]={t:"n",v:o};break;case"?":for(o=a;t.charAt(++s)===a;)o+=a;i[i.length]={t:a,v:o},l=a;break;case"*":++s,(t.charAt(s)==" "||t.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=a;s<t.length&&"0123456789".indexOf(t.charAt(++s))>-1;)o+=t.charAt(s);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:a,v:a},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++s;break}var w=0,_=0,S;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=h,l="h",w<1&&(w=1);break;case"s":(S=i[s].v.match(/\.0+$/))&&(_=Math.max(_,S[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[s].v.match(/[Hh]/)&&(w=1),w<2&&i[s].v.match(/[Mm]/)&&(w=2),w<3&&i[s].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",P;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=_Pe(i[s].t.charCodeAt(0),i[s].v,c,_),i[s].t="t";break;case"n":case"?":for(P=s+1;i[P]!=null&&((a=i[P].t)==="?"||a==="D"||(a===" "||a==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[s].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[s].v+=i[P].v,i[P]={v:"",t:";"},++P;x+=i[s].v,s=P-1;break;case"G":i[s].t="t",i[s].v=Tp(e,n);break}var k="",b,C;if(x.length>0){x.charCodeAt(0)==40?(b=e<0&&x.charCodeAt(0)===45?-e:e,C=Md("n",x,b)):(b=e<0&&r>1?-e:e,C=Md("n",x,b),b<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),P=C.length-1;var N=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){N=s;break}var B=i.length;if(N===i.length&&C.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(P>=i[s].v.length-1?(P-=i[s].v.length,i[s].v=C.substr(P+1,i[s].v.length)):P<0?i[s].v="":(i[s].v=C.substr(0,P+1),P=-1),i[s].t="t",B=s);P>=0&&B<i.length&&(i[B].v=C.substr(0,P+1)+i[B].v)}else if(N!==i.length&&C.indexOf("E")===-1){for(P=C.indexOf(".")-1,s=N;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(u=i[s].v.indexOf(".")>-1&&s===N?i[s].v.indexOf(".")-1:i[s].v.length-1,k=i[s].v.substr(u+1);u>=0;--u)P>=0&&(i[s].v.charAt(u)==="0"||i[s].v.charAt(u)==="#")&&(k=C.charAt(P--)+k);i[s].v=k,i[s].t="t",B=s}for(P>=0&&B<i.length&&(i[B].v=C.substr(0,P+1)+i[B].v),P=C.indexOf(".")+1,s=N;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==N)){for(u=i[s].v.indexOf(".")>-1&&s===N?i[s].v.indexOf(".")+1:0,k=i[s].v.substr(0,u);u<i[s].v.length;++u)P<C.length&&(k+=C.charAt(P++));i[s].v=k,i[s].t="t",B=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(b=r>1&&e<0&&s>0&&i[s-1].v==="-"?-e:e,i[s].v=Md(i[s].t,i[s].v,b),i[s].t="t");var Y="";for(s=0;s!==i.length;++s)i[s]!=null&&(Y+=i[s].v);return Y}var IZ=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function AZ(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function MPe(t,e){var n=IPe(t),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break;case 4:break}var o=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,o];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var s=n[0].match(IZ),a=n[1].match(IZ);return AZ(e,s)?[r,n[0]]:AZ(e,a)?[r,n[1]]:[r,n[s!=null&&a!=null?2:1]]}return[r,o]}function hl(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:Kt)[t],r==null&&(r=n.table&&n.table[TZ[t]]||Kt[TZ[t]]),r==null&&(r=fPe[t]||"General");break}if(gA(r,0))return Tp(e,n);e instanceof Date&&(e=OQ(e,n.date1904));var i=MPe(r,e);if(gA(i[1]))return Tp(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return APe(i[1],e,n,i[0])}function Od(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(Kt[n]==null){e<0&&(e=n);continue}if(Kt[n]==t){e=n;break}}e<0&&(e=391)}return Kt[e]=t,e}function IA(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Od(t[e],e)}function $v(){Kt=hPe()}var OPe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},UQ=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function NPe(t){var e=typeof t=="number"?Kt[t]:t;return e=e.replace(UQ,"(\\d+)"),new RegExp("^"+e+"$")}function PPe(t,e,n){var r=-1,i=-1,o=-1,s=-1,a=-1,l=-1;(e.match(UQ)||[]).forEach(function(d,h){var f=parseInt(n[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":r=f;break;case"d":o=f;break;case"h":s=f;break;case"s":l=f;break;case"m":s>=0?a=f:i=f;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&a==-1&&l==-1?c:r==-1&&i==-1&&o==-1?u:c+"T"+u}var kPe=function(){var t={};t.version="1.2.0";function e(){for(var C=0,N=new Array(256),B=0;B!=256;++B)C=B,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,N[B]=C;return typeof Int32Array<"u"?new Int32Array(N):N}var n=e();function r(C){var N=0,B=0,Y=0,ee=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Y=0;Y!=256;++Y)ee[Y]=C[Y];for(Y=0;Y!=256;++Y)for(B=C[Y],N=256+Y;N<4096;N+=256)B=ee[N]=B>>>8^C[B&255];var te=[];for(Y=1;Y!=16;++Y)te[Y-1]=typeof Int32Array<"u"?ee.subarray(Y*256,Y*256+256):ee.slice(Y*256,Y*256+256);return te}var i=r(n),o=i[0],s=i[1],a=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],f=i[8],p=i[9],g=i[10],w=i[11],_=i[12],S=i[13],x=i[14];function P(C,N){for(var B=N^-1,Y=0,ee=C.length;Y<ee;)B=B>>>8^n[(B^C.charCodeAt(Y++))&255];return~B}function k(C,N){for(var B=N^-1,Y=C.length-15,ee=0;ee<Y;)B=x[C[ee++]^B&255]^S[C[ee++]^B>>8&255]^_[C[ee++]^B>>16&255]^w[C[ee++]^B>>>24]^g[C[ee++]]^p[C[ee++]]^f[C[ee++]]^h[C[ee++]]^d[C[ee++]]^u[C[ee++]]^c[C[ee++]]^l[C[ee++]]^a[C[ee++]]^s[C[ee++]]^o[C[ee++]]^n[C[ee++]];for(Y+=15;ee<Y;)B=B>>>8^n[(B^C[ee++])&255];return~B}function b(C,N){for(var B=N^-1,Y=0,ee=C.length,te=0,Ce=0;Y<ee;)te=C.charCodeAt(Y++),te<128?B=B>>>8^n[(B^te)&255]:te<2048?(B=B>>>8^n[(B^(192|te>>6&31))&255],B=B>>>8^n[(B^(128|te&63))&255]):te>=55296&&te<57344?(te=(te&1023)+64,Ce=C.charCodeAt(Y++)&1023,B=B>>>8^n[(B^(240|te>>8&7))&255],B=B>>>8^n[(B^(128|te>>2&63))&255],B=B>>>8^n[(B^(128|Ce>>6&15|(te&3)<<4))&255],B=B>>>8^n[(B^(128|Ce&63))&255]):(B=B>>>8^n[(B^(224|te>>12&15))&255],B=B>>>8^n[(B^(128|te>>6&63))&255],B=B>>>8^n[(B^(128|te&63))&255]);return~B}return t.table=n,t.bstr=P,t.buf=k,t.str=b,t}(),Vt=function(){var e={};e.version="1.2.1";function n(H,se){for(var X=H.split("/"),K=se.split("/"),ae=0,le=0,be=Math.min(X.length,K.length);ae<be;++ae){if(le=X[ae].length-K[ae].length)return le;if(X[ae]!=K[ae])return X[ae]<K[ae]?-1:1}return X.length-K.length}function r(H){if(H.charAt(H.length-1)=="/")return H.slice(0,-1).indexOf("/")===-1?H:r(H.slice(0,-1));var se=H.lastIndexOf("/");return se===-1?H:H.slice(0,se+1)}function i(H){if(H.charAt(H.length-1)=="/")return i(H.slice(0,-1));var se=H.lastIndexOf("/");return se===-1?H:H.slice(se+1)}function o(H,se){typeof se=="string"&&(se=new Date(se));var X=se.getHours();X=X<<6|se.getMinutes(),X=X<<5|se.getSeconds()>>>1,H.write_shift(2,X);var K=se.getFullYear()-1980;K=K<<4|se.getMonth()+1,K=K<<5|se.getDate(),H.write_shift(2,K)}function s(H){var se=H.read_shift(2)&65535,X=H.read_shift(2)&65535,K=new Date,ae=X&31;X>>>=5;var le=X&15;X>>>=4,K.setMilliseconds(0),K.setFullYear(X+1980),K.setMonth(le-1),K.setDate(ae);var be=se&31;se>>>=5;var Ae=se&63;return se>>>=6,K.setHours(se),K.setMinutes(Ae),K.setSeconds(be<<1),K}function a(H){Ho(H,0);for(var se={},X=0;H.l<=H.length-4;){var K=H.read_shift(2),ae=H.read_shift(2),le=H.l+ae,be={};switch(K){case 21589:X=H.read_shift(1),X&1&&(be.mtime=H.read_shift(4)),ae>5&&(X&2&&(be.atime=H.read_shift(4)),X&4&&(be.ctime=H.read_shift(4))),be.mtime&&(be.mt=new Date(be.mtime*1e3));break}H.l=le,se[K]=be}return se}var l;function c(){return l||(l={})}function u(H,se){if(H[0]==80&&H[1]==75)return kl(H,se);if((H[0]|32)==109&&(H[1]|32)==105)return Ku(H,se);if(H.length<512)throw new Error("CFB file size "+H.length+" < 512");var X=3,K=512,ae=0,le=0,be=0,Ae=0,Ie=0,xe=[],Oe=H.slice(0,512);Ho(Oe,0);var Be=d(Oe);switch(X=Be[0],X){case 3:K=512;break;case 4:K=4096;break;case 0:if(Be[1]==0)return kl(H,se);default:throw new Error("Major Version: Expected 3 or 4 saw "+X)}K!==512&&(Oe=H.slice(0,K),Ho(Oe,28));var tt=H.slice(0,K);h(Oe,X);var it=Oe.read_shift(4,"i");if(X===3&&it!==0)throw new Error("# Directory Sectors: Expected 0 saw "+it);Oe.l+=4,be=Oe.read_shift(4,"i"),Oe.l+=4,Oe.chk("00100000","Mini Stream Cutoff Size: "),Ae=Oe.read_shift(4,"i"),ae=Oe.read_shift(4,"i"),Ie=Oe.read_shift(4,"i"),le=Oe.read_shift(4,"i");for(var nt=-1,ut=0;ut<109&&(nt=Oe.read_shift(4,"i"),!(nt<0));++ut)xe[ut]=nt;var Yt=f(H,K);w(Ie,le,Yt,K,xe);var er=S(Yt,be,xe,K);er[be].name="!Directory",ae>0&&Ae!==Ce&&(er[Ae].name="!MiniFAT"),er[xe[0]].name="!FAT",er.fat_addrs=xe,er.ssz=K;var qr={},sr=[],$i=[],Ll=[];x(be,er,Yt,sr,ae,qr,$i,Ae),p($i,Ll,sr),sr.shift();var Ys={FileIndex:$i,FullPaths:Ll};return se&&se.raw&&(Ys.raw={header:tt,sectors:Yt}),Ys}function d(H){if(H[H.l]==80&&H[H.l+1]==75)return[0,0];H.chk(Re,"Header Signature: "),H.l+=16;var se=H.read_shift(2,"u");return[H.read_shift(2,"u"),se]}function h(H,se){var X=9;switch(H.l+=2,X=H.read_shift(2)){case 9:if(se!=3)throw new Error("Sector Shift: Expected 9 saw "+X);break;case 12:if(se!=4)throw new Error("Sector Shift: Expected 12 saw "+X);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+X)}H.chk("0600","Mini Sector Shift: "),H.chk("000000000000","Reserved: ")}function f(H,se){for(var X=Math.ceil(H.length/se)-1,K=[],ae=1;ae<X;++ae)K[ae-1]=H.slice(ae*se,(ae+1)*se);return K[X-1]=H.slice(X*se),K}function p(H,se,X){for(var K=0,ae=0,le=0,be=0,Ae=0,Ie=X.length,xe=[],Oe=[];K<Ie;++K)xe[K]=Oe[K]=K,se[K]=X[K];for(;Ae<Oe.length;++Ae)K=Oe[Ae],ae=H[K].L,le=H[K].R,be=H[K].C,xe[K]===K&&(ae!==-1&&xe[ae]!==ae&&(xe[K]=xe[ae]),le!==-1&&xe[le]!==le&&(xe[K]=xe[le])),be!==-1&&(xe[be]=K),ae!==-1&&K!=xe[K]&&(xe[ae]=xe[K],Oe.lastIndexOf(ae)<Ae&&Oe.push(ae)),le!==-1&&K!=xe[K]&&(xe[le]=xe[K],Oe.lastIndexOf(le)<Ae&&Oe.push(le));for(K=1;K<Ie;++K)xe[K]===K&&(le!==-1&&xe[le]!==le?xe[K]=xe[le]:ae!==-1&&xe[ae]!==ae&&(xe[K]=xe[ae]));for(K=1;K<Ie;++K)if(H[K].type!==0){if(Ae=K,Ae!=xe[Ae])do Ae=xe[Ae],se[K]=se[Ae]+"/"+se[K];while(Ae!==0&&xe[Ae]!==-1&&Ae!=xe[Ae]);xe[K]=-1}for(se[0]+="/",K=1;K<Ie;++K)H[K].type!==2&&(se[K]+="/")}function g(H,se,X){for(var K=H.start,ae=H.size,le=[],be=K;X&&ae>0&&be>=0;)le.push(se.slice(be*te,be*te+te)),ae-=te,be=_p(X,be*4);return le.length===0?He(0):po(le).slice(0,H.size)}function w(H,se,X,K,ae){var le=Ce;if(H===Ce){if(se!==0)throw new Error("DIFAT chain shorter than expected")}else if(H!==-1){var be=X[H],Ae=(K>>>2)-1;if(!be)return;for(var Ie=0;Ie<Ae&&(le=_p(be,Ie*4))!==Ce;++Ie)ae.push(le);w(_p(be,K-4),se-1,X,K,ae)}}function _(H,se,X,K,ae){var le=[],be=[];ae||(ae=[]);var Ae=K-1,Ie=0,xe=0;for(Ie=se;Ie>=0;){ae[Ie]=!0,le[le.length]=Ie,be.push(H[Ie]);var Oe=X[Math.floor(Ie*4/K)];if(xe=Ie*4&Ae,K<4+xe)throw new Error("FAT boundary crossed: "+Ie+" 4 "+K);if(!H[Oe])break;Ie=_p(H[Oe],xe)}return{nodes:le,data:WZ([be])}}function S(H,se,X,K){var ae=H.length,le=[],be=[],Ae=[],Ie=[],xe=K-1,Oe=0,Be=0,tt=0,it=0;for(Oe=0;Oe<ae;++Oe)if(Ae=[],tt=Oe+se,tt>=ae&&(tt-=ae),!be[tt]){Ie=[];var nt=[];for(Be=tt;Be>=0;){nt[Be]=!0,be[Be]=!0,Ae[Ae.length]=Be,Ie.push(H[Be]);var ut=X[Math.floor(Be*4/K)];if(it=Be*4&xe,K<4+it)throw new Error("FAT boundary crossed: "+Be+" 4 "+K);if(!H[ut]||(Be=_p(H[ut],it),nt[Be]))break}le[tt]={nodes:Ae,data:WZ([Ie])}}return le}function x(H,se,X,K,ae,le,be,Ae){for(var Ie=0,xe=K.length?2:0,Oe=se[H].data,Be=0,tt=0,it;Be<Oe.length;Be+=128){var nt=Oe.slice(Be,Be+128);Ho(nt,64),tt=nt.read_shift(2),it=NA(nt,0,tt-xe),K.push(it);var ut={name:it,type:nt.read_shift(1),color:nt.read_shift(1),L:nt.read_shift(4,"i"),R:nt.read_shift(4,"i"),C:nt.read_shift(4,"i"),clsid:nt.read_shift(16),state:nt.read_shift(4,"i"),start:0,size:0},Yt=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);Yt!==0&&(ut.ct=P(nt,nt.l-8));var er=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);er!==0&&(ut.mt=P(nt,nt.l-8)),ut.start=nt.read_shift(4,"i"),ut.size=nt.read_shift(4,"i"),ut.size<0&&ut.start<0&&(ut.size=ut.type=0,ut.start=Ce,ut.name=""),ut.type===5?(Ie=ut.start,ae>0&&Ie!==Ce&&(se[Ie].name="!StreamData")):ut.size>=4096?(ut.storage="fat",se[ut.start]===void 0&&(se[ut.start]=_(X,ut.start,se.fat_addrs,se.ssz)),se[ut.start].name=ut.name,ut.content=se[ut.start].data.slice(0,ut.size)):(ut.storage="minifat",ut.size<0?ut.size=0:Ie!==Ce&&ut.start!==Ce&&se[Ie]&&(ut.content=g(ut,se[Ie].data,(se[Ae]||{}).data))),ut.content&&Ho(ut.content,0),le[it]=ut,be.push(ut)}}function P(H,se){return new Date((mo(H,se+4)/1e7*Math.pow(2,32)+mo(H,se)/1e7-11644473600)*1e3)}function k(H,se){return c(),u(l.readFileSync(H),se)}function b(H,se){var X=se&&se.type;switch(X||In&&Buffer.isBuffer(H)&&(X="buffer"),X||"base64"){case"file":return k(H,se);case"base64":return u(Ta(Da(H)),se);case"binary":return u(Ta(H),se)}return u(H,se)}function C(H,se){var X=se||{},K=X.root||"Root Entry";if(H.FullPaths||(H.FullPaths=[]),H.FileIndex||(H.FileIndex=[]),H.FullPaths.length!==H.FileIndex.length)throw new Error("inconsistent CFB structure");H.FullPaths.length===0&&(H.FullPaths[0]=K+"/",H.FileIndex[0]={name:K,type:5}),X.CLSID&&(H.FileIndex[0].clsid=X.CLSID),N(H)}function N(H){var se="Sh33tJ5";if(!Vt.find(H,"/"+se)){var X=He(4);X[0]=55,X[1]=X[3]=50,X[2]=54,H.FileIndex.push({name:se,type:2,content:X,size:4,L:69,R:69,C:69}),H.FullPaths.push(H.FullPaths[0]+se),B(H)}}function B(H,se){C(H);for(var X=!1,K=!1,ae=H.FullPaths.length-1;ae>=0;--ae){var le=H.FileIndex[ae];switch(le.type){case 0:K?X=!0:(H.FileIndex.pop(),H.FullPaths.pop());break;case 1:case 2:case 5:K=!0,isNaN(le.R*le.L*le.C)&&(X=!0),le.R>-1&&le.L>-1&&le.R==le.L&&(X=!0);break;default:X=!0;break}}if(!(!X&&!se)){var be=new Date(1987,1,19),Ae=0,Ie=Object.create?Object.create(null):{},xe=[];for(ae=0;ae<H.FullPaths.length;++ae)Ie[H.FullPaths[ae]]=!0,H.FileIndex[ae].type!==0&&xe.push([H.FullPaths[ae],H.FileIndex[ae]]);for(ae=0;ae<xe.length;++ae){var Oe=r(xe[ae][0]);K=Ie[Oe],K||(xe.push([Oe,{name:i(Oe).replace("/",""),type:1,clsid:L,ct:be,mt:be,content:null}]),Ie[Oe]=!0)}for(xe.sort(function(it,nt){return n(it[0],nt[0])}),H.FullPaths=[],H.FileIndex=[],ae=0;ae<xe.length;++ae)H.FullPaths[ae]=xe[ae][0],H.FileIndex[ae]=xe[ae][1];for(ae=0;ae<xe.length;++ae){var Be=H.FileIndex[ae],tt=H.FullPaths[ae];if(Be.name=i(tt).replace("/",""),Be.L=Be.R=Be.C=-(Be.color=1),Be.size=Be.content?Be.content.length:0,Be.start=0,Be.clsid=Be.clsid||L,ae===0)Be.C=xe.length>1?1:-1,Be.size=0,Be.type=5;else if(tt.slice(-1)=="/"){for(Ae=ae+1;Ae<xe.length&&r(H.FullPaths[Ae])!=tt;++Ae);for(Be.C=Ae>=xe.length?-1:Ae,Ae=ae+1;Ae<xe.length&&r(H.FullPaths[Ae])!=r(tt);++Ae);Be.R=Ae>=xe.length?-1:Ae,Be.type=1}else r(H.FullPaths[ae+1]||"")==r(tt)&&(Be.R=ae+1),Be.type=2}}}function Y(H,se){var X=se||{};if(X.fileType=="mad")return vh(H,X);switch(B(H),X.fileType){case"zip":return ga(H,X)}var K=function(it){for(var nt=0,ut=0,Yt=0;Yt<it.FileIndex.length;++Yt){var er=it.FileIndex[Yt];if(er.content){var qr=er.content.length;qr>0&&(qr<4096?nt+=qr+63>>6:ut+=qr+511>>9)}}for(var sr=it.FullPaths.length+3>>2,$i=nt+7>>3,Ll=nt+127>>7,Ys=$i+ut+sr+Ll,qs=Ys+127>>7,Hl=qs<=109?0:Math.ceil((qs-109)/127);Ys+qs+Hl+127>>7>qs;)Hl=++qs<=109?0:Math.ceil((qs-109)/127);var ws=[1,Hl,qs,Ll,sr,ut,nt,0];return it.FileIndex[0].size=nt<<6,ws[7]=(it.FileIndex[0].start=ws[0]+ws[1]+ws[2]+ws[3]+ws[4]+ws[5])+(ws[6]+7>>3),ws}(H),ae=He(K[7]<<9),le=0,be=0;{for(le=0;le<8;++le)ae.write_shift(1,_e[le]);for(le=0;le<8;++le)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),le=0;le<3;++le)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,K[2]),ae.write_shift(4,K[0]+K[1]+K[2]+K[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,K[3]?K[0]+K[1]+K[2]-1:Ce),ae.write_shift(4,K[3]),ae.write_shift(-4,K[1]?K[0]-1:Ce),ae.write_shift(4,K[1]),le=0;le<109;++le)ae.write_shift(-4,le<K[2]?K[1]+le:-1)}if(K[1])for(be=0;be<K[1];++be){for(;le<236+be*127;++le)ae.write_shift(-4,le<K[2]?K[1]+le:-1);ae.write_shift(-4,be===K[1]-1?Ce:be+1)}var Ae=function(it){for(be+=it;le<be-1;++le)ae.write_shift(-4,le+1);it&&(++le,ae.write_shift(-4,Ce))};for(be=le=0,be+=K[1];le<be;++le)ae.write_shift(-4,M.DIFSECT);for(be+=K[2];le<be;++le)ae.write_shift(-4,M.FATSECT);Ae(K[3]),Ae(K[4]);for(var Ie=0,xe=0,Oe=H.FileIndex[0];Ie<H.FileIndex.length;++Ie)Oe=H.FileIndex[Ie],Oe.content&&(xe=Oe.content.length,!(xe<4096)&&(Oe.start=be,Ae(xe+511>>9)));for(Ae(K[6]+7>>3);ae.l&511;)ae.write_shift(-4,M.ENDOFCHAIN);for(be=le=0,Ie=0;Ie<H.FileIndex.length;++Ie)Oe=H.FileIndex[Ie],Oe.content&&(xe=Oe.content.length,!(!xe||xe>=4096)&&(Oe.start=be,Ae(xe+63>>6)));for(;ae.l&511;)ae.write_shift(-4,M.ENDOFCHAIN);for(le=0;le<K[4]<<2;++le){var Be=H.FullPaths[le];if(!Be||Be.length===0){for(Ie=0;Ie<17;++Ie)ae.write_shift(4,0);for(Ie=0;Ie<3;++Ie)ae.write_shift(4,-1);for(Ie=0;Ie<12;++Ie)ae.write_shift(4,0);continue}Oe=H.FileIndex[le],le===0&&(Oe.start=Oe.size?Oe.start-1:Ce);var tt=le===0&&X.root||Oe.name;if(xe=2*(tt.length+1),ae.write_shift(64,tt,"utf16le"),ae.write_shift(2,xe),ae.write_shift(1,Oe.type),ae.write_shift(1,Oe.color),ae.write_shift(-4,Oe.L),ae.write_shift(-4,Oe.R),ae.write_shift(-4,Oe.C),Oe.clsid)ae.write_shift(16,Oe.clsid,"hex");else for(Ie=0;Ie<4;++Ie)ae.write_shift(4,0);ae.write_shift(4,Oe.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,Oe.start),ae.write_shift(4,Oe.size),ae.write_shift(4,0)}for(le=1;le<H.FileIndex.length;++le)if(Oe=H.FileIndex[le],Oe.size>=4096)if(ae.l=Oe.start+1<<9,In&&Buffer.isBuffer(Oe.content))Oe.content.copy(ae,ae.l,0,Oe.size),ae.l+=Oe.size+511&-512;else{for(Ie=0;Ie<Oe.size;++Ie)ae.write_shift(1,Oe.content[Ie]);for(;Ie&511;++Ie)ae.write_shift(1,0)}for(le=1;le<H.FileIndex.length;++le)if(Oe=H.FileIndex[le],Oe.size>0&&Oe.size<4096)if(In&&Buffer.isBuffer(Oe.content))Oe.content.copy(ae,ae.l,0,Oe.size),ae.l+=Oe.size+63&-64;else{for(Ie=0;Ie<Oe.size;++Ie)ae.write_shift(1,Oe.content[Ie]);for(;Ie&63;++Ie)ae.write_shift(1,0)}if(In)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function ee(H,se){var X=H.FullPaths.map(function(Ie){return Ie.toUpperCase()}),K=X.map(function(Ie){var xe=Ie.split("/");return xe[xe.length-(Ie.slice(-1)=="/"?2:1)]}),ae=!1;se.charCodeAt(0)===47?(ae=!0,se=X[0].slice(0,-1)+se):ae=se.indexOf("/")!==-1;var le=se.toUpperCase(),be=ae===!0?X.indexOf(le):K.indexOf(le);if(be!==-1)return H.FileIndex[be];var Ae=!le.match(b1);for(le=le.replace(os,""),Ae&&(le=le.replace(b1,"!")),be=0;be<X.length;++be)if((Ae?X[be].replace(b1,"!"):X[be]).replace(os,"")==le||(Ae?K[be].replace(b1,"!"):K[be]).replace(os,"")==le)return H.FileIndex[be];return null}var te=64,Ce=-2,Re="d0cf11e0a1b11ae1",_e=[208,207,17,224,161,177,26,225],L="00000000000000000000000000000000",M={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ce,FREESECT:-1,HEADER_SIGNATURE:Re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:L,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function q(H,se,X){c();var K=Y(H,X);l.writeFileSync(se,K)}function y(H){for(var se=new Array(H.length),X=0;X<H.length;++X)se[X]=String.fromCharCode(H[X]);return se.join("")}function E(H,se){var X=Y(H,se);switch(se&&se.type||"buffer"){case"file":return c(),l.writeFileSync(se.filename,X),X;case"binary":return typeof X=="string"?X:y(X);case"base64":return F1(typeof X=="string"?X:y(X));case"buffer":if(In)return Buffer.isBuffer(X)?X:kd(X);case"array":return typeof X=="string"?Ta(X):X}return X}var R;function D(H){try{var se=H.InflateRaw,X=new se;if(X._processChunk(new Uint8Array([3,0]),X._finishFlushFlag),X.bytesRead)R=H;else throw new Error("zlib does not expose bytesRead")}catch(K){console.error("cannot use native zlib: "+(K.message||K))}}function A(H,se){if(!R)return Mn(H,se);var X=R.InflateRaw,K=new X,ae=K._processChunk(H.slice(H.l),K._finishFlushFlag);return H.l+=K.bytesRead,ae}function O(H){return R?R.deflateRawSync(H):ke(H)}var U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ie=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(H){var se=(H<<1|H<<11)&139536|(H<<5|H<<15)&558144;return(se>>16|se>>8|se)&255}for(var de=typeof Uint8Array<"u",ye=de?new Uint8Array(256):[],Pe=0;Pe<256;++Pe)ye[Pe]=fe(Pe);function F(H,se){var X=ye[H&255];return se<=8?X>>>8-se:(X=X<<8|ye[H>>8&255],se<=16?X>>>16-se:(X=X<<8|ye[H>>16&255],X>>>24-se))}function Ke(H,se){var X=se&7,K=se>>>3;return(H[K]|(X<=6?0:H[K+1]<<8))>>>X&3}function $e(H,se){var X=se&7,K=se>>>3;return(H[K]|(X<=5?0:H[K+1]<<8))>>>X&7}function rt(H,se){var X=se&7,K=se>>>3;return(H[K]|(X<=4?0:H[K+1]<<8))>>>X&15}function Ye(H,se){var X=se&7,K=se>>>3;return(H[K]|(X<=3?0:H[K+1]<<8))>>>X&31}function Me(H,se){var X=se&7,K=se>>>3;return(H[K]|(X<=1?0:H[K+1]<<8))>>>X&127}function j(H,se,X){var K=se&7,ae=se>>>3,le=(1<<X)-1,be=H[ae]>>>K;return X<8-K||(be|=H[ae+1]<<8-K,X<16-K)||(be|=H[ae+2]<<16-K,X<24-K)||(be|=H[ae+3]<<24-K),be&le}function z(H,se,X){var K=se&7,ae=se>>>3;return K<=5?H[ae]|=(X&7)<<K:(H[ae]|=X<<K&255,H[ae+1]=(X&7)>>8-K),se+3}function J(H,se,X){var K=se&7,ae=se>>>3;return X=(X&1)<<K,H[ae]|=X,se+1}function pe(H,se,X){var K=se&7,ae=se>>>3;return X<<=K,H[ae]|=X&255,X>>>=8,H[ae+1]=X,se+8}function he(H,se,X){var K=se&7,ae=se>>>3;return X<<=K,H[ae]|=X&255,X>>>=8,H[ae+1]=X&255,H[ae+2]=X>>>8,se+16}function me(H,se){var X=H.length,K=2*X>se?2*X:se+5,ae=0;if(X>=se)return H;if(In){var le=EZ(K);if(H.copy)H.copy(le);else for(;ae<H.length;++ae)le[ae]=H[ae];return le}else if(de){var be=new Uint8Array(K);if(be.set)be.set(H);else for(;ae<X;++ae)be[ae]=H[ae];return be}return H.length=K,H}function ve(H){for(var se=new Array(H),X=0;X<H;++X)se[X]=0;return se}function ne(H,se,X){var K=1,ae=0,le=0,be=0,Ae=0,Ie=H.length,xe=de?new Uint16Array(32):ve(32);for(le=0;le<32;++le)xe[le]=0;for(le=Ie;le<X;++le)H[le]=0;Ie=H.length;var Oe=de?new Uint16Array(Ie):ve(Ie);for(le=0;le<Ie;++le)xe[ae=H[le]]++,K<ae&&(K=ae),Oe[le]=0;for(xe[0]=0,le=1;le<=K;++le)xe[le+16]=Ae=Ae+xe[le-1]<<1;for(le=0;le<Ie;++le)Ae=H[le],Ae!=0&&(Oe[le]=xe[Ae+16]++);var Be=0;for(le=0;le<Ie;++le)if(Be=H[le],Be!=0)for(Ae=F(Oe[le],K)>>K-Be,be=(1<<K+4-Be)-1;be>=0;--be)se[Ae|be<<Be]=Be&15|le<<4;return K}var ce=de?new Uint16Array(512):ve(512),oe=de?new Uint16Array(32):ve(32);if(!de){for(var ge=0;ge<512;++ge)ce[ge]=0;for(ge=0;ge<32;++ge)oe[ge]=0}(function(){for(var H=[],se=0;se<32;se++)H.push(5);ne(H,oe,32);var X=[];for(se=0;se<=143;se++)X.push(8);for(;se<=255;se++)X.push(9);for(;se<=279;se++)X.push(7);for(;se<=287;se++)X.push(8);ne(X,ce,288)})();var Ve=function(){for(var se=de?new Uint8Array(32768):[],X=0,K=0;X<ue.length-1;++X)for(;K<ue[X+1];++K)se[K]=X;for(;K<32768;++K)se[K]=29;var ae=de?new Uint8Array(259):[];for(X=0,K=0;X<ie.length-1;++X)for(;K<ie[X+1];++K)ae[K]=X;function le(Ae,Ie){for(var xe=0;xe<Ae.length;){var Oe=Math.min(65535,Ae.length-xe),Be=xe+Oe==Ae.length;for(Ie.write_shift(1,+Be),Ie.write_shift(2,Oe),Ie.write_shift(2,~Oe&65535);Oe-- >0;)Ie[Ie.l++]=Ae[xe++]}return Ie.l}function be(Ae,Ie){for(var xe=0,Oe=0,Be=de?new Uint16Array(32768):[];Oe<Ae.length;){var tt=Math.min(65535,Ae.length-Oe);if(tt<10){for(xe=z(Ie,xe,+(Oe+tt==Ae.length)),xe&7&&(xe+=8-(xe&7)),Ie.l=xe/8|0,Ie.write_shift(2,tt),Ie.write_shift(2,~tt&65535);tt-- >0;)Ie[Ie.l++]=Ae[Oe++];xe=Ie.l*8;continue}xe=z(Ie,xe,+(Oe+tt==Ae.length)+2);for(var it=0;tt-- >0;){var nt=Ae[Oe];it=(it<<5^nt)&32767;var ut=-1,Yt=0;if((ut=Be[it])&&(ut|=Oe&-32768,ut>Oe&&(ut-=32768),ut<Oe))for(;Ae[ut+Yt]==Ae[Oe+Yt]&&Yt<250;)++Yt;if(Yt>2){nt=ae[Yt],nt<=22?xe=pe(Ie,xe,ye[nt+1]>>1)-1:(pe(Ie,xe,3),xe+=5,pe(Ie,xe,ye[nt-23]>>5),xe+=3);var er=nt<8?0:nt-4>>2;er>0&&(he(Ie,xe,Yt-ie[nt]),xe+=er),nt=se[Oe-ut],xe=pe(Ie,xe,ye[nt]>>3),xe-=3;var qr=nt<4?0:nt-2>>1;qr>0&&(he(Ie,xe,Oe-ut-ue[nt]),xe+=qr);for(var sr=0;sr<Yt;++sr)Be[it]=Oe&32767,it=(it<<5^Ae[Oe])&32767,++Oe;tt-=Yt-1}else nt<=143?nt=nt+48:xe=J(Ie,xe,1),xe=pe(Ie,xe,ye[nt]),Be[it]=Oe&32767,++Oe}xe=pe(Ie,xe,0)-1}return Ie.l=(xe+7)/8|0,Ie.l}return function(Ie,xe){return Ie.length<8?le(Ie,xe):be(Ie,xe)}}();function ke(H){var se=He(50+Math.floor(H.length*1.1)),X=Ve(H,se);return se.slice(0,X)}var Xe=de?new Uint16Array(32768):ve(32768),gt=de?new Uint16Array(32768):ve(32768),Mt=de?new Uint16Array(128):ve(128),Nt=1,$t=1;function Rn(H,se){var X=Ye(H,se)+257;se+=5;var K=Ye(H,se)+1;se+=5;var ae=rt(H,se)+4;se+=4;for(var le=0,be=de?new Uint8Array(19):ve(19),Ae=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ie=1,xe=de?new Uint8Array(8):ve(8),Oe=de?new Uint8Array(8):ve(8),Be=be.length,tt=0;tt<ae;++tt)be[U[tt]]=le=$e(H,se),Ie<le&&(Ie=le),xe[le]++,se+=3;var it=0;for(xe[0]=0,tt=1;tt<=Ie;++tt)Oe[tt]=it=it+xe[tt-1]<<1;for(tt=0;tt<Be;++tt)(it=be[tt])!=0&&(Ae[tt]=Oe[it]++);var nt=0;for(tt=0;tt<Be;++tt)if(nt=be[tt],nt!=0){it=ye[Ae[tt]]>>8-nt;for(var ut=(1<<7-nt)-1;ut>=0;--ut)Mt[it|ut<<nt]=nt&7|tt<<3}var Yt=[];for(Ie=1;Yt.length<X+K;)switch(it=Mt[Me(H,se)],se+=it&7,it>>>=3){case 16:for(le=3+Ke(H,se),se+=2,it=Yt[Yt.length-1];le-- >0;)Yt.push(it);break;case 17:for(le=3+$e(H,se),se+=3;le-- >0;)Yt.push(0);break;case 18:for(le=11+Me(H,se),se+=7;le-- >0;)Yt.push(0);break;default:Yt.push(it),Ie<it&&(Ie=it);break}var er=Yt.slice(0,X),qr=Yt.slice(X);for(tt=X;tt<286;++tt)er[tt]=0;for(tt=K;tt<30;++tt)qr[tt]=0;return Nt=ne(er,Xe,286),$t=ne(qr,gt,30),se}function yr(H,se){if(H[0]==3&&!(H[1]&3))return[wf(se),2];for(var X=0,K=0,ae=EZ(se||1<<18),le=0,be=ae.length>>>0,Ae=0,Ie=0;!(K&1);){if(K=$e(H,X),X+=3,K>>>1)K>>1==1?(Ae=9,Ie=5):(X=Rn(H,X),Ae=Nt,Ie=$t);else{X&7&&(X+=8-(X&7));var xe=H[X>>>3]|H[(X>>>3)+1]<<8;if(X+=32,xe>0)for(!se&&be<le+xe&&(ae=me(ae,le+xe),be=ae.length);xe-- >0;)ae[le++]=H[X>>>3],X+=8;continue}for(;;){!se&&be<le+32767&&(ae=me(ae,le+32767),be=ae.length);var Oe=j(H,X,Ae),Be=K>>>1==1?ce[Oe]:Xe[Oe];if(X+=Be&15,Be>>>=4,!(Be>>>8&255))ae[le++]=Be;else{if(Be==256)break;Be-=257;var tt=Be<8?0:Be-4>>2;tt>5&&(tt=0);var it=le+ie[Be];tt>0&&(it+=j(H,X,tt),X+=tt),Oe=j(H,X,Ie),Be=K>>>1==1?oe[Oe]:gt[Oe],X+=Be&15,Be>>>=4;var nt=Be<4?0:Be-2>>1,ut=ue[Be];for(nt>0&&(ut+=j(H,X,nt),X+=nt),!se&&be<it&&(ae=me(ae,it+100),be=ae.length);le<it;)ae[le]=ae[le-ut],++le}}}return se?[ae,X+7>>>3]:[ae.slice(0,le),X+7>>>3]}function Mn(H,se){var X=H.slice(H.l||0),K=yr(X,se);return H.l+=K[1],K[0]}function zs(H,se){if(H)typeof console<"u"&&console.error(se);else throw new Error(se)}function kl(H,se){var X=H;Ho(X,0);var K=[],ae=[],le={FileIndex:K,FullPaths:ae};C(le,{root:se.root});for(var be=X.length-4;(X[be]!=80||X[be+1]!=75||X[be+2]!=5||X[be+3]!=6)&&be>=0;)--be;X.l=be+4,X.l+=4;var Ae=X.read_shift(2);X.l+=6;var Ie=X.read_shift(4);for(X.l=Ie,be=0;be<Ae;++be){X.l+=20;var xe=X.read_shift(4),Oe=X.read_shift(4),Be=X.read_shift(2),tt=X.read_shift(2),it=X.read_shift(2);X.l+=8;var nt=X.read_shift(4),ut=a(X.slice(X.l+Be,X.l+Be+tt));X.l+=Be+tt+it;var Yt=X.l;X.l=nt+4,ji(X,xe,Oe,le,ut),X.l=Yt}return le}function ji(H,se,X,K,ae){H.l+=2;var le=H.read_shift(2),be=H.read_shift(2),Ae=s(H);if(le&8257)throw new Error("Unsupported ZIP encryption");for(var Ie=H.read_shift(4),xe=H.read_shift(4),Oe=H.read_shift(4),Be=H.read_shift(2),tt=H.read_shift(2),it="",nt=0;nt<Be;++nt)it+=String.fromCharCode(H[H.l++]);if(tt){var ut=a(H.slice(H.l,H.l+tt));(ut[21589]||{}).mt&&(Ae=ut[21589].mt),((ae||{})[21589]||{}).mt&&(Ae=ae[21589].mt)}H.l+=tt;var Yt=H.slice(H.l,H.l+xe);switch(be){case 8:Yt=A(H,Oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+be)}var er=!1;le&8&&(Ie=H.read_shift(4),Ie==134695760&&(Ie=H.read_shift(4),er=!0),xe=H.read_shift(4),Oe=H.read_shift(4)),xe!=se&&zs(er,"Bad compressed size: "+se+" != "+xe),Oe!=X&&zs(er,"Bad uncompressed size: "+X+" != "+Oe),xm(K,it,Yt,{unsafe:!0,mt:Ae})}function ga(H,se){var X=se||{},K=[],ae=[],le=He(1),be=X.compression?8:0,Ae=0,Ie=!1;Ie&&(Ae|=8);var xe=0,Oe=0,Be=0,tt=0,it=H.FullPaths[0],nt=it,ut=H.FileIndex[0],Yt=[],er=0;for(xe=1;xe<H.FullPaths.length;++xe)if(nt=H.FullPaths[xe].slice(it.length),ut=H.FileIndex[xe],!(!ut.size||!ut.content||nt=="Sh33tJ5")){var qr=Be,sr=He(nt.length);for(Oe=0;Oe<nt.length;++Oe)sr.write_shift(1,nt.charCodeAt(Oe)&127);sr=sr.slice(0,sr.l),Yt[tt]=kPe.buf(ut.content,0);var $i=ut.content;be==8&&($i=O($i)),le=He(30),le.write_shift(4,67324752),le.write_shift(2,20),le.write_shift(2,Ae),le.write_shift(2,be),ut.mt?o(le,ut.mt):le.write_shift(4,0),le.write_shift(-4,Ae&8?0:Yt[tt]),le.write_shift(4,Ae&8?0:$i.length),le.write_shift(4,Ae&8?0:ut.content.length),le.write_shift(2,sr.length),le.write_shift(2,0),Be+=le.length,K.push(le),Be+=sr.length,K.push(sr),Be+=$i.length,K.push($i),Ae&8&&(le=He(12),le.write_shift(-4,Yt[tt]),le.write_shift(4,$i.length),le.write_shift(4,ut.content.length),Be+=le.l,K.push(le)),le=He(46),le.write_shift(4,33639248),le.write_shift(2,0),le.write_shift(2,20),le.write_shift(2,Ae),le.write_shift(2,be),le.write_shift(4,0),le.write_shift(-4,Yt[tt]),le.write_shift(4,$i.length),le.write_shift(4,ut.content.length),le.write_shift(2,sr.length),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(4,0),le.write_shift(4,qr),er+=le.l,ae.push(le),er+=sr.length,ae.push(sr),++tt}return le=He(22),le.write_shift(4,101010256),le.write_shift(2,0),le.write_shift(2,0),le.write_shift(2,tt),le.write_shift(2,tt),le.write_shift(4,er),le.write_shift(4,Be),le.write_shift(2,0),po([po(K),po(ae),le])}var Ir={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _r(H,se){if(H.ctype)return H.ctype;var X=H.name||"",K=X.match(/\.([^\.]+)$/);return K&&Ir[K[1]]||se&&(K=(X=se).match(/[\.\\]([^\.\\])+$/),K&&Ir[K[1]])?Ir[K[1]]:"application/octet-stream"}function vn(H){for(var se=F1(H),X=[],K=0;K<se.length;K+=76)X.push(se.slice(K,K+76));return X.join(`\r
`)+`\r
`}function Sm(H){var se=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(xe){var Oe=xe.charCodeAt(0).toString(16).toUpperCase();return"="+(Oe.length==1?"0"+Oe:Oe)});se=se.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),se.charAt(0)==`
`&&(se="=0D"+se.slice(1)),se=se.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var X=[],K=se.split(`\r
`),ae=0;ae<K.length;++ae){var le=K[ae];if(le.length==0){X.push("");continue}for(var be=0;be<le.length;){var Ae=76,Ie=le.slice(be,be+Ae);Ie.charAt(Ae-1)=="="?Ae--:Ie.charAt(Ae-2)=="="?Ae-=2:Ie.charAt(Ae-3)=="="&&(Ae-=3),Ie=le.slice(be,be+Ae),be+=Ae,be<le.length&&(Ie+="="),X.push(Ie)}}return X.join(`\r
`)}function Fl(H){for(var se=[],X=0;X<H.length;++X){for(var K=H[X];X<=H.length&&K.charAt(K.length-1)=="=";)K=K.slice(0,K.length-1)+H[++X];se.push(K)}for(var ae=0;ae<se.length;++ae)se[ae]=se[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(le){return String.fromCharCode(parseInt(le.slice(1),16))});return Ta(se.join(`\r
`))}function Em(H,se,X){for(var K="",ae="",le="",be,Ae=0;Ae<10;++Ae){var Ie=se[Ae];if(!Ie||Ie.match(/^\s*$/))break;var xe=Ie.match(/^(.*?):\s*([^\s].*)$/);if(xe)switch(xe[1].toLowerCase()){case"content-location":K=xe[2].trim();break;case"content-type":le=xe[2].trim();break;case"content-transfer-encoding":ae=xe[2].trim();break}}switch(++Ae,ae.toLowerCase()){case"base64":be=Ta(Da(se.slice(Ae).join("")));break;case"quoted-printable":be=Fl(se.slice(Ae));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var Oe=xm(H,K.slice(X.length),be,{unsafe:!0});le&&(Oe.ctype=le)}function Ku(H,se){if(y(H.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var X=se&&se.root||"",K=(In&&Buffer.isBuffer(H)?H.toString("binary"):y(H)).split(`\r
`),ae=0,le="";for(ae=0;ae<K.length;++ae)if(le=K[ae],!!/^Content-Location:/i.test(le)&&(le=le.slice(le.indexOf("file")),X||(X=le.slice(0,le.lastIndexOf("/")+1)),le.slice(0,X.length)!=X))for(;X.length>0&&(X=X.slice(0,X.length-1),X=X.slice(0,X.lastIndexOf("/")+1),le.slice(0,X.length)!=X););var be=(K[1]||"").match(/boundary="(.*?)"/);if(!be)throw new Error("MAD cannot find boundary");var Ae="--"+(be[1]||""),Ie=[],xe=[],Oe={FileIndex:Ie,FullPaths:xe};C(Oe);var Be,tt=0;for(ae=0;ae<K.length;++ae){var it=K[ae];it!==Ae&&it!==Ae+"--"||(tt++&&Em(Oe,K.slice(Be,ae),X),Be=ae)}return Oe}function vh(H,se){var X=se||{},K=X.boundary||"SheetJS";K="------="+K;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+K.slice(2)+'"',"","",""],le=H.FullPaths[0],be=le,Ae=H.FileIndex[0],Ie=1;Ie<H.FullPaths.length;++Ie)if(be=H.FullPaths[Ie].slice(le.length),Ae=H.FileIndex[Ie],!(!Ae.size||!Ae.content||be=="Sh33tJ5")){be=be.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Yt){return"_x"+Yt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Yt){return"_u"+Yt.charCodeAt(0).toString(16)+"_"});for(var xe=Ae.content,Oe=In&&Buffer.isBuffer(xe)?xe.toString("binary"):y(xe),Be=0,tt=Math.min(1024,Oe.length),it=0,nt=0;nt<=tt;++nt)(it=Oe.charCodeAt(nt))>=32&&it<128&&++Be;var ut=Be>=tt*4/5;ae.push(K),ae.push("Content-Location: "+(X.root||"file:///C:/SheetJS/")+be),ae.push("Content-Transfer-Encoding: "+(ut?"quoted-printable":"base64")),ae.push("Content-Type: "+_r(Ae,be)),ae.push(""),ae.push(ut?Sm(Oe):vn(Oe))}return ae.push(K+`--\r
`),ae.join(`\r
`)}function Et(H){var se={};return C(se,H),se}function xm(H,se,X,K){var ae=K&&K.unsafe;ae||C(H);var le=!ae&&Vt.find(H,se);if(!le){var be=H.FullPaths[0];se.slice(0,be.length)==be?be=se:(be.slice(-1)!="/"&&(be+="/"),be=(be+se).replace("//","/")),le={name:i(se),type:2},H.FileIndex.push(le),H.FullPaths.push(be),ae||Vt.utils.cfb_gc(H)}return le.content=X,le.size=X?X.length:0,K&&(K.CLSID&&(le.clsid=K.CLSID),K.mt&&(le.mt=K.mt),K.ct&&(le.ct=K.ct)),le}function s0(H,se){C(H);var X=Vt.find(H,se);if(X){for(var K=0;K<H.FileIndex.length;++K)if(H.FileIndex[K]==X)return H.FileIndex.splice(K,1),H.FullPaths.splice(K,1),!0}return!1}function Ar(H,se,X){C(H);var K=Vt.find(H,se);if(K){for(var ae=0;ae<H.FileIndex.length;++ae)if(H.FileIndex[ae]==K)return H.FileIndex[ae].name=i(X),H.FullPaths[ae]=X,!0}return!1}function Xu(H){B(H,!0)}return e.find=ee,e.read=b,e.parse=u,e.write=E,e.writeFile=q,e.utils={cfb_new:Et,cfb_add:xm,cfb_del:s0,cfb_mov:Ar,cfb_gc:Xu,ReadShift:R1,CheckField:oJ,prep_blob:Ho,bconcat:po,use_zlib:D,_deflateRaw:ke,_inflateRaw:Mn,consts:M},e}(),Nv;function FPe(t){return typeof t=="string"?DA(t):Array.isArray(t)?lPe(t):t}function K1(t,e,n){if(typeof Nv<"u"&&Nv.writeFileSync)return n?Nv.writeFileSync(t,e,n):Nv.writeFileSync(t,e);if(typeof Deno<"u"){if(n&&typeof e=="string")switch(n){case"utf8":e=new TextEncoder(n).encode(e);break;case"binary":e=DA(e);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(t,e)}var r=n=="utf8"?hu(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var i=new Blob([FPe(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=t,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=Sf(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function LPe(t){if(typeof Nv<"u")return Nv.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var n=e.read();return e.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+t)}function pi(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function MZ(t,e){for(var n=[],r=pi(t),i=0;i!==r.length;++i)n[t[r[i]][e]]==null&&(n[t[r[i]][e]]=r[i]);return n}function AA(t){for(var e=[],n=pi(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}function MA(t){for(var e=[],n=pi(t),r=0;r!==n.length;++r)e[t[n[r]]]=parseInt(n[r],10);return e}function HPe(t){for(var e=[],n=pi(t),r=0;r!==n.length;++r)e[t[n[r]]]==null&&(e[t[n[r]]]=[]),e[t[n[r]]].push(n[r]);return e}var wA=new Date(1899,11,30,0,0,0);function Ji(t,e){var n=t.getTime();e&&(n-=1462*24*60*60*1e3);var r=wA.getTime()+(t.getTimezoneOffset()-wA.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var WQ=new Date,VPe=wA.getTime()+(WQ.getTimezoneOffset()-wA.getTimezoneOffset())*6e4,OZ=WQ.getTimezoneOffset();function OA(t){var e=new Date;return e.setTime(t*24*60*60*1e3+VPe),e.getTimezoneOffset()!==OZ&&e.setTime(e.getTime()+(e.getTimezoneOffset()-OZ)*6e4),e}function BPe(t){var e=0,n=0,r=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(n=1,o>3&&(r=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}e+=n*parseInt(i[o],10)}return e}var NZ=new Date("2017-02-19T19:06:09.000Z"),jQ=isNaN(NZ.getFullYear())?new Date("2/19/17"):NZ,UPe=jQ.getFullYear()==2017;function Lr(t,e){var n=new Date(t);if(UPe)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(jQ.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Rp(t,e){if(In&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return hu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return hu(AQ(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return hu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return hu(new TextDecoder("utf-16be").decode(t.slice(2)))}var n={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return n[o]||o})}catch{}for(var r=[],i=0;i!=t.length;++i)r.push(String.fromCharCode(t[i]));return r.join("")}function Hr(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=Hr(t[n]));return e}function hi(t,e){for(var n="";n.length<e;)n+=t;return n}function cc(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,o){return n=-n,o}),!isNaN(e=Number(r)))?e/n:e}var WPe=["january","february","march","april","may","june","july","august","september","october","november","december"];function Bv(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),i=e.getMonth(),o=e.getDate();if(isNaN(o))return n;var s=t.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&WPe.indexOf(s)==-1)return n}else if(s.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||o>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}var jPe=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(n,r,i){if(t||typeof r=="string")return n.split(r);for(var o=n.split(r),s=[o[0]],a=1;a<o.length;++a)s.push(i),s.push(o[a]);return s}}();function $Q(t){return t?t.content&&t.type?Rp(t.content,!0):t.data?x1(t.data):t.asNodeBuffer&&In?x1(t.asNodeBuffer().toString("binary")):t.asBinary?x1(t.asBinary()):t._data&&t._data.getContent?x1(Rp(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function GQ(t){if(!t)return null;if(t.data)return SB(t.data);if(t.asNodeBuffer&&In)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?SB(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function $Pe(t){return t&&t.name.slice(-4)===".bin"?GQ(t):$Q(t)}function cl(t,e){for(var n=t.FullPaths||pi(t.files),r=e.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),o=0;o<n.length;++o){var s=n[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==s||i==s)return t.files?t.files[n[o]]:t.FileIndex[o]}return null}function BB(t,e){var n=cl(t,e);if(n==null)throw new Error("Cannot find file "+e+" in zip");return n}function Li(t,e,n){if(!n)return $Pe(BB(t,e));if(!e)return null;try{return Li(t,e)}catch{return null}}function Ra(t,e,n){if(!n)return $Q(BB(t,e));if(!e)return null;try{return Ra(t,e)}catch{return null}}function zQ(t,e,n){if(!n)return GQ(BB(t,e));if(!e)return null;try{return zQ(t,e)}catch{return null}}function PZ(t){for(var e=t.FullPaths||pi(t.files),n=[],r=0;r<e.length;++r)e[r].slice(-1)!="/"&&n.push(e[r].replace(/^Root Entry[\/]/,""));return n.sort()}function _n(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return In?r=kd(n):r=cPe(n),Vt.utils.cfb_add(t,e,r)}Vt.utils.cfb_add(t,e,n)}else t.file(e,n)}function UB(){return Vt.utils.cfb_new()}function YQ(t,e){switch(e.type){case"base64":return Vt.read(t,{type:"base64"});case"binary":return Vt.read(t,{type:"binary"});case"buffer":case"array":return Vt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function T1(t,e){if(t.charAt(0)=="/")return t.slice(1);var n=e.split("/");e.slice(-1)!="/"&&n.pop();for(var r=t.split("/");r.length!==0;){var i=r.shift();i===".."?n.pop():i!=="."&&n.push(i)}return n.join("/")}var Ti=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,GPe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,kZ=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,zPe=/<[^>]*>/g,ls=Ti.match(kZ)?kZ:zPe,YPe=/<\w*:/,qPe=/<(\/?)\w+:/;function Zt(t,e,n){for(var r={},i=0,o=0;i!==t.length&&!((o=t.charCodeAt(i))===32||o===10||o===13);++i);if(e||(r[0]=t.slice(0,i)),i===t.length)return r;var s=t.match(GPe),a=0,l="",c=0,u="",d="",h=1;if(s)for(c=0;c!=s.length;++c){for(d=s[c],o=0;o!=d.length&&d.charCodeAt(o)!==61;++o);for(u=d.slice(0,o).trim();d.charCodeAt(o+1)==32;)++o;for(h=(i=d.charCodeAt(o+1))==34||i==39?1:0,l=d.slice(o+1+h,d.length-h),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),r[u]=l,n||(r[u.toLowerCase()]=l);else{var f=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(r[f]&&u.slice(a-3,a)=="ext")continue;r[f]=l,n||(r[f.toLowerCase()]=l)}}return r}function mu(t){return t.replace(qPe,"<$1")}var qQ={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},WB=AA(qQ),Yn=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function n(r){var i=r+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(t,function(a,l){return qQ[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(e,function(a,l){return String.fromCharCode(parseInt(l,16))});var s=i.indexOf("]]>");return n(i.slice(0,o))+i.slice(o+9,s)+n(i.slice(s+3))}}(),jB=/[&<>'"]/g,KPe=/[\u0000-\u0008\u000b-\u001f]/g;function gr(t){var e=t+"";return e.replace(jB,function(n){return WB[n]}).replace(KPe,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function FZ(t){return gr(t).replace(/ /g,"_x0020_")}var KQ=/[\u0000-\u001f]/g;function $B(t){var e=t+"";return e.replace(jB,function(n){return WB[n]}).replace(/\n/g,"<br/>").replace(KQ,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function XPe(t){var e=t+"";return e.replace(jB,function(n){return WB[n]}).replace(KQ,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var LZ=function(){var t=/&#(\d+);/g;function e(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(t,e)}}();function ZPe(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Fr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function cB(t){for(var e="",n=0,r=0,i=0,o=0,s=0,a=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(i=t.charCodeAt(n++),r>191&&r<224){s=(r&31)<<6,s|=i&63,e+=String.fromCharCode(s);continue}if(o=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63);continue}s=t.charCodeAt(n++),a=((r&7)<<18|(i&63)<<12|(o&63)<<6|s&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function HZ(t){var e=wf(2*t.length),n,r,i=1,o=0,s=0,a;for(r=0;r<t.length;r+=i)i=1,(a=t.charCodeAt(r))<128?n=a:a<224?(n=(a&31)*64+(t.charCodeAt(r+1)&63),i=2):a<240?(n=(a&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),i=3):(i=4,n=(a&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,s=55296+(n>>>10&1023),n=56320+(n&1023)),s!==0&&(e[o++]=s&255,e[o++]=s>>>8,s=0),e[o++]=n%256,e[o++]=n>>>8;return e.slice(0,o).toString("ucs2")}function VZ(t){return kd(t,"binary").toString("utf8")}var oA="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Sr=In&&(VZ(oA)==cB(oA)&&VZ||HZ(oA)==cB(oA)&&HZ)||cB,hu=In?function(t){return kd(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,i=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},H1=function(){var t={};return function(n,r){var i=n+"|"+(r||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),XQ=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)r=r.replace(t[i][0],t[i][1]);return r}}(),QPe=function(){var t={};return function(n){return t[n]!==void 0?t[n]:t[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),JPe=/<\/?(?:vt:)?variant>/g,eke=/<(?:vt:)([^>]*)>([\s\S]*)</;function BZ(t,e){var n=Zt(t),r=t.match(QPe(n.baseType))||[],i=[];if(r.length!=n.size){if(e.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return i}return r.forEach(function(o){var s=o.replace(JPe,"").match(eke);s&&i.push({v:Sr(s[2]),t:s[1]})}),i}var ZQ=/(^\s|\s$|\n)/;function Vo(t,e){return"<"+t+(e.match(ZQ)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function V1(t){return pi(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ct(t,e,n){return"<"+t+(n!=null?V1(n):"")+(e!=null?(e.match(ZQ)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function EB(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(n){if(e)throw n}return""}function tke(t,e){switch(typeof t){case"string":var n=ct("vt:lpwstr",gr(t));return e&&(n=n.replace(/&quot;/g,"_x0022_")),n;case"number":return ct((t|0)==t?"vt:i4":"vt:r8",gr(String(t)));case"boolean":return ct("vt:bool",t?"true":"false")}if(t instanceof Date)return ct("vt:filetime",EB(t));throw new Error("Unable to serialize "+t)}function GB(t){if(In&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Sr(Sf(LB(t)));throw new Error("Bad input format: expected Buffer or string")}var B1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Qi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Op=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ba={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function nke(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,o=5;o>=0;--o)i=i*256+t[e+o];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function rke(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,i=0,o=0,s=r?-e:e;isFinite(s)?s==0?i=o=0:(i=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(e)?26985:0);for(var a=0;a<=5;++a,o/=256)t[n+a]=o&255;t[n+6]=(i&15)<<4|o&15,t[n+7]=i>>4|r}var UZ=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var i=0,o=t[0][r].length;i<o;i+=n)e.push.apply(e,t[0][r].slice(i,i+n));return e},WZ=In?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:kd(e)})):UZ(t)}:UZ,jZ=function(t,e,n){for(var r=[],i=e;i<n;i+=2)r.push(String.fromCharCode(Ad(t,i)));return r.join("").replace(os,"")},NA=In?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(os,""):jZ(t,e,n)}:jZ,$Z=function(t,e,n){for(var r=[],i=e;i<e+n;++i)r.push(("0"+t[i].toString(16)).slice(-2));return r.join("")},QQ=In?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):$Z(t,e,n)}:$Z,GZ=function(t,e,n){for(var r=[],i=e;i<n;i++)r.push(String.fromCharCode(Ov(t,i)));return r.join("")},Gv=In?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):GZ(e,n,r)}:GZ,JQ=function(t,e){var n=mo(t,e);return n>0?Gv(t,e+4,e+4+n-1):""},zB=JQ,eJ=function(t,e){var n=mo(t,e);return n>0?Gv(t,e+4,e+4+n-1):""},YB=eJ,tJ=function(t,e){var n=2*mo(t,e);return n>0?Gv(t,e+4,e+4+n-1):""},qB=tJ,nJ=function(e,n){var r=mo(e,n);return r>0?NA(e,n+4,n+4+r):""},KB=nJ,rJ=function(t,e){var n=mo(t,e);return n>0?Gv(t,e+4,e+4+n):""},XB=rJ,iJ=function(t,e){return nke(t,e)},yA=iJ,ZB=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};In&&(zB=function(e,n){if(!Buffer.isBuffer(e))return JQ(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},YB=function(e,n){if(!Buffer.isBuffer(e))return eJ(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},qB=function(e,n){if(!Buffer.isBuffer(e))return tJ(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},KB=function(e,n){if(!Buffer.isBuffer(e))return nJ(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},XB=function(e,n){if(!Buffer.isBuffer(e))return rJ(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},yA=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):iJ(e,n)},ZB=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function ike(){NA=function(t,e,n){return ur.utils.decode(1200,t.slice(e,n)).replace(os,"")},Gv=function(t,e,n){return ur.utils.decode(65001,t.slice(e,n))},zB=function(t,e){var n=mo(t,e);return n>0?ur.utils.decode(Vv,t.slice(e+4,e+4+n-1)):""},YB=function(t,e){var n=mo(t,e);return n>0?ur.utils.decode(fu,t.slice(e+4,e+4+n-1)):""},qB=function(t,e){var n=2*mo(t,e);return n>0?ur.utils.decode(1200,t.slice(e+4,e+4+n-1)):""},KB=function(t,e){var n=mo(t,e);return n>0?ur.utils.decode(1200,t.slice(e+4,e+4+n)):""},XB=function(t,e){var n=mo(t,e);return n>0?ur.utils.decode(65001,t.slice(e+4,e+4+n)):""}}typeof ur<"u"&&ike();var Ov=function(t,e){return t[e]},Ad=function(t,e){return t[e+1]*256+t[e]},oke=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},mo=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},_p=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},ske=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function R1(t,e){var n="",r,i,o=[],s,a,l,c;switch(e){case"dbcs":if(c=this.l,In&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)n+=String.fromCharCode(Ad(this,c)),c+=2;t*=2;break;case"utf8":n=Gv(this,this.l,this.l+t);break;case"utf16le":t*=2,n=NA(this,this.l,this.l+t);break;case"wstr":if(typeof ur<"u")n=ur.utils.decode(fu,this.slice(this.l,this.l+2*t));else return R1.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":n=zB(this,this.l),t=4+mo(this,this.l);break;case"lpstr-cp":n=YB(this,this.l),t=4+mo(this,this.l);break;case"lpwstr":n=qB(this,this.l),t=4+2*mo(this,this.l);break;case"lpp4":t=4+mo(this,this.l),n=KB(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+mo(this,this.l),n=XB(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(s=Ov(this,this.l+t++))!==0;)o.push(iA(s));n=o.join("");break;case"_wstr":for(t=0,n="";(s=Ad(this,this.l+t))!==0;)o.push(iA(s)),t+=2;t+=2,n=o.join("");break;case"dbcs-cont":for(n="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Ov(this,c),this.l=c+1,a=R1.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),o.join("")+a;o.push(iA(Ad(this,c))),c+=2}n=o.join(""),t*=2;break;case"cpstr":if(typeof ur<"u"){n=ur.utils.decode(fu,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(n="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=Ov(this,c),this.l=c+1,a=R1.call(this,t-l,s?"dbcs-cont":"sbcs-cont"),o.join("")+a;o.push(iA(Ov(this,c))),c+=1}n=o.join("");break;default:switch(t){case 1:return r=Ov(this,this.l),this.l++,r;case 2:return r=(e==="i"?oke:Ad)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(r=(t>0?_p:ske)(this,this.l),this.l+=4,r):(i=mo(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=yA(this,this.l):i=yA([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:n=QQ(this,this.l,t);break}}return this.l+=t,n}var ake=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},lke=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},cke=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function uke(t,e,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=e.length;++i)cke(this,e.charCodeAt(i),this.l+2*i);r=2*e.length}else if(n==="sbcs"){if(typeof ur<"u"&&Vv==874)for(i=0;i!=e.length;++i){var o=ur.utils.encode(Vv,e.charAt(i));this[this.l+i]=o[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;r=e.length}else if(n==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var a=e.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,ake(this,e,this.l);break;case 8:if(r=8,n==="f"){rke(this,e,this.l);break}case 16:break;case-4:r=4,lke(this,e,this.l);break}return this.l+=r,this}function oJ(t,e){var n=QQ(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function Ho(t,e){t.l=e,t.read_shift=R1,t.chk=oJ,t.write_shift=uke}function as(t,e){t.l+=e}function He(t){var e=wf(t);return Ho(e,0),e}function Fd(t,e,n){if(t){var r,i,o;Ho(t,t.l||0);for(var s=t.length,a=0,l=0;t.l<s;){a=t.read_shift(1),a&128&&(a=(a&127)+((t.read_shift(1)&127)<<7));var c=z1[a]||z1[65535];for(r=t.read_shift(1),o=r&127,i=1;i<4&&r&128;++i)o+=((r=t.read_shift(1))&127)<<7*i;l=t.l+o;var u=c.f&&c.f(t,o,n);if(t.l=l,e(u,c,a))return}}}function ra(){var t=[],e=In?256:2048,n=function(c){var u=He(c);return Ho(u,0),u},r=n(e),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},o=function(c){return r&&c<r.length-r.l?r:(i(),r=n(Math.max(c+1,e)))},s=function(){return i(),po(t)},a=function(c){i(),r=c,r.l==null&&(r.l=r.length),o(e)};return{next:o,push:a,end:s,_bufs:t}}function Ge(t,e,n,r){var i=+e,o;if(!isNaN(i)){r||(r=z1[i].p||(n||[]).length||0),o=1+(i>=128?1:0)+1,r>=128&&++o,r>=16384&&++o,r>=2097152&&++o;var s=t.next(o);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(r>=128)s.write_shift(1,(r&127)+128),r>>=7;else{s.write_shift(1,r);break}r>0&&ZB(n)&&t.push(n)}}function D1(t,e,n){var r=Hr(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function zZ(t,e,n){var r=Hr(t);return r.s=D1(r.s,e.s,n),r.e=D1(r.e,e.s,n),r}function I1(t,e){if(t.cRel&&t.c<0)for(t=Hr(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Hr(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=Xt(t);return!t.cRel&&t.cRel!=null&&(n=fke(n)),!t.rRel&&t.rRel!=null&&(n=dke(n)),n}function uB(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Qr(t.s.c)+":"+(t.e.cRel?"":"$")+Qr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+bi(t.s.r)+":"+(t.e.rRel?"":"$")+bi(t.e.r):I1(t.s,e.biff)+":"+I1(t.e,e.biff)}function QB(t){return parseInt(hke(t),10)-1}function bi(t){return""+(t+1)}function dke(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function hke(t){return t.replace(/\$(\d+)$/,"$1")}function JB(t){for(var e=mke(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function Qr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function fke(t){return t.replace(/^([A-Z])/,"$$$1")}function mke(t){return t.replace(/^\$([A-Z])/,"$1")}function pke(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Jr(t){for(var e=0,n=0,r=0;r<t.length;++r){var i=t.charCodeAt(r);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:e-1}}function Xt(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function ia(t){var e=t.indexOf(":");return e==-1?{s:Jr(t),e:Jr(t)}:{s:Jr(t.slice(0,e)),e:Jr(t.slice(e+1))}}function fn(t,e){return typeof e>"u"||typeof e=="number"?fn(t.s,t.e):(typeof t!="string"&&(t=Xt(t)),typeof e!="string"&&(e=Xt(e)),t==e?t:t+":"+e)}function qn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,o=t.length;for(n=0;r<o&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(e.s.c=--n,n=0;r<o&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(e.s.r=--n,r===o||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=o&&!((i=t.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(e.e.c=--n,n=0;r!=o&&!((i=t.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return e.e.r=--n,e}function YZ(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=hl(t.z,n?Ji(e):e)}catch{}try{return t.w=hl((t.XF||{}).numFmtId||(n?14:0),n?Ji(e):e)}catch{return""+e}}function Pd(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?Ld[t.v]||t.v:e==null?YZ(t,t.v):YZ(t,e))}function Ef(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function sJ(t,e,n){var r=n||{},i=t?Array.isArray(t):r.dense;mi!=null&&i==null&&(i=mi);var o=t||(i?[]:{}),s=0,a=0;if(o&&r.origin!=null){if(typeof r.origin=="number")s=r.origin;else{var l=typeof r.origin=="string"?Jr(r.origin):r.origin;s=l.r,a=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=qn(o["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var d=0;d!=e.length;++d)if(e[d]){if(!Array.isArray(e[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[d].length;++h)if(!(typeof e[d][h]>"u")){var f={v:e[d][h]},p=s+d,g=a+h;if(c.s.r>p&&(c.s.r=p),c.s.c>g&&(c.s.c=g),c.e.r<p&&(c.e.r=p),c.e.c<g&&(c.e.c=g),e[d][h]&&typeof e[d][h]=="object"&&!Array.isArray(e[d][h])&&!(e[d][h]instanceof Date))f=e[d][h];else if(Array.isArray(f.v)&&(f.f=e[d][h][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(r.nullError)f.t="e",f.v=0;else if(r.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=r.dateNF||Kt[14],r.cellDates?(f.t="d",f.w=hl(f.z,Ji(f.v))):(f.t="n",f.v=Ji(f.v),f.w=hl(f.z,f.v))):f.t="s";if(i)o[p]||(o[p]=[]),o[p][g]&&o[p][g].z&&(f.z=o[p][g].z),o[p][g]=f;else{var w=Xt({c:g,r:p});o[w]&&o[w].z&&(f.z=o[w].z),o[w]=f}}}return c.s.c<1e7&&(o["!ref"]=fn(c)),o}function zv(t,e){return sJ(null,t,e)}function gke(t){return t.read_shift(4,"i")}function uc(t,e){return e||(e=He(4)),e.write_shift(4,t),e}function ss(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function go(t,e){var n=!1;return e==null&&(n=!0,e=He(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}function vke(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function wke(t,e){return e||(e=He(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function e3(t,e){var n=t.l,r=t.read_shift(1),i=ss(t),o=[],s={t:i,h:i};if(r&1){for(var a=t.read_shift(4),l=0;l!=a;++l)o.push(vke(t));s.r=o}else s.r=[{ich:0,ifnt:0}];return t.l=n+e,s}function yke(t,e){var n=!1;return e==null&&(n=!0,e=He(15+4*t.t.length)),e.write_shift(1,0),go(t.t,e),n?e.slice(0,e.l):e}var _ke=e3;function Cke(t,e){var n=!1;return e==null&&(n=!0,e=He(23+4*t.t.length)),e.write_shift(1,1),go(t.t,e),e.write_shift(4,1),wke({ich:0,ifnt:0},e),n?e.slice(0,e.l):e}function fl(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function Np(t,e){return e==null&&(e=He(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Pp(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function kp(t,e){return e==null&&(e=He(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Ske=ss,aJ=go;function t3(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function _A(t,e){var n=!1;return e==null&&(n=!0,e=He(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}var Eke=ss,xB=t3,n3=_A;function r3(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var i=r===0?yA([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):_p(e,0)>>2;return n?i/100:i}function lJ(t,e){e==null&&(e=He(4));var n=0,r=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?r=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(r=1,n=1),r)e.write_shift(-4,((n?i:t)<<2)+(n+2));else throw new Error("unsupported RkNumber "+t)}function cJ(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function xke(t,e){return e||(e=He(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Fp=cJ,Yv=xke;function is(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Dp(t,e){return(e||He(8)).write_shift(8,t,"f")}function bke(t){var e={},n=t.read_shift(1),r=n>>>1,i=t.read_shift(1),o=t.read_shift(2,"i"),s=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=i;var c=Sp[i];c&&(e.rgb=W1(c));break;case 2:e.rgb=W1([s,a,l]);break;case 3:e.theme=i;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function CA(t,e){if(e||(e=He(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var n=t.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),e.write_shift(2,n),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=t.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function Tke(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function Rke(t,e){e||(e=He(2));var n=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,n),e.write_shift(1,0),e}function uJ(t,e){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=t.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[t.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Dke(t){return uJ(t,1)}function Ike(t){return uJ(t,2)}var i3=2,na=3,sA=11,qZ=12,SA=19;var aA=64,Ake=65,Mke=71;var Oke=4108,Nke=4126,fo=80,dJ=81,Pke=[fo,dJ],bB={1:{n:"CodePage",t:i3},2:{n:"Category",t:fo},3:{n:"PresentationFormat",t:fo},4:{n:"ByteCount",t:na},5:{n:"LineCount",t:na},6:{n:"ParagraphCount",t:na},7:{n:"SlideCount",t:na},8:{n:"NoteCount",t:na},9:{n:"HiddenCount",t:na},10:{n:"MultimediaClipCount",t:na},11:{n:"ScaleCrop",t:sA},12:{n:"HeadingPairs",t:Oke},13:{n:"TitlesOfParts",t:Nke},14:{n:"Manager",t:fo},15:{n:"Company",t:fo},16:{n:"LinksUpToDate",t:sA},17:{n:"CharacterCount",t:na},19:{n:"SharedDoc",t:sA},22:{n:"HyperlinksChanged",t:sA},23:{n:"AppVersion",t:na,p:"version"},24:{n:"DigSig",t:Ake},26:{n:"ContentType",t:fo},27:{n:"ContentStatus",t:fo},28:{n:"Language",t:fo},29:{n:"Version",t:fo},255:{},2147483648:{n:"Locale",t:SA},2147483651:{n:"Behavior",t:SA},1919054434:{}},TB={1:{n:"CodePage",t:i3},2:{n:"Title",t:fo},3:{n:"Subject",t:fo},4:{n:"Author",t:fo},5:{n:"Keywords",t:fo},6:{n:"Comments",t:fo},7:{n:"Template",t:fo},8:{n:"LastAuthor",t:fo},9:{n:"RevNumber",t:fo},10:{n:"EditTime",t:aA},11:{n:"LastPrinted",t:aA},12:{n:"CreatedDate",t:aA},13:{n:"ModifiedDate",t:aA},14:{n:"PageCount",t:na},15:{n:"WordCount",t:na},16:{n:"CharCount",t:na},17:{n:"Thumbnail",t:Mke},18:{n:"Application",t:fo},19:{n:"DocSecurity",t:na},255:{},2147483648:{n:"Locale",t:SA},2147483651:{n:"Behavior",t:SA},1919054434:{}},KZ={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},kke=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Fke(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Lke=Fke([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Sp=Hr(Lke),Ld={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},hJ={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},RB={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},lA={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function o3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Hke(t){var e=o3();if(!t||!t.match)return e;var n={};if((t.match(ls)||[]).forEach(function(r){var i=Zt(r);switch(i[0].replace(YPe,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[i.Extension]=i.ContentType;break;case"<Override":e[RB[i.ContentType]]!==void 0&&e[RB[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Qi.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=n,delete e.calcchains,e}function fJ(t,e){var n=HPe(RB),r=[],i;r[r.length]=Ti,r[r.length]=ct("Types",null,{xmlns:Qi.CT,"xmlns:xsd":Qi.xsd,"xmlns:xsi":Qi.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return ct("Default",null,{Extension:l[0],ContentType:l[1]})}));var o=function(l){t[l]&&t[l].length>0&&(i=t[l][0],r[r.length]=ct("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:lA[l][e.bookType]||lA[l].xlsx}))},s=function(l){(t[l]||[]).forEach(function(c){r[r.length]=ct("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:lA[l][e.bookType]||lA[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(c){r[r.length]=ct("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:n[l][0]})})};return o("workbooks"),s("sheets"),s("charts"),a("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),s("metadata"),a("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var Cn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function U1(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function A1(t,e){var n={"!id":{}};if(!t)return n;e.charAt(0)!=="/"&&(e="/"+e);var r={};return(t.match(ls)||[]).forEach(function(i){var o=Zt(i);if(o[0]==="<Relationship"){var s={};s.Type=o.Type,s.Target=o.Target,s.Id=o.Id,o.TargetMode&&(s.TargetMode=o.TargetMode);var a=o.TargetMode==="External"?o.Target:T1(o.Target,e);n[a]=s,r[o.Id]=s}}),n["!id"]=r,n}function Fv(t){var e=[Ti,ct("Relationships",null,{xmlns:Qi.RELS})];return pi(t["!id"]).forEach(function(n){e[e.length]=ct("Relationship",null,t["!id"][n])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function pr(t,e,n,r,i,o){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=r,i.Target=n,o?i.TargetMode=o:[Cn.HLINK,Cn.XPATH,Cn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var Vke="application/vnd.oasis.opendocument.spreadsheet";function Bke(t,e){for(var n=GB(t),r,i;r=B1.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(i=Zt(r[0],!1),i.path=="/"&&i.type!==Vke)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw r}}function Uke(t){var e=[Ti];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<t.length;++n)e.push('  <manifest:file-entry manifest:full-path="'+t[n][0]+'" manifest:media-type="'+t[n][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function XZ(t,e,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Wke(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function jke(t){var e=[Ti];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=t.length;++n)e.push(XZ(t[n][0],t[n][1])),e.push(Wke("",t[n][0]));return e.push(XZ("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function mJ(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+k1.version+"</meta:generator></office:meta></office:document-meta>"}var dl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],$ke=function(){for(var t=new Array(dl.length),e=0;e<dl.length;++e){var n=dl[e],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);t[e]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return t}();function pJ(t){var e={};t=Sr(t);for(var n=0;n<dl.length;++n){var r=dl[n],i=t.match($ke[n]);i!=null&&i.length>0&&(e[r[1]]=Yn(i[1])),r[2]==="date"&&e[r[1]]&&(e[r[1]]=Lr(e[r[1]]))}return e}function dB(t,e,n,r,i){i[t]!=null||e==null||e===""||(i[t]=e,e=gr(e),r[r.length]=n?ct(t,e,n):Vo(t,e))}function gJ(t,e){var n=e||{},r=[Ti,ct("cp:coreProperties",null,{"xmlns:cp":Qi.CORE_PROPS,"xmlns:dc":Qi.dc,"xmlns:dcterms":Qi.dcterms,"xmlns:dcmitype":Qi.dcmitype,"xmlns:xsi":Qi.xsi})],i={};if(!t&&!n.Props)return r.join("");t&&(t.CreatedDate!=null&&dB("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:EB(t.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),t.ModifiedDate!=null&&dB("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:EB(t.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var o=0;o!=dl.length;++o){var s=dl[o],a=n.Props&&n.Props[s[1]]!=null?n.Props[s[1]]:t?t[s[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&dB(s[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ep=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],vJ=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wJ(t,e,n,r){var i=[];if(typeof t=="string")i=BZ(t,r);else for(var o=0;o<t.length;++o)i=i.concat(t[o].map(function(u){return{v:u}}));var s=typeof e=="string"?BZ(e,r).map(function(u){return u.v}):e,a=0,l=0;if(s.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":n.Worksheets=l,n.SheetNames=s.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":n.NamedRanges=l,n.DefinedNames=s.slice(a,a+l);break;case"Charts":case"Diagramme":n.Chartsheets=l,n.ChartNames=s.slice(a,a+l);break}a+=l}}function Gke(t,e,n){var r={};return e||(e={}),t=Sr(t),Ep.forEach(function(i){var o=(t.match(H1(i[0]))||[])[1];switch(i[2]){case"string":o&&(e[i[1]]=Yn(o));break;case"bool":e[i[1]]=o==="true";break;case"raw":var s=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(r[i[1]]=s[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&wJ(r.HeadingPairs,r.TitlesOfParts,e,n),e}function yJ(t){var e=[],n=ct;return t||(t={}),t.Application="SheetJS",e[e.length]=Ti,e[e.length]=ct("Properties",null,{xmlns:Qi.EXT_PROPS,"xmlns:vt":Qi.vt}),Ep.forEach(function(r){if(t[r[1]]!==void 0){var i;switch(r[2]){case"string":i=gr(String(t[r[1]]));break;case"bool":i=t[r[1]]?"true":"false";break}i!==void 0&&(e[e.length]=n(r[0],i))}}),e[e.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=n("TitlesOfParts",n("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+gr(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var zke=/<[^>]+>[^<]*/g;function Yke(t,e){var n={},r="",i=t.match(zke);if(i)for(var o=0;o!=i.length;++o){var s=i[o],a=Zt(s);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":r=Yn(a.name);break;case"</property>":r=null;break;default:if(s.indexOf("<vt:")===0){var l=s.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":n[r]=Yn(u);break;case"bool":n[r]=Fr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(u,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(u);break;case"filetime":case"date":n[r]=Lr(u);break;case"cy":case"error":n[r]=Yn(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",s,c,l)}}else if(s.slice(0,2)!=="</"){if(e.WTF)throw new Error(s)}}}return n}function _J(t){var e=[Ti,ct("Properties",null,{xmlns:Qi.CUST_PROPS,"xmlns:vt":Qi.vt})];if(!t)return e.join("");var n=1;return pi(t).forEach(function(i){++n,e[e.length]=ct("property",tke(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:gr(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var DB={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},hB;function qke(t,e,n){hB||(hB=AA(DB)),e=hB[e]||e,t[e]=n}function Kke(t,e){var n=[];return pi(DB).map(function(r){for(var i=0;i<dl.length;++i)if(dl[i][1]==r)return dl[i];for(i=0;i<Ep.length;++i)if(Ep[i][1]==r)return Ep[i];throw r}).forEach(function(r){if(t[r[1]]!=null){var i=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:t[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Vo(DB[r[1]]||r[1],i))}}),ct("DocumentProperties",n.join(""),{xmlns:ba.o})}function Xke(t,e){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return t&&pi(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var s=0;s<dl.length;++s)if(o==dl[s][1])return;for(s=0;s<Ep.length;++s)if(o==Ep[s][1])return;for(s=0;s<n.length;++s)if(o==n[s])return;var a=t[o],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(ct(FZ(o),a,{"dt:dt":l}))}}),e&&pi(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var s=e[o],a="string";typeof s=="number"?(a="float",s=String(s)):s===!0||s===!1?(a="boolean",s=s?"1":"0"):s instanceof Date?(a="dateTime.tz",s=s.toISOString()):s=String(s),i.push(ct(FZ(o),s,{"dt:dt":a}))}}),"<"+r+' xmlns="'+ba.o+'">'+i.join("")+"</"+r+">"}function s3(t){var e=t.read_shift(4),n=t.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Zke(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,n=e.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var o=r/Math.pow(2,32)|0;o>0&&(r=r%Math.pow(2,32),i+=o);var s=He(8);return s.write_shift(4,r),s.write_shift(4,i),s}function CJ(t,e,n){var r=t.l,i=t.read_shift(0,"lpstr-cp");if(n)for(;t.l-r&3;)++t.l;return i}function SJ(t,e,n){var r=t.read_shift(0,"lpwstr");return n&&(t.l+=4-(r.length+1&3)&3),r}function EJ(t,e,n){return e===31?SJ(t):CJ(t,e,n)}function IB(t,e,n){return EJ(t,e,n===!1?0:4)}function Qke(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return EJ(t,e,0)}function Jke(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r){var i=t.l;n[r]=t.read_shift(0,"lpwstr").replace(os,""),t.l-i&2&&(t.l+=2)}return n}function eFe(t){for(var e=t.read_shift(4),n=[],r=0;r!=e;++r)n[r]=t.read_shift(0,"lpstr-cp").replace(os,"");return n}function tFe(t){var e=t.l,n=EA(t,dJ);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var r=EA(t,na);return[n,r]}function nFe(t){for(var e=t.read_shift(4),n=[],r=0;r<e/2;++r)n.push(tFe(t));return n}function ZZ(t,e){for(var n=t.read_shift(4),r={},i=0;i!=n;++i){var o=t.read_shift(4),s=t.read_shift(4);r[o]=t.read_shift(s,e===1200?"utf16le":"utf8").replace(os,"").replace(b1,"!"),e===1200&&s%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>2+1<<2),r}function xJ(t){var e=t.read_shift(4),n=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),n}function rFe(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function EA(t,e,n){var r=t.read_shift(2),i,o=n||{};if(t.l+=2,e!==qZ&&r!==e&&Pke.indexOf(e)===-1&&!((e&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+e+" saw "+r);switch(e===qZ?r:e){case 2:return i=t.read_shift(2,"i"),o.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return CJ(t,r,4).replace(os,"");case 31:return SJ(t);case 64:return s3(t);case 65:return xJ(t);case 71:return rFe(t);case 80:return IB(t,r,!o.raw).replace(os,"");case 81:return Qke(t,r).replace(os,"");case 4108:return nFe(t);case 4126:case 4127:return r==4127?Jke(t):eFe(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}}function QZ(t,e){var n=He(4),r=He(4);switch(n.write_shift(4,t==80?31:t),t){case 3:r.write_shift(-4,e);break;case 5:r=He(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=Zke(e);break;case 31:case 80:for(r=He(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return po([n,r])}function JZ(t,e){var n=t.l,r=t.read_shift(4),i=t.read_shift(4),o=[],s=0,a=0,l=-1,c={};for(s=0;s!=i;++s){var u=t.read_shift(4),d=t.read_shift(4);o[s]=[u,d+n]}o.sort(function(S,x){return S[1]-x[1]});var h={};for(s=0;s!=i;++s){if(t.l!==o[s][1]){var f=!0;if(s>0&&e)switch(e[o[s-1][0]].t){case 2:t.l+2===o[s][1]&&(t.l+=2,f=!1);break;case 80:t.l<=o[s][1]&&(t.l=o[s][1],f=!1);break;case 4108:t.l<=o[s][1]&&(t.l=o[s][1],f=!1);break}if((!e||s==0)&&t.l<=o[s][1]&&(f=!1,t.l=o[s][1]),f)throw new Error("Read Error: Expected address "+o[s][1]+" at "+t.l+" :"+s)}if(e){var p=e[o[s][0]];if(h[p.n]=EA(t,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ac(a=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(o[s][0]===1){if(a=h.CodePage=EA(t,i3),ac(a),l!==-1){var g=t.l;t.l=o[l][1],c=ZZ(t,a),t.l=g}}else if(o[s][0]===0){if(a===0){l=s,t.l=o[s+1][1];continue}c=ZZ(t,a)}else{var w=c[o[s][0]],_;switch(t[t.l]){case 65:t.l+=4,_=xJ(t);break;case 30:t.l+=4,_=IB(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,_=IB(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,_=t.read_shift(4,"i");break;case 19:t.l+=4,_=t.read_shift(4);break;case 5:t.l+=4,_=t.read_shift(8,"f");break;case 11:t.l+=4,_=xi(t,4);break;case 64:t.l+=4,_=Lr(s3(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[w]=_}}return t.l=n+r,h}var bJ=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function iFe(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function eQ(t,e,n){var r=He(8),i=[],o=[],s=8,a=0,l=He(8),c=He(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),o.push(l),i.push(c),s+=8+l.length,!e){c=He(8),c.write_shift(4,0),i.unshift(c);var u=[He(4)];for(u[0].write_shift(4,t.length),a=0;a<t.length;++a){var d=t[a][0];for(l=He(4+4+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=po(u),o.unshift(l),s+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(bJ.indexOf(t[a][0])>-1||vJ.indexOf(t[a][0])>-1)&&t[a][1]!=null){var h=t[a][1],f=0;if(e){f=+e[t[a][0]];var p=n[f];if(p.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}l=QZ(p.t,h)}else{var w=iFe(h);w==-1&&(w=31,h=String(h)),l=QZ(w,h)}o.push(l),c=He(8),c.write_shift(4,e?f:2+a),i.push(c),s+=8+l.length}var _=8*(o.length+1);for(a=0;a<o.length;++a)i[a].write_shift(4,_),_+=o[a].length;return r.write_shift(4,s),r.write_shift(4,o.length),po([r].concat(i).concat(o))}function tQ(t,e,n){var r=t.content;if(!r)return{};Ho(r,0);var i,o,s,a,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var c=r.read_shift(4),u=r.read_shift(16);if(u!==Vt.utils.consts.HEADER_CLSID&&u!==n)throw new Error("Bad PropertySet CLSID "+u);if(i=r.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=r.read_shift(16),a=r.read_shift(4),i===1&&a!==r.l)throw new Error("Length mismatch: "+a+" !== "+r.l);i===2&&(s=r.read_shift(16),l=r.read_shift(4));var d=JZ(r,e),h={SystemIdentifier:c};for(var f in d)h[f]=d[f];if(h.FMTID=o,i===1)return h;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);var p;try{p=JZ(r,null)}catch{}for(f in p)h[f]=p[f];return h.FMTID=[o,s],h}function nQ(t,e,n,r,i,o){var s=He(i?68:48),a=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,Vt.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,e,"hex"),s.write_shift(4,i?68:48);var l=eQ(t,n,r);if(a.push(l),i){var c=eQ(i,null,null);s.write_shift(16,o,"hex"),s.write_shift(4,68+l.length),a.push(c)}return po(a)}function pf(t,e){return t.read_shift(e),null}function oFe(t,e){e||(e=He(t));for(var n=0;n<t;++n)e.write_shift(1,0);return e}function sFe(t,e,n){for(var r=[],i=t.l+e;t.l<i;)r.push(n(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return r}function xi(t,e){return t.read_shift(e)===1}function Ns(t,e){return e||(e=He(2)),e.write_shift(2,+!!t),e}function Hi(t){return t.read_shift(2,"u")}function ul(t,e){return e||(e=He(2)),e.write_shift(2,t),e}function TJ(t,e){return sFe(t,e,Hi)}function aFe(t){var e=t.read_shift(1),n=t.read_shift(1);return n===1?e:e===1}function RJ(t,e,n){return n||(n=He(2)),n.write_shift(1,e=="e"?+t:+!!t),n.write_shift(1,e=="e"?1:0),n}function X1(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont",o=fu;if(n&&n.biff>=8&&(fu=1200),!n||n.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var a=r?t.read_shift(r,i):"";return fu=o,a}function lFe(t){var e=fu;fu=1200;var n=t.read_shift(2),r=t.read_shift(1),i=r&4,o=r&8,s=1+(r&1),a=0,l,c={};o&&(a=t.read_shift(2)),i&&(l=t.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=n===0?"":t.read_shift(n,u);return o&&(t.l+=4*a),i&&(t.l+=l),c.t=d,o||(c.raw="<t>"+c.t+"</t>",c.r=c.t),fu=e,c}function cFe(t){var e=t.t||"",n=1,r=He(3+(n>1?2:0));r.write_shift(2,e.length),r.write_shift(1,(n>1?8:0)|1),n>1&&r.write_shift(2,n);var i=He(2*e.length);i.write_shift(2*e.length,e,"utf16le");var o=[r,i];return po(o)}function Ip(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function Z1(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):Ip(t,r,n)}function Lp(t,e,n){if(n.biff>5)return Z1(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function DJ(t,e,n){return n||(n=He(3+2*t.length)),n.write_shift(2,t.length),n.write_shift(1,1),n.write_shift(31,t,"utf16le"),n}function uFe(t){var e=t.read_shift(1);t.l++;var n=t.read_shift(2);return t.l+=2,[e,n]}function dFe(t){var e=t.read_shift(4),n=t.l,r=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),t.l=n);var i=t.read_shift((r?e-24:e)>>1,"utf16le").replace(os,"");return r&&(t.l+=24),i}function hFe(t){for(var e=t.read_shift(2),n="";e-- >0;)n+="../";var r=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return n+r.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=t.read_shift(o>>1,"utf16le").replace(os,"");return n+s}function fFe(t,e){var n=t.read_shift(16);switch(e-=16,n){case"e0c9ea79f9bace118c8200aa004ba90b":return dFe(t,e);case"0303000000000000c000000000000046":return hFe(t,e);default:throw new Error("Unsupported Moniker "+n)}}function cA(t){var e=t.read_shift(4),n=e>0?t.read_shift(e,"utf16le").replace(os,""):"";return n}function rQ(t,e){e||(e=He(6+t.length*2)),e.write_shift(4,1+t.length);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function mFe(t,e){var n=t.l+e,r=t.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var i=t.read_shift(2);t.l+=2;var o,s,a,l,c="",u,d;i&16&&(o=cA(t,n-t.l)),i&128&&(s=cA(t,n-t.l)),(i&257)===257&&(a=cA(t,n-t.l)),(i&257)===1&&(l=fFe(t,n-t.l)),i&8&&(c=cA(t,n-t.l)),i&32&&(u=t.read_shift(16)),i&64&&(d=s3(t)),t.l=n;var h=s||a||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var f={Target:h};return u&&(f.guid=u),d&&(f.time=d),o&&(f.Tooltip=o),f}function pFe(t){var e=He(512),n=0,r=t.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),o=i>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var s=[8,6815827,6619237,4849780,83];for(n=0;n<s.length;++n)e.write_shift(4,s[n]);if(o==28)r=r.slice(1),rQ(r,e);else if(o&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<s.length;++n)e.write_shift(1,parseInt(s[n],16));var a=i>-1?r.slice(0,i):r;for(e.write_shift(4,2*(a.length+1)),n=0;n<a.length;++n)e.write_shift(2,a.charCodeAt(n));e.write_shift(2,0),o&8&&rQ(i>-1?r.slice(i+1):"",e)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<s.length;++n)e.write_shift(1,parseInt(s[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)e.write_shift(1,r.charCodeAt(n+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),n=0;n<6;++n)e.write_shift(4,0)}return e.slice(0,e.l)}function IJ(t){var e=t.read_shift(1),n=t.read_shift(1),r=t.read_shift(1),i=t.read_shift(1);return[e,n,r,i]}function AJ(t,e){var n=IJ(t,e);return n[3]=0,n}function pu(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return{r:e,c:n,ixfe:r}}function Ap(t,e,n,r){return r||(r=He(6)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n||0),r}function gFe(t){var e=t.read_shift(2),n=t.read_shift(2);return t.l+=8,{type:e,flags:n}}function vFe(t,e,n){return e===0?"":Lp(t,e,n)}function wFe(t,e,n){var r=n.biff>8?4:2,i=t.read_shift(r),o=t.read_shift(r,"i"),s=t.read_shift(r,"i");return[i,o,s]}function MJ(t){var e=t.read_shift(2),n=r3(t);return[e,n]}function yFe(t,e,n){t.l+=4,e-=4;var r=t.l+e,i=X1(t,e,n),o=t.read_shift(2);if(r-=t.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return t.l+=o,i}function PA(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2);return{s:{c:r,r:e},e:{c:i,r:n}}}function OJ(t,e){return e||(e=He(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function NJ(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(1),i=t.read_shift(1);return{s:{c:r,r:e},e:{c:i,r:n}}}var _Fe=NJ;function PJ(t){t.l+=4;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2);return t.l+=12,[n,e,r]}function CFe(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function SFe(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function es(t){t.l+=2,t.l+=t.read_shift(2)}var EFe={0:es,4:es,5:es,6:es,7:SFe,8:es,9:es,10:es,11:es,12:es,13:CFe,14:es,15:es,16:es,17:es,18:es,19:es,20:es,21:PJ};function xFe(t,e){for(var n=t.l+e,r=[];t.l<n;){var i=t.read_shift(2);t.l-=2;try{r.push(EFe[i](t,n-t.l))}catch{return t.l=n,r}}return t.l!=n&&(t.l=n),r}function uA(t,e){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=t.read_shift(2),e-=2,e>=2&&(n.dt=t.read_shift(2),t.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return t.read_shift(e),n}function a3(t,e,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=He(i);return o.write_shift(2,r),o.write_shift(2,e),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function bFe(t,e){return e===0||t.read_shift(2),1200}function TFe(t,e,n){if(n.enc)return t.l+=e,"";var r=t.l,i=Lp(t,0,n);return t.read_shift(e+r-t.l),i}function RFe(t,e){var n=!e||e.biff==8,r=He(n?112:54);for(r.write_shift(e.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function DFe(t,e,n){var r=n&&n.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function IFe(t,e,n){var r=t.read_shift(4),i=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var s=X1(t,0,n);return s.length===0&&(s="Sheet1"),{pos:r,hs:i,dt:o,name:s}}function AFe(t,e){var n=!e||e.biff>=8?2:1,r=He(8+n*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(n*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function MFe(t,e){for(var n=t.l+e,r=t.read_shift(4),i=t.read_shift(4),o=[],s=0;s!=i&&t.l<n;++s)o.push(lFe(t));return o.Count=r,o.Unique=i,o}function OFe(t,e){var n=He(8);n.write_shift(4,t.Count),n.write_shift(4,t.Unique);for(var r=[],i=0;i<t.length;++i)r[i]=cFe(t[i],e);var o=po([n].concat(r));return o.parts=[n.length].concat(r.map(function(s){return s.length})),o}function NFe(t,e){var n={};return n.dsst=t.read_shift(2),t.l+=e-2,n}function PFe(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var n=t.read_shift(2);t.l+=4;var r=t.read_shift(1);return t.l+=3,r&7&&(e.level=r&7),r&32&&(e.hidden=!0),r&64&&(e.hpt=n/20),e}function kFe(t){var e=gFe(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var n=t.read_shift(4);return n!==0}function FFe(t){return t.read_shift(2),t.read_shift(4)}function iQ(t,e,n){var r=0;n&&n.biff==2||(r=t.read_shift(2));var i=t.read_shift(2);n&&n.biff==2&&(r=1-(i>>15),i&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,i]}function LFe(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,n],Dim:[r,i],Flags:o,CurTab:s,FirstTab:a,Selected:l,TabRatio:c}}function HFe(){var t=He(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function VFe(t,e,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=t.read_shift(2);return{RTL:r&64}}function BFe(t){var e=He(18),n=1718;return t&&t.RTL&&(n|=64),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function UFe(){}function WFe(t,e,n){var r={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return r.name=X1(t,0,n),r}function jFe(t,e){var n=t.name||"Arial",r=e&&e.biff==5,i=r?15+n.length:16+2*n.length,o=He(i);return o.write_shift(2,(t.sz||12)*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,n.length),r||o.write_shift(1,1),o.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),o}function $Fe(t){var e=pu(t);return e.isst=t.read_shift(4),e}function GFe(t,e,n,r){var i=He(10);return Ap(t,e,r,i),i.write_shift(4,n),i}function zFe(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=t.l+e,i=pu(t,6);n.biff==2&&t.l++;var o=Z1(t,r-t.l,n);return i.val=o,i}function YFe(t,e,n,r,i){var o=!i||i.biff==8,s=He(6+2+ +o+(1+o)*n.length);return Ap(t,e,r,s),s.write_shift(2,n.length),o&&s.write_shift(1,1),s.write_shift((1+o)*n.length,n,o?"utf16le":"sbcs"),s}function qFe(t,e,n){var r=t.read_shift(2),i=Lp(t,0,n);return[r,i]}function KFe(t,e,n,r){var i=n&&n.biff==5;r||(r=He(i?3+e.length:5+2*e.length)),r.write_shift(2,t),r.write_shift(i?1:2,e.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return o.l==null&&(o.l=o.length),o}var XFe=Lp;function oQ(t,e,n){var r=t.l+e,i=n.biff==8||!n.biff?4:2,o=t.read_shift(i),s=t.read_shift(i),a=t.read_shift(2),l=t.read_shift(2);return t.l=r,{s:{r:o,c:a},e:{r:s,c:l}}}function ZFe(t,e){var n=e.biff==8||!e.biff?4:2,r=He(2*n+6);return r.write_shift(n,t.s.r),r.write_shift(n,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}function QFe(t){var e=t.read_shift(2),n=t.read_shift(2),r=MJ(t);return{r:e,c:n,ixfe:r[0],rknum:r[1]}}function JFe(t,e){for(var n=t.l+e-2,r=t.read_shift(2),i=t.read_shift(2),o=[];t.l<n;)o.push(MJ(t));if(t.l!==n)throw new Error("MulRK read error");var s=t.read_shift(2);if(o.length!=s-i+1)throw new Error("MulRK length mismatch");return{r,c:i,C:s,rkrec:o}}function e2e(t,e){for(var n=t.l+e-2,r=t.read_shift(2),i=t.read_shift(2),o=[];t.l<n;)o.push(t.read_shift(2));if(t.l!==n)throw new Error("MulBlank read error");var s=t.read_shift(2);if(o.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r,c:i,C:s,ixfe:o}}function t2e(t,e,n,r){var i={},o=t.read_shift(4),s=t.read_shift(4),a=t.read_shift(4),l=t.read_shift(2);return i.patternType=kke[a>>26],r.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function n2e(t,e,n){var r={};return r.ifnt=t.read_shift(2),r.numFmtId=t.read_shift(2),r.flags=t.read_shift(2),r.fStyle=r.flags>>2&1,e-=6,r.data=t2e(t,e,r.fStyle,n),r}function sQ(t,e,n,r){var i=n&&n.biff==5;r||(r=He(i?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,e<<4));var o=0;return t.numFmtId>0&&i&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function r2e(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function i2e(t){var e=He(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function aQ(t,e,n){var r=pu(t,6);(n.biff==2||e==9)&&++t.l;var i=aFe(t,2);return r.val=i,r.t=i===!0||i===!1?"b":"e",r}function o2e(t,e,n,r,i,o){var s=He(8);return Ap(t,e,r,s),RJ(n,o,s),s}function s2e(t,e,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=pu(t,6),i=is(t,8);return r.val=i,r}function a2e(t,e,n,r){var i=He(14);return Ap(t,e,r,i),Dp(n,i),i}var lQ=vFe;function l2e(t,e,n){var r=t.l+e,i=t.read_shift(2),o=t.read_shift(2);if(n.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var s=Ip(t,o),a=[];r>t.l;)a.push(Z1(t));return[o,i,s,a]}function cQ(t,e,n){var r=t.read_shift(2),i,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(i=yFe(t,e-2,n)),o.body=i||t.read_shift(e-2),typeof i=="string"&&(o.Name=i),o}var c2e=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function uQ(t,e,n){var r=t.l+e,i=t.read_shift(2),o=t.read_shift(1),s=t.read_shift(1),a=t.read_shift(n&&n.biff==2?1:2),l=0;(!n||n.biff>=5)&&(n.biff!=5&&(t.l+=2),l=t.read_shift(2),n.biff==5&&(t.l+=2),t.l+=4);var c=Ip(t,s,n);i&32&&(c=c2e[c.charCodeAt(0)]);var u=r-t.l;n&&n.biff==2&&--u;var d=r==t.l||a===0||!(u>0)?[]:xBe(t,u,n,a);return{chKey:o,Name:c,itab:l,rgce:d}}function kJ(t,e,n){if(n.biff<8)return u2e(t,e,n);for(var r=[],i=t.l+e,o=t.read_shift(n.biff>8?4:2);o--!==0;)r.push(wFe(t,n.biff>8?12:6,n));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return r}function u2e(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=X1(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function d2e(t,e,n){if(n.biff<8){t.l+=e;return}var r=t.read_shift(2),i=t.read_shift(2),o=Ip(t,r,n),s=Ip(t,i,n);return[o,s]}function h2e(t,e,n){var r=NJ(t,6);t.l++;var i=t.read_shift(1);return e-=8,[bBe(t,e,n),i,r]}function dQ(t,e,n){var r=_Fe(t,6);switch(n.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[r,SBe(t,e,n,r)]}function f2e(t){var e=t.read_shift(4)!==0,n=t.read_shift(4)!==0,r=t.read_shift(4);return[e,n,r]}function m2e(t,e,n){if(!(n.biff<8)){var r=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),s=t.read_shift(2),a=Lp(t,0,n);return n.biff<8&&t.read_shift(1),[{r,c:i},a,s,o]}}function p2e(t,e,n){return m2e(t,e,n)}function g2e(t,e){for(var n=[],r=t.read_shift(2);r--;)n.push(PA(t,e));return n}function v2e(t){var e=He(2+t.length*8);e.write_shift(2,t.length);for(var n=0;n<t.length;++n)OJ(t[n],e);return e}function w2e(t,e,n){if(n&&n.biff<8)return _2e(t,e,n);var r=PJ(t,22),i=xFe(t,e-22,r[1]);return{cmo:r,ft:i}}var y2e={8:function(t,e){var n=t.l+e;t.l+=10;var r=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=n,{fmt:r}}};function _2e(t,e,n){t.l+=4;var r=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var s=[];return s.push((y2e[r]||as)(t,e,n)),{cmo:[i,r,o],ft:s}}function C2e(t,e,n){var r=t.l,i="";try{t.l+=4;var o=(n.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:s=uFe(t,6,n);var a=t.read_shift(2);t.read_shift(2),Hi(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-r!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],d=Ip(t,t.lens[c+1]-t.lens[c]-1);if(i+=d,i.length>=(u?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return t.l=r+e,{t:i}}catch{return t.l=r+e,{t:i}}}function S2e(t,e){var n=PA(t,8);t.l+=16;var r=mFe(t,e-24);return[n,r]}function E2e(t){var e=He(24),n=Jr(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(r[i],16));return po([e,pFe(t[1])])}function x2e(t,e){t.read_shift(2);var n=PA(t,8),r=t.read_shift((e-10)/2,"dbcs-cont");return r=r.replace(os,""),[n,r]}function b2e(t){var e=t[1].Tooltip,n=He(10+2*(e.length+1));n.write_shift(2,2048);var r=Jr(t[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<e.length;++i)n.write_shift(2,e.charCodeAt(i));return n.write_shift(2,0),n}function T2e(t){var e=[0,0],n;return n=t.read_shift(2),e[0]=KZ[n]||n,n=t.read_shift(2),e[1]=KZ[n]||n,e}function R2e(t){return t||(t=He(4)),t.write_shift(2,1),t.write_shift(2,1),t}function D2e(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(AJ(t,8));return n}function I2e(t){for(var e=t.read_shift(2),n=[];e-- >0;)n.push(AJ(t,8));return n}function A2e(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function FJ(t,e,n){if(!n.cellStyles)return as(t,e);var r=n&&n.biff>=12?4:2,i=t.read_shift(r),o=t.read_shift(r),s=t.read_shift(r),a=t.read_shift(r),l=t.read_shift(2);r==2&&(t.l+=2);var c={s:i,e:o,w:s,ixfe:a,flags:l};return(n.biff>=5||!n.biff)&&(c.level=l>>8&7),c}function M2e(t,e){var n=He(12);n.write_shift(2,e),n.write_shift(2,e),n.write_shift(2,t.width*256),n.write_shift(2,0);var r=0;return t.hidden&&(r|=1),n.write_shift(1,r),r=t.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function O2e(t,e){var n={};return e<32||(t.l+=16,n.header=is(t,8),n.footer=is(t,8),t.l+=2),n}function N2e(t,e,n){var r={area:!1};if(n.biff!=5)return t.l+=e,r;var i=t.read_shift(1);return t.l+=3,i&16&&(r.area=!0),r}function P2e(t){for(var e=He(2*t),n=0;n<t;++n)e.write_shift(2,n+1);return e}var k2e=pu,F2e=TJ,L2e=Z1;function H2e(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),i={fmt:e,env:n,len:r,data:t.slice(t.l,t.l+r)};return t.l+=r,i}function V2e(t,e,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=pu(t,6);++t.l;var i=Lp(t,e-7,n);return r.t="str",r.val=i,r}function B2e(t){var e=pu(t,6);++t.l;var n=is(t,8);return e.t="n",e.val=n,e}function U2e(t,e,n){var r=He(15);return tS(r,t,e),r.write_shift(8,n,"f"),r}function W2e(t){var e=pu(t,6);++t.l;var n=t.read_shift(2);return e.t="n",e.val=n,e}function j2e(t,e,n){var r=He(9);return tS(r,t,e),r.write_shift(2,n),r}function $2e(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function G2e(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function z2e(t,e,n){var r=t.l+e,i=pu(t,6),o=t.read_shift(2),s=Ip(t,o,n);return t.l=r,i.t="str",i.val=s,i}var Y2e=[2,3,48,49,131,139,140,245],AB=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=AA({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(a,l){var c=[],u=wf(1);switch(l.type){case"base64":u=Ta(Da(a));break;case"binary":u=Ta(a);break;case"buffer":case"array":u=a;break}Ho(u,0);var d=u.read_shift(1),h=!!(d&136),f=!1,p=!1;switch(d){case 2:break;case 3:break;case 48:f=!0,h=!0;break;case 49:f=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,w=521;d==2&&(g=u.read_shift(2)),u.l+=3,d!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(w=u.read_shift(2));var _=u.read_shift(2),S=l.codepage||1252;d!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(S=t[u[u.l]]),u.l+=1,u.l+=2),p&&(u.l+=36);for(var x=[],P={},k=Math.min(u.length,d==2?521:w-10-(f?264:0)),b=p?32:11;u.l<k&&u[u.l]!=13;)switch(P={},P.name=ur.utils.decode(S,u.slice(u.l,u.l+b)).replace(/[\u0000\r\n].*$/g,""),u.l+=b,P.type=String.fromCharCode(u.read_shift(1)),d!=2&&!p&&(P.offset=u.read_shift(4)),P.len=u.read_shift(1),d==2&&(P.offset=u.read_shift(2)),P.dec=u.read_shift(1),P.name.length&&x.push(P),d!=2&&(u.l+=p?13:14),P.type){case"B":(!f||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(u[u.l]!==13&&(u.l=w-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=w;var C=0,N=0;for(c[0]=[],N=0;N!=x.length;++N)c[0][N]=x[N].name;for(;g-- >0;){if(u[u.l]===42){u.l+=_;continue}for(++u.l,c[++C]=[],N=0,N=0;N!=x.length;++N){var B=u.slice(u.l,u.l+x[N].len);u.l+=x[N].len,Ho(B,0);var Y=ur.utils.decode(S,B);switch(x[N].type){case"C":Y.trim().length&&(c[C][N]=Y.replace(/\s+$/,""));break;case"D":Y.length===8?c[C][N]=new Date(+Y.slice(0,4),+Y.slice(4,6)-1,+Y.slice(6,8)):c[C][N]=Y;break;case"F":c[C][N]=parseFloat(Y.trim());break;case"+":case"I":c[C][N]=p?B.read_shift(-4,"i")^2147483648:B.read_shift(4,"i");break;case"L":switch(Y.trim().toUpperCase()){case"Y":case"T":c[C][N]=!0;break;case"N":case"F":c[C][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Y+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[C][N]="##MEMO##"+(p?parseInt(Y.trim(),10):B.read_shift(4));break;case"N":Y=Y.replace(/\u0000/g,"").trim(),Y&&Y!="."&&(c[C][N]=+Y||0);break;case"@":c[C][N]=new Date(B.read_shift(-8,"f")-621356832e5);break;case"T":c[C][N]=new Date((B.read_shift(4)-2440588)*864e5+B.read_shift(4));break;case"Y":c[C][N]=B.read_shift(4,"i")/1e4+B.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][N]=-B.read_shift(-8,"f");break;case"B":if(f&&x[N].len==8){c[C][N]=B.read_shift(8,"f");break}case"G":case"P":B.l+=x[N].len;break;case"0":if(x[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[N].type)}}}if(d!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function r(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=zv(n(a,c),c);return u["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,u}function i(a,l){try{return Ef(r(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function s(a,l){var c=l||{};if(+c.codepage>=0&&ac(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=ra(),d=RA(a,{header:1,raw:!0,cellDates:!0}),h=d[0],f=d.slice(1),p=a["!cols"]||[],g=0,w=0,_=0,S=1;for(g=0;g<h.length;++g){if(((p[g]||{}).DBF||{}).name){h[g]=p[g].DBF.name,++_;continue}if(h[g]!=null){if(++_,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(w=0;w<1024;++w)if(h.indexOf(h[g]+"_"+w)==-1){h[g]+="_"+w;break}}}}var x=qn(a["!ref"]),P=[],k=[],b=[];for(g=0;g<=x.e.c-x.s.c;++g){var C="",N="",B=0,Y=[];for(w=0;w<f.length;++w)f[w][g]!=null&&Y.push(f[w][g]);if(Y.length==0||h[g]==null){P[g]="?";continue}for(w=0;w<Y.length;++w){switch(typeof Y[w]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=Y[w]instanceof Date?"D":"C";break;default:N="C"}B=Math.max(B,String(Y[w]).length),C=C&&C!=N?"C":N}B>250&&(B=250),N=((p[g]||{}).DBF||{}).type,N=="C"&&p[g].DBF.len>B&&(B=p[g].DBF.len),C=="B"&&N=="N"&&(C="N",b[g]=p[g].DBF.dec,B=p[g].DBF.len),k[g]=C=="C"||N=="N"?B:o[C]||0,S+=k[g],P[g]=C}var ee=u.next(32);for(ee.write_shift(4,318902576),ee.write_shift(4,f.length),ee.write_shift(2,296+32*_),ee.write_shift(2,S),g=0;g<4;++g)ee.write_shift(4,0);for(ee.write_shift(4,0|(+e[Vv]||3)<<8),g=0,w=0;g<h.length;++g)if(h[g]!=null){var te=u.next(32),Ce=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);te.write_shift(1,Ce,"sbcs"),te.write_shift(1,P[g]=="?"?"C":P[g],"sbcs"),te.write_shift(4,w),te.write_shift(1,k[g]||o[P[g]]||0),te.write_shift(1,b[g]||0),te.write_shift(1,2),te.write_shift(4,0),te.write_shift(1,0),te.write_shift(4,0),te.write_shift(4,0),w+=k[g]||o[P[g]]||0}var Re=u.next(264);for(Re.write_shift(4,13),g=0;g<65;++g)Re.write_shift(4,0);for(g=0;g<f.length;++g){var _e=u.next(S);for(_e.write_shift(1,0),w=0;w<h.length;++w)if(h[w]!=null)switch(P[w]){case"L":_e.write_shift(1,f[g][w]==null?63:f[g][w]?84:70);break;case"B":_e.write_shift(8,f[g][w]||0,"f");break;case"N":var L="0";for(typeof f[g][w]=="number"&&(L=f[g][w].toFixed(b[w]||0)),_=0;_<k[w]-L.length;++_)_e.write_shift(1,32);_e.write_shift(1,L,"sbcs");break;case"D":f[g][w]?(_e.write_shift(4,("0000"+f[g][w].getFullYear()).slice(-4),"sbcs"),_e.write_shift(2,("00"+(f[g][w].getMonth()+1)).slice(-2),"sbcs"),_e.write_shift(2,("00"+f[g][w].getDate()).slice(-2),"sbcs")):_e.write_shift(8,"00000000","sbcs");break;case"C":var M=String(f[g][w]!=null?f[g][w]:"").slice(0,k[w]);for(_e.write_shift(1,M,"sbcs"),_=0;_<k[w]-M.length;++_)_e.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:r,from_sheet:s}}(),LJ=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+pi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(h,f){var p=t[f];return typeof p=="number"?SZ(p):p},r=function(h,f,p){var g=f.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return g==59?h:SZ(g)};t["|"]=254;function i(h,f){switch(f.type){case"base64":return o(Da(h),f);case"binary":return o(h,f);case"buffer":return o(In&&Buffer.isBuffer(h)?h.toString("binary"):Sf(h),f);case"array":return o(Rp(h),f)}throw new Error("Unrecognized type "+f.type)}function o(h,f){var p=h.split(/[\n\r]+/),g=-1,w=-1,_=0,S=0,x=[],P=[],k=null,b={},C=[],N=[],B=[],Y=0,ee;for(+f.codepage>=0&&ac(+f.codepage);_!==p.length;++_){Y=0;var te=p[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),Ce=te.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")}),Re=Ce[0],_e;if(te.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ce[1].charAt(0)=="P"&&P.push(te.slice(3).replace(/;;/g,";"));break;case"C":var L=!1,M=!1,q=!1,y=!1,E=-1,R=-1;for(S=1;S<Ce.length;++S)switch(Ce[S].charAt(0)){case"A":break;case"X":w=parseInt(Ce[S].slice(1))-1,M=!0;break;case"Y":for(g=parseInt(Ce[S].slice(1))-1,M||(w=0),ee=x.length;ee<=g;++ee)x[ee]=[];break;case"K":_e=Ce[S].slice(1),_e.charAt(0)==='"'?_e=_e.slice(1,_e.length-1):_e==="TRUE"?_e=!0:_e==="FALSE"?_e=!1:isNaN(cc(_e))?isNaN(Bv(_e).getDate())||(_e=Lr(_e)):(_e=cc(_e),k!==null&&jv(k)&&(_e=OA(_e))),typeof ur<"u"&&typeof _e=="string"&&(f||{}).type!="string"&&(f||{}).codepage&&(_e=ur.utils.decode(f.codepage,_e)),L=!0;break;case"E":y=!0;var D=Lv(Ce[S].slice(1),{r:g,c:w});x[g][w]=[x[g][w],D];break;case"S":q=!0,x[g][w]=[x[g][w],"S5S"];break;case"G":break;case"R":E=parseInt(Ce[S].slice(1))-1;break;case"C":R=parseInt(Ce[S].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+te)}if(L&&(x[g][w]&&x[g][w].length==2?x[g][w][0]=_e:x[g][w]=_e,k=null),q){if(y)throw new Error("SYLK shared formula cannot have own formula");var A=E>-1&&x[E][R];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");x[g][w][1]=tee(A[1],{r:g-E,c:w-R})}break;case"F":var O=0;for(S=1;S<Ce.length;++S)switch(Ce[S].charAt(0)){case"X":w=parseInt(Ce[S].slice(1))-1,++O;break;case"Y":for(g=parseInt(Ce[S].slice(1))-1,ee=x.length;ee<=g;++ee)x[ee]=[];break;case"M":Y=parseInt(Ce[S].slice(1))/20;break;case"F":break;case"G":break;case"P":k=P[parseInt(Ce[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(B=Ce[S].slice(1).split(" "),ee=parseInt(B[0],10);ee<=parseInt(B[1],10);++ee)Y=parseInt(B[2],10),N[ee-1]=Y===0?{hidden:!0}:{wch:Y},yf(N[ee-1]);break;case"C":w=parseInt(Ce[S].slice(1))-1,N[w]||(N[w]={});break;case"R":g=parseInt(Ce[S].slice(1))-1,C[g]||(C[g]={}),Y>0?(C[g].hpt=Y,C[g].hpx=Wv(Y)):Y===0&&(C[g].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+te)}O<1&&(k=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+te)}}return C.length>0&&(b["!rows"]=C),N.length>0&&(b["!cols"]=N),f&&f.sheetRows&&(x=x.slice(0,f.sheetRows)),[x,b]}function s(h,f){var p=i(h,f),g=p[0],w=p[1],_=zv(g,f);return pi(w).forEach(function(S){_[S]=w[S]}),_}function a(h,f){return Ef(s(h,f),f)}function l(h,f,p,g){var w="C;Y"+(p+1)+";X"+(g+1)+";K";switch(h.t){case"n":w+=h.v||0,h.f&&!h.F&&(w+=";E"+f3(h.f,{r:p,c:g}));break;case"b":w+=h.v?"TRUE":"FALSE";break;case"e":w+=h.w||h.v;break;case"d":w+='"'+(h.w||h.v)+'"';break;case"s":w+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function c(h,f){f.forEach(function(p,g){var w="F;W"+(g+1)+" "+(g+1)+" ";p.hidden?w+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=j1(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=$1(p.wpx)),typeof p.wch=="number"&&(w+=Math.round(p.wch))),w.charAt(w.length-1)!=" "&&h.push(w)})}function u(h,f){f.forEach(function(p,g){var w="F;";p.hidden?w+="M0;":p.hpt?w+="M"+20*p.hpt+";":p.hpx&&(w+="M"+20*G1(p.hpx)+";"),w.length>2&&h.push(w+"R"+(g+1))})}function d(h,f){var p=["ID;PWXL;N;E"],g=[],w=qn(h["!ref"]),_,S=Array.isArray(h),x=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&c(p,h["!cols"]),h["!rows"]&&u(p,h["!rows"]),p.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var P=w.s.r;P<=w.e.r;++P)for(var k=w.s.c;k<=w.e.c;++k){var b=Xt({r:P,c:k});_=S?(h[P]||[])[k]:h[b],!(!_||_.v==null&&(!_.f||_.F))&&g.push(l(_,h,P,k,f))}return p.join(x)+x+g.join(x)+x+"E"+x}return{to_workbook:a,to_sheet:s,from_sheet:d}}(),HJ=function(){function t(o,s){switch(s.type){case"base64":return e(Da(o),s);case"binary":return e(o,s);case"buffer":return e(In&&Buffer.isBuffer(o)?o.toString("binary"):Sf(o),s);case"array":return e(Rp(o),s)}throw new Error("Unrecognized type "+s.type)}function e(o,s){for(var a=o.split(`
`),l=-1,c=-1,u=0,d=[];u!==a.length;++u){if(a[u].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=a[u].trim().split(","),f=h[0],p=h[1];++u;for(var g=a[u]||"";(g.match(/["]/g)||[]).length&1&&u<a.length-1;)g+=`
`+a[++u];switch(g=g.trim(),+f){case-1:if(g==="BOT"){d[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[l][c]=!0:g==="FALSE"?d[l][c]=!1:isNaN(cc(p))?isNaN(Bv(p).getDate())?d[l][c]=p:d[l][c]=Lr(p):d[l][c]=cc(p),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),S1&&g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function n(o,s){return zv(t(o,s),s)}function r(o,s){return Ef(n(o,s),s)}var i=function(){var o=function(l,c,u,d,h){l.push(c),l.push(u+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},s=function(l,c,u,d){l.push(c+","+u),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],u=qn(l["!ref"]),d,h=Array.isArray(l);o(c,"TABLE",0,1,"sheetjs"),o(c,"VECTORS",0,u.e.r-u.s.r+1,""),o(c,"TUPLES",0,u.e.c-u.s.c+1,""),o(c,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){s(c,-1,0,"BOT");for(var p=u.s.c;p<=u.e.c;++p){var g=Xt({r:f,c:p});if(d=h?(l[f]||[])[p]:l[g],!d){s(c,1,0,"");continue}switch(d.t){case"n":var w=S1?d.w:d.v;!w&&d.v!=null&&(w=d.v),w==null?S1&&d.f&&!d.F?s(c,1,0,"="+d.f):s(c,1,0,""):s(c,0,w,"V");break;case"b":s(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(c,1,0,!S1||isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=hl(d.z||Kt[14],Ji(Lr(d.v)))),S1?s(c,0,d.w,"V"):s(c,1,0,d.w);break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var _=`\r
`,S=c.join(_);return S}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),VJ=function(){function t(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(d,h){for(var f=d.split(`
`),p=-1,g=-1,w=0,_=[];w!==f.length;++w){var S=f[w].trim().split(":");if(S[0]==="cell"){var x=Jr(S[1]);if(_.length<=x.r)for(p=_.length;p<=x.r;++p)_[p]||(_[p]=[]);switch(p=x.r,g=x.c,S[2]){case"t":_[p][g]=t(S[3]);break;case"v":_[p][g]=+S[3];break;case"vtf":var P=S[S.length-1];case"vtc":switch(S[3]){case"nl":_[p][g]=!!+S[4];break;default:_[p][g]=+S[4];break}S[2]=="vtf"&&(_[p][g]=[_[p][g],P])}}}return h&&h.sheetRows&&(_=_.slice(0,h.sheetRows)),_}function r(d,h){return zv(n(d,h),h)}function i(d,h){return Ef(r(d,h),h)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],f=[],p,g="",w=ia(d["!ref"]),_=Array.isArray(d),S=w.s.r;S<=w.e.r;++S)for(var x=w.s.c;x<=w.e.c;++x)if(g=Xt({r:S,c:x}),p=_?(d[S]||[])[x]:d[g],!(!p||p.v==null||p.t==="z")){switch(f=["cell",g,"t"],p.t){case"s":case"str":f.push(e(p.v));break;case"n":p.f?(f[2]="vtf",f[3]="n",f[4]=p.v,f[5]=e(p.f)):(f[2]="v",f[3]=p.v);break;case"b":f[2]="vt"+(p.f?"f":"c"),f[3]="nl",f[4]=p.v?"1":"0",f[5]=e(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var P=Ji(Lr(p.v));f[2]="vtc",f[3]="nd",f[4]=""+P,f[5]=p.w||hl(p.z||Kt[14],P);break;case"e":continue}h.push(f.join(":"))}return h.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(d){return[o,s,a,s,c(d),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:u}}(),Uv=function(){function t(u,d,h,f,p){p.raw?d[h][f]=u:u===""||(u==="TRUE"?d[h][f]=!0:u==="FALSE"?d[h][f]=!1:isNaN(cc(u))?isNaN(Bv(u).getDate())?d[h][f]=u:d[h][f]=Lr(u):d[h][f]=cc(u))}function e(u,d){var h=d||{},f=[];if(!u||u.length===0)return f;for(var p=u.split(/[\r\n]/),g=p.length-1;g>=0&&p[g].length===0;)--g;for(var w=10,_=0,S=0;S<=g;++S)_=p[S].indexOf(" "),_==-1?_=p[S].length:_++,w=Math.max(w,_);for(S=0;S<=g;++S){f[S]=[];var x=0;for(t(p[S].slice(0,w).trim(),f,S,x,h),x=1;x<=(p[S].length-w)/10+1;++x)t(p[S].slice(w+(x-1)*10,w+x*10).trim(),f,S,x,h)}return h.sheetRows&&(f=f.slice(0,h.sheetRows)),f}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(u){for(var d={},h=!1,f=0,p=0;f<u.length;++f)(p=u.charCodeAt(f))==34?h=!h:!h&&p in n&&(d[p]=(d[p]||0)+1);p=[];for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&p.push([d[f],f]);if(!p.length){d=r;for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&p.push([d[f],f])}return p.sort(function(g,w){return g[0]-w[0]||r[g[1]]-r[w[1]]}),n[p.pop()[1]]||44}function o(u,d){var h=d||{},f="";mi!=null&&h.dense==null&&(h.dense=mi);var p=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=i(u.slice(0,1024)):h&&h.FS?f=h.FS:f=i(u.slice(0,1024));var w=0,_=0,S=0,x=0,P=0,k=f.charCodeAt(0),b=!1,C=0,N=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var B=h.dateNF!=null?NPe(h.dateNF):null;function Y(){var ee=u.slice(x,P),te={};if(ee.charAt(0)=='"'&&ee.charAt(ee.length-1)=='"'&&(ee=ee.slice(1,-1).replace(/""/g,'"')),ee.length===0)te.t="z";else if(h.raw)te.t="s",te.v=ee;else if(ee.trim().length===0)te.t="s",te.v=ee;else if(ee.charCodeAt(0)==61)ee.charCodeAt(1)==34&&ee.charCodeAt(ee.length-1)==34?(te.t="s",te.v=ee.slice(2,-1).replace(/""/g,'"')):lVe(ee)?(te.t="n",te.f=ee.slice(1)):(te.t="s",te.v=ee);else if(ee=="TRUE")te.t="b",te.v=!0;else if(ee=="FALSE")te.t="b",te.v=!1;else if(!isNaN(S=cc(ee)))te.t="n",h.cellText!==!1&&(te.w=ee),te.v=S;else if(!isNaN(Bv(ee).getDate())||B&&ee.match(B)){te.z=h.dateNF||Kt[14];var Ce=0;B&&ee.match(B)&&(ee=PPe(ee,h.dateNF,ee.match(B)||[]),Ce=1),h.cellDates?(te.t="d",te.v=Lr(ee,Ce)):(te.t="n",te.v=Ji(Lr(ee,Ce))),h.cellText!==!1&&(te.w=hl(te.z,te.v instanceof Date?Ji(te.v):te.v)),h.cellNF||delete te.z}else te.t="s",te.v=ee;if(te.t=="z"||(h.dense?(p[w]||(p[w]=[]),p[w][_]=te):p[Xt({c:_,r:w})]=te),x=P+1,N=u.charCodeAt(x),g.e.c<_&&(g.e.c=_),g.e.r<w&&(g.e.r=w),C==k)++_;else if(_=0,++w,h.sheetRows&&h.sheetRows<=w)return!0}e:for(;P<u.length;++P)switch(C=u.charCodeAt(P)){case 34:N===34&&(b=!b);break;case k:case 10:case 13:if(!b&&Y())break e;break;default:break}return P-x>0&&Y(),p["!ref"]=fn(g),p}function s(u,d){return!(d&&d.PRN)||d.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?o(u,d):zv(e(u,d),d)}function a(u,d){var h="",f=d.type=="string"?[0,0,0,0]:C3(u,d);switch(d.type){case"base64":h=Da(u);break;case"binary":h=u;break;case"buffer":d.codepage==65001?h=u.toString("utf8"):d.codepage&&typeof ur<"u"?h=ur.utils.decode(d.codepage,u):h=In&&Buffer.isBuffer(u)?u.toString("binary"):Sf(u);break;case"array":h=Rp(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+d.type)}return f[0]==239&&f[1]==187&&f[2]==191?h=Sr(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=Sr(h):d.type=="binary"&&typeof ur<"u"&&d.codepage&&(h=ur.utils.decode(d.codepage,ur.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?VJ.to_sheet(d.type=="string"?h:Sr(h),d):s(h,d)}function l(u,d){return Ef(a(u,d),d)}function c(u){for(var d=[],h=qn(u["!ref"]),f,p=Array.isArray(u),g=h.s.r;g<=h.e.r;++g){for(var w=[],_=h.s.c;_<=h.e.c;++_){var S=Xt({r:g,c:_});if(f=p?(u[g]||[])[_]:u[S],!f||f.v==null){w.push("          ");continue}for(var x=(f.w||(Pd(f),f.w)||"").slice(0,10);x.length<10;)x+=" ";w.push(x+(_===0?" ":""))}d.push(w.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}}();function q2e(t,e){var n=e||{},r=!!n.WTF;n.WTF=!0;try{var i=LJ.to_workbook(t,n);return n.WTF=r,i}catch(o){if(n.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return Uv.to_workbook(t,e)}}var xp=function(){function t(D,A,O){if(D){Ho(D,D.l||0);for(var U=O.Enum||E;D.l<D.length;){var ie=D.read_shift(2),ue=U[ie]||U[65535],fe=D.read_shift(2),de=D.l+fe,ye=ue.f&&ue.f(D,fe,O);if(D.l=de,A(ye,ue,ie))return}}}function e(D,A){switch(A.type){case"base64":return n(Ta(Da(D)),A);case"binary":return n(Ta(D),A);case"buffer":case"array":return n(D,A)}throw"Unsupported type "+A.type}function n(D,A){if(!D)return D;var O=A||{};mi!=null&&O.dense==null&&(O.dense=mi);var U=O.dense?[]:{},ie="Sheet1",ue="",fe=0,de={},ye=[],Pe=[],F={s:{r:0,c:0},e:{r:0,c:0}},Ke=O.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)O.Enum=E,t(D,function(Me,j,z){switch(z){case 0:O.vers=Me,Me>=4096&&(O.qpro=!0);break;case 6:F=Me;break;case 204:Me&&(ue=Me);break;case 222:ue=Me;break;case 15:case 51:O.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:z==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=O.dateNF||Kt[14],O.cellDates&&(Me[1].t="d",Me[1].v=OA(Me[1].v))),O.qpro&&Me[3]>fe&&(U["!ref"]=fn(F),de[ie]=U,ye.push(ie),U=O.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},fe=Me[3],ie=ue||"Sheet"+(fe+1),ue="");var J=O.dense?(U[Me[0].r]||[])[Me[0].c]:U[Xt(Me[0])];if(J){J.t=Me[1].t,J.v=Me[1].v,Me[1].z!=null&&(J.z=Me[1].z),Me[1].f!=null&&(J.f=Me[1].f);break}O.dense?(U[Me[0].r]||(U[Me[0].r]=[]),U[Me[0].r][Me[0].c]=Me[1]):U[Xt(Me[0])]=Me[1];break;default:}},O);else if(D[2]==26||D[2]==14)O.Enum=R,D[2]==14&&(O.qpro=!0,D.l=0),t(D,function(Me,j,z){switch(z){case 204:ie=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>fe&&(U["!ref"]=fn(F),de[ie]=U,ye.push(ie),U=O.dense?[]:{},F={s:{r:0,c:0},e:{r:0,c:0}},fe=Me[3],ie="Sheet"+(fe+1)),Ke>0&&Me[0].r>=Ke)break;O.dense?(U[Me[0].r]||(U[Me[0].r]=[]),U[Me[0].r][Me[0].c]=Me[1]):U[Xt(Me[0])]=Me[1],F.e.c<Me[0].c&&(F.e.c=Me[0].c),F.e.r<Me[0].r&&(F.e.r=Me[0].r);break;case 27:Me[14e3]&&(Pe[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Pe[Me[0]]=Me[1],Me[0]==fe&&(ie=Me[1]);break;default:break}},O);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(U["!ref"]=fn(F),de[ue||ie]=U,ye.push(ue||ie),!Pe.length)return{SheetNames:ye,Sheets:de};for(var $e={},rt=[],Ye=0;Ye<Pe.length;++Ye)de[ye[Ye]]?(rt.push(Pe[Ye]||ye[Ye]),$e[Pe[Ye]]=de[Pe[Ye]]||de[ye[Ye]]):(rt.push(Pe[Ye]),$e[Pe[Ye]]={"!ref":"A1"});return{SheetNames:rt,Sheets:$e}}function r(D,A){var O=A||{};if(+O.codepage>=0&&ac(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var U=ra(),ie=qn(D["!ref"]),ue=Array.isArray(D),fe=[];dt(U,0,o(1030)),dt(U,6,l(ie));for(var de=Math.min(ie.e.r,8191),ye=ie.s.r;ye<=de;++ye)for(var Pe=bi(ye),F=ie.s.c;F<=ie.e.c;++F){ye===ie.s.r&&(fe[F]=Qr(F));var Ke=fe[F]+Pe,$e=ue?(D[ye]||[])[F]:D[Ke];if(!(!$e||$e.t=="z"))if($e.t=="n")($e.v|0)==$e.v&&$e.v>=-32768&&$e.v<=32767?dt(U,13,f(ye,F,$e.v)):dt(U,14,g(ye,F,$e.v));else{var rt=Pd($e);dt(U,15,d(ye,F,rt.slice(0,239)))}}return dt(U,1),U.end()}function i(D,A){var O=A||{};if(+O.codepage>=0&&ac(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var U=ra();dt(U,0,s(D));for(var ie=0,ue=0;ie<D.SheetNames.length;++ie)(D.Sheets[D.SheetNames[ie]]||{})["!ref"]&&dt(U,27,y(D.SheetNames[ie],ue++));var fe=0;for(ie=0;ie<D.SheetNames.length;++ie){var de=D.Sheets[D.SheetNames[ie]];if(!(!de||!de["!ref"])){for(var ye=qn(de["!ref"]),Pe=Array.isArray(de),F=[],Ke=Math.min(ye.e.r,8191),$e=ye.s.r;$e<=Ke;++$e)for(var rt=bi($e),Ye=ye.s.c;Ye<=ye.e.c;++Ye){$e===ye.s.r&&(F[Ye]=Qr(Ye));var Me=F[Ye]+rt,j=Pe?(de[$e]||[])[Ye]:de[Me];if(!(!j||j.t=="z"))if(j.t=="n")dt(U,23,Y($e,Ye,fe,j.v));else{var z=Pd(j);dt(U,22,C($e,Ye,fe,z.slice(0,239)))}}++fe}}return dt(U,1),U.end()}function o(D){var A=He(2);return A.write_shift(2,D),A}function s(D){var A=He(26);A.write_shift(2,4096),A.write_shift(2,4),A.write_shift(4,0);for(var O=0,U=0,ie=0,ue=0;ue<D.SheetNames.length;++ue){var fe=D.SheetNames[ue],de=D.Sheets[fe];if(!(!de||!de["!ref"])){++ie;var ye=ia(de["!ref"]);O<ye.e.r&&(O=ye.e.r),U<ye.e.c&&(U=ye.e.c)}}return O>8191&&(O=8191),A.write_shift(2,O),A.write_shift(1,ie),A.write_shift(1,U),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(1,1),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(4,0),A}function a(D,A,O){var U={s:{c:0,r:0},e:{c:0,r:0}};return A==8&&O.qpro?(U.s.c=D.read_shift(1),D.l++,U.s.r=D.read_shift(2),U.e.c=D.read_shift(1),D.l++,U.e.r=D.read_shift(2),U):(U.s.c=D.read_shift(2),U.s.r=D.read_shift(2),A==12&&O.qpro&&(D.l+=2),U.e.c=D.read_shift(2),U.e.r=D.read_shift(2),A==12&&O.qpro&&(D.l+=2),U.s.c==65535&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}function l(D){var A=He(8);return A.write_shift(2,D.s.c),A.write_shift(2,D.s.r),A.write_shift(2,D.e.c),A.write_shift(2,D.e.r),A}function c(D,A,O){var U=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(U[0].c=D.read_shift(1),U[3]=D.read_shift(1),U[0].r=D.read_shift(2),D.l+=2):(U[2]=D.read_shift(1),U[0].c=D.read_shift(2),U[0].r=D.read_shift(2)),U}function u(D,A,O){var U=D.l+A,ie=c(D,A,O);if(ie[1].t="s",O.vers==20768){D.l++;var ue=D.read_shift(1);return ie[1].v=D.read_shift(ue,"utf8"),ie}return O.qpro&&D.l++,ie[1].v=D.read_shift(U-D.l,"cstr"),ie}function d(D,A,O){var U=He(7+O.length);U.write_shift(1,255),U.write_shift(2,A),U.write_shift(2,D),U.write_shift(1,39);for(var ie=0;ie<U.length;++ie){var ue=O.charCodeAt(ie);U.write_shift(1,ue>=128?95:ue)}return U.write_shift(1,0),U}function h(D,A,O){var U=c(D,A,O);return U[1].v=D.read_shift(2,"i"),U}function f(D,A,O){var U=He(7);return U.write_shift(1,255),U.write_shift(2,A),U.write_shift(2,D),U.write_shift(2,O,"i"),U}function p(D,A,O){var U=c(D,A,O);return U[1].v=D.read_shift(8,"f"),U}function g(D,A,O){var U=He(13);return U.write_shift(1,255),U.write_shift(2,A),U.write_shift(2,D),U.write_shift(8,O,"f"),U}function w(D,A,O){var U=D.l+A,ie=c(D,A,O);if(ie[1].v=D.read_shift(8,"f"),O.qpro)D.l=U;else{var ue=D.read_shift(2);P(D.slice(D.l,D.l+ue),ie),D.l+=ue}return ie}function _(D,A,O){var U=A&32768;return A&=-32769,A=(U?D:0)+(A>=8192?A-16384:A),(U?"":"$")+(O?Qr(A):bi(A))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(D,A){Ho(D,0);for(var O=[],U=0,ie="",ue="",fe="",de="";D.l<D.length;){var ye=D[D.l++];switch(ye){case 0:O.push(D.read_shift(8,"f"));break;case 1:ue=_(A[0].c,D.read_shift(2),!0),ie=_(A[0].r,D.read_shift(2),!1),O.push(ue+ie);break;case 2:{var Pe=_(A[0].c,D.read_shift(2),!0),F=_(A[0].r,D.read_shift(2),!1);ue=_(A[0].c,D.read_shift(2),!0),ie=_(A[0].r,D.read_shift(2),!1),O.push(Pe+F+":"+ue+ie)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(D.read_shift(2));break;case 6:{for(var Ke="";ye=D[D.l++];)Ke+=String.fromCharCode(ye);O.push('"'+Ke.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:de=O.pop(),fe=O.pop(),O.push(["AND","OR"][ye-20]+"("+fe+","+de+")");break;default:if(ye<32&&x[ye])de=O.pop(),fe=O.pop(),O.push(fe+x[ye]+de);else if(S[ye]){if(U=S[ye][1],U==69&&(U=D[D.l++]),U>O.length){console.error("WK1 bad formula parse 0x"+ye.toString(16)+":|"+O.join("|")+"|");return}var $e=O.slice(-U);O.length-=U,O.push(S[ye][0]+"("+$e.join(",")+")")}else return ye<=7?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=24?console.error("WK1 unsupported op "+ye.toString(16)):ye<=30?console.error("WK1 invalid opcode "+ye.toString(16)):ye<=115?console.error("WK1 unsupported function opcode "+ye.toString(16)):console.error("WK1 unrecognized opcode "+ye.toString(16))}}O.length==1?A[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function k(D){var A=[{c:0,r:0},{t:"n",v:0},0];return A[0].r=D.read_shift(2),A[3]=D[D.l++],A[0].c=D[D.l++],A}function b(D,A){var O=k(D,A);return O[1].t="s",O[1].v=D.read_shift(A-4,"cstr"),O}function C(D,A,O,U){var ie=He(6+U.length);ie.write_shift(2,D),ie.write_shift(1,O),ie.write_shift(1,A),ie.write_shift(1,39);for(var ue=0;ue<U.length;++ue){var fe=U.charCodeAt(ue);ie.write_shift(1,fe>=128?95:fe)}return ie.write_shift(1,0),ie}function N(D,A){var O=k(D,A);O[1].v=D.read_shift(2);var U=O[1].v>>1;if(O[1].v&1)switch(U&7){case 0:U=(U>>3)*5e3;break;case 1:U=(U>>3)*500;break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64;break}return O[1].v=U,O}function B(D,A){var O=k(D,A),U=D.read_shift(4),ie=D.read_shift(4),ue=D.read_shift(2);if(ue==65535)return U===0&&ie===3221225472?(O[1].t="e",O[1].v=15):U===0&&ie===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var fe=ue&32768;return ue=(ue&32767)-16446,O[1].v=(1-fe*2)*(ie*Math.pow(2,ue+32)+U*Math.pow(2,ue)),O}function Y(D,A,O,U){var ie=He(14);if(ie.write_shift(2,D),ie.write_shift(1,O),ie.write_shift(1,A),U==0)return ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(2,65535),ie;var ue=0,fe=0,de=0,ye=0;return U<0&&(ue=1,U=-U),fe=Math.log2(U)|0,U/=Math.pow(2,fe-31),ye=U>>>0,ye&2147483648||(U/=2,++fe,ye=U>>>0),U-=ye,ye|=2147483648,ye>>>=0,U*=Math.pow(2,32),de=U>>>0,ie.write_shift(4,de),ie.write_shift(4,ye),fe+=16383+(ue?32768:0),ie.write_shift(2,fe),ie}function ee(D,A){var O=B(D,14);return D.l+=A-14,O}function te(D,A){var O=k(D,A),U=D.read_shift(4);return O[1].v=U>>6,O}function Ce(D,A){var O=k(D,A),U=D.read_shift(8,"f");return O[1].v=U,O}function Re(D,A){var O=Ce(D,14);return D.l+=A-10,O}function _e(D,A){return D[D.l+A-1]==0?D.read_shift(A,"cstr"):""}function L(D,A){var O=D[D.l++];O>A-1&&(O=A-1);for(var U="";U.length<O;)U+=String.fromCharCode(D[D.l++]);return U}function M(D,A,O){if(!(!O.qpro||A<21)){var U=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var ie=D.read_shift(A-21,"cstr");return[U,ie]}}function q(D,A){for(var O={},U=D.l+A;D.l<U;){var ie=D.read_shift(2);if(ie==14e3){for(O[ie]=[0,""],O[ie][0]=D.read_shift(2);D[D.l];)O[ie][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return O}function y(D,A){var O=He(5+D.length);O.write_shift(2,14e3),O.write_shift(2,A);for(var U=0;U<D.length;++U){var ie=D.charCodeAt(U);O[O.l++]=ie>127?95:ie}return O[O.l++]=0,O}var E={0:{n:"BOF",f:Hi},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:_e},222:{n:"SHEETNAMELP",f:L},65535:{n:""}},R={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:B},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:te},38:{n:"??"},39:{n:"NUMBER27",f:Ce},40:{n:"FORMULA28",f:Re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:_e},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:M},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:e}}();function K2e(t){var e={},n=t.match(ls),r=0,i=!1;if(n)for(;r!=n.length;++r){var o=Zt(n[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=PB[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return e}var X2e=function(){var t=H1("t"),e=H1("rPr");function n(o){var s=o.match(t);if(!s)return{t:"s",v:""};var a={t:"s",v:Yn(s[1])},l=o.match(e);return l&&(a.s=K2e(l[1])),a}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(r,"").split(i).map(n).filter(function(a){return a.v})}}(),Z2e=function(){var e=/(\r\n|\n)/g;function n(i,o,s){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),o.push('<span style="'+a.join("")+'">'),i.b&&(o.push("<b>"),s.push("</b>")),i.i&&(o.push("<i>"),s.push("</i>")),i.strike&&(o.push("<s>"),s.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(o.push("<"+l+">"),s.push("</"+l+">")),s.push("</span>"),i}function r(i){var o=[[],i.v,[]];return i.v?(i.s&&n(i.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}}(),Q2e=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,J2e=/<(?:\w+:)?r>/,eLe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function l3(t,e){var n=e?e.cellHTML:!0,r={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=Yn(Sr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Sr(t),n&&(r.h=$B(r.t))):t.match(J2e)&&(r.r=Sr(t),r.t=Yn(Sr((t.replace(eLe,"").match(Q2e)||[]).join("").replace(ls,""))),n&&(r.h=Z2e(X2e(r.r)))),r):{t:""}}var tLe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nLe=/<(?:\w+:)?(?:si|sstItem)>/g,rLe=/<\/(?:\w+:)?(?:si|sstItem)>/;function iLe(t,e){var n=[],r="";if(!t)return n;var i=t.match(tLe);if(i){r=i[2].replace(nLe,"").split(rLe);for(var o=0;o!=r.length;++o){var s=l3(r[o].trim(),e);s!=null&&(n[n.length]=s)}i=Zt(i[1]),n.Count=i.count,n.Unique=i.uniqueCount}return n}var oLe=/^\s|\s$|[\t\n\r]/;function BJ(t,e){if(!e.bookSST)return"";var n=[Ti];n[n.length]=ct("sst",null,{xmlns:Op[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(t[r]!=null){var i=t[r],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(oLe)&&(o+=' xml:space="preserve"'),o+=">"+gr(i.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function sLe(t){return[t.read_shift(4),t.read_shift(4)]}function aLe(t,e){var n=[],r=!1;return Fd(t,function(o,s,a){switch(a){case 159:n.Count=o[0],n.Unique=o[1];break;case 19:n.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(s.T,!r||e.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function lLe(t,e){return e||(e=He(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var cLe=yke;function uLe(t){var e=ra();Ge(e,159,lLe(t));for(var n=0;n<t.length;++n)Ge(e,19,cLe(t[n]));return Ge(e,160),e.end()}function UJ(t){if(typeof ur<"u")return ur.utils.encode(Vv,t);for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function Nd(t,e){var n={};return n.Major=t.read_shift(2),n.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),n}function dLe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Nd(t,4),e.U=Nd(t,4),e.W=Nd(t,4),e}function hLe(t){for(var e=t.read_shift(4),n=t.l+e-4,r={},i=t.read_shift(4),o=[];i-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(r.name=t.read_shift(0,"lpp4"),r.comps=o,t.l!=n)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+n);return r}function fLe(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(hLe(t));return e}function mLe(t){var e=[];t.l+=4;for(var n=t.read_shift(4);n-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function pLe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Nd(t,4),e.U=Nd(t,4),e.W=Nd(t,4),e}function gLe(t){var e=pLe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function WJ(t,e){var n=t.l+e,r={};r.Flags=t.read_shift(4)&63,t.l+=4,r.AlgID=t.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=r.Flags==36;break;case 26625:i=r.Flags==4;break;case 0:i=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=t.read_shift(4),r.KeySize=t.read_shift(4),r.ProviderType=t.read_shift(4),t.l+=8,r.CSPName=t.read_shift(n-t.l>>1,"utf16le"),t.l=n,r}function jJ(t,e){var n={},r=t.l+e;return t.l+=4,n.Salt=t.slice(t.l,t.l+16),t.l+=16,n.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),n.VerifierHash=t.slice(t.l,r),t.l=r,n}function vLe(t){var e=Nd(t);switch(e.Minor){case 2:return[e.Minor,wLe(t,e)];case 3:return[e.Minor,yLe(t,e)];case 4:return[e.Minor,_Le(t,e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function wLe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var n=t.read_shift(4),r=WJ(t,n),i=jJ(t,t.length-t.l);return{t:"Std",h:r,v:i}}function yLe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function _Le(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var n=t.read_shift(t.length-t.l,"utf8"),r={};return n.replace(ls,function(o){var s=Zt(o);switch(mu(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(a){r[a]=s[a]});break;case"<dataIntegrity":r.encryptedHmacKey=s.encryptedHmacKey,r.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(s);break;default:throw s[0]}}),r}function CLe(t,e){var n={},r=n.EncryptionVersionInfo=Nd(t,4);if(e-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,n.EncryptionHeader=WJ(t,i),e-=i,n.EncryptionVerifier=jJ(t,e),n}function SLe(t){var e={},n=e.EncryptionVersionInfo=Nd(t,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function c3(t){var e=0,n,r=UJ(t),i=r.length+1,o,s,a,l,c;for(n=wf(i),n[0]=r.length,o=1;o!=i;++o)n[o]=r[o-1];for(o=i-1;o>=0;--o)s=n[o],a=e&16384?1:0,l=e<<1&32767,c=a|l,e=c^s;return e^52811}var $J=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(s){return(s/2|s*128)&255},i=function(s,a){return r(s^a)},o=function(s){for(var a=e[s.length-1],l=104,c=s.length-1;c>=0;--c)for(var u=s[c],d=0;d!=7;++d)u&64&&(a^=n[l]),u*=2,--l;return a};return function(s){for(var a=UJ(s),l=o(a),c=a.length,u=wf(16),d=0;d!=16;++d)u[d]=0;var h,f,p;for((c&1)===1&&(h=l>>8,u[c]=i(t[0],h),--c,h=l&255,f=a[a.length-1],u[c]=i(f,h));c>0;)--c,h=l>>8,u[c]=i(a[c],h),--c,h=l&255,u[c]=i(a[c],h);for(c=15,p=15-a.length;p>0;)h=l>>8,u[c]=i(t[p],h),--c,--p,h=l&255,u[c]=i(a[c],h),--c,--p;return u}}(),ELe=function(t,e,n,r,i){i||(i=e),r||(r=$J(t));var o,s;for(o=0;o!=e.length;++o)s=e[o],s^=r[n],s=(s>>5|s<<3)&255,i[o]=s,++n;return[i,n,r]},xLe=function(t){var e=0,n=$J(t);return function(r){var i=ELe("",r,e,n);return e=i[1],i[0]}};function bLe(t,e,n,r){var i={key:Hi(t),verificationBytes:Hi(t)};return n.password&&(i.verifier=c3(n.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=xLe(n.password)),i}function TLe(t,e,n){var r=n||{};return r.Info=t.read_shift(2),t.l-=2,r.Info===1?r.Data=SLe(t,e):r.Data=CLe(t,e),r}function RLe(t,e,n){var r={Type:n.biff>=8?t.read_shift(2):0};return r.Type?TLe(t,e-2,r):bLe(t,n.biff>=8?e:e-2,n,r),r}var GJ=function(){function t(i,o){switch(o.type){case"base64":return e(Da(i),o);case"binary":return e(i,o);case"buffer":return e(In&&Buffer.isBuffer(i)?i.toString("binary"):Sf(i),o);case"array":return e(Rp(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){var s=o||{},a=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,d){Array.isArray(a)&&(a[d]=[]);for(var h=/\\\w+\b/g,f=0,p,g=-1;p=h.exec(u);){switch(p[0]){case"\\cell":var w=u.slice(f,h.lastIndex-p[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var _={v:w,t:"s"};Array.isArray(a)?a[d][g]=_:a[Xt({r:d,c:g})]=_}break}f=h.lastIndex}g>c.e.c&&(c.e.c=g)}),a["!ref"]=fn(c),a}function n(i,o){return Ef(t(i,o),o)}function r(i){for(var o=["{\\rtf1\\ansi"],s=qn(i["!ref"]),a,l=Array.isArray(i),c=s.s.r;c<=s.e.r;++c){o.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)o.push("\\cellx"+(u+1));for(o.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var d=Xt({r:c,c:u});a=l?(i[c]||[])[u]:i[d],!(!a||a.v==null&&(!a.f||a.F))&&(o.push(" "+(a.w||(Pd(a),a.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function DLe(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function W1(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}function ILe(t){var e=t[0]/255,n=t[1]/255,r=t[2]/255,i=Math.max(e,n,r),o=Math.min(e,n,r),s=i-o;if(s===0)return[0,0,e];var a=0,l=0,c=i+o;switch(l=s/(c>1?2-c:c),i){case e:a=((n-r)/s+6)%6;break;case n:a=(r-e)/s+2;break;case r:a=(e-n)/s+4;break}return[a/6,l,c/2]}function ALe(t){var e=t[0],n=t[1],r=t[2],i=n*2*(r<.5?r:1-r),o=r-i/2,s=[o,o,o],a=6*e,l;if(n!==0)switch(a|0){case 0:case 6:l=i*a,s[0]+=i,s[1]+=l;break;case 1:l=i*(2-a),s[0]+=l,s[1]+=i;break;case 2:l=i*(a-2),s[1]+=i,s[2]+=l;break;case 3:l=i*(4-a),s[1]+=l,s[2]+=i;break;case 4:l=i*(a-4),s[2]+=i,s[0]+=l;break;case 5:l=i*(6-a),s[2]+=l,s[0]+=i;break}for(var c=0;c!=3;++c)s[c]=Math.round(s[c]*255);return s}function xA(t,e){if(e===0)return t;var n=ILe(DLe(t));return e<0?n[2]=n[2]*(1+e):n[2]=1-(1-n[2])*(1-e),W1(ALe(n))}var zJ=6,MLe=15,OLe=1,rs=zJ;function j1(t){return Math.floor((t+Math.round(128/rs)/256)*rs)}function $1(t){return Math.floor((t-5)/rs*100+.5)/100}function bA(t){return Math.round((t*rs+5)/rs*256)/256}function fB(t){return bA($1(j1(t)))}function u3(t){var e=Math.abs(t-fB(t)),n=rs;if(e>.005)for(rs=OLe;rs<MLe;++rs)Math.abs(t-fB(t))<=e&&(e=Math.abs(t-fB(t)),n=rs);rs=n}function yf(t){t.width?(t.wpx=j1(t.width),t.wch=$1(t.wpx),t.MDW=rs):t.wpx?(t.wch=$1(t.wpx),t.width=bA(t.wch),t.MDW=rs):typeof t.wch=="number"&&(t.width=bA(t.wch),t.wpx=j1(t.width),t.MDW=rs),t.customWidth&&delete t.customWidth}var NLe=96,YJ=NLe;function G1(t){return t*96/YJ}function Wv(t){return t*YJ/96}var PLe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function kLe(t,e,n,r){e.Borders=[];var i={},o=!1;(t[0].match(ls)||[]).forEach(function(s){var a=Zt(s);switch(mu(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=Fr(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=Fr(a.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+a[0]+" in borders")}})}function FLe(t,e,n,r){e.Fills=[];var i={},o=!1;(t[0].match(ls)||[]).forEach(function(s){var a=Zt(s);switch(mu(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+a[0]+" in fills")}})}function LLe(t,e,n,r){e.Fonts=[];var i={},o=!1;(t[0].match(ls)||[]).forEach(function(s){var a=Zt(s);switch(mu(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=Sr(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?Fr(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?Fr(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?Fr(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?Fr(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?Fr(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?Fr(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?Fr(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=PB[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=Fr(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var l=Sp[i.color.index];i.color.index==81&&(l=Sp[1]),l||(l=Sp[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&n.themeElements&&n.themeElements.clrScheme&&(i.color.rgb=xA(n.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+a[0]+" in fonts")}})}function HLe(t,e,n){e.NumberFmt=[];for(var r=pi(Kt),i=0;i<r.length;++i)e.NumberFmt[r[i]]=Kt[r[i]];var o=t[0].match(ls);if(o)for(i=0;i<o.length;++i){var s=Zt(o[i]);switch(mu(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=Yn(Sr(s.formatCode)),l=parseInt(s.numFmtId,10);if(e.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=a}Od(a,l)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}function VLe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&(e[e.length]=ct("numFmt",null,{numFmtId:r,formatCode:gr(t[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ct("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var dA=["numFmtId","fillId","fontId","borderId","xfId"],hA=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function BLe(t,e,n){e.CellXf=[];var r,i=!1;(t[0].match(ls)||[]).forEach(function(o){var s=Zt(o),a=0;switch(mu(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=s,delete r[0],a=0;a<dA.length;++a)r[dA[a]]&&(r[dA[a]]=parseInt(r[dA[a]],10));for(a=0;a<hA.length;++a)r[hA[a]]&&(r[hA[a]]=Fr(r[hA[a]]));if(e.NumberFmt&&r.numFmtId>392){for(a=392;a>60;--a)if(e.NumberFmt[r.numFmtId]==e.NumberFmt[a]){r.numFmtId=a;break}}e.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};s.vertical&&(l.vertical=s.vertical),s.horizontal&&(l.horizontal=s.horizontal),s.textRotation!=null&&(l.textRotation=s.textRotation),s.indent&&(l.indent=s.indent),s.wrapText&&(l.wrapText=Fr(s.wrapText)),r.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}function ULe(t){var e=[];return e[e.length]=ct("cellXfs",null),t.forEach(function(n){e[e.length]=ct("xf",null,n)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ct("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var WLe=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,c){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=a.match(e))&&HLe(d,u,c),(d=a.match(i))&&LLe(d,u,l,c),(d=a.match(r))&&FLe(d,u,l,c),(d=a.match(o))&&kLe(d,u,l,c),(d=a.match(n))&&BLe(d,u,c),u}}();function qJ(t,e){var n=[Ti,ct("styleSheet",null,{xmlns:Op[0],"xmlns:vt":Qi.vt})],r;return t.SSF&&(r=VLe(t.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=ULe(e.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function jLe(t,e){var n=t.read_shift(2),r=ss(t,e-2);return[n,r]}function $Le(t,e,n){n||(n=He(6+4*e.length)),n.write_shift(2,t),go(e,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function GLe(t,e,n){var r={};r.sz=t.read_shift(2)/20;var i=Tke(t,2,n);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var o=t.read_shift(2);switch(o===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var s=t.read_shift(1);s!=0&&(r.underline=s);var a=t.read_shift(1);a>0&&(r.family=a);var l=t.read_shift(1);switch(l>0&&(r.charset=l),t.l++,r.color=bke(t,8),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=ss(t,e-21),r}function zLe(t,e){e||(e=He(25+4*32)),e.write_shift(2,t.sz*20),Rke(t,e),e.write_shift(2,t.bold?700:400);var n=0;t.vertAlign=="superscript"?n=1:t.vertAlign=="subscript"&&(n=2),e.write_shift(2,n),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),CA(t.color,e);var r=0;return t.scheme=="major"&&(r=1),t.scheme=="minor"&&(r=2),e.write_shift(1,r),go(t.name,e),e.length>e.l?e.slice(0,e.l):e}var YLe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],mB,qLe=as;function hQ(t,e){e||(e=He(4*3+8*7+16*1)),mB||(mB=AA(YLe));var n=mB[t.patternType];n==null&&(n=40),e.write_shift(4,n);var r=0;if(n!=40)for(CA({auto:1},e),CA({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function KLe(t,e){var n=t.l+e,r=t.read_shift(2),i=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:i}}function KJ(t,e,n){n||(n=He(16)),n.write_shift(2,e||0),n.write_shift(2,t.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function E1(t,e){return e||(e=He(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var XLe=as;function ZLe(t,e){return e||(e=He(51)),e.write_shift(1,0),E1(null,e),E1(null,e),E1(null,e),E1(null,e),E1(null,e),e.length>e.l?e.slice(0,e.l):e}function QLe(t,e){return e||(e=He(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),_A(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function JLe(t,e,n){var r=He(2052);return r.write_shift(4,t),_A(e,r),_A(n,r),r.length>r.l?r.slice(0,r.l):r}function eHe(t,e,n){var r={};r.NumberFmt=[];for(var i in Kt)r.NumberFmt[i]=Kt[i];r.CellXf=[],r.Fonts=[];var o=[],s=!1;return Fd(t,function(l,c,u){switch(u){case 44:r.NumberFmt[l[0]]=l[1],Od(l[1],l[0]);break;case 43:r.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=xA(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(u),s=!0;break;case 38:o.pop(),s=!1;break;default:if(c.T>0)o.push(u);else if(c.T<0)o.pop();else if(!s||n.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function tHe(t,e){if(e){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&++n}),n!=0&&(Ge(t,615,uc(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&Ge(t,44,$Le(i,e[i]))}),Ge(t,616))}}function nHe(t){var e=1;e!=0&&(Ge(t,611,uc(e)),Ge(t,43,zLe({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Ge(t,612))}function rHe(t){var e=2;e!=0&&(Ge(t,603,uc(e)),Ge(t,45,hQ({patternType:"none"})),Ge(t,45,hQ({patternType:"gray125"})),Ge(t,604))}function iHe(t){var e=1;e!=0&&(Ge(t,613,uc(e)),Ge(t,46,ZLe({})),Ge(t,614))}function oHe(t){var e=1;Ge(t,626,uc(e)),Ge(t,47,KJ({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Ge(t,627)}function sHe(t,e){Ge(t,617,uc(e.length)),e.forEach(function(n){Ge(t,47,KJ(n,0))}),Ge(t,618)}function aHe(t){var e=1;Ge(t,619,uc(e)),Ge(t,48,QLe({xfId:0,builtinId:0,name:"Normal"})),Ge(t,620)}function lHe(t){var e=0;Ge(t,505,uc(e)),Ge(t,506)}function cHe(t){var e=0;Ge(t,508,JLe(e,"TableStyleMedium9","PivotStyleMedium4")),Ge(t,509)}function uHe(t,e){var n=ra();return Ge(n,278),tHe(n,t.SSF),nHe(n,t),rHe(n,t),iHe(n,t),oHe(n,t),sHe(n,e.cellXfs),aHe(n,t),lHe(n,t),cHe(n,t),Ge(n,279),n.end()}var dHe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function hHe(t,e,n){e.themeElements.clrScheme=[];var r={};(t[0].match(ls)||[]).forEach(function(i){var o=Zt(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[dHe.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function fHe(){}function mHe(){}var pHe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,gHe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,vHe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function wHe(t,e,n){e.themeElements={};var r;[["clrScheme",pHe,hHe],["fontScheme",gHe,fHe],["fmtScheme",vHe,mHe]].forEach(function(i){if(!(r=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,e,n)})}var yHe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function XJ(t,e){(!t||t.length===0)&&(t=d3());var n,r={};if(!(n=t.match(yHe)))throw new Error("themeElements not found in theme");return wHe(n[0],r,e),r.raw=t,r}function d3(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var n=[Ti];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',n[n.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',n[n.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',n[n.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',n[n.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',n[n.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',n[n.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function _He(t,e,n){var r=t.l+e,i=t.read_shift(4);if(i!==124226){if(!n.cellStyles){t.l=r;return}var o=t.slice(t.l);t.l=r;var s;try{s=YQ(o,{type:"array"})}catch{return}var a=Ra(s,"theme/theme/theme1.xml",!0);if(a)return XJ(a,n)}}function CHe(t){return t.read_shift(4)}function SHe(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=EHe(t,4);break;case 2:e.xclrValue=IJ(t,4);break;case 3:e.xclrValue=CHe(t,4);break;case 4:t.l+=4;break}return t.l+=8,e}function EHe(t,e){return as(t,e)}function xHe(t,e){return as(t,e)}function bHe(t){var e=t.read_shift(2),n=t.read_shift(2)-4,r=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=SHe(t,n);break;case 6:r[1]=xHe(t,n);break;case 14:case 15:r[1]=t.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+n)}return r}function THe(t,e){var n=t.l+e;t.l+=2;var r=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),o=[];i-- >0;)o.push(bHe(t,n-t.l));return{ixfe:r,ext:o}}function RHe(t,e){e.forEach(function(n){switch(n[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function DHe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:ss(t,e-8)}}function IHe(t){var e=He(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),go(t.name,e),e.slice(0,e.l)}function AHe(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function MHe(t){var e=He(4+8*t.length);e.write_shift(4,t.length);for(var n=0;n<t.length;++n)e.write_shift(4,t[n][0]),e.write_shift(4,t[n][1]);return e}function OHe(t,e){var n=He(8+2*e.length);return n.write_shift(4,t),go(e,n),n.slice(0,n.l)}function NHe(t){return t.l+=4,t.read_shift(4)!=0}function PHe(t,e){var n=He(8);return n.write_shift(4,t),n.write_shift(4,e?1:0),n}function kHe(t,e,n){var r={Types:[],Cell:[],Value:[]},i=n||{},o=[],s=!1,a=2;return Fd(t,function(l,c,u){switch(u){case 335:r.Types.push({name:l.name});break;case 51:l.forEach(function(d){a==1?r.Cell.push({type:r.Types[d[0]-1].name,index:d[1]}):a==0&&r.Value.push({type:r.Types[d[0]-1].name,index:d[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:o.push(u),s=!0;break;case 36:o.pop(),s=!1;break;default:if(!c.T){if(!s||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function FHe(){var t=ra();return Ge(t,332),Ge(t,334,uc(1)),Ge(t,335,IHe({name:"XLDAPR",version:12e4,flags:3496657072})),Ge(t,336),Ge(t,339,OHe(1,"XLDAPR")),Ge(t,52),Ge(t,35,uc(514)),Ge(t,4096,uc(0)),Ge(t,4097,ul(1)),Ge(t,36),Ge(t,53),Ge(t,340),Ge(t,337,PHe(1,!0)),Ge(t,51,MHe([[1,0]])),Ge(t,338),Ge(t,333),t.end()}function LHe(t,e,n){var r={Types:[],Cell:[],Value:[]};if(!t)return r;var i=!1,o=2,s;return t.replace(ls,function(a){var l=Zt(a);switch(mu(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<r.Types.length;++c)r.Types[c].name==l.name&&(s=r.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[l.t-1].name,index:+l.v}):o==0&&r.Value.push({type:r.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+l.i);break;default:if(!i&&n.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),r}function ZJ(){var t=[Ti];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function HHe(t){var e=[];if(!t)return e;var n=1;return(t.match(ls)||[]).forEach(function(r){var i=Zt(r);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?n=i.i:i.i=n,e.push(i);break}}),e}function VHe(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=Xt(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}function BHe(t,e,n){var r=[],i=!1;return Fd(t,function(s,a,l){switch(l){case 63:r.push(s);break;default:if(!a.T){if(!i||n.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function UHe(t,e,n,r){if(!t)return t;var i=r||{},o=!1,s=!1;Fd(t,function(l,c,u){if(!s)switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!c.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function WHe(t,e){if(!t)return"??";var n=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][n].Target}var Pv=1024;function QJ(t,e){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[ct("xml",null,{"xmlns:v":ba.v,"xmlns:o":ba.o,"xmlns:x":ba.x,"xmlns:mv":ba.mv}).replace(/\/>/,">"),ct("o:shapelayout",ct("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ct("v:shapetype",[ct("v:stroke",null,{joinstyle:"miter"}),ct("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Pv<t*1e3;)Pv+=1e3;return e.forEach(function(o){var s=Jr(o[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?ct("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=ct("v:fill",l,a),u={on:"t",obscured:"t"};++Pv,i=i.concat(["<v:shape"+V1({id:"_x0000_s"+Pv,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,ct("v:shadow",null,u),ct("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Vo("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Vo("x:AutoFill","False"),Vo("x:Row",String(s.r)),Vo("x:Column",String(s.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function fQ(t,e,n,r){var i=Array.isArray(t),o;e.forEach(function(s){var a=Jr(s.ref);if(i?(t[a.r]||(t[a.r]=[]),o=t[a.r][a.c]):o=t[s.ref],!o){o={t:"z"},i?t[a.r][a.c]=o:t[s.ref]=o;var l=qn(t["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var c=fn(l);c!==t["!ref"]&&(t["!ref"]=c)}o.c||(o.c=[]);var u={a:s.author,t:s.t,r:s.r,T:n};s.h&&(u.h=s.h);for(var d=o.c.length-1;d>=0;--d){if(!n&&o.c[d].T)return;n&&!o.c[d].T&&o.c.splice(d,1)}if(n&&r){for(d=0;d<r.length;++d)if(u.a==r[d].id){u.a=r[d].name||u.a;break}}o.c.push(u)})}function jHe(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var a=s.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&n.push(a[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var a=s.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=Zt(a[0]),c={author:l.authorId&&n[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=Jr(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var d=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&l3(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=h.h),r.push(c)}}}}),r}function JJ(t){var e=[Ti,ct("comments",null,{xmlns:Op[0]})],n=[];return e.push("<authors>"),t.forEach(function(r){r[1].forEach(function(i){var o=gr(i.a);n.indexOf(o)==-1&&(n.push(o),e.push("<author>"+o+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(r){var i=0,o=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf(gr(l.a))),o.push(l.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),o.length<=1)e.push(Vo("t",gr(o[0]||"")));else{for(var s=`Comment:
    `+o[0]+`
`,a=1;a<o.length;++a)s+=`Reply:
    `+o[a]+`
`;e.push(Vo("t",gr(s)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function $He(t,e){var n=[],r=!1,i={},o=0;return t.replace(ls,function(a,l){var c=Zt(a);switch(mu(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&n.push(i);break;case"<text>":case"<text":o=l+a.length;break;case"</text>":i.t=t.slice(o,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return a}),n}function GHe(t,e,n){var r=[Ti,ct("ThreadedComments",null,{xmlns:Qi.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var o="";(i[1]||[]).forEach(function(s,a){if(!s.T){delete s.ID;return}s.a&&e.indexOf(s.a)==-1&&e.push(s.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};a==0?o=l.id:l.parentId=o,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(s.a)).slice(-12)+"}"),r.push(ct("threadedComment",Vo("text",s.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function zHe(t,e){var n=[],r=!1;return t.replace(ls,function(o){var s=Zt(o);switch(mu(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&e.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return o}),n}function YHe(t){var e=[Ti,ct("personList",null,{xmlns:Qi.TCMNT,"xmlns:x":Op[0]}).replace(/[\/]>/,">")];return t.forEach(function(n,r){e.push(ct("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),e.push("</personList>"),e.join("")}function qHe(t){var e={};e.iauthor=t.read_shift(4);var n=Fp(t,16);return e.rfx=n.s,e.ref=Xt(n.s),t.l+=16,e}function KHe(t,e){return e==null&&(e=He(36)),e.write_shift(4,t[1].iauthor),Yv(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var XHe=ss;function ZHe(t){return go(t.slice(0,54))}function QHe(t,e){var n=[],r=[],i={},o=!1;return Fd(t,function(a,l,c){switch(c){case 632:r.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,n.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function JHe(t){var e=ra(),n=[];return Ge(e,628),Ge(e,630),t.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),Ge(e,632,ZHe(i.a)))})}),Ge(e,631),Ge(e,633),t.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var o={s:Jr(r[0]),e:Jr(r[0])};Ge(e,635,KHe([o,i])),i.t&&i.t.length>0&&Ge(e,637,Cke(i)),Ge(e,636),delete i.iauthor})}),Ge(e,634),Ge(e,629),e.end()}var eVe="application/vnd.ms-office.vbaProject";function tVe(t){var e=Vt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var i=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Vt.utils.cfb_add(e,i,t.FileIndex[r].content)}}),Vt.write(e)}function nVe(t,e){e.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Vt.utils.cfb_add(t,i,e.FileIndex[r].content)}})}var eee=["xlsb","xlsm","xlam","biff8","xla"];function rVe(){return{"!type":"dialog"}}function iVe(){return{"!type":"dialog"}}function oVe(){return{"!type":"macro"}}function sVe(){return{"!type":"macro"}}var Lv=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,i,o,s){var a=!1,l=!1;o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1)),s.length==0?a=!0:s.charAt(0)=="["&&(a=!0,s=s.slice(1,-1));var c=o.length>0?parseInt(o,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return a?u+=e.c:--u,l?c+=e.r:--c,i+(a?"":"$")+Qr(u)+(l?"":"$")+bi(c)}return function(i,o){return e=o,i.replace(t,n)}}(),h3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,f3=function(){return function(e,n){return e.replace(h3,function(r,i,o,s,a,l){var c=JB(s)-(o?0:n.c),u=QB(l)-(a?0:n.r),d=u==0?"":a?u+1:"["+u+"]",h=c==0?"":o?c+1:"["+c+"]";return i+"R"+d+"C"+h})}}();function tee(t,e){return t.replace(h3,function(n,r,i,o,s,a){return r+(i=="$"?i+o:Qr(JB(o)+e.c))+(s=="$"?s+a:bi(QB(a)+e.r))})}function aVe(t,e,n){var r=ia(e),i=r.s,o=Jr(n),s={r:o.r-i.r,c:o.c-i.c};return tee(t,s)}function lVe(t){return t.length!=1}function mQ(t){return t.replace(/_xlfn\./g,"")}function Fi(t){t.l+=1}function _f(t,e){var n=t.read_shift(e==1?1:2);return[n&16383,n>>14&1,n>>15&1]}function nee(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return ree(t,e,n);n.biff==12&&(r=4)}var i=t.read_shift(r),o=t.read_shift(r),s=_f(t,2),a=_f(t,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:a[0],cRel:a[1],rRel:a[2]}}}function ree(t){var e=_f(t,2),n=_f(t,2),r=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function cVe(t,e,n){if(n.biff<8)return ree(t,e,n);var r=t.read_shift(n.biff==12?4:2),i=t.read_shift(n.biff==12?4:2),o=_f(t,2),s=_f(t,2);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function iee(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return uVe(t,e,n);var r=t.read_shift(n&&n.biff==12?4:2),i=_f(t,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function uVe(t){var e=_f(t,2),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function dVe(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function hVe(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return fVe(t,e,n);var i=t.read_shift(r>=12?4:2),o=t.read_shift(2),s=(o&16384)>>14,a=(o&32768)>>15;if(o&=16383,a==1)for(;i>524287;)i-=1048576;if(s==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:s,rRel:a}}function fVe(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),i==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:i,rRel:r}}function mVe(t,e,n){var r=(t[t.l++]&96)>>5,i=nee(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function pVe(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),o=8;if(n)switch(n.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var s=nee(t,o,n);return[r,i,s]}function gVe(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function vVe(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2),o=8;if(n)switch(n.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[r,i]}function wVe(t,e,n){var r=(t[t.l++]&96)>>5,i=cVe(t,e-1,n);return[r,i]}function yVe(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function pQ(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function _Ve(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),i=[],o=0;o<=r;++o)i.push(t.read_shift(n&&n.biff==2?1:2));return i}function CVe(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function SVe(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function EVe(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function xVe(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function oee(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function bVe(t){return t.read_shift(2),oee(t,2)}function TVe(t){return t.read_shift(2),oee(t,2)}function RVe(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=iee(t,0,n);return[r,i]}function DVe(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=hVe(t,0,n);return[r,i]}function IVe(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var o=iee(t,0,n);return[r,i,o]}function AVe(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(n&&n.biff<=3?1:2);return[NBe[i],lee[i],r]}function MVe(t,e,n){var r=t[t.l++],i=t.read_shift(1),o=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:OVe(t);return[i,(o[0]===0?lee:OBe)[o[1]]]}function OVe(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function NVe(t,e,n){t.l+=n&&n.biff==2?3:4}function PVe(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function kVe(t){return t.l++,Ld[t.read_shift(1)]}function FVe(t){return t.l++,t.read_shift(2)}function LVe(t){return t.l++,t.read_shift(1)!==0}function HVe(t){return t.l++,is(t,8)}function VVe(t,e,n){return t.l++,X1(t,e-1,n)}function BVe(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=xi(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=Ld[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=is(t,8);break;case 2:n[1]=Lp(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function UVe(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),i=[],o=0;o!=r;++o)i.push((n.biff==12?Fp:PA)(t,8));return i}function WVe(t,e,n){var r=0,i=0;n.biff==12?(r=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var o=0,s=[];o!=r&&(s[o]=[]);++o)for(var a=0;a!=i;++a)s[o][a]=BVe(t,n.biff);return s}function jVe(t,e,n){var r=t.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,o=t.read_shift(i);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,o]}function $Ve(t,e,n){if(n.biff==5)return GVe(t,e,n);var r=t.read_shift(1)>>>5&3,i=t.read_shift(2),o=t.read_shift(4);return[r,i,o]}function GVe(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function zVe(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function YVe(t,e,n){var r=t.read_shift(1)>>>5&3,i=t.read_shift(n&&n.biff==2?1:2);return[r,i]}function qVe(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function KVe(t,e,n){var r=(t[t.l++]&96)>>5,i=t.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[r,i]}var XVe=as,ZVe=as,QVe=as;function Q1(t,e,n){return t.l+=2,[dVe(t,4,n)]}function m3(t){return t.l+=6,[]}var JVe=Q1,eBe=m3,tBe=m3,nBe=Q1;function see(t){return t.l+=2,[Hi(t),t.read_shift(2)&1]}var rBe=Q1,iBe=see,oBe=m3,sBe=Q1,aBe=Q1,lBe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function cBe(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),i=t.read_shift(2),o=t.read_shift(2),s=lBe[n>>2&31];return{ixti:e,coltype:n&3,rt:s,idx:r,c:i,C:o}}function uBe(t){return t.l+=2,[t.read_shift(4)]}function dBe(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function hBe(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function fBe(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function mBe(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function pBe(t){return t.l+=4,[0,0]}var gQ={1:{n:"PtgExp",f:PVe},2:{n:"PtgTbl",f:QVe},3:{n:"PtgAdd",f:Fi},4:{n:"PtgSub",f:Fi},5:{n:"PtgMul",f:Fi},6:{n:"PtgDiv",f:Fi},7:{n:"PtgPower",f:Fi},8:{n:"PtgConcat",f:Fi},9:{n:"PtgLt",f:Fi},10:{n:"PtgLe",f:Fi},11:{n:"PtgEq",f:Fi},12:{n:"PtgGe",f:Fi},13:{n:"PtgGt",f:Fi},14:{n:"PtgNe",f:Fi},15:{n:"PtgIsect",f:Fi},16:{n:"PtgUnion",f:Fi},17:{n:"PtgRange",f:Fi},18:{n:"PtgUplus",f:Fi},19:{n:"PtgUminus",f:Fi},20:{n:"PtgPercent",f:Fi},21:{n:"PtgParen",f:Fi},22:{n:"PtgMissArg",f:Fi},23:{n:"PtgStr",f:VVe},26:{n:"PtgSheet",f:dBe},27:{n:"PtgEndSheet",f:hBe},28:{n:"PtgErr",f:kVe},29:{n:"PtgBool",f:LVe},30:{n:"PtgInt",f:FVe},31:{n:"PtgNum",f:HVe},32:{n:"PtgArray",f:yVe},33:{n:"PtgFunc",f:AVe},34:{n:"PtgFuncVar",f:MVe},35:{n:"PtgName",f:jVe},36:{n:"PtgRef",f:RVe},37:{n:"PtgArea",f:mVe},38:{n:"PtgMemArea",f:zVe},39:{n:"PtgMemErr",f:XVe},40:{n:"PtgMemNoMem",f:ZVe},41:{n:"PtgMemFunc",f:YVe},42:{n:"PtgRefErr",f:qVe},43:{n:"PtgAreaErr",f:gVe},44:{n:"PtgRefN",f:DVe},45:{n:"PtgAreaN",f:wVe},46:{n:"PtgMemAreaN",f:fBe},47:{n:"PtgMemNoMemN",f:mBe},57:{n:"PtgNameX",f:$Ve},58:{n:"PtgRef3d",f:IVe},59:{n:"PtgArea3d",f:pVe},60:{n:"PtgRefErr3d",f:KVe},61:{n:"PtgAreaErr3d",f:vVe},255:{}},gBe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},vBe={1:{n:"PtgElfLel",f:see},2:{n:"PtgElfRw",f:sBe},3:{n:"PtgElfCol",f:JVe},6:{n:"PtgElfRwV",f:aBe},7:{n:"PtgElfColV",f:nBe},10:{n:"PtgElfRadical",f:rBe},11:{n:"PtgElfRadicalS",f:oBe},13:{n:"PtgElfColS",f:eBe},15:{n:"PtgElfColSV",f:tBe},16:{n:"PtgElfRadicalLel",f:iBe},25:{n:"PtgList",f:cBe},29:{n:"PtgSxName",f:uBe},255:{}},wBe={0:{n:"PtgAttrNoop",f:pBe},1:{n:"PtgAttrSemi",f:xVe},2:{n:"PtgAttrIf",f:SVe},4:{n:"PtgAttrChoose",f:_Ve},8:{n:"PtgAttrGoto",f:CVe},16:{n:"PtgAttrSum",f:NVe},32:{n:"PtgAttrBaxcel",f:pQ},33:{n:"PtgAttrBaxcel",f:pQ},64:{n:"PtgAttrSpace",f:bVe},65:{n:"PtgAttrSpaceSemi",f:TVe},128:{n:"PtgAttrIfError",f:EVe},255:{}};function J1(t,e,n,r){if(r.biff<8)return as(t,e);for(var i=t.l+e,o=[],s=0;s!==n.length;++s)switch(n[s][0]){case"PtgArray":n[s][1]=WVe(t,0,r),o.push(n[s][1]);break;case"PtgMemArea":n[s][2]=UVe(t,n[s][1],r),o.push(n[s][2]);break;case"PtgExp":r&&r.biff==12&&(n[s][1][1]=t.read_shift(4),o.push(n[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[s][0];default:break}return e=i-t.l,e!==0&&o.push(as(t,e)),o}function eS(t,e,n){for(var r=t.l+e,i,o,s=[];r!=t.l;)e=r-t.l,o=t[t.l],i=gQ[o]||gQ[gBe[o]],(o===24||o===25)&&(i=(o===24?vBe:wBe)[t[t.l+1]]),!i||!i.f?as(t,e):s.push([i.n,i.f(t,e,n)]);return s}function yBe(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],i=[],o=0;o<r.length;++o){var s=r[o];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var _Be={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function CBe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function aee(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(t[r[0]][0]){case 357:return i=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[r[0]][0][3]?(i=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function vQ(t,e,n){var r=aee(t,e,n);return r=="#REF"?r:CBe(r,n)}function ns(t,e,n,r,i){var o=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},a=[],l,c,u,d=0,h=0,f,p="";if(!t[0]||!t[0][0])return"";for(var g=-1,w="",_=0,S=t[0].length;_<S;++_){var x=t[0][_];switch(x[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),g>=0){switch(t[0][g][1][0]){case 0:w=hi(" ",t[0][g][1][1]);break;case 1:w=hi("\r",t[0][g][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}c=c+w,g=-1}a.push(c+_Be[x[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=D1(x[1][1],s,i),a.push(I1(u,o));break;case"PtgRefN":u=n?D1(x[1][1],n,i):x[1][1],a.push(I1(u,o));break;case"PtgRef3d":d=x[1][1],u=D1(x[1][2],s,i),p=vQ(r,d,i);var P=p;a.push(p+"!"+I1(u,o));break;case"PtgFunc":case"PtgFuncVar":var k=x[1][0],b=x[1][1];k||(k=0),k&=127;var C=k==0?[]:a.slice(-k);a.length-=k,b==="User"&&(b=C.shift()),a.push(b+"("+C.join(",")+")");break;case"PtgBool":a.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(x[1]);break;case"PtgNum":a.push(String(x[1]));break;case"PtgStr":a.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(x[1]);break;case"PtgAreaN":f=zZ(x[1][1],n?{s:n}:s,i),a.push(uB(f,i));break;case"PtgArea":f=zZ(x[1][1],s,i),a.push(uB(f,i));break;case"PtgArea3d":d=x[1][1],f=x[1][2],p=vQ(r,d,i),a.push(p+"!"+uB(f,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var N=(r.names||[])[h-1]||(r[0]||[])[h],B=N?N.Name:"SH33TJSNAME"+String(h);B&&B.slice(0,6)=="_xlfn."&&!i.xlfn&&(B=B.slice(6)),a.push(B);break;case"PtgNameX":var Y=x[1][1];h=x[1][2];var ee;if(i.biff<=5)Y<0&&(Y=-Y),r[Y]&&(ee=r[Y][h]);else{var te="";if(((r[Y]||[])[0]||[])[0]==14849||(((r[Y]||[])[0]||[])[0]==1025?r[Y][h]&&r[Y][h].itab>0&&(te=r.SheetNames[r[Y][h].itab-1]+"!"):te=r.SheetNames[h-1]+"!"),r[Y]&&r[Y][h])te+=r[Y][h].Name;else if(r[0]&&r[0][h])te+=r[0][h].Name;else{var Ce=(aee(r,Y,i)||"").split(";;");Ce[h-1]?te=Ce[h-1]:te+="SH33TJSERRX"}a.push(te);break}ee||(ee={Name:"SH33TJSERRY"}),a.push(ee.Name);break;case"PtgParen":var Re="(",_e=")";if(g>=0){switch(w="",t[0][g][1][0]){case 2:Re=hi(" ",t[0][g][1][1])+Re;break;case 3:Re=hi("\r",t[0][g][1][1])+Re;break;case 4:_e=hi(" ",t[0][g][1][1])+_e;break;case 5:_e=hi("\r",t[0][g][1][1])+_e;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}a.push(Re+a.pop()+_e);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:x[1][1],r:x[1][0]};var L={c:n.c,r:n.r};if(r.sharedf[Xt(u)]){var M=r.sharedf[Xt(u)];a.push(ns(M,s,L,r,i))}else{var q=!1;for(l=0;l!=r.arrayf.length;++l)if(c=r.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(ns(c[1],s,L,r,i)),q=!0;break}q||a.push(x[1])}break;case"PtgArray":a.push("{"+yBe(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var y=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&y.indexOf(t[0][_][0])==-1){x=t[0][g];var E=!0;switch(x[1][0]){case 4:E=!1;case 0:w=hi(" ",x[1][1]);break;case 5:E=!1;case 1:w=hi("\r",x[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}a.push((E?w:"")+a.pop()+(E?"":w)),g=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function SBe(t,e,n){var r=t.l+e,i=n.biff==2?1:2,o,s=t.read_shift(i);if(s==65535)return[[],as(t,e-2)];var a=eS(t,s,n);return e!==s+i&&(o=J1(t,e-s-i,a,n)),t.l=r,[a,o]}function EBe(t,e,n){var r=t.l+e,i=n.biff==2?1:2,o,s=t.read_shift(i);if(s==65535)return[[],as(t,e-2)];var a=eS(t,s,n);return e!==s+i&&(o=J1(t,e-s-i,a,n)),t.l=r,[a,o]}function xBe(t,e,n,r){var i=t.l+e,o=eS(t,r,n),s;return i!==t.l&&(s=J1(t,i-t.l,o,n)),[o,s]}function bBe(t,e,n){var r=t.l+e,i,o=t.read_shift(2),s=eS(t,o,n);return o==65535?[[],as(t,e-2)]:(e!==o+2&&(i=J1(t,r-o-2,s,n)),[s,i])}function TBe(t){var e;if(Ad(t,t.l+6)!==65535)return[is(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function RBe(t){if(t==null){var e=He(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Dp(t);return Dp(0)}function pB(t,e,n){var r=t.l+e,i=pu(t,6);n.biff==2&&++t.l;var o=TBe(t,8),s=t.read_shift(1);n.biff!=2&&(t.read_shift(1),n.biff>=5&&t.read_shift(4));var a=EBe(t,r-t.l,n);return{cell:i,val:o[0],formula:a,shared:s>>3&1,tt:o[1]}}function DBe(t,e,n,r,i){var o=Ap(e,n,i),s=RBe(t.v),a=He(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=He(t.bf.length),u=0;u<t.bf.length;++u)c[u]=t.bf[u];var d=po([o,s,a,c]);return d}function kA(t,e,n){var r=t.read_shift(4),i=eS(t,r,n),o=t.read_shift(4),s=o>0?J1(t,o,i,n):null;return[i,s]}var IBe=kA,FA=kA,ABe=kA,MBe=kA,OBe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},lee={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},NBe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wQ(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,n){return n.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function PBe(t){var e="of:="+t.replace(h3,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function gB(t){var e=t.split(":"),n=e[0].split(".")[0];return[n,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function kBe(t){return t.replace(/\./,"!")}var M1={},Hv={},O1=typeof Map<"u";function p3(t,e,n){var r=0,i=t.length;if(n){if(O1?n.has(e):Object.prototype.hasOwnProperty.call(n,e)){for(var o=O1?n.get(e):n[e];r<o.length;++r)if(t[o[r]].t===e)return t.Count++,o[r]}}else for(;r<i;++r)if(t[r].t===e)return t.Count++,r;return t[i]={t:e},t.Count++,t.Unique++,n&&(O1?(n.has(e)||n.set(e,[]),n.get(e).push(i)):(Object.prototype.hasOwnProperty.call(n,e)||(n[e]=[]),n[e].push(i))),i}function LA(t,e){var n={min:t+1,max:t+1},r=-1;return e.MDW&&(rs=e.MDW),e.width!=null?n.customWidth=1:e.wpx!=null?r=$1(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(n.width=bA(r),n.customWidth=1):e.width!=null&&(n.width=e.width),e.hidden&&(n.hidden=!0),e.level!=null&&(n.outlineLevel=n.level=e.level),n}function bp(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(n=[1,1,1,1,.5,.5]),t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function xf(t,e,n){var r=n.revssf[e.z!=null?e.z:"General"],i=60,o=t.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){Od(e.z,i),n.ssf[i]=e.z,n.revssf[e.z]=r=i;break}}for(i=0;i!=o;++i)if(t[i].numFmtId===r)return i;return t[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function cee(t,e,n,r,i,o){try{r.cellNF&&(t.z=Kt[e])}catch(a){if(r.WTF)throw a}if(!(t.t==="z"&&!r.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Lr(t.v)),(!r||r.cellText!==!1)&&t.t!=="z")try{if(Kt[e]==null&&Od(OPe[e]||"General",e),t.t==="e")t.w=t.w||Ld[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=L1(t.v);else if(t.t==="d"){var s=Ji(t.v);(s|0)===s?t.w=s.toString(10):t.w=L1(s)}else{if(t.v===void 0)return"";t.w=Tp(t.v,Hv)}else t.t==="d"?t.w=hl(e,Ji(t.v),Hv):t.w=hl(e,t.v,Hv)}catch(a){if(r.WTF)throw a}if(r.cellStyles&&n!=null)try{t.s=o.Fills[n],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=xA(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),r.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=xA(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),r.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(a){if(r.WTF&&o.Fills)throw a}}}function FBe(t,e,n){if(t&&t["!ref"]){var r=qn(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+t["!ref"])}}function LBe(t,e){var n=qn(e);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(t["!ref"]=fn(n))}var HBe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,VBe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,BBe=/<(?:\w:)?hyperlink [^>]*>/mg,UBe=/"(\w*:\w*)"/,WBe=/<(?:\w:)?col\b[^>]*[\/]?>/g,jBe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,$Be=/<(?:\w:)?pageMargins[^>]*\/>/g,uee=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,GBe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,zBe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function YBe(t,e,n,r,i,o,s){if(!t)return t;r||(r={"!id":{}}),mi!=null&&e.dense==null&&(e.dense=mi);var a=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",d=t.match(VBe);d?(c=t.slice(0,d.index),u=t.slice(d.index+d[0].length)):c=u=t;var h=c.match(uee);h?g3(h[0],a,i,n):(h=c.match(GBe))&&KBe(h[0],h[1]||"",a,i,n,s,o);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var p=c.slice(f,f+50).match(UBe);p&&LBe(a,p[1])}var g=c.match(zBe);g&&g[1]&&l3e(g[1],i);var w=[];if(e.cellStyles){var _=c.match(WBe);_&&r3e(w,_)}d&&d3e(d[1],a,e,l,o,s);var S=u.match(jBe);S&&(a["!autofilter"]=o3e(S[0]));var x=[],P=u.match(HBe);if(P)for(f=0;f!=P.length;++f)x[f]=qn(P[f].slice(P[f].indexOf('"')+1));var k=u.match(BBe);k&&e3e(a,k,r);var b=u.match($Be);if(b&&(a["!margins"]=t3e(Zt(b[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=fn(l)),e.sheetRows>0&&a["!ref"]){var C=qn(a["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>l.e.r&&(C.e.r=l.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>l.e.c&&(C.e.c=l.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),a["!fullref"]=a["!ref"],a["!ref"]=fn(C))}return w.length>0&&(a["!cols"]=w),x.length>0&&(a["!merges"]=x),a}function qBe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',n=0;n!=t.length;++n)e+='<mergeCell ref="'+fn(t[n])+'"/>';return e+"</mergeCells>"}function g3(t,e,n,r){var i=Zt(t);n.Sheets[r]||(n.Sheets[r]={}),i.codeName&&(n.Sheets[r].CodeName=Yn(Sr(i.codeName)))}function KBe(t,e,n,r,i){g3(t.slice(0,t.indexOf(">")),n,r,i)}function XBe(t,e,n,r,i){var o=!1,s={},a=null;if(r.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[n];try{e.Workbook&&(l=e.Workbook.Sheets[n].CodeName||l)}catch{}o=!0,s.codeName=hu(gr(l))}if(t&&t["!outline"]){var c={summaryBelow:1,summaryRight:1};t["!outline"].above&&(c.summaryBelow=0),t["!outline"].left&&(c.summaryRight=0),a=(a||"")+ct("outlinePr",null,c)}!o&&!a||(i[i.length]=ct("sheetPr",a,s))}var ZBe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],QBe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function JBe(t){var e={sheet:1};return ZBe.forEach(function(n){t[n]!=null&&t[n]&&(e[n]="1")}),QBe.forEach(function(n){t[n]!=null&&!t[n]&&(e[n]="0")}),t.password&&(e.password=c3(t.password).toString(16).toUpperCase()),ct("sheetProtection",null,e)}function e3e(t,e,n){for(var r=Array.isArray(t),i=0;i!=e.length;++i){var o=Zt(Sr(e[i]),!0);if(!o.ref)return;var s=((n||{})["!id"]||[])[o.id];s?(o.Target=s.Target,o.location&&(o.Target+="#"+Yn(o.location))):(o.Target="#"+Yn(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var a=qn(o.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=Xt({c,r:l});r?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=o):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=o)}}}function t3e(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(n){t[n]&&(e[n]=parseFloat(t[n]))}),e}function n3e(t){return bp(t),ct("pageMargins",null,t)}function r3e(t,e){for(var n=!1,r=0;r!=e.length;++r){var i=Zt(e[r],!0);i.hidden&&(i.hidden=Fr(i.hidden));var o=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!n&&i.width&&(n=!0,u3(i.width)),yf(i);o<=s;)t[o++]=Hr(i)}}function i3e(t,e){for(var n=["<cols>"],r,i=0;i!=e.length;++i)(r=e[i])&&(n[n.length]=ct("col",null,LA(i,r)));return n[n.length]="</cols>",n.join("")}function o3e(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function s3e(t,e,n,r){var i=typeof t.ref=="string"?t.ref:fn(t.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,s=ia(i);s.s.r==s.e.r&&(s.e.r=ia(e["!ref"]).e.r,i=fn(s));for(var a=0;a<o.length;++a){var l=o[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return a==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),ct("autoFilter",null,{ref:i})}var a3e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function l3e(t,e){e.Views||(e.Views=[{}]),(t.match(a3e)||[]).forEach(function(n,r){var i=Zt(n);e.Views[r]||(e.Views[r]={}),+i.zoomScale&&(e.Views[r].zoom=+i.zoomScale),Fr(i.rightToLeft)&&(e.Views[r].RTL=!0)})}function c3e(t,e,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ct("sheetViews",ct("sheetView",null,i),{})}function u3e(t,e,n,r){if(t.c&&n["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",o=t.t,s=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Ld[t.v];break;case"d":r&&r.cellDates?i=Lr(t.v,-1).toISOString():(t=Hr(t),t.t="n",i=""+(t.v=Ji(Lr(t.v)))),typeof t.z>"u"&&(t.z=Kt[14]);break;default:i=t.v;break}var a=Vo("v",gr(i)),l={r:e},c=xf(r.cellXfs,t,r);switch(c!==0&&(l.s=c),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=Vo("v",""+p3(r.Strings,t.v,r.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=o&&(t.t=o,t.v=s),typeof t.f=="string"&&t.f){var u=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=ct("f",gr(t.f),u)+(t.v!=null?a:"")}return t.l&&n["!links"].push([e,t.l]),t.D&&(l.cm=1),ct("c",a,l)}var d3e=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=H1("v"),s=H1("f");return function(l,c,u,d,h,f){for(var p=0,g="",w=[],_=[],S=0,x=0,P=0,k="",b,C,N=0,B=0,Y,ee,te=0,Ce=0,Re=Array.isArray(f.CellXf),_e,L=[],M=[],q=Array.isArray(c),y=[],E={},R=!1,D=!!u.sheetStubs,A=l.split(e),O=0,U=A.length;O!=U;++O){g=A[O].trim();var ie=g.length;if(ie!==0){var ue=0;e:for(p=0;p<ie;++p)switch(g[p]){case">":if(g[p-1]!="/"){++p;break e}if(u&&u.cellStyles){if(C=Zt(g.slice(ue,p),!0),N=C.r!=null?parseInt(C.r,10):N+1,B=-1,u.sheetRows&&u.sheetRows<N)continue;E={},R=!1,C.ht&&(R=!0,E.hpt=parseFloat(C.ht),E.hpx=Wv(E.hpt)),C.hidden=="1"&&(R=!0,E.hidden=!0),C.outlineLevel!=null&&(R=!0,E.level=+C.outlineLevel),R&&(y[N-1]=E)}break;case"<":ue=p;break}if(ue>=p)break;if(C=Zt(g.slice(ue,p),!0),N=C.r!=null?parseInt(C.r,10):N+1,B=-1,!(u.sheetRows&&u.sheetRows<N)){d.s.r>N-1&&(d.s.r=N-1),d.e.r<N-1&&(d.e.r=N-1),u&&u.cellStyles&&(E={},R=!1,C.ht&&(R=!0,E.hpt=parseFloat(C.ht),E.hpx=Wv(E.hpt)),C.hidden=="1"&&(R=!0,E.hidden=!0),C.outlineLevel!=null&&(R=!0,E.level=+C.outlineLevel),R&&(y[N-1]=E)),w=g.slice(p).split(t);for(var fe=0;fe!=w.length&&w[fe].trim().charAt(0)=="<";++fe);for(w=w.slice(fe),p=0;p!=w.length;++p)if(g=w[p].trim(),g.length!==0){if(_=g.match(n),S=p,x=0,P=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,_!=null&&_.length===2){for(S=0,k=_[1],x=0;x!=k.length&&!((P=k.charCodeAt(x)-64)<1||P>26);++x)S=26*S+P;--S,B=S}else++B;for(x=0;x!=g.length&&g.charCodeAt(x)!==62;++x);if(++x,C=Zt(g.slice(0,x),!0),C.r||(C.r=Xt({r:N-1,c:B})),k=g.slice(x),b={t:""},(_=k.match(o))!=null&&_[1]!==""&&(b.v=Yn(_[1])),u.cellFormula){if((_=k.match(s))!=null&&_[1]!==""){if(b.f=Yn(Sr(_[1])).replace(/\r\n/g,`
`),u.xlfn||(b.f=mQ(b.f)),_[0].indexOf('t="array"')>-1)b.F=(k.match(i)||[])[1],b.F.indexOf(":")>-1&&L.push([qn(b.F),b.F]);else if(_[0].indexOf('t="shared"')>-1){ee=Zt(_[0]);var de=Yn(Sr(_[1]));u.xlfn||(de=mQ(de)),M[parseInt(ee.si,10)]=[ee,de,C.r]}}else(_=k.match(/<f[^>]*\/>/))&&(ee=Zt(_[0]),M[ee.si]&&(b.f=aVe(M[ee.si][1],M[ee.si][2],C.r)));var ye=Jr(C.r);for(x=0;x<L.length;++x)ye.r>=L[x][0].s.r&&ye.r<=L[x][0].e.r&&ye.c>=L[x][0].s.c&&ye.c<=L[x][0].e.c&&(b.F=L[x][1])}if(C.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(D)b.t="z";else continue;else b.t=C.t||"n";switch(d.s.c>B&&(d.s.c=B),d.e.c<B&&(d.e.c=B),b.t){case"n":if(b.v==""||b.v==null){if(!D)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!D)continue;b.t="z"}else Y=M1[parseInt(b.v,10)],b.v=Y.t,b.r=Y.r,u.cellHTML&&(b.h=Y.h);break;case"str":b.t="s",b.v=b.v!=null?Sr(b.v):"",u.cellHTML&&(b.h=$B(b.v));break;case"inlineStr":_=k.match(r),b.t="s",_!=null&&(Y=l3(_[1]))?(b.v=Y.t,u.cellHTML&&(b.h=Y.h)):b.v="";break;case"b":b.v=Fr(b.v);break;case"d":u.cellDates?b.v=Lr(b.v,1):(b.v=Ji(Lr(b.v,1)),b.t="n");break;case"e":(!u||u.cellText!==!1)&&(b.w=b.v),b.v=hJ[b.v];break}if(te=Ce=0,_e=null,Re&&C.s!==void 0&&(_e=f.CellXf[C.s],_e!=null&&(_e.numFmtId!=null&&(te=_e.numFmtId),u.cellStyles&&_e.fillId!=null&&(Ce=_e.fillId))),cee(b,te,Ce,u,h,f),u.cellDates&&Re&&b.t=="n"&&jv(Kt[te])&&(b.t="d",b.v=OA(b.v)),C.cm&&u.xlmeta){var Pe=(u.xlmeta.Cell||[])[+C.cm-1];Pe&&Pe.type=="XLDAPR"&&(b.D=!0)}if(q){var F=Jr(C.r);c[F.r]||(c[F.r]=[]),c[F.r][F.c]=b}else c[C.r]=b}}}}y.length>0&&(c["!rows"]=y)}}();function h3e(t,e,n,r){var i=[],o=[],s=qn(t["!ref"]),a="",l,c="",u=[],d=0,h=0,f=t["!rows"],p=Array.isArray(t),g={r:c},w,_=-1;for(h=s.s.c;h<=s.e.c;++h)u[h]=Qr(h);for(d=s.s.r;d<=s.e.r;++d){for(o=[],c=bi(d),h=s.s.c;h<=s.e.c;++h){l=u[h]+c;var S=p?(t[d]||[])[h]:t[l];S!==void 0&&(a=u3e(S,l,t,e,n,r))!=null&&o.push(a)}(o.length>0||f&&f[d])&&(g={r:c},f&&f[d]&&(w=f[d],w.hidden&&(g.hidden=1),_=-1,w.hpx?_=G1(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(g.ht=_,g.customHeight=1),w.level&&(g.outlineLevel=w.level)),i[i.length]=ct("row",o.join(""),g))}if(f)for(;d<f.length;++d)f&&f[d]&&(g={r:d+1},w=f[d],w.hidden&&(g.hidden=1),_=-1,w.hpx?_=G1(w.hpx):w.hpt&&(_=w.hpt),_>-1&&(g.ht=_,g.customHeight=1),w.level&&(g.outlineLevel=w.level),i[i.length]=ct("row","",g));return i.join("")}function dee(t,e,n,r){var i=[Ti,ct("worksheet",null,{xmlns:Op[0],"xmlns:r":Qi.r})],o=n.SheetNames[t],s=0,a="",l=n.Sheets[o];l==null&&(l={});var c=l["!ref"]||"A1",u=qn(c);if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=fn(u)}r||(r={}),l["!comments"]=[];var d=[];XBe(l,n,t,e,i),i[i.length]=ct("dimension",null,{ref:c}),i[i.length]=c3e(l,e,t,n),e.sheetFormat&&(i[i.length]=ct("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=i3e(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=h3e(l,e,t,n,r),a.length>0&&(i[i.length]=a)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),l["!protect"]&&(i[i.length]=JBe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=s3e(l["!autofilter"],l,n,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=qBe(l["!merges"]));var h=-1,f,p=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(f={ref:g[0]},g[1].Target.charAt(0)!="#"&&(p=pr(r,-1,gr(g[1].Target).replace(/#.*$/,""),Cn.HLINK),f["r:id"]="rId"+p),(h=g[1].Target.indexOf("#"))>-1&&(f.location=gr(g[1].Target.slice(h+1))),g[1].Tooltip&&(f.tooltip=gr(g[1].Tooltip)),i[i.length]=ct("hyperlink",null,f))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=n3e(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Vo("ignoredErrors",ct("ignoredError",null,{numberStoredAsText:1,sqref:c}))),d.length>0&&(p=pr(r,-1,"../drawings/drawing"+(t+1)+".xml",Cn.DRAW),i[i.length]=ct("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=d),l["!comments"].length>0&&(p=pr(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Cn.VML),i[i.length]=ct("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function f3e(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=r,o&7&&(n.level=o&7),o&16&&(n.hidden=!0),o&32&&(n.hpt=i/20),n}function m3e(t,e,n){var r=He(145),i=(n["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var o=320;i.hpx?o=G1(i.hpx)*20:i.hpt&&(o=i.hpt*20),r.write_shift(2,o),r.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),r.write_shift(1,s),r.write_shift(1,0);var a=0,l=r.l;r.l+=4;for(var c={r:t,c:0},u=0;u<16;++u)if(!(e.s.c>u+1<<10||e.e.c<u<<10)){for(var d=-1,h=-1,f=u<<10;f<u+1<<10;++f){c.c=f;var p=Array.isArray(n)?(n[c.r]||[])[c.c]:n[Xt(c)];p&&(d<0&&(d=f),h=f)}d<0||(++a,r.write_shift(4,d),r.write_shift(4,h))}var g=r.l;return r.l=l,r.write_shift(4,a),r.l=g,r.length>r.l?r.slice(0,r.l):r}function p3e(t,e,n,r){var i=m3e(r,n,e);(i.length>17||(e["!rows"]||[])[r])&&Ge(t,0,i)}var g3e=Fp,v3e=Yv;function w3e(){}function y3e(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=Ske(t,e-19),n}function _3e(t,e,n){n==null&&(n=He(84+4*t.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return CA({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),aJ(t,n),n.slice(0,n.l)}function C3e(t){var e=fl(t);return[e]}function S3e(t,e,n){return n==null&&(n=He(8)),Np(e,n)}function E3e(t){var e=Pp(t);return[e]}function x3e(t,e,n){return n==null&&(n=He(4)),kp(e,n)}function b3e(t){var e=fl(t),n=t.read_shift(1);return[e,n,"b"]}function T3e(t,e,n){return n==null&&(n=He(9)),Np(e,n),n.write_shift(1,t.v?1:0),n}function R3e(t){var e=Pp(t),n=t.read_shift(1);return[e,n,"b"]}function D3e(t,e,n){return n==null&&(n=He(5)),kp(e,n),n.write_shift(1,t.v?1:0),n}function I3e(t){var e=fl(t),n=t.read_shift(1);return[e,n,"e"]}function A3e(t,e,n){return n==null&&(n=He(9)),Np(e,n),n.write_shift(1,t.v),n}function M3e(t){var e=Pp(t),n=t.read_shift(1);return[e,n,"e"]}function O3e(t,e,n){return n==null&&(n=He(8)),kp(e,n),n.write_shift(1,t.v),n.write_shift(2,0),n.write_shift(1,0),n}function N3e(t){var e=fl(t),n=t.read_shift(4);return[e,n,"s"]}function P3e(t,e,n){return n==null&&(n=He(12)),Np(e,n),n.write_shift(4,e.v),n}function k3e(t){var e=Pp(t),n=t.read_shift(4);return[e,n,"s"]}function F3e(t,e,n){return n==null&&(n=He(8)),kp(e,n),n.write_shift(4,e.v),n}function L3e(t){var e=fl(t),n=is(t);return[e,n,"n"]}function H3e(t,e,n){return n==null&&(n=He(16)),Np(e,n),Dp(t.v,n),n}function hee(t){var e=Pp(t),n=is(t);return[e,n,"n"]}function V3e(t,e,n){return n==null&&(n=He(12)),kp(e,n),Dp(t.v,n),n}function B3e(t){var e=fl(t),n=r3(t);return[e,n,"n"]}function U3e(t,e,n){return n==null&&(n=He(12)),Np(e,n),lJ(t.v,n),n}function W3e(t){var e=Pp(t),n=r3(t);return[e,n,"n"]}function j3e(t,e,n){return n==null&&(n=He(8)),kp(e,n),lJ(t.v,n),n}function $3e(t){var e=fl(t),n=e3(t);return[e,n,"is"]}function G3e(t){var e=fl(t),n=ss(t);return[e,n,"str"]}function z3e(t,e,n){return n==null&&(n=He(12+4*t.v.length)),Np(e,n),go(t.v,n),n.length>n.l?n.slice(0,n.l):n}function Y3e(t){var e=Pp(t),n=ss(t);return[e,n,"str"]}function q3e(t,e,n){return n==null&&(n=He(8+4*t.v.length)),kp(e,n),go(t.v,n),n.length>n.l?n.slice(0,n.l):n}function K3e(t,e,n){var r=t.l+e,i=fl(t);i.r=n["!row"];var o=t.read_shift(1),s=[i,o,"b"];if(n.cellFormula){t.l+=2;var a=FA(t,r-t.l,n);s[3]=ns(a,null,i,n.supbooks,n)}else t.l=r;return s}function X3e(t,e,n){var r=t.l+e,i=fl(t);i.r=n["!row"];var o=t.read_shift(1),s=[i,o,"e"];if(n.cellFormula){t.l+=2;var a=FA(t,r-t.l,n);s[3]=ns(a,null,i,n.supbooks,n)}else t.l=r;return s}function Z3e(t,e,n){var r=t.l+e,i=fl(t);i.r=n["!row"];var o=is(t),s=[i,o,"n"];if(n.cellFormula){t.l+=2;var a=FA(t,r-t.l,n);s[3]=ns(a,null,i,n.supbooks,n)}else t.l=r;return s}function Q3e(t,e,n){var r=t.l+e,i=fl(t);i.r=n["!row"];var o=ss(t),s=[i,o,"str"];if(n.cellFormula){t.l+=2;var a=FA(t,r-t.l,n);s[3]=ns(a,null,i,n.supbooks,n)}else t.l=r;return s}var J3e=Fp,e4e=Yv;function t4e(t,e){return e==null&&(e=He(4)),e.write_shift(4,t),e}function n4e(t,e){var n=t.l+e,r=Fp(t,16),i=t3(t),o=ss(t),s=ss(t),a=ss(t);t.l=n;var l={rfx:r,relId:i,loc:o,display:a};return s&&(l.Tooltip=s),l}function r4e(t,e){var n=He(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Yv({s:Jr(t[0]),e:Jr(t[0])},n),n3("rId"+e,n);var r=t[1].Target.indexOf("#"),i=r==-1?"":t[1].Target.slice(r+1);return go(i||"",n),go(t[1].Tooltip||"",n),go("",n),n.slice(0,n.l)}function i4e(){}function o4e(t,e,n){var r=t.l+e,i=cJ(t,16),o=t.read_shift(1),s=[i];if(s[2]=o,n.cellFormula){var a=IBe(t,r-t.l,n);s[1]=a}else t.l=r;return s}function s4e(t,e,n){var r=t.l+e,i=Fp(t,16),o=[i];if(n.cellFormula){var s=MBe(t,r-t.l,n);o[1]=s,t.l=r}else t.l=r;return o}function a4e(t,e,n){n==null&&(n=He(18));var r=LA(t,e);n.write_shift(-4,t),n.write_shift(-4,t),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),n.write_shift(2,i),n}var fee=["left","right","top","bottom","header","footer"];function l4e(t){var e={};return fee.forEach(function(n){e[n]=is(t,8)}),e}function c4e(t,e){return e==null&&(e=He(6*8)),bp(t),fee.forEach(function(n){Dp(t[n],e)}),e}function u4e(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function d4e(t,e,n){n==null&&(n=He(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function h4e(t){var e=He(24);return e.write_shift(4,4),e.write_shift(4,1),Yv(t,e),e}function f4e(t,e){return e==null&&(e=He(16*4+2)),e.write_shift(2,t.password?c3(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?e.write_shift(4,t[n[0]]!=null&&!t[n[0]]?1:0):e.write_shift(4,t[n[0]]!=null&&t[n[0]]?0:1)}),e}function m4e(){}function p4e(){}function g4e(t,e,n,r,i,o,s){if(!t)return t;var a=e||{};r||(r={"!id":{}}),mi!=null&&a.dense==null&&(a.dense=mi);var l=a.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=[],h=!1,f=!1,p,g,w,_,S,x,P,k,b,C=[];a.biff=12,a["!row"]=0;var N=0,B=!1,Y=[],ee={},te=a.supbooks||i.supbooks||[[]];if(te.sharedf=ee,te.arrayf=Y,te.SheetNames=i.SheetNames||i.Sheets.map(function(E){return E.name}),!a.supbooks&&(a.supbooks=te,i.Names))for(var Ce=0;Ce<i.Names.length;++Ce)te[0][Ce+1]=i.Names[Ce];var Re=[],_e=[],L=!1;z1[16]={n:"BrtShortReal",f:hee};var M,q;if(Fd(t,function(R,D,A){if(!f)switch(A){case 148:c=R;break;case 0:p=R,a.sheetRows&&a.sheetRows<=p.r&&(f=!0),k=bi(_=p.r),a["!row"]=p.r,(R.hidden||R.hpt||R.level!=null)&&(R.hpt&&(R.hpx=Wv(R.hpt)),_e[R.r]=R);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:R[2]},R[2]){case"n":g.v=R[1];break;case"s":P=M1[R[1]],g.v=P.t,g.r=P.r;break;case"b":g.v=!!R[1];break;case"e":g.v=R[1],a.cellText!==!1&&(g.w=Ld[g.v]);break;case"str":g.t="s",g.v=R[1];break;case"is":g.t="s",g.v=R[1].t;break}if((w=s.CellXf[R[0].iStyleRef])&&cee(g,w.numFmtId,null,a,o,s),S=R[0].c==-1?S+1:R[0].c,a.dense?(l[_]||(l[_]=[]),l[_][S]=g):l[Qr(S)+k]=g,a.cellFormula){for(B=!1,N=0;N<Y.length;++N){var O=Y[N];p.r>=O[0].s.r&&p.r<=O[0].e.r&&S>=O[0].s.c&&S<=O[0].e.c&&(g.F=fn(O[0]),B=!0)}!B&&R.length>3&&(g.f=R[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>S&&(u.s.c=S),u.e.r<p.r&&(u.e.r=p.r),u.e.c<S&&(u.e.c=S),a.cellDates&&w&&g.t=="n"&&jv(Kt[w.numFmtId])){var U=Cp(g.v);U&&(g.t="d",g.v=new Date(U.y,U.m-1,U.d,U.H,U.M,U.S,U.u))}M&&(M.type=="XLDAPR"&&(g.D=!0),M=void 0),q&&(q=void 0);break;case 1:case 12:if(!a.sheetStubs||h)break;g={t:"z",v:void 0},S=R[0].c==-1?S+1:R[0].c,a.dense?(l[_]||(l[_]=[]),l[_][S]=g):l[Qr(S)+k]=g,u.s.r>p.r&&(u.s.r=p.r),u.s.c>S&&(u.s.c=S),u.e.r<p.r&&(u.e.r=p.r),u.e.c<S&&(u.e.c=S),M&&(M.type=="XLDAPR"&&(g.D=!0),M=void 0),q&&(q=void 0);break;case 176:C.push(R);break;case 49:M=((a.xlmeta||{}).Cell||[])[R-1];break;case 494:var ie=r["!id"][R.relId];for(ie?(R.Target=ie.Target,R.loc&&(R.Target+="#"+R.loc),R.Rel=ie):R.relId==""&&(R.Target="#"+R.loc),_=R.rfx.s.r;_<=R.rfx.e.r;++_)for(S=R.rfx.s.c;S<=R.rfx.e.c;++S)a.dense?(l[_]||(l[_]=[]),l[_][S]||(l[_][S]={t:"z",v:void 0}),l[_][S].l=R):(x=Xt({c:S,r:_}),l[x]||(l[x]={t:"z",v:void 0}),l[x].l=R);break;case 426:if(!a.cellFormula)break;Y.push(R),b=a.dense?l[_][S]:l[Qr(S)+k],b.f=ns(R[1],u,{r:p.r,c:S},te,a),b.F=fn(R[0]);break;case 427:if(!a.cellFormula)break;ee[Xt(R[0].s)]=R[1],b=a.dense?l[_][S]:l[Qr(S)+k],b.f=ns(R[1],u,{r:p.r,c:S},te,a);break;case 60:if(!a.cellStyles)break;for(;R.e>=R.s;)Re[R.e--]={width:R.w/256,hidden:!!(R.flags&1),level:R.level},L||(L=!0,u3(R.w/256)),yf(Re[R.e+1]);break;case 161:l["!autofilter"]={ref:fn(R)};break;case 476:l["!margins"]=R;break;case 147:i.Sheets[n]||(i.Sheets[n]={}),R.name&&(i.Sheets[n].CodeName=R.name),(R.above||R.left)&&(l["!outline"]={above:R.above,left:R.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),R.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:d.push(A),h=!0;break;case 38:d.pop(),h=!1;break;default:if(!D.T){if(!h||a.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=fn(c||u)),a.sheetRows&&l["!ref"]){var y=qn(l["!ref"]);a.sheetRows<=+y.e.r&&(y.e.r=a.sheetRows-1,y.e.r>u.e.r&&(y.e.r=u.e.r),y.e.r<y.s.r&&(y.s.r=y.e.r),y.e.c>u.e.c&&(y.e.c=u.e.c),y.e.c<y.s.c&&(y.s.c=y.e.c),l["!fullref"]=l["!ref"],l["!ref"]=fn(y))}return C.length>0&&(l["!merges"]=C),Re.length>0&&(l["!cols"]=Re),_e.length>0&&(l["!rows"]=_e),l}function v4e(t,e,n,r,i,o,s){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=Hr(e),e.z=e.z||Kt[14],e.v=Ji(Lr(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r:n,c:r};switch(l.s=xf(i.cellXfs,e,i),e.l&&o["!links"].push([Xt(l),e.l]),e.c&&o["!comments"].push([Xt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=p3(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,s?Ge(t,18,F3e(e,l)):Ge(t,7,P3e(e,l))):(l.t="str",s?Ge(t,17,q3e(e,l)):Ge(t,6,z3e(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?s?Ge(t,13,j3e(e,l)):Ge(t,2,U3e(e,l)):s?Ge(t,16,V3e(e,l)):Ge(t,5,H3e(e,l)),!0;case"b":return l.t="b",s?Ge(t,15,D3e(e,l)):Ge(t,4,T3e(e,l)),!0;case"e":return l.t="e",s?Ge(t,14,O3e(e,l)):Ge(t,3,A3e(e,l)),!0}return s?Ge(t,12,x3e(e,l)):Ge(t,1,S3e(e,l)),!0}function w4e(t,e,n,r){var i=qn(e["!ref"]||"A1"),o,s="",a=[];Ge(t,145);var l=Array.isArray(e),c=i.e.r;e["!rows"]&&(c=Math.max(i.e.r,e["!rows"].length-1));for(var u=i.s.r;u<=c;++u){s=bi(u),p3e(t,e,i,u);var d=!1;if(u<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){u===i.s.r&&(a[h]=Qr(h)),o=a[h]+s;var f=l?(e[u]||[])[h]:e[o];if(!f){d=!1;continue}d=v4e(t,f,u,h,r,e,d)}}Ge(t,146)}function y4e(t,e){!e||!e["!merges"]||(Ge(t,177,t4e(e["!merges"].length)),e["!merges"].forEach(function(n){Ge(t,176,e4e(n))}),Ge(t,178))}function _4e(t,e){!e||!e["!cols"]||(Ge(t,390),e["!cols"].forEach(function(n,r){n&&Ge(t,60,a4e(r,n))}),Ge(t,391))}function C4e(t,e){!e||!e["!ref"]||(Ge(t,648),Ge(t,649,h4e(qn(e["!ref"]))),Ge(t,650))}function S4e(t,e,n){e["!links"].forEach(function(r){if(r[1].Target){var i=pr(n,-1,r[1].Target.replace(/#.*$/,""),Cn.HLINK);Ge(t,494,r4e(r,i))}}),delete e["!links"]}function E4e(t,e,n,r){if(e["!comments"].length>0){var i=pr(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",Cn.VML);Ge(t,551,n3("rId"+i)),e["!legacy"]=i}}function x4e(t,e,n,r){if(e["!autofilter"]){var i=e["!autofilter"],o=typeof i.ref=="string"?i.ref:fn(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,a=ia(o);a.s.r==a.e.r&&(a.e.r=ia(e["!ref"]).e.r,o=fn(a));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==r){c.Ref="'"+n.SheetNames[r]+"'!"+o;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+o}),Ge(t,161,Yv(qn(o))),Ge(t,162)}}function b4e(t,e,n){Ge(t,133),Ge(t,137,d4e(e,n)),Ge(t,138),Ge(t,134)}function T4e(t,e){e["!protect"]&&Ge(t,535,f4e(e["!protect"]))}function R4e(t,e,n,r){var i=ra(),o=n.SheetNames[t],s=n.Sheets[o]||{},a=o;try{n&&n.Workbook&&(a=n.Workbook.Sheets[t].CodeName||a)}catch{}var l=qn(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Ge(i,129),(n.vbaraw||s["!outline"])&&Ge(i,147,_3e(a,s["!outline"])),Ge(i,148,v3e(l)),b4e(i,s,n.Workbook),_4e(i,s,t,e,n),w4e(i,s,t,e,n),T4e(i,s),x4e(i,s,n,t),y4e(i,s),S4e(i,s,r),s["!margins"]&&Ge(i,476,c4e(s["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&C4e(i,s),E4e(i,s,t,r),Ge(i,130),i.end()}function D4e(t){var e=[],n=t.match(/^<c:numCache>/),r;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var s=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(e[+s[1]]=n?+s[2]:s[2])});var i=Yn((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[e,i,r]}function I4e(t,e,n,r,i,o){var s=o||{"!type":"chart"};if(!t)return o;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=D4e(d);u.s.r=u.s.c=0,u.e.c=a,c=Qr(a),h[0].forEach(function(f,p){s[c+bi(p)]={t:"n",v:f,z:h[1]},l=p}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(s["!ref"]=fn(u)),s}function A4e(t,e,n,r,i){if(!t)return t;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s,a=t.match(uee);return a&&g3(a[0],o,i,n),(s=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function M4e(t,e){t.l+=10;var n=ss(t,e-10);return{name:n}}function O4e(t,e,n,r,i){if(!t)return t;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s=[],a=!1;return Fd(t,function(c,u,d){switch(d){case 550:o["!rel"]=c;break;case 651:i.Sheets[n]||(i.Sheets[n]={}),c.name&&(i.Sheets[n].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(d);break;case 38:s.pop();break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!a||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}},e),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var v3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],N4e=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],P4e=[],k4e=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function yQ(t,e){for(var n=0;n!=t.length;++n)for(var r=t[n],i=0;i!=e.length;++i){var o=e[i];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=Fr(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function _Q(t,e){for(var n=0;n!=e.length;++n){var r=e[n];if(t[r[0]]==null)t[r[0]]=r[1];else switch(r[2]){case"bool":typeof t[r[0]]=="string"&&(t[r[0]]=Fr(t[r[0]]));break;case"int":typeof t[r[0]]=="string"&&(t[r[0]]=parseInt(t[r[0]],10));break}}}function mee(t){_Q(t.WBProps,v3),_Q(t.CalcPr,k4e),yQ(t.WBView,N4e),yQ(t.Sheets,P4e),Hv.date1904=Fr(t.WBProps.date1904)}function F4e(t){return!t.Workbook||!t.Workbook.WBProps?"false":Fr(t.Workbook.WBProps.date1904)?"true":"false"}var L4e="][*?/\\".split("");function pee(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return L4e.forEach(function(r){if(t.indexOf(r)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}function H4e(t,e,n){t.forEach(function(r,i){pee(r);for(var o=0;o<i;++o)if(r==t[o])throw new Error("Duplicate Sheet Name: "+r);if(n){var s=e&&e[i]&&e[i].CodeName||r;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function V4e(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];H4e(t.SheetNames,e,!!t.vbaraw);for(var n=0;n<t.SheetNames.length;++n)FBe(t.Sheets[t.SheetNames[n]],t.SheetNames[n],n)}var B4e=/<\w+:workbook/;function U4e(t,e){if(!t)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",o={},s=0;if(t.replace(ls,function(l,c){var u=Zt(l);switch(mu(u[0])){case"<?xml":break;case"<workbook":l.match(B4e)&&(i="xmlns"+l.match(/<(\w+):/)[1]),n.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],n.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":v3.forEach(function(d){if(u[d[0]]!=null)switch(d[2]){case"bool":n.WBProps[d[0]]=Fr(u[d[0]]);break;case"int":n.WBProps[d[0]]=parseInt(u[d[0]],10);break;default:n.WBProps[d[0]]=u[d[0]]}}),u.codeName&&(n.WBProps.CodeName=Sr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],n.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=Yn(Sr(u.name)),delete u[0],n.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=Sr(u.name),u.comment&&(o.Comment=u.comment),u.localSheetId&&(o.Sheet=+u.localSheetId),Fr(u.hidden||"0")&&(o.Hidden=!0),s=c+l.length;break;case"</definedName>":o.Ref=Yn(Sr(t.slice(s,c))),n.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete u[0],n.CalcPr=u;break;case"<calcPr/>":delete u[0],n.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Op.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return mee(n),n}function gee(t){var e=[Ti];e[e.length]=ct("workbook",null,{xmlns:Op[0],"xmlns:r":Qi.r});var n=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(v3.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(r[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=ct("workbookPr",null,r);var i=t.Workbook&&t.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!i[o]||!i[o].Hidden);++o);o==t.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var s={name:gr(t.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}e[e.length]=ct("sheet",null,s)}return e[e.length]="</sheets>",n&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=ct("definedName",gr(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function W4e(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=xB(t,e-8),n.name=ss(t),n}function j4e(t,e){return e||(e=He(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),n3(t.strRelID,e),go(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function $4e(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var i=e>8?ss(t):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function G4e(t,e){e||(e=He(72));var n=0;return t&&t.filterPrivacy&&(n|=8),e.write_shift(4,n),e.write_shift(4,0),aJ(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function z4e(t,e){var n={};return t.read_shift(4),n.ArchID=t.read_shift(4),t.l+=e-8,n}function Y4e(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),o=Eke(t),s=ABe(t,0,n),a=t3(t);t.l=r;var l={Name:o,Ptg:s};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function q4e(t,e){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;e||(e={}),e.biff=12;var o=[],s=[[]];return s.SheetNames=[],s.XTI=[],z1[16]={n:"BrtFRTArchID$",f:z4e},Fd(t,function(l,c,u){switch(u){case 156:s.SheetNames.push(l.name),n.Sheets.push(l);break;case 153:n.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=ns(l.Ptg,null,null,s,e),delete e.SID,delete l.Ptg,o.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([u,l]):s[0]=[u,l],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(l),s.XTI=s.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(u),i=!0;break;case 36:r.pop(),i=!1;break;case 37:r.push(u),i=!0;break;case 38:r.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||e.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),mee(n),n.Names=o,n.supbooks=s,n}function K4e(t,e){Ge(t,143);for(var n=0;n!=e.SheetNames.length;++n){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[n]&&e.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:e.SheetNames[n]};Ge(t,156,j4e(i))}Ge(t,144)}function X4e(t,e){e||(e=He(127));for(var n=0;n!=4;++n)e.write_shift(4,0);return go("SheetJS",e),go(k1.version,e),go(k1.version,e),go("7262",e),e.length>e.l?e.slice(0,e.l):e}function Z4e(t,e){e||(e=He(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var n=120;return e.write_shift(1,n),e.length>e.l?e.slice(0,e.l):e}function Q4e(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var n=e.Workbook.Sheets,r=0,i=-1,o=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&o==-1&&(o=r);o>i||(Ge(t,135),Ge(t,158,Z4e(i)),Ge(t,136))}}function J4e(t,e){var n=ra();return Ge(n,131),Ge(n,128,X4e()),Ge(n,153,G4e(t.Workbook&&t.Workbook.WBProps||null)),Q4e(n,t,e),K4e(n,t,e),Ge(n,132),n.end()}function eUe(t,e,n){return e.slice(-4)===".bin"?q4e(t,n):U4e(t,n)}function tUe(t,e,n,r,i,o,s,a){return e.slice(-4)===".bin"?g4e(t,r,n,i,o,s,a):YBe(t,r,n,i,o,s,a)}function nUe(t,e,n,r,i,o,s,a){return e.slice(-4)===".bin"?O4e(t,r,n,i,o,s,a):A4e(t,r,n,i,o,s,a)}function rUe(t,e,n,r,i,o,s,a){return e.slice(-4)===".bin"?oVe(t,r,n,i,o,s,a):sVe(t,r,n,i,o,s,a)}function iUe(t,e,n,r,i,o,s,a){return e.slice(-4)===".bin"?rVe(t,r,n,i,o,s,a):iVe(t,r,n,i,o,s,a)}function oUe(t,e,n,r){return e.slice(-4)===".bin"?eHe(t,n,r):WLe(t,n,r)}function sUe(t,e,n){return XJ(t,n)}function aUe(t,e,n){return e.slice(-4)===".bin"?aLe(t,n):iLe(t,n)}function lUe(t,e,n){return e.slice(-4)===".bin"?QHe(t,n):jHe(t,n)}function cUe(t,e,n){return e.slice(-4)===".bin"?BHe(t,e,n):HHe(t,e,n)}function uUe(t,e,n,r){return n.slice(-4)===".bin"?UHe(t,e,n,r):void 0}function dUe(t,e,n){return e.slice(-4)===".bin"?kHe(t,e,n):LHe(t,e,n)}function hUe(t,e,n){return(e.slice(-4)===".bin"?J4e:gee)(t,n)}function fUe(t,e,n,r,i){return(e.slice(-4)===".bin"?R4e:dee)(t,n,r,i)}function mUe(t,e,n){return(e.slice(-4)===".bin"?uHe:qJ)(t,n)}function pUe(t,e,n){return(e.slice(-4)===".bin"?uLe:BJ)(t,n)}function gUe(t,e,n){return(e.slice(-4)===".bin"?JHe:JJ)(t,n)}function vUe(t){return(t.slice(-4)===".bin"?FHe:ZJ)()}var vee=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wee=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function sc(t,e){var n=t.split(/\s+/),r=[];if(e||(r[0]=n[0]),n.length===1)return r;var i=t.match(vee),o,s,a,l;if(i)for(l=0;l!=i.length;++l)o=i[l].match(wee),(s=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?a="xmlns"+o[1].slice(6):a=o[1].slice(s+1),r[a]=o[2].slice(1,o[2].length-1));return r}function wUe(t){var e=t.split(/\s+/),n={};if(e.length===1)return n;var r=t.match(vee),i,o,s,a;if(r)for(a=0;a!=r.length;++a)i=r[a].match(wee),(o=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(o+1),n[s]=i[2].slice(1,i[2].length-1));return n}var N1;function yUe(t,e){var n=N1[t]||Yn(t);return n==="General"?Tp(e):hl(n,e)}function _Ue(t,e,n,r){var i=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Fr(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=Lr(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}t[Yn(e)]=i}function CUe(t,e,n){if(t.t!=="z"){if(!n||n.cellText!==!1)try{t.t==="e"?t.w=t.w||Ld[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=L1(t.v):t.w=Tp(t.v):t.w=yUe(e||"General",t.v)}catch(o){if(n.WTF)throw o}try{var r=N1[e]||e||"General";if(n.cellNF&&(t.z=r),n.cellDates&&t.t=="n"&&jv(r)){var i=Cp(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(n.WTF)throw o}}}function SUe(t,e,n){if(n.cellStyles&&e.Interior){var r=e.Interior;r.Pattern&&(r.patternType=PLe[r.Pattern]||r.Pattern)}t[e.ID]=e}function EUe(t,e,n,r,i,o,s,a,l,c){var u="General",d=r.StyleID,h={};c=c||{};var f=[],p=0;for(d===void 0&&a&&(d=a.StyleID),d===void 0&&s&&(d=s.StyleID);o[d]!==void 0&&(o[d].nf&&(u=o[d].nf),o[d].Interior&&f.push(o[d].Interior),!!o[d].Parent);)d=o[d].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Fr(t);break;case"String":r.t="s",r.r=LZ(Yn(t)),r.v=t.indexOf("<")>-1?Yn(e||t).replace(/<.*?>/g,""):r.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),r.v=(Lr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=Yn(t):r.v<60&&(r.v=r.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+t),r.t||(r.t="n");break;case"Error":r.t="e",r.v=hJ[t],c.cellText!==!1&&(r.w=t);break;default:t==""&&e==""?r.t="z":(r.t="s",r.v=LZ(e||t));break}if(CUe(r,u,c),c.cellFormula!==!1)if(r.Formula){var g=Yn(r.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),r.f=Lv(g,i),delete r.Formula,r.ArrayRange=="RC"?r.F=Lv("RC:RC",i):r.ArrayRange&&(r.F=Lv(r.ArrayRange,i),l.push([qn(r.F),r.F]))}else for(p=0;p<l.length;++p)i.r>=l[p][0].s.r&&i.r<=l[p][0].e.r&&i.c>=l[p][0].s.c&&i.c<=l[p][0].e.c&&(r.F=l[p][1]);c.cellStyles&&(f.forEach(function(w){!h.patternType&&w.patternType&&(h.patternType=w.patternType)}),r.s=h),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function xUe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function vB(t,e){var n=e||{};$v();var r=x1(GB(t));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(typeof ur<"u"?r=ur.utils.decode(65001,SB(r)):r=Sr(r));var i=r.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Hr(n);return s.type="string",Uv.to_workbook(r,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(j){i.indexOf("<"+j)>=0&&(o=!0)}),o)return cWe(r,n);N1={"General Number":"General","General Date":Kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Kt[15],"Short Date":Kt[14],"Long Time":Kt[19],"Medium Time":Kt[18],"Short Time":Kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Kt[2],Standard:Kt[4],Percent:Kt[10],Scientific:Kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],c;mi!=null&&n.dense==null&&(n.dense=mi);var u={},d=[],h=n.dense?[]:{},f="",p={},g={},w=sc('<Data ss:Type="String">'),_=0,S=0,x=0,P={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},b={},C="",N=0,B=[],Y={},ee={},te=0,Ce=[],Re=[],_e={},L=[],M,q=!1,y=[],E=[],R={},D=0,A=0,O={Sheets:[],WBProps:{date1904:!1}},U={};B1.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ie="";a=B1.exec(r);)switch(a[3]=(ie=a[3]).toLowerCase()){case"data":if(ie=="data"){if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?EUe(r.slice(_,a.index),C,w,l[l.length-1][0]=="comment"?_e:p,{c:S,r:x},k,L[S],g,y,n):(C="",w=sc(a[0]),_=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(Re.length>0&&(p.c=Re),(!n.sheetRows||n.sheetRows>x)&&p.v!==void 0&&(n.dense?(h[x]||(h[x]=[]),h[x][S]=p):h[Qr(S)+bi(x)]=p),p.HRef&&(p.l={Target:Yn(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(D=S+(parseInt(p.MergeAcross,10)|0),A=x+(parseInt(p.MergeDown,10)|0),B.push({s:{c:S,r:x},e:{c:D,r:A}})),!n.sheetStubs)p.MergeAcross?S=D+1:++S;else if(p.MergeAcross||p.MergeDown){for(var ue=S;ue<=D;++ue)for(var fe=x;fe<=A;++fe)(ue>S||fe>x)&&(n.dense?(h[fe]||(h[fe]=[]),h[fe][ue]={t:"z"}):h[Qr(ue)+bi(fe)]={t:"z"});S=D+1}else++S;else p=wUe(a[0]),p.Index&&(S=+p.Index-1),S<P.s.c&&(P.s.c=S),S>P.e.c&&(P.e.c=S),a[0].slice(-2)==="/>"&&++S,Re=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(x<P.s.r&&(P.s.r=x),x>P.e.r&&(P.e.r=x),a[0].slice(-2)==="/>"&&(g=sc(a[0]),g.Index&&(x=+g.Index-1)),S=0,++x):(g=sc(a[0]),g.Index&&(x=+g.Index-1),R={},(g.AutoFitHeight=="0"||g.Height)&&(R.hpx=parseInt(g.Height,10),R.hpt=G1(R.hpx),E[x]=R),g.Hidden=="1"&&(R.hidden=!0,E[x]=R));break;case"worksheet":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));d.push(f),P.s.r<=P.e.r&&P.s.c<=P.e.c&&(h["!ref"]=fn(P),n.sheetRows&&n.sheetRows<=P.e.r&&(h["!fullref"]=h["!ref"],P.e.r=n.sheetRows-1,h["!ref"]=fn(P))),B.length&&(h["!merges"]=B),L.length>0&&(h["!cols"]=L),E.length>0&&(h["!rows"]=E),u[f]=h}else P={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=S=0,l.push([a[3],!1]),c=sc(a[0]),f=Yn(c.Name),h=n.dense?[]:{},B=[],y=[],E=[],U={name:f,Hidden:0},O.Sheets.push(U);break;case"table":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),L=[],q=!1}break;case"style":a[1]==="/"?SUe(k,b,n):b=sc(a[0]);break;case"numberformat":b.nf=Yn(sc(a[0]).Format||"General"),N1[b.nf]&&(b.nf=N1[b.nf]);for(var de=0;de!=392&&Kt[de]!=b.nf;++de);if(de==392){for(de=57;de!=392;++de)if(Kt[de]==null){Od(b.nf,de);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(M=sc(a[0]),M.Hidden&&(M.hidden=!0,delete M.Hidden),M.Width&&(M.wpx=parseInt(M.Width,10)),!q&&M.wpx>10){q=!0,rs=zJ;for(var ye=0;ye<L.length;++ye)L[ye]&&yf(L[ye])}q&&yf(M),L[M.Index-1||L.length]=M;for(var Pe=0;Pe<+M.Span;++Pe)L[L.length]=Hr(M);break;case"namedrange":if(a[1]==="/")break;O.Names||(O.Names=[]);var F=Zt(a[0]),Ke={Name:F.Name,Ref:Lv(F.RefersTo.slice(1),{r:0,c:0})};O.Sheets.length>0&&(Ke.Sheet=O.Sheets.length-1),O.Names.push(Ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?C+=r.slice(N,a.index):N=a.index+a[0].length;break;case"interior":if(!n.cellStyles)break;b.Interior=sc(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?qke(Y,ie,r.slice(te,a.index)):te=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));xUe(_e),Re.push(_e)}else l.push([a[3],!1]),c=sc(a[0]),_e={a:c.Author};break;case"autofilter":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var $e=sc(a[0]);h["!autofilter"]={ref:Lv($e.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return bQ(r,n);var rt=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:rt=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:rt=!1}break;case"excelworkbook":switch(a[3]){case"date1904":O.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:rt=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:rt=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(r.slice(te,a.index)){case"SheetHidden":U.Hidden=1;break;case"SheetVeryHidden":U.Hidden=2;break}else te=a.index+a[0].length;break;case"header":h["!margins"]||bp(h["!margins"]={},"xlml"),isNaN(+Zt(a[0]).Margin)||(h["!margins"].header=+Zt(a[0]).Margin);break;case"footer":h["!margins"]||bp(h["!margins"]={},"xlml"),isNaN(+Zt(a[0]).Margin)||(h["!margins"].footer=+Zt(a[0]).Margin);break;case"pagemargins":var Ye=Zt(a[0]);h["!margins"]||bp(h["!margins"]={},"xlml"),isNaN(+Ye.Top)||(h["!margins"].top=+Ye.Top),isNaN(+Ye.Left)||(h["!margins"].left=+Ye.Left),isNaN(+Ye.Right)||(h["!margins"].right=+Ye.Right),isNaN(+Ye.Bottom)||(h["!margins"].bottom=+Ye.Bottom);break;case"displayrighttoleft":O.Views||(O.Views=[]),O.Views[0]||(O.Views[0]={}),O.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:rt=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:rt=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:rt=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:rt=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:rt=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:rt=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:rt=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:rt=!1}break;case"smarttags":break;default:rt=!1;break}if(rt||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?_Ue(ee,ie,Ce,r.slice(te,a.index)):(Ce=a,te=a.index+a[0].length);break}if(n.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var Me={};return!n.bookSheets&&!n.bookProps&&(Me.Sheets=u),Me.SheetNames=d,Me.Workbook=O,Me.SSF=Hr(Kt),Me.Props=Y,Me.Custprops=ee,Me}function MB(t,e){switch(y3(e=e||{}),e.type||"base64"){case"base64":return vB(Da(t),e);case"binary":case"buffer":case"file":return vB(t,e);case"array":return vB(Sf(t),e)}}function bUe(t,e){var n=[];return t.Props&&n.push(Kke(t.Props,e)),t.Custprops&&n.push(Xke(t.Props,t.Custprops,e)),n.join("")}function TUe(){return""}function RUe(t,e){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,i){var o=[];o.push(ct("NumberFormat",null,{"ss:Format":gr(Kt[r.numFmtId])}));var s={"ss:ID":"s"+(21+i)};n.push(ct("Style",o.join(""),s))}),ct("Styles",n.join(""))}function yee(t){return ct("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+f3(t.Ref,{r:0,c:0})})}function DUe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,n=[],r=0;r<e.length;++r){var i=e[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(yee(i)))}return ct("Names",n.join(""))}function IUe(t,e,n,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,o=[],s=0;s<i.length;++s){var a=i[s];a.Sheet==n&&(a.Name.match(/^_xlfn\./)||o.push(yee(a)))}return o.join("")}function AUe(t,e,n,r){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(ct("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(ct("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(ct("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(ct("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<n&&!(r.Workbook.Sheets[o]&&!r.Workbook.Sheets[o].Hidden);++o);o==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Vo("ProtectContents","True")),t["!protect"].objects&&i.push(Vo("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Vo("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Vo("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Vo("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){t["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":ct("WorksheetOptions",i.join(""),{xmlns:ba.x})}function MUe(t){return t.map(function(e){var n=ZPe(e.t||""),r=ct("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return ct("Comment",r,{"ss:Author":e.a})}).join("")}function OUe(t,e,n,r,i,o,s){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+gr(f3(t.f,s))),t.F&&t.F.slice(0,e.length)==e){var l=Jr(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=gr(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=gr(t.l.Tooltip))),n["!merges"])for(var c=n["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var d="",h="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":d="Number",h=String(t.v);break;case"b":d="Boolean",h=t.v?"1":"0";break;case"e":d="Error",h=Ld[t.v];break;case"d":d="DateTime",h=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Kt[14]);break;case"s":d="String",h=XPe(t.v||"");break}var f=xf(r.cellXfs,t,r);a["ss:StyleID"]="s"+(21+f),a["ss:Index"]=s.c+1;var p=t.v!=null?h:"",g=t.t=="z"?"":'<Data ss:Type="'+d+'">'+p+"</Data>";return(t.c||[]).length>0&&(g+=MUe(t.c)),ct("Cell",g,a)}function NUe(t,e){var n='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Wv(e.hpt)),e.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(n+=' ss:Hidden="1"')),n+">"}function PUe(t,e,n,r){if(!t["!ref"])return"";var i=qn(t["!ref"]),o=t["!merges"]||[],s=0,a=[];t["!cols"]&&t["!cols"].forEach(function(w,_){yf(w);var S=!!w.width,x=LA(_,w),P={"ss:Index":_+1};S&&(P["ss:Width"]=j1(x.width)),w.hidden&&(P["ss:Hidden"]="1"),a.push(ct("Column",null,P))});for(var l=Array.isArray(t),c=i.s.r;c<=i.e.r;++c){for(var u=[NUe(c,(t["!rows"]||[])[c])],d=i.s.c;d<=i.e.c;++d){var h=!1;for(s=0;s!=o.length;++s)if(!(o[s].s.c>d)&&!(o[s].s.r>c)&&!(o[s].e.c<d)&&!(o[s].e.r<c)){(o[s].s.c!=d||o[s].s.r!=c)&&(h=!0);break}if(!h){var f={r:c,c:d},p=Xt(f),g=l?(t[c]||[])[d]:t[p];u.push(OUe(g,p,t,e,n,r,f))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function kUe(t,e,n){var r=[],i=n.SheetNames[t],o=n.Sheets[i],s=o?IUe(o,e,t,n):"";return s.length>0&&r.push("<Names>"+s+"</Names>"),s=o?PUe(o,e,t,n):"",s.length>0&&r.push("<Table>"+s+"</Table>"),r.push(AUe(o,e,t,n)),r.join("")}function FUe(t,e){e||(e={}),t.SSF||(t.SSF=Hr(Kt)),t.SSF&&($v(),IA(t.SSF),e.revssf=MA(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],xf(e.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(bUe(t,e)),n.push(TUe(t,e)),n.push(""),n.push("");for(var r=0;r<t.SheetNames.length;++r)n.push(ct("Worksheet",kUe(r,e,t),{"ss:Name":gr(t.SheetNames[r])}));return n[2]=RUe(t,e),n[3]=DUe(t,e),Ti+ct("Workbook",n.join(""),{xmlns:ba.ss,"xmlns:o":ba.o,"xmlns:x":ba.x,"xmlns:ss":ba.ss,"xmlns:dt":ba.dt,"xmlns:html":ba.html})}function LUe(t){var e={},n=t.content;if(n.l=28,e.AnsiUserType=n.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Dke(n),n.length-n.l<=4)return e;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,e.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(e.UnicodeClipboardFormat=Ike(n),r=n.read_shift(4),r==0||r>40))return e;n.l-=4,e.Reserved2=n.read_shift(0,"lpwstr")}var HUe=[60,1084,2066,2165,2175];function VUe(t,e,n,r,i){var o=r,s=[],a=n.slice(n.l,n.l+o);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}s.push(a),n.l+=o;for(var l=Ad(n,n.l),c=OB[l],u=0;c!=null&&HUe.indexOf(l)>-1;)o=Ad(n,n.l+2),u=n.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),a=n.slice(u,n.l+4+o),s.push(a),n.l+=4+o,c=OB[l=Ad(n,n.l)];var d=po(s);Ho(d,0);var h=0;d.lens=[];for(var f=0;f<s.length;++f)d.lens.push(h),h+=s[f].length;if(d.length<r)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+d.length+" < "+r;return e.f(d,d.length,i)}function cu(t,e,n){if(t.t!=="z"&&t.XF){var r=0;try{r=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Kt[r])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ld[t.v]:r===0||r=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=L1(t.v):t.w=Tp(t.v):t.w=hl(r,t.v,{date1904:!!n,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&r&&t.t=="n"&&jv(Kt[r]||String(r))){var i=Cp(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function fA(t,e,n){return{v:t,ixfe:e,t:n}}function BUe(t,e){var n={opts:{}},r={};mi!=null&&e.dense==null&&(e.dense=mi);var i=e.dense?[]:{},o={},s={},a=null,l=[],c="",u={},d,h="",f,p,g,w,_={},S=[],x,P,k=[],b=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},B=function(ke){return ke<8?Sp[ke]:ke<64&&b[ke-8]||Sp[ke]},Y=function(ke,Xe,gt){var Mt=Xe.XF.data;if(!(!Mt||!Mt.patternType||!gt||!gt.cellStyles)){Xe.s={},Xe.s.patternType=Mt.patternType;var Nt;(Nt=W1(B(Mt.icvFore)))&&(Xe.s.fgColor={rgb:Nt}),(Nt=W1(B(Mt.icvBack)))&&(Xe.s.bgColor={rgb:Nt})}},ee=function(ke,Xe,gt){if(!(R>1)&&!(gt.sheetRows&&ke.r>=gt.sheetRows)){if(gt.cellStyles&&Xe.XF&&Xe.XF.data&&Y(ke,Xe,gt),delete Xe.ixfe,delete Xe.XF,d=ke,h=Xt(ke),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),ke.r<s.s.r&&(s.s.r=ke.r),ke.c<s.s.c&&(s.s.c=ke.c),ke.r+1>s.e.r&&(s.e.r=ke.r+1),ke.c+1>s.e.c&&(s.e.c=ke.c+1),gt.cellFormula&&Xe.f){for(var Mt=0;Mt<S.length;++Mt)if(!(S[Mt][0].s.c>ke.c||S[Mt][0].s.r>ke.r)&&!(S[Mt][0].e.c<ke.c||S[Mt][0].e.r<ke.r)){Xe.F=fn(S[Mt][0]),(S[Mt][0].s.c!=ke.c||S[Mt][0].s.r!=ke.r)&&delete Xe.f,Xe.f&&(Xe.f=""+ns(S[Mt][1],s,ke,y,te));break}}gt.dense?(i[ke.r]||(i[ke.r]=[]),i[ke.r][ke.c]=Xe):i[h]=Xe}},te={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(te.password=e.password);var Ce,Re=[],_e=[],L=[],M=[],q=!1,y=[];y.SheetNames=te.snames,y.sharedf=te.sharedf,y.arrayf=te.arrayf,y.names=[],y.XTI=[];var E=0,R=0,D=0,A=[],O=[],U;te.codepage=1200,ac(1200);for(var ie=!1;t.l<t.length-1;){var ue=t.l,fe=t.read_shift(2);if(fe===0&&E===10)break;var de=t.l===t.length?0:t.read_shift(2),ye=OB[fe];if(ye&&ye.f){if(e.bookSheets&&E===133&&fe!==133)break;if(E=fe,ye.r===2||ye.r==12){var Pe=t.read_shift(2);if(de-=2,!te.enc&&Pe!==fe&&((Pe&255)<<8|Pe>>8)!==fe)throw new Error("rt mismatch: "+Pe+"!="+fe);ye.r==12&&(t.l+=10,de-=10)}var F={};if(fe===10?F=ye.f(t,de,te):F=VUe(fe,ye,t,de,te),R==0&&[9,521,1033,2057].indexOf(E)===-1)continue;switch(fe){case 34:n.opts.Date1904=C.WBProps.date1904=F;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(te.enc||(t.l=0),te.enc=F,!e.password)throw new Error("File is password-protected");if(F.valid==null)throw new Error("Encryption scheme unsupported");if(!F.valid)throw new Error("Password is incorrect");break;case 92:te.lastuser=F;break;case 66:var Ke=Number(F);switch(Ke){case 21010:Ke=1200;break;case 32768:Ke=1e4;break;case 32769:Ke=1252;break}ac(te.codepage=Ke),ie=!0;break;case 317:te.rrtabid=F;break;case 25:te.winlocked=F;break;case 439:n.opts.RefreshAll=F;break;case 12:n.opts.CalcCount=F;break;case 16:n.opts.CalcDelta=F;break;case 17:n.opts.CalcIter=F;break;case 13:n.opts.CalcMode=F;break;case 14:n.opts.CalcPrecision=F;break;case 95:n.opts.CalcSaveRecalc=F;break;case 15:te.CalcRefMode=F;break;case 2211:n.opts.FullCalc=F;break;case 129:F.fDialog&&(i["!type"]="dialog"),F.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),F.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:k.push(F);break;case 430:y.push([F]),y[y.length-1].XTI=[];break;case 35:case 547:y[y.length-1].push(F);break;case 24:case 536:U={Name:F.Name,Ref:ns(F.rgce,s,null,y,te)},F.itab>0&&(U.Sheet=F.itab-1),y.names.push(U),y[0]||(y[0]=[],y[0].XTI=[]),y[y.length-1].push(F),F.Name=="_xlnm._FilterDatabase"&&F.itab>0&&F.rgce&&F.rgce[0]&&F.rgce[0][0]&&F.rgce[0][0][0]=="PtgArea3d"&&(O[F.itab-1]={ref:fn(F.rgce[0][0][1][2])});break;case 22:te.ExternCount=F;break;case 23:y.length==0&&(y[0]=[],y[0].XTI=[]),y[y.length-1].XTI=y[y.length-1].XTI.concat(F),y.XTI=y.XTI.concat(F);break;case 2196:if(te.biff<8)break;U!=null&&(U.Comment=F[1]);break;case 18:i["!protect"]=F;break;case 19:F!==0&&te.WTF&&console.error("Password verifier: "+F);break;case 133:o[F.pos]=F,te.snames.push(F.name);break;case 10:{if(--R)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=fn(s),e.sheetRows&&e.sheetRows<=s.e.r){var $e=s.e.r;s.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=fn(s),s.e.r=$e}s.e.r++,s.e.c++}Re.length>0&&(i["!merges"]=Re),_e.length>0&&(i["!objects"]=_e),L.length>0&&(i["!cols"]=L),M.length>0&&(i["!rows"]=M),C.Sheets.push(N)}c===""?u=i:r[c]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(te.biff===8&&(te.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[F.BIFFVer]||8),te.biffguess=F.BIFFVer==0,F.BIFFVer==0&&F.dt==4096&&(te.biff=5,ie=!0,ac(te.codepage=28591)),te.biff==8&&F.BIFFVer==0&&F.dt==16&&(te.biff=2),R++)break;if(i=e.dense?[]:{},te.biff<8&&!ie&&(ie=!0,ac(te.codepage=e.codepage||1252)),te.biff<5||F.BIFFVer==0&&F.dt==4096){c===""&&(c="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var rt={pos:t.l-de,name:c};o[rt.pos]=rt,te.snames.push(c)}else c=(o[ue]||{name:""}).name;F.dt==32&&(i["!type"]="chart"),F.dt==64&&(i["!type"]="macro"),Re=[],_e=[],te.arrayf=S=[],L=[],M=[],q=!1,N={Hidden:(o[ue]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[F.r]||[])[F.c]:i[Xt({c:F.c,r:F.r})])&&++F.c,x={ixfe:F.ixfe,XF:k[F.ixfe]||{},v:F.val,t:"n"},D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee({c:F.c,r:F.r},x,e);break;case 5:case 517:x={ixfe:F.ixfe,XF:k[F.ixfe],v:F.val,t:F.t},D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee({c:F.c,r:F.r},x,e);break;case 638:x={ixfe:F.ixfe,XF:k[F.ixfe],v:F.rknum,t:"n"},D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee({c:F.c,r:F.r},x,e);break;case 189:for(var Ye=F.c;Ye<=F.C;++Ye){var Me=F.rkrec[Ye-F.c][0];x={ixfe:Me,XF:k[Me],v:F.rkrec[Ye-F.c][1],t:"n"},D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee({c:Ye,r:F.r},x,e)}break;case 6:case 518:case 1030:{if(F.val=="String"){a=F;break}if(x=fA(F.val,F.cell.ixfe,F.tt),x.XF=k[x.ixfe],e.cellFormula){var j=F.formula;if(j&&j[0]&&j[0][0]&&j[0][0][0]=="PtgExp"){var z=j[0][0][1][0],J=j[0][0][1][1],pe=Xt({r:z,c:J});_[pe]?x.f=""+ns(F.formula,s,F.cell,y,te):x.F=((e.dense?(i[z]||[])[J]:i[pe])||{}).F}else x.f=""+ns(F.formula,s,F.cell,y,te)}D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee(F.cell,x,e),a=F}break;case 7:case 519:if(a)a.val=F,x=fA(F,a.cell.ixfe,"s"),x.XF=k[x.ixfe],e.cellFormula&&(x.f=""+ns(a.formula,s,a.cell,y,te)),D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee(a.cell,x,e),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(F);var he=Xt(F[0].s);if(f=e.dense?(i[F[0].s.r]||[])[F[0].s.c]:i[he],e.cellFormula&&f){if(!a||!he||!f)break;f.f=""+ns(F[1],s,F[0],y,te),f.F=fn(F[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!a)break;_[Xt(a.cell)]=F[0],f=e.dense?(i[a.cell.r]||[])[a.cell.c]:i[Xt(a.cell)],(f||{}).f=""+ns(F[0],s,d,y,te)}}break;case 253:x=fA(l[F.isst].t,F.ixfe,"s"),l[F.isst].h&&(x.h=l[F.isst].h),x.XF=k[x.ixfe],D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee({c:F.c,r:F.r},x,e);break;case 513:e.sheetStubs&&(x={ixfe:F.ixfe,XF:k[F.ixfe],t:"z"},D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee({c:F.c,r:F.r},x,e));break;case 190:if(e.sheetStubs)for(var me=F.c;me<=F.C;++me){var ve=F.ixfe[me-F.c];x={ixfe:ve,XF:k[ve],t:"z"},D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee({c:me,r:F.r},x,e)}break;case 214:case 516:case 4:x=fA(F.val,F.ixfe,"s"),x.XF=k[x.ixfe],D>0&&(x.z=A[x.ixfe>>8&63]),cu(x,e,n.opts.Date1904),ee({c:F.c,r:F.r},x,e);break;case 0:case 512:R===1&&(s=F);break;case 252:l=F;break;case 1054:if(te.biff==4){A[D++]=F[1];for(var ne=0;ne<D+163&&Kt[ne]!=F[1];++ne);ne>=163&&Od(F[1],D+163)}else Od(F[1],F[0]);break;case 30:{A[D++]=F;for(var ce=0;ce<D+163&&Kt[ce]!=F;++ce);ce>=163&&Od(F,D+163)}break;case 229:Re=Re.concat(F);break;case 93:_e[F.cmo[0]]=te.lastobj=F;break;case 438:te.lastobj.TxO=F;break;case 127:te.lastobj.ImData=F;break;case 440:for(w=F[0].s.r;w<=F[0].e.r;++w)for(g=F[0].s.c;g<=F[0].e.c;++g)f=e.dense?(i[w]||[])[g]:i[Xt({c:g,r:w})],f&&(f.l=F[1]);break;case 2048:for(w=F[0].s.r;w<=F[0].e.r;++w)for(g=F[0].s.c;g<=F[0].e.c;++g)f=e.dense?(i[w]||[])[g]:i[Xt({c:g,r:w})],f&&f.l&&(f.l.Tooltip=F[1]);break;case 28:{if(te.biff<=5&&te.biff>=2)break;f=e.dense?(i[F[0].r]||[])[F[0].c]:i[Xt(F[0])];var oe=_e[F[2]];f||(e.dense?(i[F[0].r]||(i[F[0].r]=[]),f=i[F[0].r][F[0].c]={t:"z"}):f=i[Xt(F[0])]={t:"z"},s.e.r=Math.max(s.e.r,F[0].r),s.s.r=Math.min(s.s.r,F[0].r),s.e.c=Math.max(s.e.c,F[0].c),s.s.c=Math.min(s.s.c,F[0].c)),f.c||(f.c=[]),p={a:F[1],t:oe.TxO.t},f.c.push(p)}break;case 2173:RHe(k[F.ixfe],F.ext);break;case 125:{if(!te.cellStyles)break;for(;F.e>=F.s;)L[F.e--]={width:F.w/256,level:F.level||0,hidden:!!(F.flags&1)},q||(q=!0,u3(F.w/256)),yf(L[F.e+1])}break;case 520:{var ge={};F.level!=null&&(M[F.r]=ge,ge.level=F.level),F.hidden&&(M[F.r]=ge,ge.hidden=!0),F.hpt&&(M[F.r]=ge,ge.hpt=F.hpt,ge.hpx=Wv(F.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||bp(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=F;break;case 161:i["!margins"]||bp(i["!margins"]={}),i["!margins"].header=F.header,i["!margins"].footer=F.footer;break;case 574:F.RTL&&(C.Views[0].RTL=!0);break;case 146:b=F;break;case 2198:Ce=F;break;case 140:P=F;break;case 442:c?N.CodeName=F||N.name:C.WBProps.CodeName=F||"ThisWorkbook";break}}else ye||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),t.l+=de}return n.SheetNames=pi(o).sort(function(Ve,ke){return Number(Ve)-Number(ke)}).map(function(Ve){return o[Ve].name}),e.bookSheets||(n.Sheets=r),!n.SheetNames.length&&u["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=u)):n.Preamble=u,n.Sheets&&O.forEach(function(Ve,ke){n.Sheets[n.SheetNames[ke]]["!autofilter"]=Ve}),n.Strings=l,n.SSF=Hr(Kt),te.enc&&(n.Encryption=te.enc),Ce&&(n.Themes=Ce),n.Metadata={},P!==void 0&&(n.Metadata.Country=P),y.names.length>0&&(C.Names=y.names),n.Workbook=C,n}var P1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function UUe(t,e,n){var r=Vt.find(t,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=tQ(r,bB,P1.DSI);for(var o in i)e[o]=i[o]}catch(c){if(n.WTF)throw c}var s=Vt.find(t,"/!SummaryInformation");if(s&&s.size>0)try{var a=tQ(s,TB,P1.SI);for(var l in a)e[l]==null&&(e[l]=a[l])}catch(c){if(n.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(wJ(e.HeadingPairs,e.TitlesOfParts,e,n),delete e.HeadingPairs,delete e.TitlesOfParts)}function WUe(t,e){var n=[],r=[],i=[],o=0,s,a=MZ(bB,"n"),l=MZ(TB,"n");if(t.Props)for(s=pi(t.Props),o=0;o<s.length;++o)(Object.prototype.hasOwnProperty.call(a,s[o])?n:Object.prototype.hasOwnProperty.call(l,s[o])?r:i).push([s[o],t.Props[s[o]]]);if(t.Custprops)for(s=pi(t.Custprops),o=0;o<s.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},s[o])||(Object.prototype.hasOwnProperty.call(a,s[o])?n:Object.prototype.hasOwnProperty.call(l,s[o])?r:i).push([s[o],t.Custprops[s[o]]]);var c=[];for(o=0;o<i.length;++o)bJ.indexOf(i[o][0])>-1||vJ.indexOf(i[o][0])>-1||i[o][1]!=null&&c.push(i[o]);r.length&&Vt.utils.cfb_add(e,"/SummaryInformation",nQ(r,P1.SI,l,TB)),(n.length||c.length)&&Vt.utils.cfb_add(e,"/DocumentSummaryInformation",nQ(n,P1.DSI,a,bB,c.length?c:null,P1.UDI))}function _ee(t,e){e||(e={}),y3(e),FB(),e.codepage&&kB(e.codepage);var n,r;if(t.FullPaths){if(Vt.find(t,"/encryption"))throw new Error("File is password-protected");n=Vt.find(t,"!CompObj"),r=Vt.find(t,"/Workbook")||Vt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ta(Da(t));break;case"binary":t=Ta(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Ho(t,0),r={content:t}}var i,o;if(n&&LUe(n),e.bookProps&&!e.bookSheets)i={};else{var s=In?"buffer":"array";if(r&&r.content)i=BUe(r.content,e);else if((o=Vt.find(t,"PerfectOffice_MAIN"))&&o.content)i=xp.to_workbook(o.content,(e.type=s,e));else if((o=Vt.find(t,"NativeContent_MAIN"))&&o.content)i=xp.to_workbook(o.content,(e.type=s,e));else throw(o=Vt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Vt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=tVe(t))}var a={};return t.FullPaths&&UUe(t,a,e),i.Props=i.Custprops=a,e.bookFiles&&(i.cfb=t),i}function jUe(t,e){var n=e||{},r=Vt.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Vt.utils.cfb_add(r,i,Cee(t,n)),n.biff==8&&(t.Props||t.Custprops)&&WUe(t,r),n.biff==8&&t.vbaraw&&nVe(r,Vt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),r}var z1={0:{f:f3e},1:{f:C3e},2:{f:B3e},3:{f:I3e},4:{f:b3e},5:{f:L3e},6:{f:G3e},7:{f:N3e},8:{f:Q3e},9:{f:Z3e},10:{f:K3e},11:{f:X3e},12:{f:E3e},13:{f:W3e},14:{f:M3e},15:{f:R3e},16:{f:hee},17:{f:Y3e},18:{f:k3e},19:{f:e3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Y4e},40:{},42:{},43:{f:GLe},44:{f:jLe},45:{f:qLe},46:{f:XLe},47:{f:KLe},48:{},49:{f:gke},50:{},51:{f:AHe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:FJ},62:{f:$3e},63:{f:VHe},64:{f:m4e},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:as,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:u4e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:y3e},148:{f:g3e,p:16},151:{f:i4e},152:{},153:{f:$4e},154:{},155:{},156:{f:W4e},157:{},158:{},159:{T:1,f:sLe},160:{T:-1},161:{T:1,f:Fp},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:J3e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:DHe},336:{T:-1},337:{f:NHe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:xB},357:{},358:{},359:{},360:{T:1},361:{},362:{f:kJ},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:o4e},427:{f:s4e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:l4e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:w3e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:n4e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:xB},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:XHe},633:{T:1},634:{T:-1},635:{T:1,f:qHe},636:{T:-1},637:{f:_ke},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:M4e},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:p4e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},OB={6:{f:pB},10:{f:pf},12:{f:Hi},13:{f:Hi},14:{f:xi},15:{f:xi},16:{f:is},17:{f:xi},18:{f:xi},19:{f:Hi},20:{f:lQ},21:{f:lQ},23:{f:kJ},24:{f:uQ},25:{f:xi},26:{},27:{},28:{f:p2e},29:{},34:{f:xi},35:{f:cQ},38:{f:is},39:{f:is},40:{f:is},41:{f:is},42:{f:xi},43:{f:xi},47:{f:RLe},49:{f:WFe},51:{f:Hi},60:{},61:{f:LFe},64:{f:xi},65:{f:UFe},66:{f:Hi},77:{},80:{},81:{},82:{},85:{f:Hi},89:{},90:{},91:{},92:{f:TFe},93:{f:w2e},94:{},95:{f:xi},96:{},97:{},99:{f:xi},125:{f:FJ},128:{f:r2e},129:{f:DFe},130:{f:Hi},131:{f:xi},132:{f:xi},133:{f:IFe},134:{},140:{f:T2e},141:{f:Hi},144:{},146:{f:I2e},151:{},152:{},153:{},154:{},155:{},156:{f:Hi},157:{},158:{},160:{f:F2e},161:{f:O2e},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:JFe},190:{f:e2e},193:{f:pf},197:{},198:{},199:{},200:{},201:{},202:{f:xi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Hi},220:{},221:{f:xi},222:{},224:{f:n2e},225:{f:bFe},226:{f:pf},227:{},229:{f:g2e},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:MFe},253:{f:$Fe},255:{f:NFe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:TJ},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xi},353:{f:pf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:l2e},431:{f:xi},432:{},433:{},434:{},437:{},438:{f:C2e},439:{f:xi},440:{f:S2e},441:{},442:{f:Z1},443:{},444:{f:Hi},445:{},446:{},448:{f:pf},449:{f:FFe,r:2},450:{f:pf},512:{f:oQ},513:{f:k2e},515:{f:s2e},516:{f:zFe},517:{f:aQ},519:{f:L2e},520:{f:PFe},523:{},545:{f:dQ},549:{f:iQ},566:{},574:{f:VFe},638:{f:QFe},659:{},1048:{},1054:{f:qFe},1084:{},1212:{f:h2e},2048:{f:x2e},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:uA},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:pf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:A2e,r:12},2173:{f:THe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:d2e,r:12},2197:{},2198:{f:_He,r:12},2199:{},2200:{},2201:{},2202:{f:f2e,r:12},2203:{f:pf},2204:{},2205:{},2206:{},2207:{},2211:{f:kFe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Hi},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:N2e},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:D2e},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:oQ},1:{},2:{f:W2e},3:{f:B2e},4:{f:V2e},5:{f:aQ},7:{f:$2e},8:{},9:{f:uA},11:{},22:{f:Hi},30:{f:XFe},31:{},32:{},33:{f:dQ},36:{},37:{f:iQ},50:{f:G2e},62:{},52:{},67:{},68:{f:Hi},69:{},86:{},126:{},127:{f:H2e},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:z2e},223:{},234:{},354:{},421:{},518:{f:pB},521:{f:uA},536:{f:uQ},547:{f:cQ},561:{},579:{},1030:{f:pB},1033:{f:uA},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function dt(t,e,n,r){var i=e;if(!isNaN(i)){var o=r||(n||[]).length||0,s=t.next(4);s.write_shift(2,i),s.write_shift(2,o),o>0&&ZB(n)&&t.push(n)}}function $Ue(t,e,n,r){var i=r||(n||[]).length||0;if(i<=8224)return dt(t,e,n,i);var o=e;if(!isNaN(o)){for(var s=n.parts||[],a=0,l=0,c=0;c+(s[a]||8224)<=8224;)c+=s[a]||8224,a++;var u=t.next(4);for(u.write_shift(2,o),u.write_shift(2,c),t.push(n.slice(l,l+c)),l+=c;l<i;){for(u=t.next(4),u.write_shift(2,60),c=0;c+(s[a]||8224)<=8224;)c+=s[a]||8224,a++;u.write_shift(2,c),t.push(n.slice(l,l+c)),l+=c}}}function tS(t,e,n){return t||(t=He(7)),t.write_shift(2,e),t.write_shift(2,n),t.write_shift(2,0),t.write_shift(1,0),t}function GUe(t,e,n,r){var i=He(9);return tS(i,t,e),RJ(n,r||"b",i),i}function zUe(t,e,n){var r=He(8+2*n.length);return tS(r,t,e),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function YUe(t,e,n,r){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Ji(Lr(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?dt(t,2,j2e(n,r,i)):dt(t,3,U2e(n,r,i));return;case"b":case"e":dt(t,5,GUe(n,r,e.v,e.t));return;case"s":case"str":dt(t,4,zUe(n,r,(e.v||"").slice(0,255)));return}dt(t,1,tS(null,n,r))}function qUe(t,e,n,r){var i=Array.isArray(e),o=qn(e["!ref"]||"A1"),s,a="",l=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),s=fn(o)}for(var c=o.s.r;c<=o.e.r;++c){a=bi(c);for(var u=o.s.c;u<=o.e.c;++u){c===o.s.r&&(l[u]=Qr(u)),s=l[u]+a;var d=i?(e[c]||[])[u]:e[s];d&&YUe(t,d,c,u,r)}}}function KUe(t,e){var n=e||{};mi!=null&&n.dense==null&&(n.dense=mi);for(var r=ra(),i=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==n.sheet&&(i=o);if(i==0&&n.sheet&&t.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return dt(r,n.biff==4?1033:n.biff==3?521:9,a3(t,16,n)),qUe(r,t.Sheets[t.SheetNames[i]],i,n,t),dt(r,10),r.end()}function XUe(t,e,n){dt(t,49,jFe({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},n))}function ZUe(t,e,n){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)e[i]!=null&&dt(t,1054,KFe(i,e[i],n))})}function QUe(t,e){var n=He(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),dt(t,2151,n),n=He(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),OJ(qn(e["!ref"]||"A1"),n),n.write_shift(4,4),dt(t,2152,n)}function JUe(t,e){for(var n=0;n<16;++n)dt(t,224,sQ({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){dt(t,224,sQ(r,0,e))})}function eWe(t,e){for(var n=0;n<e["!links"].length;++n){var r=e["!links"][n];dt(t,440,E2e(r)),r[1].Tooltip&&dt(t,2048,b2e(r))}delete e["!links"]}function tWe(t,e){if(e){var n=0;e.forEach(function(r,i){++n<=256&&r&&dt(t,125,M2e(LA(i,r),i))})}}function nWe(t,e,n,r,i){var o=16+xf(i.cellXfs,e,i);if(e.v==null&&!e.bf){dt(t,513,Ap(n,r,o));return}if(e.bf)dt(t,6,DBe(e,n,r,i,o));else switch(e.t){case"d":case"n":var s=e.t=="d"?Ji(Lr(e.v)):e.v;dt(t,515,a2e(n,r,s,o,i));break;case"b":case"e":dt(t,517,o2e(n,r,e.v,o,i,e.t));break;case"s":case"str":if(i.bookSST){var a=p3(i.Strings,e.v,i.revStrings);dt(t,253,GFe(n,r,a,o,i))}else dt(t,516,YFe(n,r,(e.v||"").slice(0,255),o,i));break;default:dt(t,513,Ap(n,r,o))}}function rWe(t,e,n){var r=ra(),i=n.SheetNames[t],o=n.Sheets[i]||{},s=(n||{}).Workbook||{},a=(s.Sheets||[])[t]||{},l=Array.isArray(o),c=e.biff==8,u,d="",h=[],f=qn(o["!ref"]||"A1"),p=c?65536:16384;if(f.e.c>255||f.e.r>=p){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,p-1)}dt(r,2057,a3(n,16,e)),dt(r,13,ul(1)),dt(r,12,ul(100)),dt(r,15,Ns(!0)),dt(r,17,Ns(!1)),dt(r,16,Dp(.001)),dt(r,95,Ns(!0)),dt(r,42,Ns(!1)),dt(r,43,Ns(!1)),dt(r,130,ul(1)),dt(r,128,i2e([0,0])),dt(r,131,Ns(!1)),dt(r,132,Ns(!1)),c&&tWe(r,o["!cols"]),dt(r,512,ZFe(f,e)),c&&(o["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){d=bi(g);for(var w=f.s.c;w<=f.e.c;++w){g===f.s.r&&(h[w]=Qr(w)),u=h[w]+d;var _=l?(o[g]||[])[w]:o[u];_&&(nWe(r,_,g,w,e),c&&_.l&&o["!links"].push([u,_.l]))}}var S=a.CodeName||a.name||i;return c&&dt(r,574,BFe((s.Views||[])[0])),c&&(o["!merges"]||[]).length&&dt(r,229,v2e(o["!merges"])),c&&eWe(r,o),dt(r,442,DJ(S,e)),c&&QUe(r,o),dt(r,10),r.end()}function iWe(t,e,n){var r=ra(),i=(t||{}).Workbook||{},o=i.Sheets||[],s=i.WBProps||{},a=n.biff==8,l=n.biff==5;if(dt(r,2057,a3(t,5,n)),n.bookType=="xla"&&dt(r,135),dt(r,225,a?ul(1200):null),dt(r,193,oFe(2)),l&&dt(r,191),l&&dt(r,192),dt(r,226),dt(r,92,RFe("SheetJS",n)),dt(r,66,ul(a?1200:1252)),a&&dt(r,353,ul(0)),a&&dt(r,448),dt(r,317,P2e(t.SheetNames.length)),a&&t.vbaraw&&dt(r,211),a&&t.vbaraw){var c=s.CodeName||"ThisWorkbook";dt(r,442,DJ(c,n))}dt(r,156,ul(17)),dt(r,25,Ns(!1)),dt(r,18,Ns(!1)),dt(r,19,ul(0)),a&&dt(r,431,Ns(!1)),a&&dt(r,444,ul(0)),dt(r,61,HFe(n)),dt(r,64,Ns(!1)),dt(r,141,ul(0)),dt(r,34,Ns(F4e(t)=="true")),dt(r,14,Ns(!0)),a&&dt(r,439,Ns(!1)),dt(r,218,ul(0)),XUe(r,t,n),ZUe(r,t.SSF,n),JUe(r,n),a&&dt(r,352,Ns(!1));var u=r.end(),d=ra();a&&dt(d,140,R2e()),a&&n.Strings&&$Ue(d,252,OFe(n.Strings,n)),dt(d,10);var h=d.end(),f=ra(),p=0,g=0;for(g=0;g<t.SheetNames.length;++g)p+=(a?12:11)+(a?2:1)*t.SheetNames[g].length;var w=u.length+p+h.length;for(g=0;g<t.SheetNames.length;++g){var _=o[g]||{};dt(f,133,AFe({pos:w,hs:_.Hidden||0,dt:0,name:t.SheetNames[g]},n)),w+=e[g].length}var S=f.end();if(p!=S.length)throw new Error("BS8 "+p+" != "+S.length);var x=[];return u.length&&x.push(u),S.length&&x.push(S),h.length&&x.push(h),po(x)}function oWe(t,e){var n=e||{},r=[];t&&!t.SSF&&(t.SSF=Hr(Kt)),t&&t.SSF&&($v(),IA(t.SSF),n.revssf=MA(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,_3(n),n.cellXfs=[],xf(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)r[r.length]=rWe(i,n,t);return r.unshift(iWe(t,r,n)),po(r)}function Cee(t,e){for(var n=0;n<=t.SheetNames.length;++n){var r=t.Sheets[t.SheetNames[n]];if(!(!r||!r["!ref"])){var i=ia(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return oWe(t,e);case 4:case 3:case 2:return KUe(t,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function CQ(t,e){var n=e||{};mi!=null&&n.dense==null&&(n.dense=mi);var r=n.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),s=i.index,a=o&&o.index||t.length,l=jPe(t.slice(s,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,d=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(s=0;s<l.length;++s){var g=l[s].trim(),w=g.slice(0,3).toLowerCase();if(w=="<tr"){if(++c,n.sheetRows&&n.sheetRows<=c){--c;break}u=0;continue}if(!(w!="<td"&&w!="<th")){var _=g.split(/<\/t[dh]>/i);for(a=0;a<_.length;++a){var S=_[a].trim();if(S.match(/<t[dh]/i)){for(var x=S,P=0;x.charAt(0)=="<"&&(P=x.indexOf(">"))>-1;)x=x.slice(P+1);for(var k=0;k<p.length;++k){var b=p[k];b.s.c==u&&b.s.r<c&&c<=b.e.r&&(u=b.e.c+1,k=-1)}var C=Zt(S.slice(0,S.indexOf(">")));h=C.colspan?+C.colspan:1,((d=+C.rowspan)>1||h>1)&&p.push({s:{r:c,c:u},e:{r:c+(d||1)-1,c:u+h-1}});var N=C.t||C["data-t"]||"";if(!x.length){u+=h;continue}if(x=XQ(x),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),!x.length){u+=h;continue}var B={t:"s",v:x};n.raw||!x.trim().length||N=="s"||(x==="TRUE"?B={t:"b",v:!0}:x==="FALSE"?B={t:"b",v:!1}:isNaN(cc(x))?isNaN(Bv(x).getDate())||(B={t:"d",v:Lr(x)},n.cellDates||(B={t:"n",v:Ji(B.v)}),B.z=n.dateNF||Kt[14]):B={t:"n",v:cc(x)}),n.dense?(r[c]||(r[c]=[]),r[c][u]=B):r[Xt({r:c,c:u})]=B,u+=h}}}}return r["!ref"]=fn(f),p.length&&(r["!merges"]=p),r}function sWe(t,e,n,r){for(var i=t["!merges"]||[],o=[],s=e.s.c;s<=e.e.c;++s){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>n||i[c].s.c>s)&&!(i[c].e.r<n||i[c].e.c<s)){if(i[c].s.r<n||i[c].s.c<s){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=Xt({r:n,c:s}),d=r.dense?(t[n]||[])[s]:t[u],h=d&&d.v!=null&&(d.h||$B(d.w||(Pd(d),d.w)||""))||"",f={};a>1&&(f.rowspan=a),l>1&&(f.colspan=l),r.editable?h='<span contenteditable="true">'+h+"</span>":d&&(f["data-t"]=d&&d.t||"z",d.v!=null&&(f["data-v"]=d.v),d.z!=null&&(f["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),f.id=(r.id||"sjs")+"-"+u,o.push(ct("td",h,f))}}var p="<tr>";return p+o.join("")+"</tr>"}var aWe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',lWe="</body></html>";function cWe(t,e){var n=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Ef(CQ(n[0],e),e);var r=E3();return n.forEach(function(i,o){x3(r,CQ(i,e),"Sheet"+(o+1))}),r}function uWe(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function See(t,e){var n=e||{},r=n.header!=null?n.header:aWe,i=n.footer!=null?n.footer:lWe,o=[r],s=ia(t["!ref"]);n.dense=Array.isArray(t),o.push(uWe(t,s,n));for(var a=s.s.r;a<=s.e.r;++a)o.push(sWe(t,s,a,n));return o.push("</table>"+i),o.join("")}function Eee(t,e,n){var r=n||{};mi!=null&&(r.dense=mi);var i=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var s=typeof r.origin=="string"?Jr(r.origin):r.origin;i=s.r,o=s.c}var a=e.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:o}};if(t["!ref"]){var u=ia(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var d=[],h=0,f=t["!rows"]||(t["!rows"]=[]),p=0,g=0,w=0,_=0,S=0,x=0;for(t["!cols"]||(t["!cols"]=[]);p<a.length&&g<l;++p){var P=a[p];if(SQ(P)){if(r.display)continue;f[g]={hidden:!0}}var k=P.children;for(w=_=0;w<k.length;++w){var b=k[w];if(!(r.display&&SQ(b))){var C=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):XQ(b.innerHTML),N=b.getAttribute("data-z")||b.getAttribute("z");for(h=0;h<d.length;++h){var B=d[h];B.s.c==_+o&&B.s.r<g+i&&g+i<=B.e.r&&(_=B.e.c+1-o,h=-1)}x=+b.getAttribute("colspan")||1,((S=+b.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:g+i,c:_+o},e:{r:g+i+(S||1)-1,c:_+o+(x||1)-1}});var Y={t:"s",v:C},ee=b.getAttribute("data-t")||b.getAttribute("t")||"";C!=null&&(C.length==0?Y.t=ee||"z":r.raw||C.trim().length==0||ee=="s"||(C==="TRUE"?Y={t:"b",v:!0}:C==="FALSE"?Y={t:"b",v:!1}:isNaN(cc(C))?isNaN(Bv(C).getDate())||(Y={t:"d",v:Lr(C)},r.cellDates||(Y={t:"n",v:Ji(Y.v)}),Y.z=r.dateNF||Kt[14]):Y={t:"n",v:cc(C)})),Y.z===void 0&&N!=null&&(Y.z=N);var te="",Ce=b.getElementsByTagName("A");if(Ce&&Ce.length)for(var Re=0;Re<Ce.length&&!(Ce[Re].hasAttribute("href")&&(te=Ce[Re].getAttribute("href"),te.charAt(0)!="#"));++Re);te&&te.charAt(0)!="#"&&(Y.l={Target:te}),r.dense?(t[g+i]||(t[g+i]=[]),t[g+i][_+o]=Y):t[Xt({c:_+o,r:g+i})]=Y,c.e.c<_+o&&(c.e.c=_+o),_+=x}}++g}return d.length&&(t["!merges"]=(t["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,g-1+i),t["!ref"]=fn(c),g>=l&&(t["!fullref"]=fn((c.e.r=a.length-p+g-1+i,c))),t}function xee(t,e){var n=e||{},r=n.dense?[]:{};return Eee(r,t,e)}function dWe(t,e){return Ef(xee(t,e),e)}function SQ(t){var e="",n=hWe(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function hWe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function fWe(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Yn(e.replace(/<[^>]*>/g,""));return[n]}var EQ={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function bee(t,e){var n=e||{};mi!=null&&n.dense==null&&(n.dense=mi);var r=GB(t),i=[],o,s,a={name:""},l="",c=0,u,d,h={},f=[],p=n.dense?[]:{},g,w,_={value:""},S="",x=0,P,k=[],b=-1,C=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,Y={},ee=[],te={},Ce=0,Re=0,_e=[],L=1,M=1,q=[],y={Names:[]},E={},R=["",""],D=[],A={},O="",U=0,ie=!1,ue=!1,fe=0;for(B1.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=B1.exec(r);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":g[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?p["!ref"]=fn(N):p["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=N.e.r&&(p["!fullref"]=p["!ref"],N.e.r=n.sheetRows-1,p["!ref"]=fn(N)),ee.length&&(p["!merges"]=ee),_e.length&&(p["!rows"]=_e),u.name=u.\u540D\u79F0||u.name,typeof JSON<"u"&&JSON.stringify(u),f.push(u.name),h[u.name]=p,ue=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Zt(g[0],!1),b=C=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,p=n.dense?[]:{},ee=[],_e=[],ue=!0);break;case"table-row-group":g[1]==="/"?--B:++B;break;case"table-row":case"\u884C":if(g[1]==="/"){b+=L,L=1;break}if(d=Zt(g[0],!1),d.\u884C\u53F7?b=d.\u884C\u53F7-1:b==-1&&(b=0),L=+d["number-rows-repeated"]||1,L<10)for(fe=0;fe<L;++fe)B>0&&(_e[b+fe]={level:B});C=-1;break;case"covered-table-cell":g[1]!=="/"&&++C,n.sheetStubs&&(n.dense?(p[b]||(p[b]=[]),p[b][C]={t:"z"}):p[Xt({r:b,c:C})]={t:"z"}),S="",k=[];break;case"table-cell":case"\u6570\u636E":if(g[0].charAt(g[0].length-2)==="/")++C,_=Zt(g[0],!1),M=parseInt(_["number-columns-repeated"]||"1",10),w={t:"z",v:null},_.formula&&n.cellFormula!=!1&&(w.f=wQ(Yn(_.formula))),(_.\u6570\u636E\u7C7B\u578B||_["value-type"])=="string"&&(w.t="s",w.v=Yn(_["string-value"]||""),n.dense?(p[b]||(p[b]=[]),p[b][C]=w):p[Xt({r:b,c:C})]=w),C+=M-1;else if(g[1]!=="/"){++C,S="",x=0,k=[],M=1;var de=L?b+L-1:b;if(C>N.e.c&&(N.e.c=C),C<N.s.c&&(N.s.c=C),b<N.s.r&&(N.s.r=b),de>N.e.r&&(N.e.r=de),_=Zt(g[0],!1),D=[],A={},w={t:_.\u6570\u636E\u7C7B\u578B||_["value-type"],v:null},n.cellFormula)if(_.formula&&(_.formula=Yn(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(Ce=parseInt(_["number-matrix-rows-spanned"],10)||0,Re=parseInt(_["number-matrix-columns-spanned"],10)||0,te={s:{r:b,c:C},e:{r:b+Ce-1,c:C+Re-1}},w.F=fn(te),q.push([te,w.F])),_.formula)w.f=wQ(_.formula);else for(fe=0;fe<q.length;++fe)b>=q[fe][0].s.r&&b<=q[fe][0].e.r&&C>=q[fe][0].s.c&&C<=q[fe][0].e.c&&(w.F=q[fe][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(Ce=parseInt(_["number-rows-spanned"],10)||0,Re=parseInt(_["number-columns-spanned"],10)||0,te={s:{r:b,c:C},e:{r:b+Ce-1,c:C+Re-1}},ee.push(te)),_["number-columns-repeated"]&&(M=parseInt(_["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Fr(_["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(_.value);break;case"percentage":w.t="n",w.v=parseFloat(_.value);break;case"currency":w.t="n",w.v=parseFloat(_.value);break;case"date":w.t="d",w.v=Lr(_["date-value"]),n.cellDates||(w.t="n",w.v=Ji(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=BPe(_["time-value"])/86400,n.cellDates&&(w.t="d",w.v=OA(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(_.\u6570\u636E\u6570\u503C);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",_["string-value"]!=null&&(S=Yn(_["string-value"]),k=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(ie=!1,w.t==="s"&&(w.v=S||"",k.length&&(w.R=k),ie=x==0),E.Target&&(w.l=E),D.length>0&&(w.c=D,D=[]),S&&n.cellText!==!1&&(w.w=S),ie&&(w.t="z",delete w.v),(!ie||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=b))for(var ye=0;ye<L;++ye){if(M=parseInt(_["number-columns-repeated"]||"1",10),n.dense)for(p[b+ye]||(p[b+ye]=[]),p[b+ye][C]=ye==0?w:Hr(w);--M>0;)p[b+ye][C+M]=Hr(w);else for(p[Xt({r:b+ye,c:C})]=w;--M>0;)p[Xt({r:b+ye,c:C+M})]=Hr(w);N.e.c<=C&&(N.e.c=C)}M=parseInt(_["number-columns-repeated"]||"1",10),C+=M-1,M=0,w={},S="",k=[]}E={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((o=i.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((o=i.pop())[0]!==g[3])throw"Bad state: "+o;A.t=S,k.length&&(A.R=k),A.a=O,D.push(A)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);O="",U=0,S="",x=0,k=[];break;case"creator":g[1]==="/"?O=r.slice(U,g.index):U=g.index+g[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((o=i.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);S="",x=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(Y[a.name]=l,(o=i.pop())[0]!==g[3])throw"Bad state: "+o}else g[0].charAt(g[0].length-2)!=="/"&&(l="",a=Zt(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Zt(g[0],!1),l+=EQ[g[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Zt(g[0],!1),l+=EQ[g[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=r.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":s=Zt(g[0],!1),R=gB(s["cell-range-address"]);var Pe={Name:s.name,Ref:R[0]+"!"+R[1]};ue&&(Pe.Sheet=f.length),y.Names.push(Pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!_||!_["string-value"])){var F=fWe(r.slice(x,g.index),P);S=(S.length>0?S+`
`:"")+F[0]}else P=Zt(g[0],!1),x=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{R=gB(Zt(g[0])["target-range-address"]),h[R[0]]["!autofilter"]={ref:R[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(E=Zt(g[0],!1),!E.href)break;E.Target=Yn(E.href),delete E.href,E.Target.charAt(0)=="#"&&E.Target.indexOf(".")>-1?(R=gB(E.Target.slice(1)),E.Target="#"+R[0]+"!"+R[1]):E.Target.match(/^\.\.[\\\/]/)&&(E.Target=E.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(n.WTF)throw new Error(g)}}var Ke={Sheets:h,SheetNames:f,Workbook:y};return n.bookSheets&&delete Ke.Sheets,Ke}function xQ(t,e){e=e||{},cl(t,"META-INF/manifest.xml")&&Bke(Li(t,"META-INF/manifest.xml"),e);var n=Ra(t,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=bee(Sr(n),e);return cl(t,"meta.xml")&&(r.Props=pJ(Li(t,"meta.xml"))),r}function bQ(t,e){return bee(t,e)}var mWe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+V1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ti+e}}(),TQ=function(){var t=function(o){return gr(o).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(o,s,a){var l=[];l.push('      <table:table table:name="'+gr(s.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,d=ia(o["!ref"]||"A1"),h=o["!merges"]||[],f=0,p=Array.isArray(o);if(o["!cols"])for(u=0;u<=d.e.c;++u)l.push("        <table:table-column"+(o["!cols"][u]?' table:style-name="co'+o["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",w=o["!rows"]||[];for(c=0;c<d.s.r;++c)g=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=d.e.r;++c){for(g=w[c]?' table:style-name="ro'+w[c].ods+'"':"",l.push("        <table:table-row"+g+`>
`),u=0;u<d.s.c;++u)l.push(e);for(;u<=d.e.c;++u){var _=!1,S={},x="";for(f=0;f!=h.length;++f)if(!(h[f].s.c>u)&&!(h[f].s.r>c)&&!(h[f].e.c<u)&&!(h[f].e.r<c)){(h[f].s.c!=u||h[f].s.r!=c)&&(_=!0),S["table:number-columns-spanned"]=h[f].e.c-h[f].s.c+1,S["table:number-rows-spanned"]=h[f].e.r-h[f].s.r+1;break}if(_){l.push(n);continue}var P=Xt({r:c,c:u}),k=p?(o[c]||[])[u]:o[P];if(k&&k.f&&(S["table:formula"]=gr(PBe(k.f)),k.F&&k.F.slice(0,P.length)==P)){var b=ia(k.F);S["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,S["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(!k){l.push(e);continue}switch(k.t){case"b":x=k.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=k.v?"true":"false";break;case"n":x=k.w||String(k.v||0),S["office:value-type"]="float",S["office:value"]=k.v||0;break;case"s":case"str":x=k.v==null?"":k.v,S["office:value-type"]="string";break;case"d":x=k.w||Lr(k.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Lr(k.v).toISOString(),S["table:style-name"]="ce1";break;default:l.push(e);continue}var C=t(x);if(k.l&&k.l.Target){var N=k.l.Target;N=N.charAt(0)=="#"?"#"+kBe(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),C=ct("text:a",C,{"xlink:href":N.replace(/&/g,"&amp;")})}l.push("          "+ct("table:table-cell",ct("text:p",C,{}),S)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(o,s){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var a=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var d=c["!cols"][u];if(d.width==null&&d.wpx==null&&d.wch==null)continue;yf(d),d.ods=a;var h=c["!cols"][u].wpx+"px";o.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),o.push(`  </style:style>
`),++a}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var d=c["!rows"][u].hpx+"px";o.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),o.push(`  </style:style>
`),++l}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(s,a){var l=[Ti],c=V1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=V1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(mJ().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=s.SheetNames.length;++d)l.push(r(s.Sheets[s.SheetNames[d]],s,d,a));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function Tee(t,e){if(e.bookType=="fods")return TQ(t,e);var n=UB(),r="",i=[],o=[];return r="mimetype",_n(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",_n(n,r,TQ(t,e)),i.push([r,"text/xml"]),o.push([r,"ContentFile"]),r="styles.xml",_n(n,r,mWe(t,e)),i.push([r,"text/xml"]),o.push([r,"StylesFile"]),r="meta.xml",_n(n,r,Ti+mJ()),i.push([r,"text/xml"]),o.push([r,"MetadataFile"]),r="manifest.rdf",_n(n,r,jke(o)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",_n(n,r,Uke(i)),n}function Mp(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function NB(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Sr(Sf(t))}function pWe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ta(hu(t))}function gWe(t,e){e:for(var n=0;n<=t.length-e.length;++n){for(var r=0;r<e.length;++r)if(t[n+r]!=e[r])continue e;return!0}return!1}function Cf(t){var e=t.reduce(function(i,o){return i+o.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(i){n.set(i,r),r+=i.length}),n}function RQ(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function vWe(t,e){for(var n=(t[e+15]&127)<<7|t[e+14]>>1,r=t[e+14]&1,i=e+13;i>=e;--i)r=r*256+t[i];return(t[e+15]&128?-r:r)*Math.pow(10,n-6176)}function wWe(t,e,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);t[e+15]|=r>>7,t[e+14]|=(r&127)<<1;for(var o=0;i>=1;++o,i/=256)t[e+o]=i&255;t[e+15]|=n>=0?0:128}function Y1(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function mr(t){var e=new Uint8Array(7);e[0]=t&127;var n=1;e:if(t>127){if(e[n-1]|=128,e[n]=t>>7&127,++n,t<=16383||(e[n-1]|=128,e[n]=t>>14&127,++n,t<=2097151)||(e[n-1]|=128,e[n]=t>>21&127,++n,t<=268435455)||(e[n-1]|=128,e[n]=t/256>>>21&127,++n,t<=34359738367)||(e[n-1]|=128,e[n]=t/65536>>>21&127,++n,t<=4398046511103))break e;e[n-1]|=128,e[n]=t/16777216>>>21&127,++n}return e.slice(0,n)}function fi(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function Zn(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],i=Y1(t,n),o=i&7;i=Math.floor(i/8);var s=0,a;if(i==0)break;switch(o){case 0:{for(var l=n[0];t[n[0]++]>=128;);a=t.slice(l,n[0])}break;case 5:s=4,a=t.slice(n[0],n[0]+s),n[0]+=s;break;case 1:s=8,a=t.slice(n[0],n[0]+s),n[0]+=s;break;case 2:s=Y1(t,n),a=t.slice(n[0],n[0]+s),n[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(r))}var c={data:a,type:o};e[i]==null?e[i]=[c]:e[i].push(c)}return e}function Lo(t){var e=[];return t.forEach(function(n,r){n.forEach(function(i){i.data&&(e.push(mr(r*8+i.type)),i.type==2&&e.push(mr(i.data.length)),e.push(i.data))})}),Cf(e)}function w3(t,e){return t?.map(function(n){return e(n.data)})||[]}function al(t){for(var e,n=[],r=[0];r[0]<t.length;){var i=Y1(t,r),o=Zn(t.slice(r[0],r[0]+i));r[0]+=i;var s={id:fi(o[1][0].data),messages:[]};o[2].forEach(function(a){var l=Zn(a.data),c=fi(l[3][0].data);s.messages.push({meta:l,data:t.slice(r[0],r[0]+c)}),r[0]+=c}),(e=o[3])!=null&&e[0]&&(s.merge=fi(o[3][0].data)>>>0>0),n.push(s)}return n}function Av(t){var e=[];return t.forEach(function(n){var r=[];r[1]=[{data:mr(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:mr(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:mr(s.data.length)}],r[2].push({data:Lo(s.meta),type:2})});var o=Lo(r);e.push(mr(o.length)),e.push(o),i.forEach(function(s){return e.push(s)})}),Cf(e)}function yWe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=Y1(e,n),i=[];n[0]<e.length;){var o=e[n[0]]&3;if(o==0){var s=e[n[0]++]>>2;if(s<60)++s;else{var a=s-59;s=e[n[0]],a>1&&(s|=e[n[0]+1]<<8),a>2&&(s|=e[n[0]+2]<<16),a>3&&(s|=e[n[0]+3]<<24),s>>>=0,s++,n[0]+=a}i.push(e.slice(n[0],n[0]+s)),n[0]+=s;continue}else{var l=0,c=0;if(o==1?(c=(e[n[0]]>>2&7)+4,l=(e[n[0]++]&224)<<3,l|=e[n[0]++]):(c=(e[n[0]++]>>2)+1,o==2?(l=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(l=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),i=[Cf(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Cf(i);if(u.length!=r)throw new Error("Unexpected length: ".concat(u.length," != ").concat(r));return u}function ll(t){for(var e=[],n=0;n<t.length;){var r=t[n++],i=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(yWe(r,t.slice(n,n+i))),n+=i}if(n!==t.length)throw new Error("data is not a valid framed stream!");return Cf(e)}function Mv(t){for(var e=[],n=0;n<t.length;){var r=Math.min(t.length-n,268435455),i=new Uint8Array(4);e.push(i);var o=mr(r),s=o.length;e.push(o),r<=60?(s++,e.push(new Uint8Array([r-1<<2]))):r<=256?(s+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(s+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(s+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(s+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(t.slice(n,n+r)),s+=r,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,n+=r}return Cf(e)}function _We(t,e,n,r){var i=Mp(t),o=i.getUint32(4,!0),s=(r>1?12:8)+RQ(o&(r>1?3470:398))*4,a=-1,l=-1,c=NaN,u=new Date(2001,0,1);o&512&&(a=i.getUint32(s,!0),s+=4),s+=RQ(o&(r>1?12288:4096))*4,o&16&&(l=i.getUint32(s,!0),s+=4),o&32&&(c=i.getFloat64(s,!0),s+=8),o&64&&(u.setTime(u.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var d;switch(t[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:e[l]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(a>-1)d={t:"s",v:n[a]};else if(l>-1)d={t:"s",v:e[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return d}function CWe(t,e,n){var r=Mp(t),i=r.getUint32(8,!0),o=12,s=-1,a=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=vWe(t,o),o+=16),i&2&&(c=r.getFloat64(o,!0),o+=8),i&4&&(u.setTime(u.getTime()+r.getFloat64(o,!0)*1e3),o+=8),i&8&&(a=r.getUint32(o,!0),o+=4),i&16&&(s=r.getUint32(o,!0),o+=4);var d;switch(t[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:e[a]};break;case 5:d={t:"d",v:u};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(s>-1)d={t:"s",v:n[s]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return d}function wB(t,e){var n=new Uint8Array(32),r=Mp(n),i=12,o=0;switch(n[0]=5,t.t){case"n":n[1]=2,wWe(n,i,t.v),o|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,t.v?1:0,!0),o|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[1]=3,r.setUint32(i,e.indexOf(t.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,o,!0),n.slice(0,i)}function yB(t,e){var n=new Uint8Array(32),r=Mp(n),i=12,o=0;switch(n[0]=3,t.t){case"n":n[2]=2,r.setFloat64(i,t.v,!0),o|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,t.v?1:0,!0),o|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[2]=3,r.setUint32(i,e.indexOf(t.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,o,!0),n.slice(0,i)}function SWe(t,e,n){switch(t[0]){case 0:case 1:case 2:case 3:return _We(t,e,n,t[0]);case 5:return CWe(t,e,n);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ts(t){var e=Zn(t);return Y1(e[1][0].data)}function DQ(t,e){var n=Zn(e.data),r=fi(n[1][0].data),i=n[3],o=[];return(i||[]).forEach(function(s){var a=Zn(s.data),l=fi(a[1][0].data)>>>0;switch(r){case 1:o[l]=NB(a[3][0].data);break;case 8:{var c=t[ts(a[9][0].data)][0],u=Zn(c.data),d=t[ts(u[1][0].data)][0],h=fi(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var f=Zn(d.data);o[l]=f[3].map(function(p){return NB(p.data)}).join("")}break}}),o}function EWe(t,e){var n,r,i,o,s,a,l,c,u,d,h,f,p,g,w=Zn(t),_=fi(w[1][0].data)>>>0,S=fi(w[2][0].data)>>>0,x=((r=(n=w[8])==null?void 0:n[0])==null?void 0:r.data)&&fi(w[8][0].data)>0||!1,P,k;if((o=(i=w[7])==null?void 0:i[0])!=null&&o.data&&e!=0)P=(a=(s=w[7])==null?void 0:s[0])==null?void 0:a.data,k=(c=(l=w[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(u=w[4])==null?void 0:u[0])!=null&&d.data&&e!=1)P=(f=(h=w[4])==null?void 0:h[0])==null?void 0:f.data,k=(g=(p=w[3])==null?void 0:p[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var b=x?4:1,C=Mp(P),N=[],B=0;B<P.length/2;++B){var Y=C.getUint16(B*2,!0);Y<65535&&N.push([B,Y])}if(N.length!=S)throw"Expected ".concat(S," cells, found ").concat(N.length);var ee=[];for(B=0;B<N.length-1;++B)ee[N[B][0]]=k.subarray(N[B][1]*b,N[B+1][1]*b);return N.length>=1&&(ee[N[N.length-1][0]]=k.subarray(N[N.length-1][1]*b)),{R:_,cells:ee}}function xWe(t,e){var n,r=Zn(e.data),i=(n=r?.[7])!=null&&n[0]?fi(r[7][0].data)>>>0>0?1:0:-1,o=w3(r[5],function(s){return EWe(s,i)});return{nrows:fi(r[4][0].data)>>>0,data:o.reduce(function(s,a){return s[a.R]||(s[a.R]=[]),a.cells.forEach(function(l,c){if(s[a.R][c])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(c));s[a.R][c]=l}),s},[])}}function bWe(t,e,n){var r,i=Zn(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(fi(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(fi(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));n["!ref"]=fn(o);var s=Zn(i[4][0].data),a=DQ(t,t[ts(s[4][0].data)][0]),l=(r=s[17])!=null&&r[0]?DQ(t,t[ts(s[17][0].data)][0]):[],c=Zn(s[3][0].data),u=0;c[1].forEach(function(d){var h=Zn(d.data),f=t[ts(h[2][0].data)][0],p=fi(f.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var g=xWe(t,f);g.data.forEach(function(w,_){w.forEach(function(S,x){var P=Xt({r:u+_,c:x}),k=SWe(S,a,l);k&&(n[P]=k)})}),u+=g.nrows})}function TWe(t,e){var n=Zn(e.data),r={"!ref":"A1"},i=t[ts(n[2][0].data)],o=fi(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return bWe(t,i[0],r),r}function RWe(t,e){var n,r=Zn(e.data),i={name:(n=r[1])!=null&&n[0]?NB(r[1][0].data):"",sheets:[]},o=w3(r[2],ts);return o.forEach(function(s){t[s].forEach(function(a){var l=fi(a.meta[1][0].data);l==6e3&&i.sheets.push(TWe(t,a))})}),i}function DWe(t,e){var n=E3(),r=Zn(e.data),i=w3(r[1],ts);if(i.forEach(function(o){t[o].forEach(function(s){var a=fi(s.meta[1][0].data);if(a==2){var l=RWe(t,s);l.sheets.forEach(function(c,u){x3(n,c,u==0?l.name:l.name+"_"+u,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function _B(t){var e,n,r,i,o={},s=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=ll(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var u;try{u=al(c)}catch(d){return console.log("## "+(d.message||d))}u.forEach(function(d){o[d.id]=d.messages,s.push(d.id)})}}),!s.length)throw new Error("File has no messages");var a=((i=(r=(n=(e=o?.[1])==null?void 0:e[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:i[0].data)&&fi(o[1][0].meta[1][0].data)==1&&o[1][0];if(a||s.forEach(function(l){o[l].forEach(function(c){var u=fi(c.meta[1][0].data)>>>0;if(u==1)if(!a)a=c;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return DWe(o,a)}function IWe(t,e,n){var r,i,o,s;if(!((r=t[6])!=null&&r[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((s=(o=t[8])==null?void 0:o[0])==null?void 0:s.data)&&fi(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=Mp(t[7][0].data),u=0,d=[],h=Mp(t[4][0].data),f=0,p=[],g=0;g<e.length;++g){if(e[g]==null){c.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}c.setUint16(g*2,u,!0),h.setUint16(g*2,f,!0);var w,_;switch(typeof e[g]){case"string":w=wB({t:"s",v:e[g]},n),_=yB({t:"s",v:e[g]},n);break;case"number":w=wB({t:"n",v:e[g]},n),_=yB({t:"n",v:e[g]},n);break;case"boolean":w=wB({t:"b",v:e[g]},n),_=yB({t:"b",v:e[g]},n);break;default:throw new Error("Unsupported value "+e[g])}d.push(w),u+=w.length,p.push(_),f+=_.length,++l}for(t[2][0].data=mr(l);g<t[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return t[6][0].data=Cf(d),t[3][0].data=Cf(p),l}function AWe(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=ia(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(fn(r)));var o=RA(n,{range:r,header:1}),s=["~Sh33tJ5~"];o.forEach(function(O){return O.forEach(function(U){typeof U=="string"&&s.push(U)})});var a={},l=[],c=Vt.read(e.numbers,{type:"base64"});c.FileIndex.map(function(O,U){return[O,c.FullPaths[U]]}).forEach(function(O){var U=O[0],ie=O[1];if(U.type==2&&U.name.match(/\.iwa/)){var ue=U.content,fe=ll(ue),de=al(fe);de.forEach(function(ye){l.push(ye.id),a[ye.id]={deps:[],location:ie,type:fi(ye.messages[0].meta[1][0].data)}})}}),l.sort(function(O,U){return O-U});var u=l.filter(function(O){return O>1}).map(function(O){return[O,mr(O)]});c.FileIndex.map(function(O,U){return[O,c.FullPaths[U]]}).forEach(function(O){var U=O[0],ie=O[1];if(U.name.match(/\.iwa/)){var ue=al(ll(U.content));ue.forEach(function(fe){fe.messages.forEach(function(de){u.forEach(function(ye){fe.messages.some(function(Pe){return fi(Pe.meta[1][0].data)!=11006&&gWe(Pe.data,ye[1])})&&a[ye[0]].deps.push(fe.id)})})})}});function d(){for(var O=927262;O<2e6;++O)if(!a[O])return O;throw new Error("Too many messages")}for(var h=Vt.find(c,a[1].location),f=al(ll(h.content)),p,g=0;g<f.length;++g){var w=f[g];w.id==1&&(p=w)}var _=ts(Zn(p.messages[0].data)[1][0].data);for(h=Vt.find(c,a[_].location),f=al(ll(h.content)),g=0;g<f.length;++g)w=f[g],w.id==_&&(p=w);for(_=ts(Zn(p.messages[0].data)[2][0].data),h=Vt.find(c,a[_].location),f=al(ll(h.content)),g=0;g<f.length;++g)w=f[g],w.id==_&&(p=w);for(_=ts(Zn(p.messages[0].data)[2][0].data),h=Vt.find(c,a[_].location),f=al(ll(h.content)),g=0;g<f.length;++g)w=f[g],w.id==_&&(p=w);var S=Zn(p.messages[0].data);{S[6][0].data=mr(r.e.r+1),S[7][0].data=mr(r.e.c+1);var x=ts(S[46][0].data),P=Vt.find(c,a[x].location),k=al(ll(P.content));{for(var b=0;b<k.length&&k[b].id!=x;++b);if(k[b].id!=x)throw"Bad ColumnRowUIDMapArchive";var C=Zn(k[b].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var N=0;N<=r.e.c;++N){var B=[];B[1]=B[2]=[{type:0,data:mr(N+420690)}],C[1].push({type:2,data:Lo(B)}),C[2].push({type:0,data:mr(N)}),C[3].push({type:0,data:mr(N)})}C[4]=[],C[5]=[],C[6]=[];for(var Y=0;Y<=r.e.r;++Y)B=[],B[1]=B[2]=[{type:0,data:mr(Y+726270)}],C[4].push({type:2,data:Lo(B)}),C[5].push({type:0,data:mr(Y)}),C[6].push({type:0,data:mr(Y)});k[b].messages[0].data=Lo(C)}P.content=Mv(Av(k)),P.size=P.content.length,delete S[46];var ee=Zn(S[4][0].data);{ee[7][0].data=mr(r.e.r+1);var te=Zn(ee[1][0].data),Ce=ts(te[2][0].data);P=Vt.find(c,a[Ce].location),k=al(ll(P.content));{if(k[0].id!=Ce)throw"Bad HeaderStorageBucket";var Re=Zn(k[0].messages[0].data);for(Y=0;Y<o.length;++Y){var _e=Zn(Re[2][0].data);_e[1][0].data=mr(Y),_e[4][0].data=mr(o[Y].length),Re[2][Y]={type:Re[2][0].type,data:Lo(_e)}}k[0].messages[0].data=Lo(Re)}P.content=Mv(Av(k)),P.size=P.content.length;var L=ts(ee[2][0].data);P=Vt.find(c,a[L].location),k=al(ll(P.content));{if(k[0].id!=L)throw"Bad HeaderStorageBucket";for(Re=Zn(k[0].messages[0].data),N=0;N<=r.e.c;++N)_e=Zn(Re[2][0].data),_e[1][0].data=mr(N),_e[4][0].data=mr(r.e.r+1),Re[2][N]={type:Re[2][0].type,data:Lo(_e)};k[0].messages[0].data=Lo(Re)}P.content=Mv(Av(k)),P.size=P.content.length;var M=ts(ee[4][0].data);(function(){for(var O=Vt.find(c,a[M].location),U=al(ll(O.content)),ie,ue=0;ue<U.length;++ue){var fe=U[ue];fe.id==M&&(ie=fe)}var de=Zn(ie.messages[0].data);{de[3]=[];var ye=[];s.forEach(function(Ke,$e){ye[1]=[{type:0,data:mr($e)}],ye[2]=[{type:0,data:mr(1)}],ye[3]=[{type:2,data:pWe(Ke)}],de[3].push({type:2,data:Lo(ye)})})}ie.messages[0].data=Lo(de);var Pe=Av(U),F=Mv(Pe);O.content=F,O.size=O.content.length})();var q=Zn(ee[3][0].data);{var y=q[1][0];delete q[2];var E=Zn(y.data);{var R=ts(E[2][0].data);(function(){for(var O=Vt.find(c,a[R].location),U=al(ll(O.content)),ie,ue=0;ue<U.length;++ue){var fe=U[ue];fe.id==R&&(ie=fe)}var de=Zn(ie.messages[0].data);{delete de[6],delete q[7];var ye=new Uint8Array(de[5][0].data);de[5]=[];for(var Pe=0,F=0;F<=r.e.r;++F){var Ke=Zn(ye);Pe+=IWe(Ke,o[F],s),Ke[1][0].data=mr(F),de[5].push({data:Lo(Ke),type:2})}de[1]=[{type:0,data:mr(r.e.c+1)}],de[2]=[{type:0,data:mr(r.e.r+1)}],de[3]=[{type:0,data:mr(Pe)}],de[4]=[{type:0,data:mr(r.e.r+1)}]}ie.messages[0].data=Lo(de);var $e=Av(U),rt=Mv($e);O.content=rt,O.size=O.content.length})()}y.data=Lo(E)}ee[3][0].data=Lo(q)}S[4][0].data=Lo(ee)}p.messages[0].data=Lo(S);var D=Av(f),A=Mv(D);return h.content=A,h.size=h.content.length,c}function Ree(t){return function(n){for(var r=0;r!=t.length;++r){var i=t[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function y3(t){Ree([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function _3(t){Ree([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function MWe(t){return Cn.WS.indexOf(t)>-1?"sheet":Cn.CS&&t==Cn.CS?"chart":Cn.DS&&t==Cn.DS?"dialog":Cn.MS&&t==Cn.MS?"macro":t&&t.length?t:"sheet"}function OWe(t,e){if(!t)return 0;try{t=e.map(function(r){return r.id||(r.id=r.strRelID),[r.name,t["!id"][r.id].Target,MWe(t["!id"][r.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function NWe(t,e,n,r,i,o,s,a,l,c,u,d){try{o[r]=A1(Ra(t,n,!0),e);var h=Li(t,e),f;switch(a){case"sheet":f=tUe(h,e,i,l,o[r],c,u,d);break;case"chart":if(f=nUe(h,e,i,l,o[r],c,u,d),!f||!f["!drawel"])break;var p=T1(f["!drawel"].Target,e),g=U1(p),w=WHe(Ra(t,p,!0),A1(Ra(t,g,!0),p)),_=T1(w,p),S=U1(_);f=I4e(Ra(t,_,!0),_,l,A1(Ra(t,S,!0),_),c,f);break;case"macro":f=rUe(h,e,i,l,o[r],c,u,d);break;case"dialog":f=iUe(h,e,i,l,o[r],c,u,d);break;default:throw new Error("Unrecognized sheet type "+a)}s[r]=f;var x=[];o&&o[r]&&pi(o[r]).forEach(function(P){var k="";if(o[r][P].Type==Cn.CMNT){k=T1(o[r][P].Target,e);var b=lUe(Li(t,k,!0),k,l);if(!b||!b.length)return;fQ(f,b,!1)}o[r][P].Type==Cn.TCMNT&&(k=T1(o[r][P].Target,e),x=x.concat($He(Li(t,k,!0),l)))}),x&&x.length&&fQ(f,x,!0,l.people||[])}catch(P){if(l.WTF)throw P}}function ol(t){return t.charAt(0)=="/"?t.slice(1):t}function PWe(t,e){if($v(),e=e||{},y3(e),cl(t,"META-INF/manifest.xml")||cl(t,"objectdata.xml"))return xQ(t,e);if(cl(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof _B<"u"){if(t.FileIndex)return _B(t);var n=Vt.utils.cfb_new();return PZ(t).forEach(function(Re){_n(n,Re,zQ(t,Re))}),_B(n)}throw new Error("Unsupported NUMBERS file")}if(!cl(t,"[Content_Types].xml"))throw cl(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):cl(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=PZ(t),i=Hke(Ra(t,"[Content_Types].xml")),o=!1,s,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",Li(t,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!Li(t,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(M1=[],i.sst)try{M1=aUe(Li(t,ol(i.sst)),i.sst,e)}catch(Re){if(e.WTF)throw Re}e.cellStyles&&i.themes.length&&(l=sUe(Ra(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(c=oUe(Li(t,ol(i.style)),i.style,l,e))}i.links.map(function(Re){try{var _e=A1(Ra(t,U1(ol(Re))),Re);return uUe(Li(t,ol(Re)),_e,Re,e)}catch{}});var u=eUe(Li(t,ol(i.workbooks[0])),i.workbooks[0],e),d={},h="";i.coreprops.length&&(h=Li(t,ol(i.coreprops[0]),!0),h&&(d=pJ(h)),i.extprops.length!==0&&(h=Li(t,ol(i.extprops[0]),!0),h&&Gke(h,d,e)));var f={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(h=Ra(t,ol(i.custprops[0]),!0),h&&(f=Yke(h,e)));var p={};if((e.bookSheets||e.bookProps)&&(u.Sheets?s=u.Sheets.map(function(_e){return _e.name}):d.Worksheets&&d.SheetNames.length>0&&(s=d.SheetNames),e.bookProps&&(p.Props=d,p.Custprops=f),e.bookSheets&&typeof s<"u"&&(p.SheetNames=s),e.bookSheets?p.SheetNames:e.bookProps))return p;s={};var g={};e.bookDeps&&i.calcchain&&(g=cUe(Li(t,ol(i.calcchain)),i.calcchain,e));var w=0,_={},S,x;{var P=u.Sheets;d.Worksheets=P.length,d.SheetNames=[];for(var k=0;k!=P.length;++k)d.SheetNames[k]=P[k].name}var b=o?"bin":"xml",C=i.workbooks[0].lastIndexOf("/"),N=(i.workbooks[0].slice(0,C+1)+"_rels/"+i.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");cl(t,N)||(N="xl/_rels/workbook."+b+".rels");var B=A1(Ra(t,N,!0),N.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=dUe(Li(t,ol(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=zHe(Li(t,ol(i.people[0])),e)),B&&(B=OWe(B,u.Sheets));var Y=Li(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=d.Worksheets;++w){var ee="sheet";if(B&&B[w]?(S="xl/"+B[w][1].replace(/[\/]?xl\//,""),cl(t,S)||(S=B[w][1]),cl(t,S)||(S=N.replace(/_rels\/.*$/,"")+B[w][1]),ee=B[w][2]):(S="xl/worksheets/sheet"+(w+1-Y)+"."+b,S=S.replace(/sheet0\./,"sheet.")),x=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(d.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var te=!1,Ce=0;Ce!=e.sheets.length;++Ce)typeof e.sheets[Ce]=="number"&&e.sheets[Ce]==w&&(te=1),typeof e.sheets[Ce]=="string"&&e.sheets[Ce].toLowerCase()==d.SheetNames[w].toLowerCase()&&(te=1);if(!te)continue e}}NWe(t,S,x,d.SheetNames[w],w,_,s,ee,e,u,l,c)}return p={Directory:i,Workbook:u,Props:d,Custprops:f,Deps:g,Sheets:s,SheetNames:d.SheetNames,Strings:M1,Styles:c,Themes:l,SSF:Hr(Kt)},e&&e.bookFiles&&(t.files?(p.keys=r,p.files=t.files):(p.keys=[],p.files={},t.FullPaths.forEach(function(Re,_e){Re=Re.replace(/^Root Entry[\/]/,""),p.keys.push(Re),p.files[Re]=t.FileIndex[_e]}))),e&&e.bookVBA&&(i.vba.length>0?p.vbaraw=Li(t,ol(i.vba[0]),!0):i.defaults&&i.defaults.bin===eVe&&(p.vbaraw=Li(t,"xl/vbaProject.bin",!0))),p}function kWe(t,e){var n=e||{},r="Workbook",i=Vt.find(t,r);try{if(r="/!DataSpaces/Version",i=Vt.find(t,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(dLe(i.content),r="/!DataSpaces/DataSpaceMap",i=Vt.find(t,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=fLe(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Vt.find(t,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=mLe(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Vt.find(t,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);gLe(i.content)}catch{}if(r="/EncryptionInfo",i=Vt.find(t,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=vLe(i.content);if(r="/EncryptedPackage",i=Vt.find(t,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,n.password||"",n);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,n.password||"",n);throw new Error("File is password-protected")}function FWe(t,e){return e.bookType=="ods"?Tee(t,e):e.bookType=="numbers"?AWe(t,e):e.bookType=="xlsb"?LWe(t,e):HWe(t,e)}function LWe(t,e){Pv=1024,t&&!t.SSF&&(t.SSF=Hr(Kt)),t&&t.SSF&&($v(),IA(t.SSF),e.revssf=MA(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,O1?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n=e.bookType=="xlsb"?"bin":"xml",r=eee.indexOf(e.bookType)>-1,i=o3();_3(e=e||{});var o=UB(),s="",a=0;if(e.cellXfs=[],xf(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",_n(o,s,gJ(t.Props,e)),i.coreprops.push(s),pr(e.rels,2,s,Cn.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,_n(o,s,yJ(t.Props,e)),i.extprops.push(s),pr(e.rels,3,s,Cn.EXT_PROPS),t.Custprops!==t.Props&&pi(t.Custprops||{}).length>0&&(s="docProps/custom.xml",_n(o,s,_J(t.Custprops,e)),i.custprops.push(s),pr(e.rels,4,s,Cn.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var u={"!id":{}},d=t.Sheets[t.SheetNames[a-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+a+"."+n,_n(o,s,fUe(a-1,s,e,t,u)),i.sheets.push(s),pr(e.wbrels,-1,"worksheets/sheet"+a+"."+n,Cn.WS[0])}if(d){var f=d["!comments"],p=!1,g="";f&&f.length>0&&(g="xl/comments"+a+"."+n,_n(o,g,gUe(f,g,e)),i.comments.push(g),pr(u,-1,"../comments"+a+"."+n,Cn.CMNT),p=!0),d["!legacy"]&&p&&_n(o,"xl/drawings/vmlDrawing"+a+".vml",QJ(a,d["!comments"])),delete d["!comments"],delete d["!legacy"]}u["!id"].rId1&&_n(o,U1(s),Fv(u))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+n,_n(o,s,pUe(e.Strings,s,e)),i.strs.push(s),pr(e.wbrels,-1,"sharedStrings."+n,Cn.SST)),s="xl/workbook."+n,_n(o,s,hUe(t,s,e)),i.workbooks.push(s),pr(e.rels,1,s,Cn.WB),s="xl/theme/theme1.xml",_n(o,s,d3(t.Themes,e)),i.themes.push(s),pr(e.wbrels,-1,"theme/theme1.xml",Cn.THEME),s="xl/styles."+n,_n(o,s,mUe(t,s,e)),i.styles.push(s),pr(e.wbrels,-1,"styles."+n,Cn.STY),t.vbaraw&&r&&(s="xl/vbaProject.bin",_n(o,s,t.vbaraw),i.vba.push(s),pr(e.wbrels,-1,"vbaProject.bin",Cn.VBA)),s="xl/metadata."+n,_n(o,s,vUe(s)),i.metadata.push(s),pr(e.wbrels,-1,"metadata."+n,Cn.XLMETA),_n(o,"[Content_Types].xml",fJ(i,e)),_n(o,"_rels/.rels",Fv(e.rels)),_n(o,"xl/_rels/workbook."+n+".rels",Fv(e.wbrels)),delete e.revssf,delete e.ssf,o}function HWe(t,e){Pv=1024,t&&!t.SSF&&(t.SSF=Hr(Kt)),t&&t.SSF&&($v(),IA(t.SSF),e.revssf=MA(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,O1?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n="xml",r=eee.indexOf(e.bookType)>-1,i=o3();_3(e=e||{});var o=UB(),s="",a=0;if(e.cellXfs=[],xf(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),s="docProps/core.xml",_n(o,s,gJ(t.Props,e)),i.coreprops.push(s),pr(e.rels,2,s,Cn.CORE_PROPS),s="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],c=0;c<t.SheetNames.length;++c)(t.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(t.SheetNames[c]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,_n(o,s,yJ(t.Props,e)),i.extprops.push(s),pr(e.rels,3,s,Cn.EXT_PROPS),t.Custprops!==t.Props&&pi(t.Custprops||{}).length>0&&(s="docProps/custom.xml",_n(o,s,_J(t.Custprops,e)),i.custprops.push(s),pr(e.rels,4,s,Cn.CUST_PROPS));var u=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var d={"!id":{}},h=t.Sheets[t.SheetNames[a-1]],f=(h||{})["!type"]||"sheet";switch(f){case"chart":default:s="xl/worksheets/sheet"+a+"."+n,_n(o,s,dee(a-1,e,t,d)),i.sheets.push(s),pr(e.wbrels,-1,"worksheets/sheet"+a+"."+n,Cn.WS[0])}if(h){var p=h["!comments"],g=!1,w="";if(p&&p.length>0){var _=!1;p.forEach(function(S){S[1].forEach(function(x){x.T==!0&&(_=!0)})}),_&&(w="xl/threadedComments/threadedComment"+a+"."+n,_n(o,w,GHe(p,u,e)),i.threadedcomments.push(w),pr(d,-1,"../threadedComments/threadedComment"+a+"."+n,Cn.TCMNT)),w="xl/comments"+a+"."+n,_n(o,w,JJ(p,e)),i.comments.push(w),pr(d,-1,"../comments"+a+"."+n,Cn.CMNT),g=!0}h["!legacy"]&&g&&_n(o,"xl/drawings/vmlDrawing"+a+".vml",QJ(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&_n(o,U1(s),Fv(d))}return e.Strings!=null&&e.Strings.length>0&&(s="xl/sharedStrings."+n,_n(o,s,BJ(e.Strings,e)),i.strs.push(s),pr(e.wbrels,-1,"sharedStrings."+n,Cn.SST)),s="xl/workbook."+n,_n(o,s,gee(t,e)),i.workbooks.push(s),pr(e.rels,1,s,Cn.WB),s="xl/theme/theme1.xml",_n(o,s,d3(t.Themes,e)),i.themes.push(s),pr(e.wbrels,-1,"theme/theme1.xml",Cn.THEME),s="xl/styles."+n,_n(o,s,qJ(t,e)),i.styles.push(s),pr(e.wbrels,-1,"styles."+n,Cn.STY),t.vbaraw&&r&&(s="xl/vbaProject.bin",_n(o,s,t.vbaraw),i.vba.push(s),pr(e.wbrels,-1,"vbaProject.bin",Cn.VBA)),s="xl/metadata."+n,_n(o,s,ZJ()),i.metadata.push(s),pr(e.wbrels,-1,"metadata."+n,Cn.XLMETA),u.length>1&&(s="xl/persons/person.xml",_n(o,s,YHe(u,e)),i.people.push(s),pr(e.wbrels,-1,"persons/person.xml",Cn.PEOPLE)),_n(o,"[Content_Types].xml",fJ(i,e)),_n(o,"_rels/.rels",Fv(e.rels)),_n(o,"xl/_rels/workbook."+n+".rels",Fv(e.wbrels)),delete e.revssf,delete e.ssf,o}function C3(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Da(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function VWe(t,e){return Vt.find(t,"EncryptedPackage")?kWe(t,e):_ee(t,e)}function BWe(t,e){var n,r=t,i=e||{};return i.type||(i.type=In&&Buffer.isBuffer(t)?"buffer":"base64"),n=YQ(r,i),PWe(n,i)}function Dee(t,e){var n=0;e:for(;n<t.length;)switch(t.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return MB(t.slice(n),e);default:break e}return Uv.to_workbook(t,e)}function UWe(t,e){var n="",r=C3(t,e);switch(e.type){case"base64":n=Da(t);break;case"binary":n=t;break;case"buffer":n=t.toString("binary");break;case"array":n=Rp(t);break;default:throw new Error("Unrecognized type "+e.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Sr(n)),e.type="binary",Dee(n,e)}function WWe(t,e){var n=t;return e.type=="base64"&&(n=Da(n)),n=ur.utils.decode(1200,n.slice(2),"str"),e.type="binary",Dee(n,e)}function jWe(t){return t.match(/[^\x00-\x7F]/)?hu(t):t}function CB(t,e,n,r){return r?(n.type="string",Uv.to_workbook(t,n)):Uv.to_workbook(e,n)}function TA(t,e){FB();var n=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return TA(new Uint8Array(t),(n=Hr(n),n.type="array",n));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=t,i=[0,0,0,0],o=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Hv={},n.dateNF&&(Hv.dateNF=n.dateNF),n.type||(n.type=In&&Buffer.isBuffer(t)?"buffer":"base64"),n.type=="file"&&(n.type=In?"buffer":"binary",r=LPe(t),typeof Uint8Array<"u"&&!In&&(n.type="array")),n.type=="string"&&(o=!0,n.type="binary",n.codepage=65001,r=jWe(t)),n.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),a=new Uint8Array(s);if(a.foo="bar",!a.foo)return n=Hr(n),n.type="array",TA(LB(r),n)}switch((i=C3(r,n))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return VWe(Vt.read(r,n),n);break;case 9:if(i[1]<=8)return _ee(r,n);break;case 60:return MB(r,n);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return q2e(r,n);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return HJ.to_workbook(r,n);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?BWe(r,n):CB(t,r,n,o);case 239:return i[3]===60?MB(r,n):CB(t,r,n,o);case 255:if(i[1]===254)return WWe(r,n);if(i[1]===0&&i[2]===2&&i[3]===0)return xp.to_workbook(r,n);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return xp.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return AB.to_workbook(r,n);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return GJ.to_workbook(r,n);break;case 10:case 13:case 32:return UWe(r,n);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Y2e.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?AB.to_workbook(r,n):CB(t,r,n,o)}function Iee(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return K1(e.file,Vt.write(t,{type:In?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Vt.write(t,e)}function $We(t,e){var n=Hr(e||{}),r=FWe(t,n);return GWe(r,n)}function GWe(t,e){var n={},r=In?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(n.compression="DEFLATE"),e.password)n.type=r;else switch(e.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Vt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!e.compression}):t.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(DA(i))}return e.password&&typeof encrypt_agile<"u"?Iee(encrypt_agile(i,e.password),e):e.type==="file"?K1(e.file,i):e.type=="string"?Sr(i):i}function zWe(t,e){var n=e||{},r=jUe(t,n);return Iee(r,n)}function du(t,e,n){n||(n="");var r=n+t;switch(e.type){case"base64":return F1(hu(r));case"binary":return hu(r);case"string":return t;case"file":return K1(e.file,r,"utf8");case"buffer":return In?kd(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):du(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function YWe(t,e){switch(e.type){case"base64":return F1(t);case"binary":return t;case"string":return t;case"file":return K1(e.file,t,"binary");case"buffer":return In?kd(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function mA(t,e){switch(e.type){case"string":case"base64":case"binary":for(var n="",r=0;r<t.length;++r)n+=String.fromCharCode(t[r]);return e.type=="base64"?F1(n):e.type=="string"?Sr(n):n;case"file":return K1(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Aee(t,e){FB(),V4e(t);var n=Hr(e||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=Aee(t,n);return n.type="array",DA(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=t.SheetNames.indexOf(n.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return du(FUe(t,n),n);case"slk":case"sylk":return du(LJ.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"htm":case"html":return du(See(t.Sheets[t.SheetNames[i]],n),n);case"txt":return YWe(Oee(t.Sheets[t.SheetNames[i]],n),n);case"csv":return du(S3(t.Sheets[t.SheetNames[i]],n),n,"\uFEFF");case"dif":return du(HJ.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"dbf":return mA(AB.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"prn":return du(Uv.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"rtf":return du(GJ.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"eth":return du(VJ.from_sheet(t.Sheets[t.SheetNames[i]],n),n);case"fods":return du(Tee(t,n),n);case"wk1":return mA(xp.sheet_to_wk1(t.Sheets[t.SheetNames[i]],n),n);case"wk3":return mA(xp.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),mA(Cee(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),zWe(t,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return $We(t,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function qWe(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(t.bookType=n.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Mee(t,e,n){var r=n||{};return r.type="file",r.file=e,qWe(r),Aee(t,r)}function KWe(t,e,n,r,i,o,s,a){var l=bi(n),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),d=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:n,enumerable:!1})}catch{h.__rowNum__=n}else h.__rowNum__=n;if(!s||t[n])for(var f=e.s.c;f<=e.e.c;++f){var p=s?t[n][f]:t[r[f]+l];if(p===void 0||p.t===void 0){if(c===void 0)continue;o[f]!=null&&(h[o[f]]=c);continue}var g=p.v;switch(p.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(o[f]!=null){if(g==null)if(p.t=="e"&&g===null)h[o[f]]=null;else if(c!==void 0)h[o[f]]=c;else if(u&&g===null)h[o[f]]=null;else continue;else h[o[f]]=u&&(p.t!=="n"||p.t==="n"&&a.rawNumbers!==!1)?g:Pd(p,g,a);g!=null&&(d=!1)}}return{row:h,isempty:d}}function RA(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,o=[],s=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?r=1:c.header==="A"?r=2:Array.isArray(c.header)?r=3:c.header==null&&(r=0),typeof u){case"string":l=qn(u);break;case"number":l=qn(t["!ref"]),l.s.r=u;break;default:l=u}r>0&&(i=0);var d=bi(l.s.r),h=[],f=[],p=0,g=0,w=Array.isArray(t),_=l.s.r,S=0,x={};w&&!t[_]&&(t[_]=[]);var P=c.skipHidden&&t["!cols"]||[],k=c.skipHidden&&t["!rows"]||[];for(S=l.s.c;S<=l.e.c;++S)if(!(P[S]||{}).hidden)switch(h[S]=Qr(S),n=w?t[_][S]:t[h[S]+d],r){case 1:o[S]=S-l.s.c;break;case 2:o[S]=h[S];break;case 3:o[S]=c.header[S-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),a=s=Pd(n,null,c),g=x[s]||0,!g)x[s]=1;else{do a=s+"_"+g++;while(x[a]);x[s]=g,x[a]=1}o[S]=a}for(_=l.s.r+i;_<=l.e.r;++_)if(!(k[_]||{}).hidden){var b=KWe(t,l,_,h,r,o,w,c);(b.isempty===!1||(r===1?c.blankrows!==!1:c.blankrows))&&(f[p++]=b.row)}return f.length=p,f}var IQ=/"/g;function XWe(t,e,n,r,i,o,s,a){for(var l=!0,c=[],u="",d=bi(n),h=e.s.c;h<=e.e.c;++h)if(r[h]){var f=a.dense?(t[n]||[])[h]:t[r[h]+d];if(f==null)u="";else if(f.v!=null){l=!1,u=""+(a.rawNumbers&&f.t=="n"?f.v:Pd(f,null,a));for(var p=0,g=0;p!==u.length;++p)if((g=u.charCodeAt(p))===i||g===o||g===34||a.forceQuotes){u='"'+u.replace(IQ,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(l=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(IQ,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(s)}function S3(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var i=qn(t["!ref"]),o=r.FS!==void 0?r.FS:",",s=o.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,l=a.charCodeAt(0),c=new RegExp((o=="|"?"\\|":o)+"+$"),u="",d=[];r.dense=Array.isArray(t);for(var h=r.skipHidden&&t["!cols"]||[],f=r.skipHidden&&t["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(h[p]||{}).hidden||(d[p]=Qr(p));for(var g=0,w=i.s.r;w<=i.e.r;++w)(f[w]||{}).hidden||(u=XWe(t,i,w,d,s,l,o,r),u!=null&&(r.strip&&(u=u.replace(c,"")),(u||r.blankrows!==!1)&&n.push((g++?a:"")+u)));return delete r.dense,n.join("")}function Oee(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=S3(t,e);if(typeof ur>"u"||e.type=="string")return n;var r=ur.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r}function ZWe(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var i=qn(t["!ref"]),o="",s=[],a,l=[],c=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)s[a]=Qr(a);for(var u=i.s.r;u<=i.e.r;++u)for(o=bi(u),a=i.s.c;a<=i.e.c;++a)if(e=s[a]+o,n=c?(t[u]||[])[a]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=e+"="+r}return l}function Nee(t,e,n){var r=n||{},i=+!r.skipHeader,o=t||{},s=0,a=0;if(o&&r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var l=typeof r.origin=="string"?Jr(r.origin):r.origin;s=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:s+e.length-1+i}};if(o["!ref"]){var d=qn(o["!ref"]);u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),s==-1&&(s=d.e.r+1,u.e.r=s+e.length-1+i)}else s==-1&&(s=0,u.e.r=e.length-1+i);var h=r.header||[],f=0;e.forEach(function(g,w){pi(g).forEach(function(_){(f=h.indexOf(_))==-1&&(h[f=h.length]=_);var S=g[_],x="z",P="",k=Xt({c:a+f,r:s+w+i});c=q1(o,k),S&&typeof S=="object"&&!(S instanceof Date)?o[k]=S:(typeof S=="number"?x="n":typeof S=="boolean"?x="b":typeof S=="string"?x="s":S instanceof Date?(x="d",r.cellDates||(x="n",S=Ji(S)),P=r.dateNF||Kt[14]):S===null&&r.nullError&&(x="e",S=0),c?(c.t=x,c.v=S,delete c.w,delete c.R,P&&(c.z=P)):o[k]=c={t:x,v:S},P&&(c.z=P))})}),u.e.c=Math.max(u.e.c,a+h.length-1);var p=bi(s);if(i)for(f=0;f<h.length;++f)o[Qr(f+a)+p]={t:"s",v:h[f]};return o["!ref"]=fn(u),o}function QWe(t,e){return Nee(null,t,e)}function q1(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=Jr(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?q1(t,Xt(e)):q1(t,Xt({r:e,c:n||0}))}function JWe(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function E3(){return{SheetNames:[],Sheets:{}}}function x3(t,e,n,r){var i=1;if(!n)for(;i<=65535&&t.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var s=o&&o[1]||n;for(++i;i<=65535&&t.SheetNames.indexOf(n=s+i)!=-1;++i);}if(pee(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function e8e(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=JWe(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function t8e(t,e){return t.z=e,t}function Pee(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function n8e(t,e,n){return Pee(t,"#"+e,n)}function r8e(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function i8e(t,e,n,r){for(var i=typeof e!="string"?e:qn(e),o=typeof e=="string"?e:fn(e),s=i.s.r;s<=i.e.r;++s)for(var a=i.s.c;a<=i.e.c;++a){var l=q1(t,s,a);l.t="n",l.F=o,delete l.v,s==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}return t}var Hp={encode_col:Qr,encode_row:bi,encode_cell:Xt,encode_range:fn,decode_col:JB,decode_row:QB,split_cell:pke,decode_cell:Jr,decode_range:ia,format_cell:Pd,sheet_add_aoa:sJ,sheet_add_json:Nee,sheet_add_dom:Eee,aoa_to_sheet:zv,json_to_sheet:QWe,table_to_sheet:xee,table_to_book:dWe,sheet_to_csv:S3,sheet_to_txt:Oee,sheet_to_json:RA,sheet_to_html:See,sheet_to_formulae:ZWe,sheet_to_row_object_array:RA,sheet_get_cell:q1,book_new:E3,book_append_sheet:x3,book_set_sheet_visibility:e8e,cell_set_number_format:t8e,cell_set_hyperlink:Pee,cell_set_internal_link:n8e,cell_add_comment:r8e,sheet_set_array_formula:i8e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var R1t=k1.version;var TLt=Q(ze(),1),RLt=Q(De(),1),DLt=Q(wie(),1);var NEt=Q(ze(),1),PEt=Q(De(),1);var AEt=Q(ze(),1),Rie=Q(yie(),1);var F4=Q(Ma(),1);var xEt=Q(ze(),1);function _ie(t){let e=t.length,n=0;for(;n<e;)t[n]=[t[n]],n+=1}function N4(t,e){let n=e.length,r=0;for(;r<n;)t.push(e[r]),r+=1}function Jv(t){let e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;let n=t.length,r=t[0].length;for(let i=0;i<n;i++)for(let o=0;o<r;o++)e[o]||(e[o]=[]),e[o][i]=t[i][o];return e}function or(t,e,n,r){let i=-1,o=t,s=n;Array.isArray(t)||(o=Array.from(t));let a=o.length;for(r&&a&&(i+=1,s=o[i]),i+=1;i<a;)s=e(s,o[i],i,o),i+=1;return s}function gi(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));let i=r.length,o=[],s=-1;for(;n<i;){let a=r[n];e(a,n,r)&&(s+=1,o[s]=a),n+=1}return o}function At(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));let i=r.length,o=[],s=-1;for(;n<i;){let a=r[n];s+=1,o[s]=e(a,n,r),n+=1}return o}function Z(t,e){let n=0,r=t;Array.isArray(t)||(r=Array.from(t));let i=r.length;for(;n<i&&e(r[n],n,r)!==!1;)n+=1;return t}function oM(t){let e=[];return Z(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function P4(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];let[r,...i]=[...e],o=r;return Z(i,s=>{o=o.filter(a=>!s.includes(a))}),o}function k4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Qt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return or(t,(o,s,a)=>{let l=s.replace(/\r?\n\s*/g,""),c=n[a]?n[a]:"";return o+l+c},"").trim()}function Qn(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Ze(t){return typeof t<"u"}function mn(t){return typeof t>"u"}function Er(t){return t===null||t===""||mn(t)}function bie(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var mS="length",pS=t=>parseInt(t,16),Cie=t=>parseInt(t,10),sM=(t,e,n)=>t.substr(e,n),gS=t=>t.codePointAt(0)-65,L4=t=>`${t}`.replace(/\-/g,""),K$e=t=>pS(sM(L4(t),pS("12"),gS("F")))/(pS(sM(L4(t),gS("B"),~~![][mS]))||9),X$e=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),Sie=!1,Eie={invalid:()=>Qt`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Qt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Qt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},xie={invalid:()=>Qt`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Qt`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Qt`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Tie(t,e){let n=!Er(t),r=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.0.0",o,s="invalid",a="invalid";t=L4(t||"");let l=Z$e(t);if(n||r||l)if(l){let c=(0,F4.default)("30/11/2023","DD/MM/YYYY"),u=Math.floor(c.toDate().getTime()/864e5),d=K$e(t);o=(0,F4.default)((d+1)*864e5,"x").format("MMMM DD, YYYY"),u>d?(s="expired",a="expired"):(s="valid",a="valid")}else r?(s="non_commercial",a="valid"):(s="invalid",a="invalid");else s="missing",a="missing";if(X$e()&&(s="valid",a="valid"),!Sie&&s!=="valid"&&(Eie[s]({keyValidityDate:o,hotVersion:i})&&console[s==="non_commercial"?"info":"warn"](Eie[s]({keyValidityDate:o,hotVersion:i})),Sie=!0),a!=="valid"&&e.parentNode&&xie[a]({keyValidityDate:o,hotVersion:i})){let u=document.createElement("div");u.className="hot-display-license-info",u.innerHTML=xie[a]({keyValidityDate:o,hotVersion:i}),e.parentNode.insertBefore(u,e.nextSibling)}}function Z$e(t){let e=[][mS],n=e;if(t[mS]!==gS("Z"))return!1;for(let r="",i="B<H4P+".split(""),o=gS(i.shift());o;o=gS(i.shift()||"A"))--o<""[mS]?n=n|(Cie(`${Cie(pS(r)+(pS(sM(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:r=sM(t,o,o?i[mS]===1?9:8:6);return n===e}function Uo(t){return t[0].toUpperCase()+t.substr(1)}function aM(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function lM(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function cM(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,r)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[r]===void 0?"":e[r])}function H4(t){return vS(`${t}`,{ALLOWED_TAGS:[]})}function vS(t,e){return Rie.default.sanitize(t,e)}var ml=t=>["tabindex",t],Die=()=>["role","treegrid"],Ps=()=>["role","presentation"],Iie=()=>["role","gridcell"],Aie=()=>["role","rowheader"],uM=()=>["role","rowgroup"],Mie=()=>["role","columnheader"],wS=()=>["role","row"],Oie=()=>["role","menu"],Nie=()=>["role","menuitem"],Pie=()=>["role","combobox"],dM=()=>["role","listbox"],kie=()=>["role","option"],Fie=()=>["role","checkbox"],Lie=()=>["scope","col"],Hie=()=>["scope","row"],Vie=()=>["type","text"],ew=t=>["aria-label",t],wo=()=>["aria-hidden","true"],Bie=()=>["aria-disabled","true"],Uie=()=>["aria-multiselectable","true"],hM=t=>["aria-haspopup",t],fM=t=>["aria-rowcount",t],tw=t=>["aria-colcount",t],mM=t=>["aria-rowindex",t],nw=t=>["aria-colindex",t],Wo=t=>["aria-expanded",t],Wie=t=>["aria-sort",t],V4=()=>["aria-readonly","true"],B4=()=>["aria-invalid","true"],jie=t=>["aria-checked",t],rw=()=>["aria-selected","true"],$ie=()=>["aria-autocomplete","list"],Gie=t=>["aria-controls",t],zie=t=>["aria-activedescendant",t],Yie=t=>["aria-live",t],qie=t=>["aria-relevant",t],Kie=t=>["aria-setsize",t],Xie=t=>["aria-posinset",t];function Zie(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=null,i=t;for(;i!==null;){if(n===e){r=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(n+=1,i=i.parentNode)}return r}function Qie(t,e){let n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function Q$e(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function $p(t){return Q$e(t)&&t.parent}function mc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:i}=Node,o=t;for(;o!=null&&o!==n;){let{nodeType:s,nodeName:a}=o;if(s===r&&(e.includes(a)||e.includes(o)))return o;let{host:l}=o;l&&s===i?o=l:o=o.parentNode}return null}function yS(t,e,n){let r=[],i=t;for(;i&&(i=mc(i,e,n),!(!i||n&&!n.contains(i)));)r.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;let o=r.length;return o?r[o-1]:null}function pc(t,e){let n=t.parentNode,r=[];for(typeof e=="string"?t.defaultView?r=Array.prototype.slice.call(t.querySelectorAll(e),0):r=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);n!==null;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function Jie(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function Rf(t,e,n){let r=n.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function eoe(t){return!t||!t.length?[]:t.filter(e=>!!e)}function toe(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];let n=[],r=[];return r.push(...t.filter(i=>{let o=i instanceof RegExp;return o&&e&&n.push(i),!o})),e?{regexFree:r,regexes:n}:r}function St(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function Ne(t,e){typeof e=="string"&&(e=e.split(" ")),e=eoe(e),e.length>0&&t.classList.add(...e)}function bt(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=toe(e,!0);n=eoe(n),n.length>0&&t.classList.remove(...n),r.forEach(i=>{t.classList.forEach(o=>{i.test(o)&&t.classList.remove(o)})})}function vt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(r=>{Array.isArray(r)&&r[0]!==""&&t.setAttribute(...r)})}function gl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:r}=toe(e,!0);n.forEach(i=>{i!==""&&t.removeAttribute(i)}),r.forEach(i=>{t.getAttributeNames().forEach(o=>{i.test(o)&&t.removeAttribute(o)})})}function W4(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){let e=t.childNodes;for(let n=e.length-1;n>=0;n--)W4(e[n])}}function yo(t){let e;for(;e=t.lastChild;)t.removeChild(e)}var J$e=/(<(.*)>|&(.*);)/;function vl(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;J$e.test(e)?t.innerHTML=n?vS(e):e:wl(t,e)}function wl(t,e){let n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(yo(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function pl(t){let e=t.ownerDocument.documentElement,n=t;for(;n!==e;){if(n===null)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(n.host){if(n.host.impl)return pl(n.host.impl);if(n.host)return pl(n.host);throw new Error("Lost in Web Components world")}else return!1;else if(yl(n).display==="none")return!1;n=n.parentNode}return!0}function vr(t){let e=t.ownerDocument,n=e.defaultView,r=e.documentElement,i=t,o,s,a;for(o=i.offsetLeft,s=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)o+=i.offsetLeft,s+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(o+=n.pageXOffset||r.scrollLeft,s+=n.pageYOffset||r.scrollTop),{left:o,top:s}}function j4(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function _S(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function Gp(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?j4(e):t.scrollTop}function CS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?_S(e):t.scrollLeft}function iw(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);let r=["auto","scroll"],i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:o,overflowX:s,overflowY:a}=i.style;if([o,s,a].includes("scroll"))return i;if({overflow:o,overflowX:s,overflowY:a}=n.getComputedStyle(i),r.includes(o)||r.includes(s)||r.includes(a)||i.clientHeight<=i.scrollHeight+1&&(r.includes(a)||r.includes(o))||i.clientWidth<=i.scrollWidth+1&&(r.includes(s)||r.includes(o)))return i;i=i.parentNode}return n}function gc(t){let e=t.ownerDocument,n=e.defaultView,r=t.parentNode;for(;r&&r.style&&e.body!==r;){if(r.style.overflow!=="visible"&&r.style.overflow!=="")return r;let i=yl(r,n),o=["scroll","hidden","auto"],s=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(o.includes(s)||o.includes(a)||o.includes(l))return r;r=r.parentNode}return n}function Df(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;let r=t.style[e];if(r!==""&&r!==void 0)return r;let i=yl(t,n);if(i[e]!==""&&i[e]!==void 0)return i[e]}function yl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function pn(t){return t.offsetWidth}function Nn(t){return t.offsetHeight}function vc(t){return t.clientHeight||t.innerHeight}function ow(t){return t.clientWidth||t.innerWidth}function pM(t){return t.selectionStart?t.selectionStart:0}function noe(t){return t.selectionEnd?t.selectionEnd:0}function $4(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function If(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{let i=t.parentNode,o=i.style.display;i.style.display="block",t.setSelectionRange(e,n),i.style.display=o}}}var U4;function eGe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";let n=t.createElement("div");n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);let r=e.offsetWidth;n.style.overflow="scroll";let i=e.offsetWidth;return r===i&&(i=n.clientWidth),(t.body||t.documentElement).removeChild(n),r-i}function dr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return U4===void 0&&(U4=eGe(t)),U4}function roe(t){return t.offsetWidth!==t.clientWidth}function ioe(t){return t.offsetHeight!==t.clientHeight}function sw(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Af(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function gM(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function vM(t){return gM(t)&&t.hasAttribute("data-hot-input")===!1}function wM(t){return!t.parentNode}function ooe(t,e){new IntersectionObserver((r,i)=>{r.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function G4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=t.ownerDocument,i=r.createRange(),o=r.defaultView.getSelection();vt(t,"contenteditable",!0),n&&vt(t,...wo()),e&&Ne(t,"invisibleSelection"),i.selectNodeContents(t),o.removeAllRanges(),o.addRange(i)}function z4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&bt(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function soe(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;G4(t,n),e(),z4(t,n)}function xn(t){return typeof t=="function"}function aw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,r;function i(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{r=t.apply(this,s)},e),r}return i}function yM(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return t.apply(this,n.concat(s))}}function aoe(t){let e=t.length;function n(r){return function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];let l=r.concat(s),c;return l.length>=e?c=t.apply(this,l):c=n(l),c}}return n([])}function SS(t,e,n,r,i,o,s,a){return Ze(a)?t.call(e,n,r,i,o,s,a):Ze(s)?t.call(e,n,r,i,o,s):Ze(o)?t.call(e,n,r,i,o):Ze(i)?t.call(e,n,r,i):Ze(r)?t.call(e,n,r):Ze(n)?t.call(e,n):t.call(e)}var jEt=Q(CM(),1),$Et=Q(ze(),1),GEt=Q(De(),1);function zp(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Rt(t,(n,r)=>{r!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[r]=zp(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[r]=[zp(n[0])]:e[r]=[]:e[r]=null)})),e}function wu(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Ln(t,e,n){let r=Array.isArray(n);return Rt(e,(i,o)=>{(r===!1||n.includes(o))&&(t[o]=i)}),t}function Yp(t,e){Rt(e,(n,r)=>{e[r]&&typeof e[r]=="object"?(t[r]||(Array.isArray(e[r])?t[r]=[]:Object.prototype.toString.call(e[r])==="[object Date]"?t[r]=e[r]:t[r]={}),Yp(t[r],e[r])):t[r]=e[r]})}function vi(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function $r(t){let e={};return Rt(t,(n,r)=>{e[r]=n}),e}function Jt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return Z(n,i=>{t.MIXINS.push(i.MIXIN_NAME),Rt(i,(o,s)=>{if(t.prototype[s]!==void 0)throw new Error(`Mixin conflict. Property '${s}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[s]=o;else{let a=function(u,d){let h=`_${u}`,f=p=>{let g=p;return(Array.isArray(g)||Tt(g))&&(g=vi(g)),g};return function(){return this[h]===void 0&&(this[h]=f(d)),this[h]}},l=function(u){let d=`_${u}`;return function(h){this[d]=h}};Object.defineProperty(t.prototype,s,{get:a(s,o),set:l(s),configurable:!0})}})}),t}function lw(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Tt(t){return Object.prototype.toString.call(t)==="[object Object]"}function _o(t,e,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(t,e,r)}function Rt(t,e){for(let n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function xoe(t,e){let n=e.split("."),r=t;return Rt(n,i=>{if(r=r[i],r===void 0)return r=void 0,!1}),r}function SM(t,e,n){let r=e.split("."),i=t;r.forEach((o,s)=>{s!==r.length-1?(Kn(i,o)||(i[o]={}),i=i[o]):i[o]=n})}function cw(t){if(!Tt(t))return 0;let e=function(n){let r=0;return Tt(n)?Rt(n,(i,o)=>{o!=="__children"&&(r+=e(i))}):r+=1,r};return e(t)}function ks(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value",n=`_${e}`,r={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[n]},set(i){this._touched=!0,this[n]=i},enumerable:!0,configurable:!0}),r}function Kn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var _l=t=>{let e={value:!1};return e.test=(n,r)=>{e.value=t(n,r)},e},Of={chrome:_l((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:_l(t=>/CriOS/.test(t)),edge:_l(t=>/Edge/.test(t)),edgeWebKit:_l(t=>/EdgiOS/.test(t)),firefox:_l(t=>/Firefox/.test(t)),firefoxWebKit:_l(t=>/FxiOS/.test(t)),mobile:_l(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:_l((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},xS={mac:_l(t=>/^Mac/.test(t)),win:_l(t=>/^Win/.test(t)),linux:_l(t=>/^Linux/.test(t)),ios:_l(t=>/iPhone|iPad|iPod/i.test(t))};function pGe(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Rt(Of,n=>{let{test:r}=n;return void r(t,e)})}function gGe(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Rt(xS,e=>{let{test:n}=e;return void n(t)})}pGe();gGe();function EM(){return Of.chrome.value}function boe(){return Of.chromeWebKit.value}function xM(){return Of.firefox.value}function Toe(){return Of.firefoxWebKit.value}function Y4(){return Of.safari.value}function Roe(){return Of.edge.value}function Oa(){return Of.mobile.value}function bM(){return xS.ios.value}function TM(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&xS.mac.value}function q4(){return xS.win.value}function uw(){return xS.mac.value}var Ext=Q(De(),1);var XEt=Q(ze(),1);var Ft={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:xM()?182:174,AUDIO_MUTE:xM()?181:173,AUDIO_UP:xM()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},vGe=[Ft.ALT,Ft.ARROW_DOWN,Ft.ARROW_LEFT,Ft.ARROW_RIGHT,Ft.ARROW_UP,Ft.AUDIO_DOWN,Ft.AUDIO_MUTE,Ft.AUDIO_UP,Ft.BACKSPACE,Ft.CAPS_LOCK,Ft.DELETE,Ft.END,Ft.ENTER,Ft.ESCAPE,Ft.F1,Ft.F2,Ft.F3,Ft.F4,Ft.F5,Ft.F6,Ft.F7,Ft.F8,Ft.F9,Ft.F10,Ft.F11,Ft.F12,Ft.F13,Ft.F14,Ft.F15,Ft.F16,Ft.F17,Ft.F18,Ft.F19,Ft.HOME,Ft.INSERT,Ft.MEDIA_NEXT,Ft.MEDIA_PLAY_PAUSE,Ft.MEDIA_PREV,Ft.MEDIA_STOP,Ft.NULL,Ft.NUM_LOCK,Ft.PAGE_DOWN,Ft.PAGE_UP,Ft.PAUSE,Ft.SCROLL_LOCK,Ft.SHIFT,Ft.TAB];function Doe(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function RM(t){return vGe.includes(t)}function Ioe(t){return[Ft.CONTROL,Ft.COMMAND_LEFT,Ft.COMMAND_RIGHT,Ft.COMMAND_FIREFOX].includes(t)}function yu(t,e){let n=e.split("|"),r=!1;return Z(n,i=>{if(t===Ft[i])return r=!0,!1}),r}function wi(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function _u(t){return t.isImmediatePropagationEnabled===!1}function Na(t){return t.button===2}function dw(t){return t.button===0}function Aoe(t,e){let n={x:t.offsetX,y:t.offsetY},r=t.target;if(!(e instanceof HTMLElement)||r!==e&&r.contains(e))return n;for(;r!==e;)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;return n}var fxt=Q(De(),1);var rxt=Q(ze(),1),ixt=Q(De(),1);function Sn(){Ze(console)&&console.warn(...arguments)}function hw(){Ze(console)&&console.error(...arguments)}function wGe(t,e,n){return e=yGe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yGe(t){var e=_Ge(t,"string");return typeof e=="symbol"?e:String(e)}function _Ge(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var fw=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],CGe=Qt`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,K4=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),X4=new Map([[]]),DM=class{static getSingleton(){return EGe()}constructor(){wGe(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){let e=Object.create(null);return Z(fw,n=>e[n]=[]),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(Array.isArray(n))Z(n,i=>this.add(e,i,r));else{K4.has(e)&&Sn(cM(CGe,{hookName:e,removedInVersion:K4.get(e)})),X4.has(e)&&Sn(X4.get(e));let i=this.getBucket(r);if(typeof i[e]>"u"&&(this.register(e),i[e]=[]),n.skip=!1,i[e].indexOf(n)===-1){let o=!1;n.initialHook&&Z(i[e],(s,a)=>{if(s.initialHook)return i[e][a]=n,o=!0,!1}),o||i[e].push(n)}}return this}once(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;Array.isArray(n)?Z(n,i=>this.once(e,i,r)):(n.runOnce=!0,this.add(e,n,r))}remove(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=this.getBucket(r);return typeof i[e]<"u"&&i[e].indexOf(n)>=0?(n.skip=!0,!0):!1}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=this.getBucket(n);return!!(r[e]!==void 0&&r[e].length)}run(e,n,r,i,o,s,a,l){{let c=this.globalBucket[n],u=c?c.length:0,d=0;if(u)for(;d<u;){if(!c[d]||c[d].skip){d+=1;continue}let h=SS(c[d],e,r,i,o,s,a,l);h!==void 0&&(r=h),c[d]&&c[d].runOnce&&this.remove(n,c[d]),d+=1}}{let c=this.getBucket(e)[n],u=c?c.length:0,d=0;if(u)for(;d<u;){if(!c[d]||c[d].skip){d+=1;continue}let h=SS(c[d],e,r,i,o,s,a,l);h!==void 0&&(r=h),c[d]&&c[d].runOnce&&this.remove(n,c[d],e),d+=1}}return r}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Rt(this.getBucket(e),(n,r,i)=>i[r].length=0)}register(e){this.isRegistered(e)||fw.push(e)}deregister(e){this.isRegistered(e)&&fw.splice(fw.indexOf(e),1)}isDeprecated(e){return X4.has(e)||K4.has(e)}isRegistered(e){return fw.indexOf(e)>=0}getRegistered(){return fw}},SGe=new DM;function EGe(){return SGe}var ot=DM;var Z4=new Map;function Ri(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Z4.has(t)||Z4.set(t,new Map);let e=Z4.get(t);function n(a,l){e.set(a,l)}function r(a){return e.get(a)}function i(a){return e.has(a)}function o(){return[...e.keys()]}function s(){return[...e.values()]}return{register:n,getItem:r,hasItem:i,getNames:o,getValues:s}}var Q4=new WeakMap,{register:xGe,getItem:Moe,hasItem:J4,getNames:gxt,getValues:vxt}=Ri("editors");function bGe(t){let e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(r){return r.guid in e||(e[r.guid]=new n(r)),e[r.guid]},ot.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function IM(t,e){let n;if(typeof t=="function")Q4.get(t)||Fs(null,t),n=Q4.get(t);else if(typeof t=="string")n=Moe(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function eU(t){if(typeof t=="function")return t;if(!J4(t))throw Error(`No registered editor found under "${t}" name`);return Moe(t).getConstructor()}function Fs(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);let n=new bGe(e);typeof t=="string"&&xGe(t,n),Q4.set(e,n)}var yxt=Q(ze(),1),_xt=Q(De(),1);function TGe(t,e,n){return e=RGe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function RGe(t){var e=DGe(t,"string");return typeof e=="symbol"?e:String(e)}function DGe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var tU=0,nU=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;TGe(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(s){r.call(this,IGe(s))}return this.context.eventListeners.push({element:e,event:n,callback:r,callbackProxy:o,options:i,eventManager:this}),e.addEventListener(n,o,i),tU+=1,()=>{this.removeEventListener(e,n,r)}}removeEventListener(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,s;for(;o;)if(o-=1,s=this.context.eventListeners[o],s.event===n&&s.element===e){if(r&&r!==s.callback||i&&s.eventManager!==this)continue;this.context.eventListeners.splice(o,1),s.element.removeEventListener(s.event,s.callbackProxy,s.options),tU-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;let r=this.context.eventListeners[n];e&&r.eventManager!==this||(this.context.eventListeners.splice(n,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),tU-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let r=e.document,i=e;r||(r=e.ownerDocument?e.ownerDocument:e,i=r.defaultView);let o={bubbles:!0,cancelable:n!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},s;r.createEvent?(s=r.createEvent("MouseEvents"),s.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||r.body.parentNode)):s=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(s):e.fireEvent(`on${n}`,s)}};function IGe(t){let e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),wi(this)},t}var ei=nU;function Ooe(t,e){AGe(t,e),e.add(t)}function AGe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nf(t,e,n){return e=MGe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function MGe(t){var e=OGe(t,"string");return typeof e=="symbol"?e:String(e)}function OGe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Noe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var qp="editorManager.navigation",Poe=new WeakSet,koe=new WeakSet,bS=class{constructor(e,n,r){Ooe(this,koe),Ooe(this,Poe),Nf(this,"hot",void 0),Nf(this,"tableMeta",void 0),Nf(this,"selection",void 0),Nf(this,"eventManager",void 0),Nf(this,"destroyed",!1),Nf(this,"lock",!1),Nf(this,"activeEditor",void 0),Nf(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=r,this.eventManager=new ei(e),this.hot.addHook("afterDocumentKeyDown",i=>Noe(this,Poe,NGe).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,o,s)=>Noe(this,koe,PGe).call(this,i,o,s))}lockEditor(){this.lock=!0}unlockEditor(){this.lock=!1}destroyEditor(e){this.lock||this.closeEditor(e)}getActiveEditor(){return this.activeEditor}prepareEditor(){if(this.lock)return;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,l=>{l&&this.prepareEditor()});return}let{highlight:e}=this.hot.getSelectedRangeLast();if(e.isHeader())return;let{row:n,col:r}=e,i=this.hot.runHooks("modifyGetCellCoords",n,r),o=n,s=r;if(Array.isArray(i)&&([o,s]=i),this.cellProperties=this.hot.getCellMeta(o,s),!this.isCellEditable()){this.clearActiveEditor();return}let a=this.hot.getCell(n,r,!0);if(a){let l=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(s),u=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),s);this.activeEditor=IM(l,this.hot),this.activeEditor.prepare(n,r,c,a,u,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,r){this.activeEditor?this.activeEditor.finishEditing(e,n,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let e=this.hot.getSelectedRangeLast();if(!e)return!1;let n=this.hot.getCellEditor(this.cellProperties),{row:r,col:i}=e.highlight,{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a=o.isHidden(this.hot.toPhysicalRow(r))||s.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){let n=typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(event):this.tableMeta.enterMoves;e?this.selection.transformStart(-n.row,-n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}};function NGe(t){let e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||_u(t))return;let{keyCode:n}=t,r=(t.ctrlKey||t.metaKey)&&!t.altKey;if((!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!RM(n)&&!Ioe(n)&&!r&&!this.isEditorOpened()){let o=this.hot.getShortcutManager().getContext("editor"),s={runOnlyIf:()=>Ze(this.hot.getSelected()),group:qp};o.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],s),this.openEditor("",t)}}function PGe(t,e,n){n.nodeName==="TD"&&this.openEditor(null,t,!0)}var Foe=new WeakMap;bS.getInstance=function(t,e,n){let r=Foe.get(t);return r||(r=new bS(t,e,n),Foe.set(t,r)),r};var Loe=bS;var Axt=Q(De(),1);function AM(t,e){Uoe(t,e),e.add(t)}function TS(t,e,n){Uoe(t,e),e.set(t,n)}function Uoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mw(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ti(t,e){var n=Woe(t,e,"get");return kGe(t,n)}function kGe(t,e){return e.get?e.get.call(t):e.value}function RS(t,e,n){var r=Woe(t,e,"set");return FGe(t,r,n),n}function Woe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function FGe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Pf=Object.freeze({CELL:"cell",MIXED:"mixed"}),jo=new WeakMap,MM=new WeakMap,OM=new WeakMap,NM=new WeakMap,PM=new WeakMap,kM=new WeakSet,Hoe=new WeakSet,Voe=new WeakSet,Boe=new WeakSet,FM=class{constructor(e){var n=this;AM(this,Boe),AM(this,Voe),AM(this,Hoe),AM(this,kM),TS(this,jo,{writable:!0,value:void 0}),TS(this,MM,{writable:!0,value:void 0}),TS(this,OM,{writable:!0,value:50}),TS(this,NM,{writable:!0,value:null}),TS(this,PM,{writable:!0,value:new Map});let r=e.getSettings();RS(this,jo,e),RS(this,MM,r.imeFastEdit?Pf.MIXED:Pf.CELL),ti(this,jo).addHook("afterUpdateSettings",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return mw(n,Boe,VGe).call(n,...o)}),ti(this,jo).addHook("afterSelection",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return mw(n,Hoe,LGe).call(n,...o)}),ti(this,jo).addHook("afterSelectionEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return mw(n,Voe,HGe).call(n,...o)})}getFocusMode(){return ti(this,MM)}setFocusMode(e){Object.values(Pf).includes(e)?RS(this,MM,e):Sn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return ti(this,OM)}setRefocusDelay(e){RS(this,OM,e)}setRefocusElementGetter(e){RS(this,NM,e)}getRefocusElement(){if(typeof ti(this,NM)=="function")return ti(this,NM).call(this);var e;return(e=ti(this,jo).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){let n=r=>{var i,o;let s=(i=ti(this,jo).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!s)return;let a=ti(this,jo).runHooks("modifyFocusedElement",s.row,s.col,r);a instanceof HTMLElement||(a=r),a&&!((o=ti(this,jo).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&a.focus({preventScroll:!0})};e?n(e):mw(this,kM,rU).call(this,r=>n(r))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ti(this,OM),r=this.getRefocusElement();ti(this,jo).getSettings().imeFastEdit&&!((e=ti(this,jo).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&r&&(ti(this,PM).has(n)||ti(this,PM).set(n,aw(()=>{r.select()},n)),ti(this,PM).get(n)())}};function rU(t){var e;let n=(e=ti(this,jo).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!n||!ti(this,jo).selection.isCellVisible(n)){t(null);return}let r=ti(this,jo).getCell(n.row,n.col,!0);r===null?ti(this,jo).addHookOnce("afterScroll",()=>{t(ti(this,jo).getCell(n.row,n.col,!0))}):t(r)}function LGe(){mw(this,kM,rU).call(this,t=>{let{activeElement:e}=ti(this,jo).rootDocument;e&&vM(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function HGe(){mw(this,kM,rU).call(this,t=>{this.getFocusMode()===Pf.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function VGe(t){t.imeFastEdit&&this.getFocusMode()!==Pf.MIXED?this.setFocusMode(Pf.MIXED):!t.imeFastEdit&&this.getFocusMode()!==Pf.CELL&&this.setFocusMode(Pf.CELL)}var kxt=Q(ze(),1);var joe={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},BGe=new RegExp(Object.keys(joe).map(t=>`(${t})`).join("|"),"gi");function UGe(t){return(t&&t.nodeName||"")==="TABLE"}function iU(t){let e=t.hasColHeaders(),n=t.hasRowHeaders(),r=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...r),o=i.length,s=o>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=n?1:0,d=e?1:0;for(let h=0;h<o;h+=1){let f=e&&h===0,p=[];for(let w=0;w<s;w+=1){let _=!f&&n&&w===0,S="";if(f)S=`<th>${t.getColHeader(w-u)}</th>`;else if(_)S=`<th>${t.getRowHeader(h-d)}</th>`;else{let x=i[h][w],{hidden:P,rowspan:k,colspan:b}=t.getCellMeta(h-d,w-u);if(!P){let C=[];if(k&&C.push(`rowspan="${k}"`),b&&C.push(`colspan="${b}"`),Er(x))S=`<td ${C.join(" ")}></td>`;else{let N=x.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");S=`<td ${C.join(" ")}>${N}</td>`}}}p.push(S)}let g=["<tr>",...p,"</tr>"].join("");f?l.splice(1,0,g):c.splice(-1,0,g)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function oU(t){let e=t.length,n=["<table>"];for(let r=0;r<e;r+=1){let i=t[r],o=i.length,s=[];r===0&&n.push("<tbody>");for(let a=0;a<o;a+=1){let l=i[a],c=Er(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");s.push(`<td>${c}</td>`)}n.push("<tr>",...s,"</tr>"),r+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function $oe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,n={},r=e.createDocumentFragment(),i=e.createElement("div");r.appendChild(i);let o=t;if(typeof o=="string"){let x=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,P=>{let k=P.match(/<td\b[^>]*?>/g)[0],b=P.substring(k.length,P.lastIndexOf("<")).replace(/(<(?!br)([^>]+)>)/gi,"");return`${k}${b}</td>`});i.insertAdjacentHTML("afterbegin",`${x}`),o=i.querySelector("table")}if(!o||!UGe(o))return;let s=i.querySelector('meta[name$="enerator"]'),a=o.querySelector("tbody th")!==null,l=o.querySelector("tr"),c=l?Array.from(l.cells).reduce((x,P)=>x+P.colSpan,0)-(a?1:0):0,u=o.tFoot&&Array.from(o.tFoot.rows)||[],d=[],h=!1,f=0,p=0;if(o.tHead){let x=Array.from(o.tHead.rows).filter(P=>{let k=P.querySelector("td")!==null;return k&&d.push(P),!k});f=x.length,h=f>0,f>1?n.nestedHeaders=Array.from(x).reduce((P,k)=>{let b=Array.from(k.cells).reduce((C,N,B)=>{if(a&&B===0)return C;let{colSpan:Y,innerHTML:ee}=N,te=Y>1?{label:ee,colspan:Y}:ee;return C.push(te),C},[]);return P.push(b),P},[]):h&&(n.colHeaders=Array.from(x[0].children).reduce((P,k,b)=>(a&&b===0||P.push(k.innerHTML),P),[]))}d.length&&(n.fixedRowsTop=d.length),u.length&&(n.fixedRowsBottom=u.length);let g=[...d,...Array.from(o.tBodies).reduce((x,P)=>(x.push(...Array.from(P.rows)),x),[]),...u];p=g.length;let w=new Array(p);for(let x=0;x<p;x++)w[x]=new Array(c);let _=[],S=[];for(let x=0;x<p;x++){let P=g[x],k=Array.from(P.cells),b=k.length;for(let C=0;C<b;C++){let N=k[C],{nodeName:B,innerHTML:Y,rowSpan:ee,colSpan:te}=N,Ce=w[x].findIndex(Re=>Re===void 0);if(B==="TD"){if(ee>1||te>1){for(let M=x;M<x+ee;M++)if(M<p)for(let q=Ce;q<Ce+te;q++)w[M][q]=null;let _e=N.getAttribute("style");_e&&_e.includes("mso-ignore:colspan")||_.push({col:Ce,row:x,rowspan:ee,colspan:te})}let Re="";s&&/excel/gi.test(s.content)?Re=Y.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):Re=Y.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),w[x][Ce]=Re.replace(BGe,_e=>joe[_e])}else S.push(Y)}}return _.length&&(n.mergeCells=_),S.length&&(n.rowHeaders=S),w.length&&(n.data=w),n}var Kxt=Q(De(),1);var Vxt=Q(De(),1);function Vi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);let r=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?\\s*(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Goe(t){return Vi(t,[","])}function st(t,e,n){let r=-1;for(typeof e=="function"?(n=e,e=t):r=t-1;++r<=e&&n(r)!==!1;);}function DS(t,e,n){let r=t+1;for(typeof e=="function"&&(n=e,e=0);--r>=e&&n(r)!==!1;);}function LM(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function eo(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}var sU="asc",WGe="desc",zoe=new Map([[sU,[-1,1]],[WGe,[1,-1]]]),jGe=t=>`The priority '${t}' is already declared in a map.`,$Ge=t=>`The priority '${t}' is not a number.`;function Yoe(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=new Map;t=xn(t)?t:jGe,e=xn(e)?e:$Ge;function r(o,s){if(!Vi(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,s)}function i(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sU,[s,a]=zoe.get(o)||zoe.get(sU);return[...n].sort((l,c)=>l[0]<c[0]?s:a).map(l=>l[1])}return{addItem:r,getItems:i}}var jxt=Q(De(),1);var GGe=t=>`The id '${t}' is already declared in a map.`;function kf(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Map;t=xn(t)?t:GGe;function n(c,u){if(l(c))throw new Error(t(c));e.set(c,u)}function r(c){return e.delete(c)}function i(){e.clear()}function o(c){let[u]=a().find(d=>{let[h,f]=d;return c===f?h:!1})||[null];return u}function s(c){return e.get(c)}function a(){return[...e]}function l(c){return e.has(c)}return{addItem:n,clear:i,getId:o,getItem:s,getItems:a,hasItem:l,removeItem:r}}var zxt=Q(De(),1);var zGe=t=>`'${t}' value is already declared in a unique set.`;function qoe(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Set;t=xn(t)?t:zGe;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function r(){return[...e]}function i(){e.clear()}return{addItem:n,clear:i,getItems:r}}var lU=t=>`There is already registered "${t}" plugin.`,YGe=t=>`There is already registered plugin on priority "${t}".`,qGe=t=>`The priority "${t}" is not a number.`,Koe=Yoe({errorPriorityExists:YGe,errorPriorityNaN:qGe}),Xoe=qoe({errorItemExists:lU}),aU=kf({errorIdExists:lU});function HM(){return[...Koe.getItems(),...Xoe.getItems()]}function VM(t){let e=Uo(t);return aU.getItem(e)}function Zoe(t){return!!VM(t)}function $n(t,e,n){[t,e,n]=XGe(t,e,n),VM(t)===void 0&&KGe(t,e,n)}function KGe(t,e,n){let r=Uo(t);if(aU.hasItem(r))throw new Error(lU(r));n===void 0?Xoe.addItem(r):Koe.addItem(n,r),aU.addItem(r,e)}function XGe(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}var tbt=Q(De(),1);var{register:ZGe,getItem:QGe,hasItem:cU,getNames:rbt,getValues:ibt}=Ri("renderers");function uU(t){if(typeof t=="function")return t;if(!cU(t))throw Error(`No registered renderer found under "${t}" name`);return QGe(t)}function wc(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),ZGe(t,e)}var sbt=Q(De(),1);var{register:JGe,getItem:eze,hasItem:dU,getNames:lbt,getValues:cbt}=Ri("validators");function Qoe(t){if(typeof t=="function")return t;if(!dU(t))throw Error(`No registered validator found under "${t}" name`);return eze(t)}function Kp(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),JGe(t,e)}var NAt=Q(ze(),1),PAt=Q(De(),1);var vbt=Q(ze(),1),wbt=Q(wU(),1),ybt=Q(De(),1);function hse(t,e,n){xze(t,e),e.set(t,n)}function xze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hd(t,e,n){return e=bze(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bze(t){var e=Tze(t,"string");return typeof e=="symbol"?e:String(e)}function Tze(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bi(t,e){var n=mse(t,e,"get");return Rze(t,n)}function Rze(t,e){return e.get?e.get.call(t):e.value}function fse(t,e,n){var r=mse(t,e,"set");return Dze(t,r,n),n}function mse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Dze(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var WM=new WeakMap,Ui=new WeakMap,yU=class t{static get DEFAULT_WIDTH(){return 50}constructor(e){Hd(this,"count",0),Hd(this,"startColumn",null),Hd(this,"endColumn",null),Hd(this,"startPosition",null),Hd(this,"isVisibleInTrimmingContainer",!1),Hd(this,"stretchAllRatio",0),Hd(this,"stretchLastWidth",0),hse(this,WM,{writable:!0,value:0}),Hd(this,"needVerifyLastColumnWidth",!0),Hd(this,"stretchAllColumnsWidth",[]),hse(this,Ui,{writable:!0,value:void 0}),fse(this,Ui,e),typeof Bi(this,Ui).stretchingColumnWidthFn!="function"&&(Bi(this,Ui).stretchingColumnWidthFn=n=>n),this.calculate()}calculate(){let{calculationType:e,overrideFn:n,scrollOffset:r,totalColumns:i,viewportWidth:o}=Bi(this,Ui),s=Math.max(Bi(this,Ui).scrollOffset,0),a=s>0?o+1:o,l=0,c=!0,u=[],d,h=0,f=0;for(let _=0;_<i;_++)if(d=this._getColumnWidth(_),l<=s&&e!==2&&(this.startColumn=_,h=d),l>=s&&l+(e===2?d:0)<=s+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=_,h=d),this.endColumn=_),u.push(l),l+=d,f=d,e!==2&&(this.endColumn=_),l>=s+o){c=!1;break}let p=r+o-a,g=e===2?0:f,w=e===2?h:0;if(p<-1*Bi(this,Ui).inlineStartOffset||r>u.at(-1)+g||-1*Bi(this,Ui).scrollOffset-Bi(this,Ui).viewportWidth>-1*w?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endColumn===i-1&&c)for(this.startColumn=this.endColumn;this.startColumn>0;){let _=u[this.endColumn]+d-u[this.startColumn-1];if((_<=o||e!==2)&&(this.startColumn-=1),_>o)break}e===1&&this.startColumn!==null&&n&&n(this),this.startPosition=u[this.startColumn],this.startPosition===void 0&&(this.startPosition=null),i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}refreshStretching(e){if(Bi(this,Ui).stretchMode==="none")return;let n=e;fse(this,WM,n);let r=Bi(this,Ui).totalColumns,i=0;for(let s=0;s<r;s++){let a=this._getColumnWidth(s),l=Bi(this,Ui).stretchingColumnWidthFn(void 0,s);typeof l=="number"?n-=l:i+=a}let o=n-i;if(Bi(this,Ui).stretchMode==="all"&&o>0)this.stretchAllRatio=n/i,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(Bi(this,Ui).stretchMode==="last"&&n!==1/0){let s=this._getColumnWidth(r-1),a=o+s;this.stretchLastWidth=a>=0?a:s}}getStretchedColumnWidth(e,n){let r=null;return Bi(this,Ui).stretchMode==="all"&&this.stretchAllRatio!==0?r=this._getStretchedAllColumnWidth(e,n):Bi(this,Ui).stretchMode==="last"&&this.stretchLastWidth!==0&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,n){let r=0,i=Bi(this,Ui).totalColumns;if(!this.stretchAllColumnsWidth[e]){let o=Math.round(n*this.stretchAllRatio),s=Bi(this,Ui).stretchingColumnWidthFn(o,e);s===void 0?this.stretchAllColumnsWidth[e]=o:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let o=0;o<this.stretchAllColumnsWidth.length;o++)r+=this.stretchAllColumnsWidth[o];r!==Bi(this,WM)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=Bi(this,WM)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){let n=Bi(this,Ui).totalColumns;return e===n-1?this.stretchLastWidth:null}_getColumnWidth(e){let n=Bi(this,Ui).columnWidthFn(e);return isNaN(n)&&(n=t.DEFAULT_WIDTH),n}},Ff=yU;var Cbt=Q(ze(),1),Sbt=Q(wU(),1),Ebt=Q(De(),1);function Ize(t,e,n){Aze(t,e),e.set(t,n)}function Aze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IS(t,e,n){return e=Mze(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mze(t){var e=Oze(t,"string");return typeof e=="symbol"?e:String(e)}function Oze(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _U(t,e){var n=pse(t,e,"get");return Nze(t,n)}function Nze(t,e){return e.get?e.get.call(t):e.value}function Pze(t,e,n){var r=pse(t,e,"set");return kze(t,r,n),n}function pse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function kze(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var AS=new WeakMap,CU=class t{static get DEFAULT_HEIGHT(){return 23}constructor(e){IS(this,"count",0),IS(this,"startRow",null),IS(this,"endRow",null),IS(this,"startPosition",null),IS(this,"isVisibleInTrimmingContainer",!1),Ize(this,AS,{writable:!0,value:void 0}),Pze(this,AS,e),this.calculate()}calculate(){let{calculationType:e,overrideFn:n,rowHeightFn:r,scrollOffset:i,totalRows:o,viewportHeight:s}=_U(this,AS),a=Math.max(_U(this,AS).scrollOffset,0),l=_U(this,AS).horizontalScrollbarHeight||0,c=0,u=!0,d=[],h,f=0,p=0;for(let S=0;S<o;S++)if(h=r(S),isNaN(h)&&(h=t.DEFAULT_HEIGHT),c<=a&&e!==2&&(this.startRow=S,f=h),c>=a&&c+(e===2?h:0)<=a+s-l&&(this.startRow===null&&(this.startRow=S,f=h),this.endRow=S),d.push(c),c+=h,p=h,e!==2&&(this.endRow=S),c>=a+s-l){u=!1;break}let g=i+s-l,w=e===2?f:0,_=e===2?0:p;if(g<w||i>d.at(-1)+_?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,this.endRow===o-1&&u)for(this.startRow=this.endRow;this.startRow>0;){let S=d[this.endRow]+h-d[this.startRow-1];if((S<=s-l||e!==2)&&(this.startRow-=1),S>=s-l)break}e===1&&this.startRow!==null&&n&&n(this),this.startPosition=d[this.startRow],this.startPosition===void 0&&(this.startPosition=null),o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}},pw=CU;var bbt=Q(De(),1);function Fze(t,e,n){Lze(t,e),e.set(t,n)}function Lze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gse(t,e,n){return e=Hze(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hze(t){var e=Vze(t,"string");return typeof e=="symbol"?e:String(e)}function Vze(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gw(t,e){var n=wse(t,e,"get");return Bze(t,n)}function Bze(t,e){return e.get?e.get.call(t):e.value}function vse(t,e,n){var r=wse(t,e,"set");return Uze(t,r,n),n}function wse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Uze(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Vd=new WeakMap,SU=class t{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;gse(this,"row",null),gse(this,"col",null),Fze(this,Vd,{writable:!0,value:!1}),vse(this,Vd,r),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){let{countRows:n,countCols:r,countRowHeaders:i,countColHeaders:o}=Ee({countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0},e);return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-i||this.row>=n||this.col>=r)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return gw(this,Vd)}isSouthEastOf(e){return this.row>=e.row&&(gw(this,Vd)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(gw(this,Vd)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(gw(this,Vd)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(gw(this,Vd)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof t&&vse(this,Vd,e.isRtl()),this}clone(){return new t(this.row,this.col,gw(this,Vd))}toObject(){return{row:this.row,col:this.col}}},Lf=SU;var Dbt=Q(ze(),1),Ibt=Q(De(),1);function Wze(t,e,n){jze(t,e),e.set(t,n)}function jze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EU(t,e,n){return e=$ze(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ze(t){var e=Gze(t,"string");return typeof e=="symbol"?e:String(e)}function Gze(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cu(t,e){var n=yse(t,e,"get");return zze(t,n)}function zze(t,e){return e.get?e.get.call(t):e.value}function Yze(t,e,n){var r=yse(t,e,"set");return qze(t,r,n),n}function yse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qze(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Cl=new WeakMap,xU=class t{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;EU(this,"highlight",null),EU(this,"from",null),EU(this,"to",null),Wze(this,Cl,{writable:!0,value:!1}),this.highlight=e.clone(),this.from=n.clone(),this.to=r.clone(),Yze(this,Cl,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){let{row:n,col:r}=e,i=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return i.row<=n&&o.row>=n&&i.col<=r&&o.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopRightCorner().col>=e.getOuterTopLeftCorner().col&&this.getOuterTopRightCorner().col<=e.getOuterTopRightCorner().col||this.getOuterTopLeftCorner().col<=e.getOuterTopRightCorner().col&&this.getOuterTopLeftCorner().col>=e.getOuterTopLeftCorner().col}isOverlappingVertically(e){return this.getOuterBottomRightCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomRightCorner().row<=e.getOuterBottomRightCorner().row||this.getOuterTopRightCorner().row<=e.getOuterBottomRightCorner().row&&this.getOuterTopRightCorner().row>=e.getOuterTopRightCorner().row}expand(e){let n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>r.row||e.col>r.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0):!1}expandByRange(e){if(this.includesRange(e)||!this.overlaps(e))return!1;let n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),a=Math.min(n.row,o.row),l=Math.min(n.col,o.col),c=Math.max(r.row,s.row),u=Math.max(r.col,s.col),d=this._createCellCoords(a,l),h=this._createCellCoords(c,u);return this.from=d,this.to=h,this.setDirection(i),this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally(),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break;default:break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break;default:break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break;default:break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Cu(this,Cl)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Cu(this,Cl)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Cu(this,Cl)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Cu(this,Cl)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Cu(this,Cl)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Cu(this,Cl)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Cu(this,Cl)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Cu(this,Cl)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e,n){return n&&n.includes(e)&&(this.getOuterTopLeftCorner().isEqual(this._createCellCoords(n.from.row,n.from.col))||this.getOuterTopRightCorner().isEqual(this._createCellCoords(n.from.row,n.to.col))||this.getOuterBottomLeftCorner().isEqual(this._createCellCoords(n.to.row,n.from.col))||this.getOuterBottomRightCorner().isEqual(this._createCellCoords(n.to.row,n.to.col)))?!0:e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e,n){if(!(e instanceof Lf))return!1;if(n){let{from:r,to:i}=n;if(n.includes(e)){if(this.getOuterTopStartCorner().isEqual(this._createCellCoords(r.row,r.col)))return this.getOuterBottomEndCorner();if(this.getOuterTopEndCorner().isEqual(this._createCellCoords(r.row,i.col)))return this.getOuterBottomStartCorner();if(this.getOuterBottomStartCorner().isEqual(this._createCellCoords(i.row,r.col)))return this.getOuterTopEndCorner();if(this.getOuterBottomEndCorner().isEqual(this._createCellCoords(i.row,i.col)))return this.getOuterTopStartCorner()}}if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];let n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},r={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return n.top===r.top&&i.push("top"),n.right===r.right&&i.push("right"),n.bottom===r.bottom&&i.push("bottom"),n.left===r.left&&i.push("left"),i}getInner(){let e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)!(this.from.row===i&&this.from.col===o)&&!(this.to.row===i&&this.to.col===o)&&r.push(this._createCellCoords(i,o));return r}getAll(){let e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),r=[];for(let i=e.row;i<=n.row;i++)for(let o=e.col;o<=n.col;o++)e.row===i&&e.col===o?r.push(e):n.row===i&&n.col===o?r.push(n):r.push(this._createCellCoords(i,o));return r}forAll(e){let n=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let i=n.row;i<=r.row;i++)for(let o=n.col;o<=r.col;o++)if(e(i,o)===!1)return}clone(){return new t(this.highlight,this.from,this.to,Cu(this,Cl))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Lf(e,n,Cu(this,Cl))}},Zp=xU;var cAt=Q(ze(),1);var Nbt=Q(De(),1);function ww(t){return window.requestAnimationFrame(t)}function yw(t){window.cancelAnimationFrame(t)}function jM(){return"ontouchstart"in window}var vw;function _se(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vw||(typeof Intl=="object"?vw=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?vw=(n,r)=>`${n}`.localeCompare(r):vw=(n,r)=>n===r?0:n>r?-1:1,vw)}function Su(t,e,n){Kze(t,e),e.set(t,n)}function Kze(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pt(t,e){var n=Cse(t,e,"get");return Xze(t,n)}function Xze(t,e){return e.get?e.get.call(t):e.value}function Hf(t,e,n){var r=Cse(t,e,"set");return Zze(t,r,n),n}function Cse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Zze(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Sl=new WeakMap,bU=new WeakMap,Co=new WeakMap,_w=new WeakMap,$M=new WeakMap,yc=new WeakMap,TU=new WeakMap,MS=new WeakMap,Qp=new WeakMap,Eu=new WeakMap,RU=class{constructor(e,n,r,i,o,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Su(this,Sl,{writable:!0,value:void 0}),Su(this,bU,{writable:!0,value:void 0}),Su(this,Co,{writable:!0,value:void 0}),Su(this,_w,{writable:!0,value:void 0}),Su(this,$M,{writable:!0,value:void 0}),Su(this,yc,{writable:!0,value:void 0}),Su(this,TU,{writable:!0,value:void 0}),Su(this,MS,{writable:!0,value:void 0}),Su(this,Qp,{writable:!0,value:[null,null]}),Su(this,Eu,{writable:!0,value:[null,null]}),Hf(this,Sl,r),Hf(this,bU,n),Hf(this,Co,o),Hf(this,_w,s),Hf(this,$M,a),Hf(this,yc,i),Hf(this,TU,e),this.registerEvents()}registerEvents(){Pt(this,yc).addEventListener(Pt(this,Co).holder,"contextmenu",r=>this.onContextMenu(r)),Pt(this,yc).addEventListener(Pt(this,Co).TABLE,"mouseover",r=>this.onMouseOver(r)),Pt(this,yc).addEventListener(Pt(this,Co).TABLE,"mouseout",r=>this.onMouseOut(r));let e=()=>{Pt(this,yc).addEventListener(Pt(this,Co).holder,"touchstart",r=>this.onTouchStart(r)),Pt(this,yc).addEventListener(Pt(this,Co).holder,"touchend",r=>this.onTouchEnd(r)),this.momentumScrolling||(this.momentumScrolling={}),Pt(this,yc).addEventListener(Pt(this,Co).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Pt(this,Sl).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Pt(this,Sl).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Pt(this,yc).addEventListener(Pt(this,Co).holder,"mouseup",r=>this.onMouseUp(r)),Pt(this,yc).addEventListener(Pt(this,Co).holder,"mousedown",r=>this.onMouseDown(r))};Oa()?e():(jM()&&e(),n())}selectedCellWasTouched(e){let r=this.parentCell(e).coords;if(Pt(this,MS)&&r){let[i,o]=[r.row,Pt(this,MS).from.row],[s,a]=[r.col,Pt(this,MS).from.col];return i===o&&s===a}return!1}parentCell(e){let n={},r=Pt(this,Co).TABLE,i=yS(e,["TD","TH"],r);return i?(n.coords=Pt(this,Co).getCoords(i),n.TD=i):St(e,"wtBorder")&&St(e,"current")?(n.coords=Pt(this,_w).getFocusSelection().cellRange.highlight,n.TD=Pt(this,Co).getCell(n.coords)):St(e,"wtBorder")&&St(e,"area")&&Pt(this,_w).getAreaSelection().cellRange&&(n.coords=Pt(this,_w).getAreaSelection().cellRange.to,n.TD=Pt(this,Co).getCell(n.coords)),n}onMouseDown(e){let n=Pt(this,bU).rootDocument.activeElement,r=yM(Zie,e.target),i=e.target;if(!["TD","TH"].includes(n.nodeName)&&(i===n||r(0)===n||r(1)===n))return;let o=this.parentCell(i);St(i,"corner")?Pt(this,Sl).getSetting("onCellCornerMouseDown",e,i):o.TD&&Pt(this,Sl).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Pt(this,Eu)[0]=o.TD,clearTimeout(Pt(this,Qp)[0]),Pt(this,Qp)[0]=setTimeout(()=>{Pt(this,Eu)[0]=null},1e3))}onContextMenu(e){if(Pt(this,Sl).has("onCellContextMenu")){let n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Pt(this,Sl).has("onCellMouseOver"))return;let n=Pt(this,Co).TABLE,r=yS(e.target,["TD","TH"],n),i=Pt(this,$M)||this;r&&r!==i.lastMouseOver&&pc(r,n)&&(i.lastMouseOver=r,this.callListener("onCellMouseOver",e,Pt(this,Co).getCoords(r),r))}onMouseOut(e){if(!Pt(this,Sl).has("onCellMouseOut"))return;let n=Pt(this,Co).TABLE,r=yS(e.target,["TD","TH"],n),i=yS(e.relatedTarget,["TD","TH"],n),o=Pt(this,$M)||this;r&&r!==i&&pc(r,n)&&(this.callListener("onCellMouseOut",e,Pt(this,Co).getCoords(r),r),i===null&&(o.lastMouseOver=null))}onMouseUp(e){let n=this.parentCell(e.target);n.TD&&Pt(this,Sl).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Pt(this,Eu)[0]&&n.TD===Pt(this,Eu)[1]?(St(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Pt(this,Eu)[0]=null,Pt(this,Eu)[1]=null):n.TD===Pt(this,Eu)[0]&&(Pt(this,Eu)[1]=n.TD,clearTimeout(Pt(this,Qp)[1]),Pt(this,Qp)[1]=setTimeout(()=>{Pt(this,Eu)[1]=null},500)))}onTouchStart(e){Hf(this,MS,Pt(this,_w).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;let r=e.target,i=(n=this.parentCell(r))===null||n===void 0?void 0:n.coords,o=Ze(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&o&&Pt(this,Sl).getSetting("isDataViewInstance")){let a=["A","BUTTON","INPUT"];bM()&&(boe()||Toe())&&this.selectedCellWasTouched(r)&&!a.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,r,i){let o=Pt(this,Sl).getSettingPure(e);o&&o(n,r,i,Pt(this,TU).call(this))}destroy(){clearTimeout(Pt(this,Qp)[0]),clearTimeout(Pt(this,Qp)[1]),Pt(this,yc).destroy()}},GM=RU;var FIt=Q(ze(),1),LIt=Q(De(),1);var ZTt=Q(De(),1),QTt=Q(ze(),1);var Bbt=Q(De(),1);function DU(t,e,n){return e=Qze(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qze(t){var e=Jze(t,"string");return typeof e=="symbol"?e:String(e)}function Jze(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var IU=class{constructor(e,n,r){DU(this,"offset",void 0),DU(this,"total",void 0),DU(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}},Sse=IU;var Wbt=Q(De(),1);function AU(t,e,n){return e=e9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e9e(t){var e=t9e(t,"string");return typeof e=="symbol"?e:String(e)}function t9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MU=class{constructor(e,n,r){AU(this,"offset",void 0),AU(this,"total",void 0),AU(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}},Ese=MU;var uTt=Q(De(),1);var Xbt=Q(ze(),1),Zbt=Q(De(),1);var Ybt=Q(De(),1);var $bt=Q(De(),1);function zM(t,e,n){return e=n9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n9e(t){var e=r9e(t,"string");return typeof e=="symbol"?e:String(e)}function r9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var OS=class{constructor(){zM(this,"currentSize",0),zM(this,"nextSize",0),zM(this,"currentOffset",0),zM(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}};function OU(t,e,n){return e=i9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i9e(t){var e=o9e(t,"string");return typeof e=="symbol"?e:String(e)}function o9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var YM=class{constructor(){OU(this,"size",new OS),OU(this,"workingSpace",0),OU(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof OS}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}};function Cw(t,e,n){return e=s9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s9e(t){var e=a9e(t,"string");return typeof e=="symbol"?e:String(e)}function a9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Jp=class{constructor(e,n,r){Cw(this,"rootNode",void 0),Cw(this,"nodesPool",void 0),Cw(this,"sizeSet",new YM),Cw(this,"childNodeType",void 0),Cw(this,"visualIndex",0),Cw(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=n,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){let e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){let{rootNode:e,sizeSet:n}=this,r=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)r+=1;else if(n.isPlaceOn(1))break;i=i.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;let{rootNode:e,sizeSet:n}=this,r=this.isSharedViewSet(),{nextSize:i}=n.getViewSize(),o=this.getRenderedChildCount();for(;o<i;){let a=this.nodesPool();!r||r&&n.isPlaceOn(2)?e.appendChild(a):e.insertBefore(a,e.firstChild),o+=1}let s=r&&n.isPlaceOn(1);for(;o>i;)e.removeChild(s?e.firstChild:e.lastChild),o-=1}render(){let{rootNode:e,sizeSet:n}=this,r=this.visualIndex;this.isSharedViewSet()&&n.isPlaceOn(2)&&(r+=n.sharedSize.nextSize);let i=e.childNodes[r];if(i.tagName!==this.childNodeType){let o=this.nodesPool();e.replaceChild(o,i),i=o}this.collectedNodes.push(i),this.visualIndex+=1}end(){}};var eg=class extends Jp{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}};var aTt=Q(De(),1);var oTt=Q(De(),1);function l9e(t,e,n){return e=c9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c9e(t){var e=u9e(t,"string");return typeof e=="symbol"?e:String(e)}function u9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qM=class{constructor(e){l9e(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}};function NS(t,e,n){return e=d9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d9e(t){var e=h9e(t,"string");return typeof e=="symbol"?e:String(e)}function h9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var El=class{constructor(e,n){NS(this,"nodesPool",null),NS(this,"nodeType",void 0),NS(this,"rootNode",void 0),NS(this,"table",null),NS(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new qM(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}};function xse(t,e,n){return e=f9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f9e(t){var e=m9e(t,"string");return typeof e=="symbol"?e:String(e)}function m9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KM=class extends El{constructor(){super("TH"),xse(this,"orderViews",new WeakMap),xse(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new eg(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){let{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:r,rows:i,cells:o}=this.table;for(let s=0;s<e;s++){let a=this.table.renderedRowToSource(s),l=i.getRenderedNode(s);this.sourceRowIndex=a;let c=this.obtainOrderView(l),u=o.obtainOrderView(l);c.appendView(u).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){c.render();let h=c.getCurrentNode();h.className="",h.removeAttribute("style"),gl(h,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&vt(h,[Aie(),Hie(),nw(d+1),ml(-1)]),n[d](a,h,d)}c.end()}}};var XM=class extends El{constructor(e){super(null,e)}adjust(){let{columnHeadersCount:e,rowHeadersCount:n}=this.table,r=this.rootNode.firstChild;if(e){let{columnsToRender:i}=this.table,o=i+n;for(let a=0,l=e;a<l;a++){for(r=this.rootNode.childNodes[a],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<o;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)r.removeChild(r.lastChild),this.renderedNodes-=1}let s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&yo(r)}render(){let{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&vt(this.rootNode,[uM()]);for(let n=0;n<e;n+=1){let{columnHeaderFunctions:r,columnsToRender:i,rowHeadersCount:o}=this.table,s=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&vt(s,[wS(),mM(n+1)]);for(let a=-1*o;a<i;a+=1){let l=this.table.renderedColumnToSource(a),c=s.childNodes[a+o];c.className="",c.removeAttribute("style"),gl(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&vt(c,[nw(a+1+this.table.rowHeadersCount),ml(-1),Mie(),...a>=0?[Lie()]:[wS()]]),r[n](l,c,n)}}}};var ZM=class extends El{constructor(e){super(null,e)}adjust(){let{columnsToRender:e,rowHeadersCount:n}=this.table,r=e+n;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:e,rowHeadersCount:n}=this.table;for(let i=0;i<n;i++){let o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[i].style.width=`${s}px`}for(let i=0;i<e;i++){let o=this.table.renderedColumnToSource(i),s=this.table.columnUtils.getStretchedColumnWidth(o);this.rootNode.childNodes[i+n].style.width=`${s}px`}let r=this.rootNode.firstChild;r&&Ne(r,"rowHeader")}};var ETt=Q(De(),1);function p9e(t,e,n){return e=g9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g9e(t){var e=v9e(t,"string");return typeof e=="symbol"?e:String(e)}function v9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bse=!1,QM=class extends El{constructor(e){super("TR",e),p9e(this,"orderView",void 0),this.orderView=new Jp(e,n=>this.nodesPool.obtain(n),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){let{rowsToRender:e}=this.table;!bse&&e>1e3&&(bse=!0,Sn(Qt`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&vt(this.rootNode,[uM()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();let o=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var n,r;vt(o,[wS(),mM(s+((n=(r=this.table.rowUtils)===null||r===void 0||(r=r.dataAccessObject)===null||r===void 0?void 0:r.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}}this.orderView.end()}};var MTt=Q(De(),1);function Tse(t,e,n){return e=w9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w9e(t){var e=y9e(t,"string");return typeof e=="symbol"?e:String(e)}function y9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var JM=class extends El{constructor(){super("TD"),Tse(this,"orderViews",new WeakMap),Tse(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new eg(e,r=>this.nodesPool.obtain(this.sourceRowIndex,r),this.nodeType),this.orderViews.set(e,n)),n}render(){let{rowsToRender:e,columnsToRender:n,rows:r,rowHeaders:i}=this.table;for(let a=0;a<e;a++){let l=this.table.renderedRowToSource(a),c=r.getRenderedNode(a);this.sourceRowIndex=l;let u=this.obtainOrderView(c),d=i.obtainOrderView(c);u.prependView(d).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<n;h++){u.render();let f=u.getCurrentNode(),p=this.table.renderedColumnToSource(h);if(St(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),gl(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,p,f),this.table.isAriaEnabled()){var o,s;vt(f,[...f.hasAttribute("role")?[]:[Iie()],ml(-1),nw(p+((o=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}u.end()}}};var LTt=Q(De(),1);function So(t,e,n){return e=_9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _9e(t){var e=C9e(t,"string");return typeof e=="symbol"?e:String(e)}function C9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var eO=class{constructor(e){let{cellRenderer:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};So(this,"rootNode",void 0),So(this,"rootDocument",void 0),So(this,"rowHeaders",null),So(this,"columnHeaders",null),So(this,"colGroup",null),So(this,"rows",null),So(this,"cells",null),So(this,"rowFilter",null),So(this,"columnFilter",null),So(this,"rowUtils",null),So(this,"columnUtils",null),So(this,"rowsToRender",0),So(this,"columnsToRender",0),So(this,"rowHeaderFunctions",[]),So(this,"rowHeadersCount",0),So(this,"columnHeaderFunctions",[]),So(this,"columnHeadersCount",0),So(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:r,rows:i,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=r,this.rows=i,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:e,rows:n}=this;for(let r=0;r<e;r++){let i=n.getRenderedNode(r);if(i.firstChild){let o=this.renderedRowToSource(r),s=this.rowUtils.getHeight(o);s?i.firstChild.style.height=`${s-1}px`:i.firstChild.style.height=""}}}};var tO=class{constructor(){let{TABLE:e,THEAD:n,COLGROUP:r,TBODY:i,rowUtils:o,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new eO(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new KM,columnHeaders:new XM(n),colGroup:new ZM(r),rows:new QM(i),cells:new JM}),this.renderer.setAxisUtils(o,s)}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}};var zTt=Q(De(),1);function kU(t,e,n){return e=S9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S9e(t){var e=E9e(t,"string");return typeof e=="symbol"?e:String(e)}function E9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nO=class{constructor(e,n){kU(this,"dataAccessObject",void 0),kU(this,"wtSettings",void 0),kU(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let n=this.dataAccessObject.wtViewport.columnsRenderCalculator,r=this.getWidth(e);if(n){let i=n.getStretchedColumnWidth(e,r);i&&(r=i)}return r}getHeaderHeight(e){let n=this.wtSettings.getSetting("defaultRowHeight"),r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return r!==void 0&&(n=n?Math.max(n,r):r),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){let{wtSettings:e}=this,{wtTable:n,wtViewport:r,cloneSource:i}=this.dataAccessObject,o=i?i.wtTable.holder:n.holder,s=o.offsetHeight<o.scrollHeight?dr():0,a=e.getSetting("rowHeaderWidth");if(r.columnsRenderCalculator.refreshStretching(r.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){let l=e.getSetting("rowHeaders").length,c=e.getSetting("defaultColumnWidth");for(let u=0;u<l;u++){let d=Array.isArray(a)?a[u]:a;d=d??c,this.headerWidths.set(u,d)}}}};var KTt=Q(De(),1);function Rse(t,e,n){return e=x9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function x9e(t){var e=b9e(t,"string");return typeof e=="symbol"?e:String(e)}function b9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rO=class{constructor(e,n){Rse(this,"dataAccessObject",void 0),Rse(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e),r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(n=n===void 0?r:Math.max(n,r)),n}};function xu(t,e,n){return e=T9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T9e(t){var e=R9e(t,"string");return typeof e=="symbol"?e:String(e)}function R9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FU=class{constructor(e,n,r,i,o){xu(this,"wtSettings",null),xu(this,"domBindings",void 0),xu(this,"TBODY",null),xu(this,"THEAD",null),xu(this,"COLGROUP",null),xu(this,"hasTableHeight",!0),xu(this,"hasTableWidth",!0),xu(this,"isTableVisible",!1),xu(this,"tableOffset",0),xu(this,"holderOffset",0),this.domBindings=r,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,W4(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new rO(this.dataAccessObject,this.wtSettings),this.columnUtils=new nO(this.dataAccessObject,this.wtSettings),this.tableRenderer=new tO({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){let e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){let n=e.parentNode,r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!St(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",n&&n.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&vt(r,[Ps()]),r}createHider(e){let n=e.parentNode,r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!St(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",n&&n.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&vt(r,[Ps()]),r}createHolder(e){let n=e.parentNode,r;return(!n||n.nodeType!==Node.ELEMENT_NODE||!St(n,"wtHolder"))&&(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",n&&n.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&vt(r.parentNode,[Ps()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&vt(r,[Ps()]),r}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtSettings:n}=this,{wtOverlays:r,wtViewport:i}=this.dataAccessObject,o=n.getSetting("totalRows"),s=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,c=n.getSetting("columnHeaders"),u=c.length,d=!1,h=e;if(this.isMaster&&(this.holderOffset=vr(this.holder),h=i.createRenderCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){let p=r.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=p!==0,g!==this.correctHeaderWidth&&(h=!1)}if(this.isMaster&&(d=r.updateStateOfRendering()),h)this.isMaster&&i.createVisibleCalculators(),r&&r.refresh(!0);else{this.isMaster?this.tableOffset=vr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let p=o>0?this.getFirstRenderedRow():0,g=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new Ese(p,o,u),this.columnFilter=new Sse(g,s,l);let w=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let _={};this.wtSettings.getSetting("beforeDraw",!0,_),w=_.skipRender!==!0}if(w){this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(Pa)||this.is(_c))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let _;if(this.isMaster&&(_=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Pa))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();let S=pn(this.hider),x=pn(this.TABLE);S!==0&&x!==S&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),_!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Pa)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let f=!1;return this.isMaster&&(f=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(f=r.bottomOverlay.resetFixedPosition()||f),f=r.inlineStartOverlay.resetFixedPosition()||f,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),f?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),d&&r.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){let n=this.columnFilter.renderedToSource(e),r=this.wtSettings.getSetting("columnHeaders").length,i=this.wtSettings.getSetting("defaultRowHeight"),o,s,a,l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,o=this.getColumnHeaderHeight(r),s=this.getColumnHeader(n,r),s&&(a=vc(s),(!o&&i<a||o<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(l)?l[r]!==null&&l[r]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(l[r]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=l[r]||l))}adjustColumnHeaderHeights(){let{wtSettings:e}=this,n=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let o=0,s=i.length;o<s;o++)if(r[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${r[o]}px`}}resetOversizedRows(){let{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Pa))&&!e.getSetting("externalRowCalculator")){let r=this.getRenderedRowsCount();for(let i=0;i<r;i++){let o=this.rowFilter.renderedToSource(i);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,r=e.col,i=this.wtSettings.getSetting("onModifyGetCellCoords",n,r);if(i&&Array.isArray(i)&&([n,r]=i),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;let o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");let s=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!s&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let n=null,r=null;if(e<0){var i;n=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),r=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),r=this.TBODY}return n!==void 0&&r!==void 0?r.childNodes.length<n+1?!1:r.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=this.THEAD.childNodes[n];return r?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){let n=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{let o=i.childNodes[r];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=this.wtSettings.getSetting("rowHeaders").length;if(n>=r)return;let i=this.rowFilter.sourceToRendered(e),o=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[o];return a?.childNodes[n]}getRowHeaders(e){let n=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<r;i++){let o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=o?.childNodes[i];s&&n.push(s)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=mc(n,["TD","TH"])),n===null)return null;let r=n.parentNode,i=r.parentNode,o=Jie(r),s=n.cellIndex;return Rf(bu,n,this.wtRootElement)||Rf(Cc,n,this.wtRootElement)?i.nodeName==="THEAD"&&(o-=i.childNodes.length):Rf(_c,n,this.wtRootElement)||Rf(Pa,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-i.childNodes.length+o:i===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):o=this.rowFilter.renderedToSource(o),Rf(bu,n,this.wtRootElement)||Rf(Sc,n,this.wtRootElement)||Rf(_c,n,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(o,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length,n=e*this.wtSettings.getSetting("defaultRowHeight"),r=vc(this.TBODY)-1,i,o,s,a,l;if(!(n===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),i=this.getRowHeight(s),a=this.getTrForRow(s),l=a.querySelector("th"),l?o=vc(l):o=vc(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<o||i<o)&&(o+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=o)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;let r=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=r}isRowHeaderRendered(e){if(e>=0)return!1;let r=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=r}isRowBeforeRenderedRows(e){let n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){let n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return pn(this.TABLE)}getHeight(){return Nn(this.TABLE)}getTotalWidth(){let e=pn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){let e=Nn(this.hider);return e!==0?e:this.getHeight()}isVisible(){return pl(this.TABLE)}_modifyRowHeaderWidth(e){let n=xn(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}},xl=FU;var D9e="stickyRowsBottom",Dse={getFirstRenderedRow(){let t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),n=t-e;return t===0||e===0?-1:n<0?0:n},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};_o(Dse,"MIXIN_NAME",D9e,{writable:!1,enumerable:!1});var iO=Dse;var I9e="stickyColumnsStart",Ise={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){let t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};_o(Ise,"MIXIN_NAME",I9e,{writable:!1,enumerable:!1});var Sw=Ise;var PS=class extends xl{constructor(e,n,r,i){super(e,n,r,i,_c)}};Jt(PS,iO);Jt(PS,Sw);var Ase=PS;var FRt=Q(De(),1);var Cc="top",Pa="bottom",Sc="inline_start",bu="top_inline_start_corner",_c="bottom_inline_start_corner",Mse=[Cc,Pa,Sc,bu,_c],Ose=new Map([[Cc,`ht_clone_${Cc}`],[Pa,`ht_clone_${Pa}`],[Sc,`ht_clone_${Sc} ht_clone_left`],[bu,`ht_clone_${bu} ht_clone_top_left_corner`],[_c,`ht_clone_${_c} ht_clone_bottom_left_corner`]]);var ORt=Q(De(),1);var ERt=Q(ze(),1),xRt=Q(De(),1);var _Rt=Q(De(),1);function LU(t,e,n){return e=A9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A9e(t){var e=M9e(t,"string");return typeof e=="symbol"?e:String(e)}function M9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var HU=class{constructor(e){LU(this,"dataAccessObject",void 0),LU(this,"lastScrolledColumnPos",-1),LU(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,n,r,i,o){let s=this.scrollViewportHorizontally(e.col,r,o),a=this.scrollViewportVertically(e.row,n,i);return s||a}scrollViewportHorizontally(e,n,r){let{drawn:i,totalColumns:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;let s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),l=n===void 0&&r===void 0,{fixedColumnsStart:c,inlineStartOverlay:u}=this.dataAccessObject;if(l&&e<c)return!1;let d=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?d=u.scrollTo(e,l?e>this.lastScrolledColumnPos:n):(l&&(e<s||e>a)||!l)&&(d=u.scrollTo(e,l?e>a:n)),d&&(this.lastScrolledColumnPos=e),d}scrollViewportVertically(e,n,r){let{drawn:i,totalRows:o}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>o)return!1;let s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),l=n===void 0&&r===void 0,{fixedRowsBottom:c,fixedRowsTop:u,topOverlay:d}=this.dataAccessObject;if(l&&(e<u||e>o-c-1))return!1;let h=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?h=d.scrollTo(e,l?e>this.lastScrolledRowPos:r):(l&&(e<s||e>a)||!l)&&(h=d.scrollTo(e,l?e>a:r)),h&&(this.lastScrolledRowPos=e),h}getFirstVisibleRow(){let{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,fixedRowsTop:o,rootWindow:s}=this.dataAccessObject,a=n.getFirstVisibleRow();if(e.mainTableScrollableElement===s){let l=vr(n.wtRootElement),c=vc(n.hider),u=vc(s),d=Gp(s,s);if(l.top+c-u<=d){let h=r.getColumnHeaderHeight();h+=e.sumCellSizes(0,o);for(let f=i;f>0;f--)if(h+=e.sumCellSizes(f-1,f),l.top+c-h<=d){a=f;break}}}return a}getLastVisibleRow(){let{topOverlay:e,wtTable:n,wtViewport:r,totalRows:i,rootWindow:o}=this.dataAccessObject,s=n.getLastVisibleRow();if(e.mainTableScrollableElement===o){let a=vr(n.wtRootElement),l=Gp(o,o);if(a.top>l){let c=vc(o),u=r.getColumnHeaderHeight();for(let d=1;d<=i;d++)if(u+=e.sumCellSizes(d-1,d),a.top+u-l>=c){s=d-2;break}}}return s}getFirstVisibleColumn(){let{inlineStartOverlay:e,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:o}=this.dataAccessObject,s=n.getFirstVisibleColumn();if(e.mainTableScrollableElement===o){let a=vr(n.wtRootElement),l=ow(n.hider),c=ow(o),u=Math.abs(CS(o,o));if(a.left+l-c<=u){let d=r.getRowHeaderWidth();for(let h=i;h>0;h--)if(d+=e.sumCellSizes(h-1,h),a.left+l-d<=u){s=h;break}}}return s}getLastVisibleColumn(){let{wtSettings:e,inlineStartOverlay:n,wtTable:r,wtViewport:i,totalColumns:o,rootWindow:s}=this.dataAccessObject,a=r.getLastVisibleColumn();if(n.mainTableScrollableElement===s){let l=e.getSetting("rtlMode"),c=null;if(l){let d=r.TABLE.getBoundingClientRect(),f=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;c=Math.abs(d.right-f)}else c=vr(r.wtRootElement).left;let u=Math.abs(CS(s,s));if(c>u){let d=ow(s),h=i.getRowHeaderWidth();for(let f=1;f<=o;f++)if(h+=n.sumCellSizes(f-1,f),c+h-u>=d){a=f-2;break}}}return a}},Nse=HU;function Ec(t,e,n){return e=O9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O9e(t){var e=N9e(t,"string");return typeof e=="symbol"?e:String(e)}function N9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vf=class{get eventManager(){return new ei(this)}constructor(e,n){Ec(this,"wtTable",void 0),Ec(this,"wtScroll",void 0),Ec(this,"wtViewport",void 0),Ec(this,"wtOverlays",void 0),Ec(this,"selectionManager",void 0),Ec(this,"wtEvent",void 0),Ec(this,"guid",`wt_${aM()}`),Ec(this,"drawInterrupted",!1),Ec(this,"drawn",!1),Ec(this,"domBindings",void 0),Ec(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Nse(this.createScrollDao())}findOriginalHeaders(){let e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,r){wl(r,e[n])}])}}createCellCoords(e,n){return new Lf(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,r){return new Zp(e,n,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);let r=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=r-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<r&&e.row>=r-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,r,i,o){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return e<0?!1:this.wtScroll.scrollViewportVertically(e,n,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}};function Pse(t,e,n){return e=P9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function P9e(t){var e=k9e(t,"string");return typeof e=="symbol"?e:String(e)}function k9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oO=class extends Vf{constructor(e,n,r){super(e,n),Pse(this,"cloneSource",void 0),Pse(this,"cloneOverlay",void 0);let i=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new GM(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}};function F9e(t,e,n){return e=L9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L9e(t){var e=H9e(t,"string");return typeof e=="symbol"?e:String(e)}function H9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var bl=class{constructor(e,n,r,i,o){F9e(this,"wtSettings",null),_o(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=i;let{TABLE:s,hider:a,spreader:l,holder:c,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=u,this.trimmingContainer=gc(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){let e=this.needFullRender;this.needFullRender=this.shouldBeRendered();let n=e!==this.needFullRender;return n&&!this.needFullRender&&this.reset(),n}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=gc(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=iw(e.TABLE)}getRelativeCellPosition(e,n,r){if(this.clone.wtTable.holder.contains(e)===!1){Sn(`The provided element is not a child of the ${this.type} overlay`);return}let i=this.mainTableScrollableElement===this.domBindings.rootWindow,o=r<this.wtSettings.getSetting("fixedColumnsStart"),s=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop},d=null;return i?d=this.getRelativeCellPositionWithinWindow(s,o,u,c):d=this.getRelativeCellPositionWithinHolder(s,a,o,u,c),d}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,r,i){let o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,a=0;if(!n)s=i.start;else{let l=o.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(o.left+o.width+dr())),s=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:a=i.top,{start:r.start+s,top:r.top+a}}getRelativeCellPositionWithinHolder(e,n,r,i,o){let s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},a=0,l=0;if(r||(a=s.horizontal-o.start),n){let c=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(l=s.vertical-o.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(Mse.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);let{wtTable:e,wtSettings:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=r.createElement("div"),s=r.createElement("table"),a=e.wtRootElement.parentNode;o.className=`${Ose.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&vt(o,[Ps()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),a.appendChild(o);let c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===Cc||c==="vertical"&&this.type===Sc?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=iw(e.TABLE),new oO(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.shouldBeRendered();this.clone&&(this.needFullRender||n)&&this.clone.draw(e),this.needFullRender=n}reset(){if(!this.clone)return;let e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,r=e.style,i=n.style,o=e.parentNode.style;Z([r,i,o],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}};var kS=class extends bl{constructor(e,n,r,i,o,s){super(e,n,_c,r,i),this.bottomOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Ase(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;let n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let o=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${s}px`}else Af(n),this.repositionOverlay();let r=Nn(this.clone.wtTable.TABLE),i=pn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),n.style.height=`${r}px`,n.style.width=`${i}px`,!1}repositionOverlay(){let{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode,o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=dr(r)),i.style.bottom=`${o}px`}};var iDt=Q(De(),1);var V9e="calculatedColumns",kse={getFirstRenderedColumn(){let t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){let t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getLastRenderedColumn(){let t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){let t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};_o(kse,"MIXIN_NAME",V9e,{writable:!1,enumerable:!1});var Ew=kse;var FS=class extends xl{constructor(e,n,r,i){super(e,n,r,i,Pa)}};Jt(FS,iO);Jt(FS,Ew);var Fse=FS;function B9e(t,e,n){return e=U9e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U9e(t){var e=W9e(t,"string");return typeof e=="symbol"?e:String(e)}function W9e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LS=class extends bl{constructor(e,n,r,i){super(e,n,Pa,r,i),B9e(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Fse(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let r=0,i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(r=this.getOverlayOffset(),n.style.bottom=`${r}px`):(r=this.getScrollPosition(),this.repositionOverlay());let o=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),o}repositionOverlay(){let{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r}=this.domBindings,i=this.clone.wtTable.holder.parentNode,o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=dr(r)),i.style.bottom=`${o}px`}setScrollPosition(e){let{rootWindow:n}=this.domBindings,r=!1;return this.mainTableScrollableElement===n?(n.scrollTo(_S(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){let{wtTable:r,wtSettings:i}=this.wot,o=i.getSetting("defaultRowHeight"),s=e,a=0;for(;s<n;){let l=r.getRowHeight(s);a+=l===void 0?o:l,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:n}=this.wot,{rootDocument:r,rootWindow:i}=this.domBindings,o=dr(r),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let u=n.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=o),u=Math.min(u,e.wtRootElement.scrollWidth),a.width=`${u}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let c=Nn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),a.height=`${c}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let r=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0;n&&o.offsetHeight!==o.clientHeight&&(s=dr(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Gp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){let i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o,a=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==n,i=this.wtSettings.getSetting("columnHeaders"),o=!1;if((r||n===0)&&i.length>0){let s=this.wot.wtTable.holder.parentNode,a=St(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Ne(s,"innerBorderBottom"),o=!a):(bt(s,"innerBorderBottom"),o=a)}return o}};var KDt=Q(De(),1);var j9e="calculatedRows",Lse={getFirstRenderedRow(){let t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){let t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getLastRenderedRow(){let t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){let t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};_o(Lse,"MIXIN_NAME",j9e,{writable:!1,enumerable:!1});var sO=Lse;var HS=class extends xl{constructor(e,n,r,i){super(e,n,r,i,Sc)}};Jt(HS,sO);Jt(HS,Sw);var Hse=HS;var wDt=Q(ze(),1);var $9e="localHooks",Vse={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,n,r,i,o,s){if(this._localHooks[t]){let a=this._localHooks[t].length;for(let l=0;l<a;l++)SS(this._localHooks[t][l],this,e,n,r,i,o,s)}},clearLocalHooks(){return this._localHooks={},this}};_o(Vse,"MIXIN_NAME",$9e,{writable:!1,enumerable:!1});var xr=Vse;var aO=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};Jt(aO,xr);var lO=aO;var xw="active-header",Bf="header",Uf="area",tg="focus",cO="fill",uO="row",dO="column",hO="custom-selection";var bw=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var HDt=Q(ze(),1),VDt=Q(VU(),1),BDt=Q(De(),1);var IDt=Q(De(),1);function z9e(t,e){Wse(t,e),e.add(t)}function Bse(t,e,n){Wse(t,e),e.set(t,n)}function Wse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function BU(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Di(t,e){var n=jse(t,e,"get");return Y9e(t,n)}function Y9e(t,e){return e.get?e.get.call(t):e.value}function Use(t,e,n){var r=jse(t,e,"set");return q9e(t,r,n),n}function jse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function q9e(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xc=new WeakMap,oa=new WeakMap,fO=new WeakSet,mO=class{constructor(){z9e(this,fO),Bse(this,xc,{writable:!0,value:void 0}),Bse(this,oa,{writable:!0,value:void 0})}setActiveOverlay(e){return Use(this,oa,e),this}setActiveSelection(e){return Use(this,xc,e),this}scan(){let e=Di(this,xc).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="area"?this.scanCellsRange(r=>n.add(r)):e==="focus"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r)),this.scanCellsRange(r=>n.add(r))):e==="fill"?this.scanCellsRange(r=>n.add(r)):e==="header"?(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanRowsInHeadersRange(r=>n.add(r))):e==="row"?(this.scanRowsInHeadersRange(r=>n.add(r)),this.scanRowsInCellsRange(r=>n.add(r))):e==="column"&&(this.scanColumnsInHeadersRange(r=>n.add(r)),this.scanColumnsInCellsRange(r=>n.add(r))),n}scanColumnsInHeadersRange(e){let[n,r,i,o]=Di(this,xc).getCorners(),{wtTable:s}=Di(this,oa),a=s.getRenderedColumnsCount(),l=s.getColumnHeadersCount(),c=0;for(let u=-s.getRowHeadersCount();u<a;u++){let d=s.columnFilter.renderedToSource(u);if(!(d<r||d>o)){for(let h=-l;h<0;h++){if(h<n||h>i)continue;let f=h+l,p=s.getColumnHeader(d,f),g=Di(this,oa).getSetting("onBeforeHighlightingColumnHeader",d,f,{selectionType:Di(this,xc).settings.selectionType,columnCursor:c,selectionWidth:o-r+1});g!==null&&(g!==d&&(p=s.getColumnHeader(g,f)),e(p))}c+=1}}}scanRowsInHeadersRange(e){let[n,r,i,o]=Di(this,xc).getCorners(),{wtTable:s}=Di(this,oa),a=s.getRenderedRowsCount(),l=s.getRowHeadersCount(),c=0;for(let u=-s.getColumnHeadersCount();u<a;u++){let d=s.rowFilter.renderedToSource(u);if(!(d<n||d>i)){for(let h=-l;h<0;h++){if(h<r||h>o)continue;let f=h+l,p=s.getRowHeader(d,f),g=Di(this,oa).getSetting("onBeforeHighlightingRowHeader",d,f,{selectionType:Di(this,xc).settings.selectionType,rowCursor:c,selectionHeight:i-n+1});g!==null&&(g!==d&&(p=s.getRowHeader(g,f)),e(p))}c+=1}}}scanCellsRange(e){let[n,r,i,o]=Di(this,xc).getCorners(),{wtTable:s}=Di(this,oa);BU(this,fO,UU).call(this,(a,l)=>{if(a>=n&&a<=i&&l>=r&&l<=o){let c=s.getCell(Di(this,oa).createCellCoords(a,l)),u=Di(this,oa).getSetting("onAfterDrawSelection",a,l,Di(this,xc).settings.layerLevel);typeof u=="string"&&Ne(c,u),e(c)}})}scanRowsInCellsRange(e){let[n,,r]=Di(this,xc).getCorners(),{wtTable:i}=Di(this,oa);BU(this,fO,UU).call(this,(o,s)=>{if(o>=n&&o<=r){let a=i.getCell(Di(this,oa).createCellCoords(o,s));e(a)}})}scanColumnsInCellsRange(e){let[,n,,r]=Di(this,xc).getCorners(),{wtTable:i}=Di(this,oa);BU(this,fO,UU).call(this,(o,s)=>{if(s>=n&&s<=r){let a=i.getCell(Di(this,oa).createCellCoords(o,s));e(a)}})}};function UU(t){let{wtTable:e}=Di(this,oa),n=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let i=0;i<n;i+=1){let o=e.rowFilter.renderedToSource(i);for(let s=0;s<r;s+=1)t(o,e.columnFilter.renderedToSource(s))}}var WU=class{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=bw,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){let e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,r=this.main.childNodes.length;n<r;n++){let i=this.main.childNodes[n];this.eventManager.addEventListener(i,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),wi(e);let r=this,i=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function s(l){if(l.clientY<Math.floor(o.top)||l.clientY>Math.ceil(o.top+o.height)||l.clientX<Math.floor(o.left)||l.clientX>Math.ceil(o.left+o.width))return!0}function a(l){s(l)&&(r.eventManager.removeEventListener(i,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){let{rootDocument:n}=this.wot;this.main=n.createElement("div");let r=["top","start","bottom","end","corner"],i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){let l=r[a],c=n.createElement("div");c.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),i=c.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Oa()&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:o}=this.wot,s=o.bordersHolder;s||(s=n.createElement("div"),s.className="htBorders",o.bordersHolder=s,o.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};let n=10,r=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let i={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`};Rt(i,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});let o={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};Rt(o,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){let r=this.wot.selectionManager.getAreaSelection();return!!(r.cellRange&&(e!==r.cellRange.to.row||n!==r.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,r,i,o,s){let l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:u,bottom:d,bottomHitArea:h}=this.selectionHandles.styles,f=parseInt(c.borderWidth,10),p=parseInt(c.width,10),g=parseInt(u.width,10),w=this.wot.wtTable.getWidth(),_=this.wot.wtTable.getHeight();c.top=`${parseInt(r-p-1,10)}px`,c[l]=`${parseInt(i-p-1,10)}px`,u.top=`${parseInt(r-g/4*3,10)}px`,u[l]=`${parseInt(i-g/4*3,10)}px`;let S=Math.min(parseInt(i+o,10),w-p-f*2),x=Math.min(parseInt(i+o-g/4,10),w-g-f*2);d[l]=`${S}px`,h[l]=`${x}px`;let P=Math.min(parseInt(r+s,10),_-p-f*2),k=Math.min(parseInt(r+s-g/4,10),_-g-f*2);d.top=`${P}px`,h.top=`${k}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",u.display="block",this.isPartRange(e,n)?(d.display="none",h.display="none"):(d.display="block",h.display="block")):(c.display="none",d.display="none",u.display="none",h.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",u.zIndex="9999"):(c.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;let{wtTable:n,rootDocument:r,rootWindow:i}=this.wot,o,s,a,l,c,u,d=n.getRenderedRowsCount();for(let q=0;q<d;q+=1){let y=n.rowFilter.renderedToSource(q);if(y>=e[0]&&y<=e[2]){o=y,c=e[0];break}}for(let q=d-1;q>=0;q-=1){let y=n.rowFilter.renderedToSource(q);if(y>=e[0]&&y<=e[2]){s=y;break}}let h=n.getRenderedColumnsCount();for(let q=0;q<h;q+=1){let y=n.columnFilter.renderedToSource(q);if(y>=e[1]&&y<=e[3]){a=y,u=e[1];break}}for(let q=h-1;q>=0;q-=1){let y=n.columnFilter.renderedToSource(q);if(y>=e[1]&&y<=e[3]){l=y;break}}if(o===void 0||a===void 0){this.disappear();return}let f=n.getCell(this.wot.createCellCoords(o,a)),p=o!==s||a!==l,g=p?n.getCell(this.wot.createCellCoords(s,l)):f,w=vr(f),_=p?vr(g):w,S=vr(n.TABLE),x=pn(n.TABLE),P=w.top,k=w.left,b=this.wot.wtSettings.getSetting("rtlMode"),C=0,N=0;if(b){let q=pn(f),y=i.innerWidth-S.left-x;N=k+q-_.left,C=i.innerWidth-k-q-y-1}else N=_.left+pn(g)-k,C=k-S.left-1;if(this.isEntireColumnSelected(o,s)){let q=this.getDimensionsFromHeader("columns",a,l,c,S),y=null;q&&([y,C,N]=q),y&&(f=y)}let B=P-S.top-1,Y=_.top+Nn(g)-P;if(this.isEntireRowSelected(a,l)){let q=this.getDimensionsFromHeader("rows",o,s,u,S),y=null;q&&([y,B,Y]=q),y&&(f=y)}let ee=yl(f,i);parseInt(ee.borderTopWidth,10)>0&&(B+=1,Y=Y>0?Y-1:0),parseInt(ee[b?"borderRightWidth":"borderLeftWidth"],10)>0&&(C+=1,N=N>0?N-1:0);let te=b?"right":"left";this.topStyle.top=`${B}px`,this.topStyle[te]=`${C}px`,this.topStyle.width=`${N}px`,this.topStyle.display="block",this.startStyle.top=`${B}px`,this.startStyle[te]=`${C}px`,this.startStyle.height=`${Y}px`,this.startStyle.display="block";let Ce=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${B+Y-Ce}px`,this.bottomStyle[te]=`${C}px`,this.bottomStyle.width=`${N}px`,this.bottomStyle.display="block",this.endStyle.top=`${B}px`,this.endStyle[te]=`${C+N-Ce}px`,this.endStyle.height=`${Y+1}px`,this.endStyle.display="block";let Re=this.settings.border.cornerVisible;Re=typeof Re=="function"?Re(this.settings.layerLevel):Re;let _e=this.wot.getSetting("onModifyGetCellCoords",s,l),[L,M]=[s,l];if(_e&&Array.isArray(_e)&&([,,L,M]=_e),Oa()||!Re||this.isPartRange(L,M))this.cornerStyle.display="none";else{this.cornerStyle.top=`${B+Y+this.cornerCenterPointOffset-1}px`,this.cornerStyle[te]=`${C+N+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let q=gc(n.TABLE),y=q===i;y&&(q=r.documentElement);let E=parseInt(this.cornerDefaultStyle.width,10)/2,R=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){let D=y?g.getBoundingClientRect().left:g.offsetLeft,A=!1,O=0;b?(O=D-parseInt(this.cornerDefaultStyle.width,10)/2,A=O<0):(O=D+pn(g)+parseInt(this.cornerDefaultStyle.width,10)/2,A=O>=ow(q)),A&&(this.cornerStyle[te]=`${Math.floor(C+N+this.cornerCenterPointOffset-E)}px`,this.cornerStyle[b?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(y?g.getBoundingClientRect().top:g.offsetTop)+Nn(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=vc(q)&&(this.cornerStyle.top=`${Math.floor(B+Y+this.cornerCenterPointOffset-R)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Oa()&&this.updateMultipleSelectionHandlesPosition(s,l,B,C,N,Y)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,r,i,o){let{wtTable:s}=this.wot,a=s.wtRootElement.parentNode,l=null,c=null,u=null,d=null,h=null,f=null,p=null,g=null;switch(e){case"rows":l=function(){return s.getRowHeader(...arguments)},c=function(){return Nn(...arguments)},u="ht__selection--rows",f="top";break;case"columns":l=function(){return s.getColumnHeader(...arguments)},c=function(){return pn(...arguments)},u="ht__selection--columns",f="left";break;default:}if(a.classList.contains(u)){let w=this.wot.getSetting("columnHeaders").length;if(p=l(n,w-i),g=l(r,w-i),!p||!g)return!1;let _=vr(p),S=vr(g);return p&&g&&(d=_[f]-o[f]-1,h=S[f]+c(g)-_[f]),[p,d,h]}return!1}changeBorderStyle(e,n){let r=this[e].style,i=n[e];!i||i.hide?Ne(this[e],"hidden"):(St(this[e],"hidden")&&bt(this[e],"hidden"),r.backgroundColor=i.color,(e==="top"||e==="bottom")&&(r.height=`${i.width}px`),(e==="start"||e==="end")&&(r.width=`${i.width}px`))}changeBorderToDefaultStyle(e){let n={width:1,color:"#000"},r=this[e].style;r.backgroundColor=n.color,r.width=`${n.width}px`,r.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?Ne(this[e],"hidden"):bt(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Oa()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}},jU=WU;function K9e(t,e){zse(t,e),e.add(t)}function Tw(t,e,n){zse(t,e),e.set(t,n)}function zse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function X9e(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function bn(t,e){var n=Yse(t,e,"get");return Z9e(t,n)}function Z9e(t,e){return e.get?e.get.call(t):e.value}function $se(t,e,n){var r=Yse(t,e,"set");return Q9e(t,r,n),n}function Yse(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Q9e(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var ds=new WeakMap,sa=new WeakMap,$U=new WeakMap,VS=new WeakMap,GU=new WeakMap,ng=new WeakMap,Gse=new WeakSet,pO=class{constructor(e){K9e(this,Gse),Tw(this,ds,{writable:!0,value:void 0}),Tw(this,sa,{writable:!0,value:void 0}),Tw(this,$U,{writable:!0,value:new mO}),Tw(this,VS,{writable:!0,value:new WeakMap}),Tw(this,GU,{writable:!0,value:new WeakSet}),Tw(this,ng,{writable:!0,value:new Map}),$se(this,sa,e)}setActiveOverlay(e){return $se(this,ds,e),bn(this,$U).setActiveOverlay(bn(this,ds)),bn(this,VS).has(bn(this,ds))||bn(this,VS).set(bn(this,ds),new Set),this}getFocusSelection(){return bn(this,sa)!==null?bn(this,sa).getFocus():null}getAreaSelection(){return bn(this,sa)!==null?bn(this,sa).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(bn(this,ng).has(e)){let r=bn(this,ng).get(e);if(r.has(bn(this,ds)))return r.get(bn(this,ds));let i=new jU(bn(this,ds),e.settings);return r.set(bn(this,ds),i),i}let n=new jU(bn(this,ds),e.settings);return bn(this,ng).set(e,new Map([[bn(this,ds),n]])),n}getBorderInstances(e){var n,r;return Array.from((n=(r=bn(this,ng).get(e))===null||r===void 0?void 0:r.values())!==null&&n!==void 0?n:[])}destroyBorders(e){bn(this,ng).get(e).forEach(n=>n.destroy()),bn(this,ng).delete(e)}render(e){if(bn(this,sa)===null)return;e&&X9e(this,Gse,J9e).call(this);let n=Array.from(bn(this,sa)),r=new Map,i=new Map;for(let o=0;o<n.length;o++){let s=n[o],{className:a,headerAttributes:l,createLayers:c,selectionType:u}=s.settings;bn(this,GU).has(s)||(bn(this,GU).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));let d=this.getBorderInstance(s);if(s.isEmpty()){d?.disappear();continue}a&&bn(this,$U).setActiveSelection(s).scan().forEach(p=>{if(r.has(p)){let g=r.get(p);g.has(a)&&c===!0?g.set(a,g.get(a)+1):g.set(a,1)}else r.set(p,new Map([[a,1]]));l&&(i.has(p)||i.set(p,[]),p.nodeName==="TH"&&i.get(p).push(...l))});let h=s.getCorners();bn(this,ds).getSetting("onBeforeDrawBorders",h,u),d?.appear(h)}r.forEach((o,s)=>{var a;let l=Array.from(o).map(c=>{let[u,d]=c;return d===1?u:[u,...Array.from({length:d-1},(h,f)=>`${u}-${f+1}`)]}).flat();l.forEach(c=>bn(this,VS).get(bn(this,ds)).add(c)),Ne(s,l),s.nodeName==="TD"&&Array.isArray((a=bn(this,sa).options)===null||a===void 0?void 0:a.cellAttributes)&&vt(s,bn(this,sa).options.cellAttributes)}),Array.from(i.keys()).forEach(o=>{vt(o,[...i.get(o)])})}};function J9e(){let t=bn(this,VS).get(bn(this,ds)),e=bn(this,ds).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var r,i;let o=bn(this,ds).wtTable.TABLE.querySelectorAll(`.${n}`),s=[];Array.isArray((r=bn(this,sa).options)===null||r===void 0?void 0:r.cellAttributes)&&(s=bn(this,sa).options.cellAttributes.map(a=>a[0])),Array.isArray((i=bn(this,sa).options)===null||i===void 0?void 0:i.headerAttributes)&&(s=[...s,...bn(this,sa).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=o.length;a<l;a++)bt(o[a],n),gl(o[a],s)}),t.clear()}var BS=class extends bl{constructor(e,n,r,i){super(e,n,Sc,r,i)}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Hse(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;let{rootWindow:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer===n&&(!i||i!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),sw(r,`${o}px`,"0px")):(o=this.getScrollPosition(),Af(r));let s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){let{rootWindow:n}=this.domBindings,r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===n&&n.scrollX!==e?(n.scrollTo(e,j4(n)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){let r=this.wtSettings.getSetting("defaultColumnWidth"),i=e,o=0;for(;i<n;)o+=this.wot.wtTable.getStretchedColumnWidth(i)||r,i+=1;return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=dr(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let c=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(c-=i),c=Math.min(c,e.wtRootElement.scrollHeight),s.height=`${c}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;let l=pn(this.clone.wtTable.TABLE);s.width=`${l}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(bw.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+n}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){let r=this.getTableParentOffset(),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,s=0;if(n){let a=this.wot.wtTable.getColumnWidth(e),l=this.wot.wtViewport.getViewportWidth();a>l&&(n=!1)}return n&&o.offsetWidth!==o.clientWidth&&(s=dr(this.domBindings.rootDocument)),n?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportWidth()):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),r+=s,this.setScrollPosition(r)}getTableParentOffset(){let e=this.wtSettings.getSetting("preventOverflow"),n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(CS(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?r=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let i=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),s=i-o;r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=this.wot.wtTable.holder.parentNode,r=this.wtSettings.getSetting("rowHeaders"),i=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?bt(n,"emptyRows"):Ne(n,"emptyRows");let s=!1;if(i&&!r.length)Ne(n,"innerBorderLeft innerBorderInlineStart");else if(!i&&r.length){let a=St(n,"innerBorderInlineStart");e?(Ne(n,"innerBorderLeft innerBorderInlineStart"),s=!a):(bt(n,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}};var uIt=Q(De(),1);var e7e="stickyRowsTop",qse={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){let t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};_o(qse,"MIXIN_NAME",e7e,{writable:!1,enumerable:!1});var gO=qse;var US=class extends xl{constructor(e,n,r,i){super(e,n,r,i,bu)}};Jt(US,gO);Jt(US,Sw);var Kse=US;function Xse(t,e,n){return e=t7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function t7e(t){var e=n7e(t,"string");return typeof e=="symbol"?e:String(e)}function n7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var WS=class extends bl{constructor(e,n,r,i,o,s){super(e,n,bu,r,i),Xse(this,"topOverlay",void 0),Xse(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Kse(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();sw(e,`${i}px`,`${o}px`)}else Af(e);let n=Nn(this.clone.wtTable.TABLE),r=pn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${r}px`,!1}};var SIt=Q(De(),1);var jS=class extends xl{constructor(e,n,r,i){super(e,n,r,i,Cc)}};Jt(jS,gO);Jt(jS,Ew);var Zse=jS;function r7e(t,e,n){return e=i7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i7e(t){var e=o7e(t,"string");return typeof e=="symbol"?e:String(e)}function o7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $S=class extends bl{constructor(e,n,r,i){super(e,n,Cc,r,i),r7e(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new Zse(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow"),i=0,o=!1;if(this.trimmingContainer===n&&(!r||r!=="vertical")){let{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),c=Math.ceil(l.bottom),u=e.offsetHeight;o=c===u,i=this.getOverlayOffset(),sw(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Af(e);let s=this.adjustHeaderBordersPosition(i,o);return this.adjustElementsSize(),s}setScrollPosition(e){let n=this.domBindings.rootWindow,r=!1;return this.mainTableScrollableElement===n&&n.scrollY!==e?(n.scrollTo(_S(n),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){let r=this.wtSettings.getSetting("defaultRowHeight"),i=e,o=0;for(;i<n;){let s=this.wot.wtTable.getRowHeight(i);o+=s===void 0?r:s,i+=1}return o}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=dr(n),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let c=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=i),c=Math.min(c,e.wtRootElement.scrollWidth),s.width=`${c}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let l=Nn(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),s.height=`${l}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,n=this.wot.selectionManager.getFocusSelection()?parseInt(bw.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+n}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let{wot:r,wtSettings:i}=this,s=(r.cloneSource?r.cloneSource:r).wtTable.holder,a=this.getTableParentOffset(),l=0;if(n){let c=this.wot.wtTable.getRowHeight(e),u=this.wot.wtViewport.getViewportHeight();c>u&&(n=!1)}if(n&&s.offsetHeight!==s.clientHeight&&(l=dr(this.domBindings.rootDocument)),n){let c=i.getSetting("fixedRowsBottom"),u=i.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=r.wtViewport.getViewportHeight()-this.sumCellSizes(u-c,u),a+=1}else a+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return a+=l,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Gp(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow"),r=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){let i=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),s=i-o;r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>s&&(r=0)}return r}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?bt(r,"emptyColumns"):Ne(r,"emptyColumns");let o=!1;if(!n){let s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,l=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&l.length>0){let c=St(r,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(Ne(r,"innerBorderTop"),o=!c):(bt(r,"innerBorderTop"),o=c)}}return o}};function Bd(t,e,n){return e=s7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s7e(t){var e=a7e(t,"string");return typeof e=="symbol"?e:String(e)}function a7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var zU=class{constructor(e,n,r,i,o,s){Bd(this,"wot",null),Bd(this,"topOverlay",null),Bd(this,"bottomOverlay",null),Bd(this,"inlineStartOverlay",null),Bd(this,"topInlineStartCornerOverlay",null),Bd(this,"bottomInlineStartCornerOverlay",null),Bd(this,"browserLineHeight",void 0),Bd(this,"wtSettings",null),Bd(this,"resizeObserver",new ResizeObserver(u=>{ww(()=>{!Array.isArray(u)||!u.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=i,this.domBindings=r,this.facadeGetter=n,this.wtTable=s;let{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=dr(a);let c=l.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?s.holder:iw(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){let{rootWindow:e,rootDocument:n}=this.domBindings,r=e.getComputedStyle(n.body),i=parseInt(r.lineHeight,10),o=parseInt(r.fontSize,10)*1.2;this.browserLineHeight=i||o}initOverlays(){let e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new $S(...e),this.bottomOverlay=new LS(...e),this.inlineStartOverlay=new BS(...e),this.topInlineStartCornerOverlay=new WS(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new kS(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",d=>this.onKeyDown(d)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",d=>this.onTableScroll(d),{passive:!0}),r!==i&&this.eventManager.addEventListener(i,"scroll",d=>this.onTableScroll(d),{passive:!0});let o=n.devicePixelRatio&&n.devicePixelRatio>1,s=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:s};(a||o||!EM())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",d=>this.onCloneWheel(d,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(d=>{if(d&&d.needFullRender){let{holder:h}=d.clone.wtTable;this.eventManager.addEventListener(h,"wheel",f=>this.onCloneWheel(f,a),l)}});let u;this.eventManager.addEventListener(n,"resize",()=>{clearTimeout(u),u=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){let n=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(i!==n&&o!==n&&!e.target.contains(i)||r!==n&&o!==n&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,n){let{rootWindow:r}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,s=e.target,a=o!==r&&s!==r&&!s.contains(o),l=i!==r&&s!==r&&!s.contains(i);if(this.keyPressed&&(a||l))return;let c=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==r&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=yu(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(r+=r*this.browserLineHeight,n+=n*this.browserLineHeight);let i=this.scrollVertically(n),o=this.scrollHorizontally(r);return i||o}scrollVertically(e){let n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){let n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let{rootWindow:e}=this.domBindings,n=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[i,o]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=n.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==o||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){n.scrollLeft=i;let s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(r.scrollTop=o),this.refreshAll()}syncScrollWithMaster(){let e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=iw(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){let e=this.wtTable.spreader,n=e.clientWidth,r=e.clientHeight,i=n!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r),i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,{wtViewport:n}=this.wot,{wtTable:r}=this,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=n.getRowHeaderWidth(),a=n.getColumnHeaderHeight(),l=r.hider.style;if(l.width=`${s+this.inlineStartOverlay.sumCellSizes(0,i)}px`,l.height=`${a+this.topOverlay.sumCellSizes(0,o)+1}px`,this.scrollbarSize>0){let{scrollHeight:c,scrollWidth:u}=r.wtRootElement,{scrollHeight:d,scrollWidth:h}=r.holder;this.hasScrollbarRight=c<d,this.hasScrollbarBottom=u<h,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>u?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>c&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;let n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],r=null;return Z(n,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(r=i.clone)}),r}syncOverlayTableClassNames(){let e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];Z(n,r=>{r&&(r.clone.wtTable.TABLE.className=e.className)})}},Qse=zU;var GIt=Q(De(),1);function Jse(t,e,n){return e=l7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l7e(t){var e=c7e(t,"string");return typeof e=="symbol"?e:String(e)}function c7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vO=class{constructor(e){Jse(this,"settings",{}),Jse(this,"defaults",Object.freeze(this.getDefaults())),Rt(this.defaults,(n,r)=>{if(e[r]!==void 0)this.settings[r]=e[r];else{if(n===void 0)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,r)=>{let i=this.getSetting("data",e,n);wl(r,i??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,n){return n===void 0?Rt(e,(r,i)=>{this.settings[i]=r}):this.settings[e]=n,this}getSetting(e,n,r,i,o){return typeof this.settings[e]=="function"?this.settings[e](n,r,i,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}};var GS=class extends xl{constructor(e,n,r,i){super(e,n,r,i,"master")}alignOverlaysWithTrimmingContainer(){let e=gc(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{let r=e.parentElement,i=Df(e,"height",n),o=Df(e,"overflow",n),s=this.holder.style,{scrollWidth:a,scrollHeight:l}=e,c=e.offsetWidth,u=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(o)){let h=e.cloneNode(!1);h.style.overflow="auto",h.style.position="absolute",e.nextElementSibling?r.insertBefore(h,e.nextElementSibling):r.appendChild(h);let f=parseInt(yl(h,n).height,10);r.removeChild(h),f===0&&(u=0)}u=Math.min(u,l),s.height=i==="auto"?"auto":`${u}px`,c=Math.min(c,a),s.width=`${c}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:u>0,this.hasTableWidth=c>0}this.isTableVisible=pl(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,r="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[r]){let a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let c=0;c<o;c++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);n.hasOversizedColumnHeadersMarked[r]=!0}}};Jt(GS,sO);Jt(GS,Ew);var eae=GS;var YU=class{constructor(e,n,r,i,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=r,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer,r=0;return n===this.domBindings.rootWindow?r=e.documentElement.clientHeight:r=Nn(n)>0&&n.clientHeight>0?n.clientHeight:1/0,r}getWorkspaceWidth(){let{wtSettings:e}=this,{rootDocument:n,rootWindow:r}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,o=n.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),c=this.wtTable.TABLE.getBoundingClientRect(),u=l?c.right-o:c.left,d=o-u,h,f;if(a)return pn(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?h=Math.min(d,o):h=Math.min(this.getContainerFillWidth(),d,o),i===r&&s>0&&this.sumColumnWidths(0,s-1)>h)return n.documentElement.clientWidth;if(i!==r&&(f=Df(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(h,i.clientWidth);let p=e.getSetting("stretchH");return p==="none"||!p?Math.max(h,pn(this.wtTable.TABLE)):h}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,n){let r=0,i=e;for(;i<n;)r+=this.wtTable.getColumnWidth(i),i+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;let e=this.wtTable.holder,n=this.domBindings.rootDocument.createElement("div");n.style.width="100%",n.style.height="1px",e.appendChild(n);let r=n.offsetWidth;return this.containerWidth=r,e.removeChild(n),r}getWorkspaceOffset(){return vr(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Nn(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;let n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getRowHeaderWidth(){let e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,i=n.length;r<i;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let r=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,o=n.length;i<o;i++)r?(this.rowHeaderWidth+=pn(r),r=r.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){let e=this.getWorkspaceWidth();if(e===1/0)return e;let n=this.getRowHeaderWidth();return n>0?e-n:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{wtSettings:n,wtTable:r}=this,i,o,s;this.rowHeaderWidth=NaN,n.getSetting("renderAllRows")&&e===1?i=1/0:i=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,l=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");return l&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=s,i-=s),c&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(u-c,u),i-=s),r.holder.clientHeight===r.holder.offsetHeight?o=0:o=dr(this.domBindings.rootDocument),new pw({viewportHeight:i,scrollOffset:a,totalRows:n.getSetting("totalRows"),rowHeightFn:d=>r.getRowHeight(d),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{wtSettings:n,wtTable:r}=this,i=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let s=n.getSetting("fixedColumnsStart");if(s&&o>=0){let a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=a,i-=a}return r.holder.clientWidth!==r.holder.offsetWidth&&(i-=dr(this.domBindings.rootDocument)),new Ff({viewportWidth:i,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>r.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:n.getSetting("stretchH"),stretchingColumnWidthFn:(a,l)=>n.getSetting("onBeforeStretchingColumnWidth",a,l),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(n){let r=this.createRowsCalculator(2),i=this.createColumnsCalculator(2);this.areAllProposedVisibleRowsAlreadyRendered(r)&&this.areAllProposedVisibleColumnsAlreadyRendered(i)||(n=!1)}return n||(this.rowsRenderCalculator=this.createRowsCalculator(1),this.columnsRenderCalculator=this.createColumnsCalculator(1)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,n}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(2),this.columnsVisibleCalculator=this.createColumnsCalculator(2)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:n,endRow:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;let{startRow:o,endRow:s}=this.rowsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:n,endColumn:r,isVisibleInTrimmingContainer:i}=e;if(n===null&&r===null)return!i;let{startColumn:o,endColumn:s}=this.columnsRenderCalculator;return n<o||n===o&&n>0?!1:!(r>s||r===s&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){Rt(this.hasOversizedColumnHeadersMarked,(e,n,r)=>{r[n]=void 0})}},tae=YU;var wO=class extends Vf{constructor(e,n){super(e,new vO(n));let r=this.wtSettings.getSetting("facade",this);this.wtTable=new eae(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new tae(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new pO(this.wtSettings.getSetting("selections")),this.wtEvent=new GM(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Qse(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],r=[];Rt(e,(i,o)=>{this.wtSettings.getSetting(o).length&&r.push(i),n.push(i)}),bt(this.wtTable.wtRootElement.parentNode,n),Ne(this.wtTable.wtRootElement.parentNode,r)}getViewportDao(){let e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}};var zS=class t{constructor(e){e instanceof Vf?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{let r=new t(n);return()=>r},this._wot=new wO(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,r){return this._wot.createCellRange(e,n,r)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,r,i,o){return this._wot.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wot.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wot.scrollViewportVertically(e,n,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,r,i,o){return this._wot.wtSettings.getSetting(e,n,r,i,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}};function nae(t){let{isShiftKey:e,isLeftClick:n,isRightClick:r,coords:i,selection:o,controller:s,cellCoordsFactory:a}=t,l=o.isSelected()?o.getSelectedRange().current():null,c=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(e&&l)i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!s.cell?o.setRangeEnd(a(i.row,i.col)):c&&i.row<0&&!s.column?o.setRangeEnd(a(l.to.row,i.col)):u&&i.col<0&&!s.row?o.setRangeEnd(a(i.row,l.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!s.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!u&&i.row<0||u&&i.row<0)&&!s.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{let d=!o.inInSelection(i),h=n||r&&d;i.row<0&&i.col>=0&&!s.column?h&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!s.row?h&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!s.cell?h&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function u7e(t){let{isLeftClick:e,coords:n,selection:r,controller:i,cellCoordsFactory:o}=t;if(!e)return;let s=r.isSelectedByRowHeader(),a=r.isSelectedByColumnHeader(),l=r.tableProps.countCols(),c=r.tableProps.countRows();a&&!i.column?r.setRangeEnd(o(c-1,n.col)):s&&!i.row?r.setRangeEnd(o(n.row,l-1)):i.cell||r.setRangeEnd(n)}var d7e=new Map([["mousedown",nae],["mouseover",u7e],["touchstart",nae]]);function qU(t,e){let{coords:n,selection:r,controller:i,cellCoordsFactory:o}=e;d7e.get(t.type)({coords:n,selection:r,controller:i,cellCoordsFactory:o,isShiftKey:t.shiftKey,isLeftClick:dw(t)||t.type==="touchstart",isRightClick:Na(t)})}var rae=new WeakMap,yO=Symbol("rootInstance");function iae(t){rae.set(t,!0)}function oae(t){return t===yO}function Rw(t){return rae.has(t)}function sae(t,e){lae(t,e),e.add(t)}function rg(t,e,n){lae(t,e),e.set(t,n)}function lae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wf(t,e,n){return e=h7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h7e(t){var e=f7e(t,"string");return typeof e=="symbol"?e:String(e)}function f7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QU(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Eo(t,e){var n=cae(t,e,"get");return m7e(t,n)}function m7e(t,e){return e.get?e.get.call(t):e.value}function Tl(t,e,n){var r=cae(t,e,"set");return p7e(t,r,n),n}function cae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function p7e(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var KU=new WeakMap,_O=new WeakMap,CO=new WeakMap,Ud=new WeakMap,bc=new WeakMap,XU=new WeakMap,ZU=new WeakMap,JU=new WeakSet,aae=new WeakSet,eW=class{constructor(e){sae(this,aae),sae(this,JU),Wf(this,"hot",void 0),Wf(this,"eventManager",void 0),Wf(this,"settings",void 0),Wf(this,"THEAD",void 0),Wf(this,"TBODY",void 0),Wf(this,"_wt",void 0),Wf(this,"activeWt",void 0),rg(this,KU,{writable:!0,value:0}),rg(this,_O,{writable:!0,value:0}),Wf(this,"postponedAdjustElementsSize",!1),rg(this,CO,{writable:!0,value:!1}),rg(this,Ud,{writable:!0,value:void 0}),rg(this,bc,{writable:!0,value:void 0}),rg(this,XU,{writable:!0,value:0}),rg(this,ZU,{writable:!0,value:0}),this.hot=e,this.eventManager=new ei(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,n){let r=this._wt.getCell(e,n);return r<0?null:r}scrollViewport(e,n,r,i,o){return this._wt.scrollViewport(e,n,r,i,o)}scrollViewportHorizontally(e,n,r){return this._wt.scrollViewportHorizontally(e,n,r)}scrollViewportVertically(e,n,r){return this._wt.scrollViewportVertically(e,n,r)}createElements(){let{rootElement:e,rootDocument:n}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),Ne(e,"handsontable"),Tl(this,bc,n.createElement("TABLE")),Ne(Eo(this,bc),"htCore"),this.hot.getSettings().tableClassName&&Ne(Eo(this,bc),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(vt(Eo(this,bc),[Ps()]),vt(e,[Die(),fM(-1),tw(this.hot.countCols()),Uie()])),this.THEAD=n.createElement("THEAD"),Eo(this,bc).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),Eo(this,bc).appendChild(this.TBODY),this.hot.table=Eo(this,bc),this.hot.container.insertBefore(Eo(this,bc),this.hot.container.firstChild)}registerEvents(){let{rootElement:e,rootDocument:n,selection:r}=this.hot,i=n.documentElement;this.eventManager.addEventListener(e,"mousedown",o=>{if(Tl(this,CO,!0),!this.isTextSelectionAllowed(o.target)){let{rootWindow:s}=this.hot;$4(s),o.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{Tl(this,CO,!1)}),this.eventManager.addEventListener(e,"mousemove",o=>{Eo(this,CO)&&!this.isTextSelectionAllowed(o.target)&&(this.settings.fragmentSelection&&$4(this.hot.rootWindow),o.preventDefault())}),this.eventManager.addEventListener(i,"keyup",o=>{r.isInProgress()&&!o.shiftKey&&r.finish()}),this.eventManager.addEventListener(i,"mouseup",o=>{r.isInProgress()&&dw(o)&&r.finish(),Tl(this,Ud,!1);let s=vM(n.activeElement);s&&(s||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!e.contains(o.target)&&!Na(o))&&this.hot.unlisten()}),this.eventManager.addEventListener(i,"contextmenu",o=>{r.isInProgress()&&Na(o)&&(r.finish(),Tl(this,Ud,!1))}),this.eventManager.addEventListener(i,"touchend",()=>{r.isInProgress()&&r.finish(),Tl(this,Ud,!1)}),this.eventManager.addEventListener(i,"mousedown",o=>{let s=o.target,a=o.x||o.clientX,l=o.y||o.clientY,c=o.target;if(Eo(this,Ud)||!e||!this.hot.view)return;let{holder:u}=this.hot.view._wt.wtTable;if(c===u){let h=dr(n);if(n.elementFromPoint(a+h,l)!==u||n.elementFromPoint(a,l+h)!==u)return}else for(;c!==i;){if(c===null){if(o.isTargetWebComponent)break;return}if(c===e)return;c=c.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(Eo(this,bc),"selectstart",o=>{this.settings.fragmentSelection||gM(o.target)||o.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,r))}translateFromRenderableToVisualIndex(e,n){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return r===null&&(r=e),i===null&&(i=n),[r,i]}countRenderableIndexes(e,n){let r=Math.min(e.getNotTrimmedIndexesLength(),n),i=e.getNearestNotHiddenIndex(r-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,r,i){if(isNaN(e)||e<0)return 0;let o=r.getNearestNotHiddenIndex(e,n),s=r.getRenderableFromVisualIndex(o);if(!Number.isInteger(s))return 0;let a=0;return n<0?a=s+1:n>0&&(a=i-s),a}countNotHiddenFixedColumnsStart(){let e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){let e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){let e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}countRenderableRowsInRange(e,n){let r=0;for(let i=e;i<=n;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){let e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){let e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Eo(this,bc),isDataViewInstance:()=>Rw(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(o,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{let o=[];return this.hot.hasRowHeaders()&&o.push((s,a)=>{let l=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),Tl(this,_O,o.length),this.hot.getSettings().ariaTags&&QU(this,JU,uae).call(this)===this.hot.countCols()&&QU(this,aae,g7e).call(this,Eo(this,_O)),o},columnHeaders:()=>{let o=[];return this.hot.hasColHeaders()&&o.push((s,a)=>{let l=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),Tl(this,KU,o.length),o},columnWidth:o=>{let s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(s===null?o:s)},rowHeight:o=>{let s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(s===null?o:s)},cellRenderer:(o,s,a)=>{let[l,c]=this.translateFromRenderableToVisualIndex(o,s),u=this.hot.runHooks("modifyGetCellCoords",l,c),d=l,h=c;Array.isArray(u)&&([d,h]=u);let f=this.hot.getCellMeta(d,h),p=this.hot.colToProp(h),g=this.hot.getDataAtRowProp(d,p);this.hot.hasHook("beforeValueRender")&&(g=this.hot.runHooks("beforeValueRender",g,f)),this.hot.runHooks("beforeRenderer",a,l,c,p,g,f),this.hot.getCellRenderer(f)(this.hot,a,l,c,p,g,f),this.hot.runHooks("afterRenderer",a,l,c,p,g,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&pl(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,s,a,l)=>{let c=this.translateFromRenderableToVisualCoords(s),u={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Tl(this,Ud,!0),this.hot.runHooks("beforeOnCellMouseDown",o,c,a,u),!_u(o)&&(qU(o,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(d,h)=>this.hot._createCellCoords(d,h)}),this.hot.runHooks("afterOnCellMouseDown",o,c,a),this.activeWt=this._wt)},onCellContextMenu:(o,s,a,l)=>{let c=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,Tl(this,Ud,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,c,a),!_u(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,c,a),this.activeWt=this._wt)},onCellMouseOut:(o,s,a,l)=>{let c=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",o,c,a),!_u(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,c,a),this.activeWt=this._wt)},onCellMouseOver:(o,s,a,l)=>{let c=this.translateFromRenderableToVisualCoords(s),u={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",o,c,a,u),!_u(o)&&(Eo(this,Ud)&&qU(o,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(d,h)=>this.hot._createCellCoords(d,h)}),this.hot.runHooks("afterOnCellMouseOver",o,c,a),this.activeWt=this._wt)},onCellMouseUp:(o,s,a,l)=>{let c=this.translateFromRenderableToVisualCoords(s);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",o,c,a),!(_u(o)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",o,c,a),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,s)=>this.beforeRender(o,s),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:o=>{let s=this.hot.rowIndexMapper,a=o<0,l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:o=>{let s=this.hot.columnIndexMapper,a=o<0,l=o;return!a&&(l=s.getVisualFromRenderableIndex(o),l===null)?o:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:s.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,s,a)=>{let l=this.hot.rowIndexMapper,c=o<0,u=o;c||(u=l.getVisualFromRenderableIndex(o));let d=this.hot.runHooks("beforeHighlightingRowHeader",u,s,a);return c?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onBeforeHighlightingColumnHeader:(o,s,a)=>{let l=this.hot.columnIndexMapper,c=o<0,u=o;c||(u=l.getVisualFromRenderableIndex(o));let d=this.hot.runHooks("beforeHighlightingColumnHeader",u,s,a);return c?d:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(d,1))},onAfterDrawSelection:(o,s,a)=>{let l,[c,u]=this.translateFromRenderableToVisualIndex(o,s),d=this.hot.selection.getSelectedRange();if(d.size()>0){let f=d.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",c,u,l,a)},onBeforeDrawBorders:(o,s)=>{let[a,l,c,u]=o,d=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u)];return this.hot.runHooks("beforeDrawBorders",d,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(o,s)=>{let a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",o,a)},onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,s,a)=>{let l=this.hot.rowIndexMapper,c=this.hot.columnIndexMapper,u=s>=0?c.getVisualFromRenderableIndex(s):s,d=o>=0?l.getVisualFromRenderableIndex(o):o,h=this.hot.runHooks("modifyGetCellCoords",d,u,a);if(Array.isArray(h)){let[f,p,g,w]=h;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,1)):p,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1)):g,w>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:o=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){let a=this.countRenderableRows(),l=o.startRow,c=o.endRow;if(typeof s=="number")o.startRow=Math.max(l-s,0),o.endRow=Math.min(c+s,a-1);else if(s==="auto"){let u=Math.ceil(c/a*12);o.startRow=Math.max(l-u,0),o.endRow=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){let a=this.countRenderableColumns(),l=o.startColumn,c=o.endColumn;if(typeof s=="number"&&(o.startColumn=Math.max(l-s,0),o.endColumn=Math.min(c+s,a-1)),s==="auto"){let u=Math.ceil(c/a*6);o.startColumn=Math.max(l-u,0),o.endColumn=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new zS(e),this.activeWt=this._wt;let n=this._wt.wtTable.spreader,{width:r,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,i),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(gM(e))return!0;let n=pc(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&n||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&n||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Eo(this,Ud)}isSelectedOnlyCell(){var e,n;return(e=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){let e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){let r=n.firstChild;if(!St(r,"relative")){yo(n),this.appendRowHeader(e,n);return}this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{let{rootDocument:r,getRowHeader:i}=this.hot,o=r.createElement("div"),s=r.createElement("span");o.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,i),o.appendChild(s),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(n.firstChild){let o=n.firstChild;St(o,"relative")?this.updateCellHeader(o.querySelector(".colHeader"),e,r,i):(yo(n),this.appendColHeader(e,n,r,i))}else{let{rootDocument:o}=this.hot,s=o.createElement("div"),a=o.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(vt(s,...Ps()),vt(a,...Ps())),this.updateCellHeader(a,e,r,i),s.appendChild(a),n.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,n,i)}updateCellHeader(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n,s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(St(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(n):St(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(n))),o>-1?vl(e,r(n,i)):(wl(e,String.fromCharCode(160)),Ne(e,"cornerHeader"))}maximumVisibleElementWidth(e){let r=this._wt.wtViewport.getWorkspaceWidth()-e;return r>0?r:0}maximumVisibleElementHeight(e){let r=this._wt.wtViewport.getWorkspaceHeight()-e;return r>0?r:0}setLastSize(e,n){Tl(this,XU,e),Tl(this,ZU,n)}getLastSize(){return{width:Eo(this,XU),height:Eo(this,ZU)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return Eo(this,KU)}getRowHeadersCount(){return Eo(this,_O)}destroy(){this._wt.destroy(),this.eventManager.destroy()}};function uae(){return parseInt(this.hot.rootElement.getAttribute(tw()[0]),10)}function g7e(t){let e=QU(this,JU,uae).call(this)+t;vt(this.hot.rootElement,...tw(e))}var dae=eW;var zAt=Q(ze(),1),YAt=Q(De(),1);var jAt=Q(ze(),1);var v7e="ABCDEFGHIJKLMNOPQRSTUVWXYZ",hae=v7e.length;function fae(t){let e=t+1,n="",r;for(;e>0;)r=(e-1)%hae,n=String.fromCharCode(65+r)+n,e=parseInt((e-r)/hae,10);return n}function tW(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t,r=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((i,o)=>{Array.isArray(i)?i.forEach((s,a)=>{r.push([o+e,a,s])}):Object.keys(i).forEach(s=>{r.push([o+e,s,i[s]])})}),r}function SO(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Tt(t[0])&&(e=cw(t[0]))),e}function mae(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function pae(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function YS(t,e,n){return e=w7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function w7e(t){var e=y7e(t,"string");return typeof e=="symbol"?e:String(e)}function y7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nW=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];YS(this,"hot",void 0),YS(this,"data",void 0),YS(this,"dataType","array"),YS(this,"colToProp",()=>{}),YS(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){let n=[];return Z(this.data,(r,i)=>{let o=this.getAtCell(i,e);n.push(o)}),n}getAtRow(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=n===void 0&&r===void 0,s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],o?s.forEach((l,c)=>{a[c]=this.getAtPhysicalCell(e,c,s)}):st(n,r,l=>{a[l-n]=this.getAtPhysicalCell(e,l,s)});else if(Tt(s)||xn(s))if(i?a=[]:a={},!o||i){let c=this.countFirstRowKeys()-1;st(0,c,u=>{let d=this.colToProp(u);if(u>=(n||0)&&u<=(r||c)&&!Number.isInteger(d)){let h=this.getAtPhysicalCell(e,d,s);i?a.push(h):SM(a,d,h)}})}else Rt(s,(l,c)=>{SM(a,c,this.getAtPhysicalCell(e,c,s))});return a}setAtCell(e,n,r){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let i=ks(r);this.hot.runHooks("modifySourceData",e,n,i,"set"),i.isTouched()&&(r=i.value)}Number.isInteger(n)?this.data[e][n]=r:SM(this.data[e],n,r)}}getAtPhysicalCell(e,n,r){let i=null;if(r&&(typeof n=="string"?i=xoe(r,n):typeof n=="function"?i=n(r):i=r[n]),this.hot.hasHook("modifySourceData")){let o=ks(i);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(i=o.value)}return i}getAtCell(e,n){let r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),r)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,o=null,s=null,a=null,l=null;e===null||n===null?(i=!0,o=0,a=this.countRows()-1):(o=Math.min(e.row,n.row),s=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));let c=[];return st(o,a,u=>{c.push(i?this.getAtRow(u,void 0,void 0,r):this.getAtRow(u,s,l,r))}),c}countRows(){if(this.hot.hasHook("modifySourceLength")){let e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return SO(this.data)}destroy(){this.data=null,this.hot=null}},gae=nW;var vOt=Q(De(),1);var UMt=Q(De(),1);var fMt=Q(ze(),1);var eMt=Q(ze(),1),tMt=Q(De(),1);function vae(t,e,n){return e=_7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _7e(t){var e=C7e(t,"string");return typeof e=="symbol"?e:String(e)}function C7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ls=class{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;vae(this,"indexedValues",[]),vae(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){let n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,xn(this.initValueOrFn)?st(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):st(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}};Jt(Ls,xr);function Dw(t,e,n,r){let i=n.length?n[0]:void 0;return[...t.slice(0,i),...n.map((o,s)=>xn(r)?r(o,s):r),...i===void 0?[]:t.slice(i)]}function Iw(t,e){return gi(t,(n,r)=>e.includes(r)===!1)}var xo=class extends Ls{insert(e,n){this.indexedValues=Dw(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=Iw(this.indexedValues,e),super.remove(e)}};var Tu=class extends xo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return or(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}};var CMt=Q(De(),1);function Aw(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Wd(t,e){return gi(t,n=>e.includes(n)===!1)}function jf(t,e){return At(t,n=>n-e.filter(r=>r<n).length)}function $f(t,e){let n=e[0],r=e.length;return At(t,i=>i>=n?i+r:i)}function S7e(t,e,n){return e=E7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E7e(t){var e=x7e(t,"string");return typeof e=="symbol"?e:String(e)}function x7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ru=class extends Ls{constructor(){super(...arguments),S7e(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Wd(this.orderOfIndexes,[e]),xn(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=Dw(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=$f(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=Iw(this.indexedValues,e),this.orderOfIndexes=Wd(this.orderOfIndexes,e),this.orderOfIndexes=jf(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}};var DMt=Q(ze(),1);var Rl=class extends xo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return or(this.getValues(),(e,n,r)=>(n&&e.push(r),e),[])}};var OMt=Q(De(),1);var wae=new Map([["indexesSequence",{getListWithInsertedItems:Aw,getListWithRemovedItems:Wd}],["physicallyIndexed",{getListWithInsertedItems:Dw,getListWithRemovedItems:Iw}]]),qS=t=>{if(wae.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return wae.get(t)};var Mw=class extends Ls{constructor(){super(e=>e)}insert(e,n){let r=$f(this.indexedValues,n);this.indexedValues=Aw(r,e,n),super.insert(e,n)}remove(e){let n=Wd(this.indexedValues,e);this.indexedValues=jf(n,e),super.remove(e)}};var yae=new Map([["hiding",Tu],["index",Ls],["linkedPhysicalIndexToValue",Ru],["physicalIndexToValue",xo],["trimming",Rl]]);function _ae(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!yae.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(yae.get(t))(e)}var tOt=Q(ze(),1),nOt=Q(De(),1);var XMt=Q(De(),1);function b7e(t,e,n){return e=T7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function T7e(t){var e=R7e(t,"string");return typeof e=="symbol"?e:String(e)}function R7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Cae=0,ig=class{constructor(){b7e(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),Cae+=1)}unregister(e){let n=this.collection.get(e);Ze(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),Cae-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return mn(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(r=>{r.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}};Jt(ig,xr);function rW(t,e,n){return e=D7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function D7e(t){var e=I7e(t,"string");return typeof e=="symbol"?e:String(e)}function I7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var KS=class extends ig{constructor(e,n){super(),rW(this,"mergedValuesCache",[]),rW(this,"aggregationFunction",void 0),rW(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];let n=At(this.get(),o=>o.getValues()),r=[],i=Ze(n[0])&&n[0].length||0;for(let o=0;o<i;o+=1){let s=[];for(let a=0;a<this.getLength();a+=1)s.push(n[a][o]);r.push(s)}return At(r,this.aggregationFunction)}getMergedValueAtIndex(e,n){let r=this.getMergedValues(n)[e];return Ze(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}};var fOt=Q(De(),1);var aOt=Q(De(),1);function A7e(t,e,n){M7e(t,e),e.set(t,n)}function M7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function O7e(t,e,n){var r=Sae(t,e,"set");return N7e(t,r,n),n}function N7e(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function P7e(t,e){var n=Sae(t,e,"get");return k7e(t,n)}function Sae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function k7e(t,e){return e.get?e.get.call(t):e.value}var iW=new WeakMap,XS=class{constructor(){A7e(this,iW,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(P7e(this,iW)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){O7e(this,iW,e)}};Jt(XS,xr);var dOt=Q(ze(),1);function oW(t,e){let n=[],r=0,i=0;for(;r<t.length&&i<e.length;r++,i++)t[r]!==e[i]&&n.push({op:"replace",index:i,oldValue:t[r],newValue:e[i]});for(;r<e.length;r++)n.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;i<t.length;i++)n.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return n}function ZS(t,e,n){F7e(t,e),e.set(t,n)}function F7e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dl(t,e){var n=Eae(t,e,"get");return L7e(t,n)}function L7e(t,e){return e.get?e.get.call(t):e.value}function EO(t,e,n){var r=Eae(t,e,"set");return H7e(t,r,n),n}function Eae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function H7e(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var xO=new WeakMap,QS=new WeakMap,bO=new WeakMap,TO=new WeakMap,RO=new WeakMap,DO=class{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ZS(this,xO,{writable:!0,value:new Set}),ZS(this,QS,{writable:!0,value:[]}),ZS(this,bO,{writable:!0,value:[]}),ZS(this,TO,{writable:!0,value:!1}),ZS(this,RO,{writable:!0,value:!1}),EO(this,RO,e??!1)}createObserver(){let e=new XS;return Dl(this,xO).add(e),e.addLocalHook("unsubscribe",()=>{Dl(this,xO).delete(e)}),e._writeInitialChanges(oW(Dl(this,QS),Dl(this,bO))),e}emit(e){let n=Dl(this,bO);(!Dl(this,TO)||Dl(this,QS).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(Dl(this,RO)):EO(this,QS,new Array(e.length).fill(Dl(this,RO))),Dl(this,TO)||(EO(this,TO,!0),n=Dl(this,QS)));let r=oW(n,e);Dl(this,xO).forEach(i=>i._write(r)),EO(this,bO,e)}};function Hs(t,e,n){return e=V7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function V7e(t){var e=B7e(t,"string");return typeof e=="symbol"?e:String(e)}function B7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var og=class{constructor(){Hs(this,"indexesSequence",new Mw),Hs(this,"trimmingMapsCollection",new KS(e=>e.some(n=>n===!0),!1)),Hs(this,"hidingMapsCollection",new KS(e=>e.some(n=>n===!0),!1)),Hs(this,"variousMapsCollection",new ig),Hs(this,"hidingChangesObservable",new DO({initialIndexValue:!1})),Hs(this,"notTrimmedIndexesCache",[]),Hs(this,"notHiddenIndexesCache",[]),Hs(this,"isBatched",!1),Hs(this,"indexesSequenceChanged",!1),Hs(this,"indexesChangeSource",void 0),Hs(this,"trimmedIndexesChanged",!1),Hs(this,"hiddenIndexesChanged",!1),Hs(this,"renderablePhysicalIndexesCache",[]),Hs(this,"fromPhysicalToVisualIndexesCache",new Map),Hs(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,r){return this.registerMap(e,_ae(n,r))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Rl?this.trimmingMapsCollection.register(e,n):n instanceof Tu?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);let r=this.getNumberOfIndexes();return r>0&&n.init(r),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){let n=this.notTrimmedIndexesCache[e];return Ze(n)?n:null}getPhysicalFromRenderableIndex(e){let n=this.renderablePhysicalIndexesCache[e];return Ze(n)?n:null}getVisualFromPhysicalIndex(e){let n=this.fromPhysicalToVisualIndexesCache.get(e);return Ze(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){let n=this.fromVisualToRenderableIndexesCache.get(e);return Ze(n)?n:null}getNearestNotHiddenIndex(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;let o=Array.from(this.fromVisualToRenderableIndexesCache.keys()),s=-1;return n>0?s=o.findIndex(a=>a>e):s=o.reverse().findIndex(a=>a<e),s===-1?r?this.getNearestNotHiddenIndex(e,-n,!1):null:o[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){let n=this.getNumberOfIndexes();if(e<n){let r=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(r)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(r=>this.isTrimmed(r)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(r=>this.isHidden(r)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(r=>this.isHidden(r)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);let r=At(e,c=>this.getPhysicalFromVisualIndex(c)),i=this.getNotTrimmedIndexesLength(),o=e.length,s=Wd(this.getIndexesSequence(),r),a=s.filter(c=>this.isTrimmed(c)===!1),l=s.indexOf(a[a.length-1])+1;if(n+o<i){let c=a[n];l=s.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(Aw(s,l,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let r=this.getNotTrimmedIndexes()[e],i=Ze(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),s=At(new Array(n).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){let r=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(r,n)}}cacheFromVisualToRenderableIndexes(){let e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){let r=this.getPhysicalFromRenderableIndex(n),i=this.getVisualFromPhysicalIndex(r);this.fromVisualToRenderableIndexesCache.set(i,n)}}};Jt(og,xr);function xae(t,e){return Rt(e,(n,r)=>{mn(t[r])&&(t[r]=n)}),t}function IO(t){let n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function AO(t){Ze(t)&&hw(Qt`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function sW(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}var{register:U7e,getValues:W7e}=Ri("phraseFormatters");function j7e(t,e){U7e(t,e)}function bae(){return W7e()}j7e("pluralize",sW);var Ot={};G_e(Ot,{CHECKBOX_CHECKED:()=>wx,CHECKBOX_RENDERER_NAMESPACE:()=>aW,CHECKBOX_UNCHECKED:()=>yx,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>yE,CONTEXTMENU_ITEMS_ALIGNMENT:()=>EE,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>AE,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>bE,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>RE,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>xE,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>IE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>TE,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>DE,CONTEXTMENU_ITEMS_BORDERS:()=>ME,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>PE,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>kE,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>NE,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>OE,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>cE,CONTEXTMENU_ITEMS_COPY:()=>uE,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>fE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>hE,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>dE,CONTEXTMENU_ITEMS_CUT:()=>mE,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>_E,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>pE,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>VE,CONTEXTMENU_ITEMS_HIDE_ROW:()=>UE,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>nE,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>rE,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>vE,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>HE,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>LE,CONTEXTMENU_ITEMS_NO_ITEMS:()=>JS,CONTEXTMENU_ITEMS_READ_ONLY:()=>lE,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>SE,CONTEXTMENU_ITEMS_REDO:()=>aE,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>FE,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>oE,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>CE,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>iE,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>eE,CONTEXTMENU_ITEMS_ROW_BELOW:()=>tE,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>BE,CONTEXTMENU_ITEMS_SHOW_ROW:()=>WE,CONTEXTMENU_ITEMS_UNDO:()=>sE,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>gE,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>wE,CONTEXT_MENU_ITEMS_NAMESPACE:()=>Tae,FILTERS_BUTTONS_CANCEL:()=>mx,FILTERS_BUTTONS_CLEAR:()=>hx,FILTERS_BUTTONS_OK:()=>fx,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>px,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>vx,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>gx,FILTERS_BUTTONS_SELECT_ALL:()=>dx,FILTERS_CONDITIONS_AFTER:()=>rx,FILTERS_CONDITIONS_BEFORE:()=>ix,FILTERS_CONDITIONS_BEGINS_WITH:()=>YE,FILTERS_CONDITIONS_BETWEEN:()=>tx,FILTERS_CONDITIONS_BY_VALUE:()=>$7e,FILTERS_CONDITIONS_CONTAINS:()=>KE,FILTERS_CONDITIONS_EMPTY:()=>jE,FILTERS_CONDITIONS_ENDS_WITH:()=>qE,FILTERS_CONDITIONS_EQUAL:()=>GE,FILTERS_CONDITIONS_GREATER_THAN:()=>ZE,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>QE,FILTERS_CONDITIONS_LESS_THAN:()=>JE,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>ex,FILTERS_CONDITIONS_NAMESPACE:()=>Gr,FILTERS_CONDITIONS_NONE:()=>sg,FILTERS_CONDITIONS_NOT_BETWEEN:()=>nx,FILTERS_CONDITIONS_NOT_CONTAIN:()=>XE,FILTERS_CONDITIONS_NOT_EMPTY:()=>$E,FILTERS_CONDITIONS_NOT_EQUAL:()=>zE,FILTERS_CONDITIONS_TODAY:()=>ox,FILTERS_CONDITIONS_TOMORROW:()=>sx,FILTERS_CONDITIONS_YESTERDAY:()=>ax,FILTERS_DIVS_FILTER_BY_CONDITION:()=>lx,FILTERS_DIVS_FILTER_BY_VALUE:()=>cx,FILTERS_LABELS_CONJUNCTION:()=>ux,FILTERS_LABELS_DISJUNCTION:()=>ag,FILTERS_NAMESPACE:()=>hs,FILTERS_VALUES_BLANK_CELLS:()=>Ow});var Tae="ContextMenu:items",un=Tae,JS=`${un}.noItems`,eE=`${un}.insertRowAbove`,tE=`${un}.insertRowBelow`,nE=`${un}.insertColumnOnTheLeft`,rE=`${un}.insertColumnOnTheRight`,iE=`${un}.removeRow`,oE=`${un}.removeColumn`,sE=`${un}.undo`,aE=`${un}.redo`,lE=`${un}.readOnly`,cE=`${un}.clearColumn`,uE=`${un}.copy`,dE=`${un}.copyWithHeaders`,hE=`${un}.copyWithGroupHeaders`,fE=`${un}.copyHeadersOnly`,mE=`${un}.cut`,pE=`${un}.freezeColumn`,gE=`${un}.unfreezeColumn`,vE=`${un}.mergeCells`,wE=`${un}.unmergeCells`,yE=`${un}.addComment`,_E=`${un}.editComment`,CE=`${un}.removeComment`,SE=`${un}.readOnlyComment`,EE=`${un}.align`,xE=`${un}.align.left`,bE=`${un}.align.center`,TE=`${un}.align.right`,RE=`${un}.align.justify`,DE=`${un}.align.top`,IE=`${un}.align.middle`,AE=`${un}.align.bottom`,ME=`${un}.borders`,OE=`${un}.borders.top`,NE=`${un}.borders.right`,PE=`${un}.borders.bottom`,kE=`${un}.borders.left`,FE=`${un}.borders.remove`,LE=`${un}.nestedHeaders.insertChildRow`,HE=`${un}.nestedHeaders.detachFromParent`,VE=`${un}.hideColumn`,BE=`${un}.showColumn`,UE=`${un}.hideRow`,WE=`${un}.showRow`,hs="Filters:",Gr=`${hs}conditions`,sg=`${Gr}.none`,jE=`${Gr}.isEmpty`,$E=`${Gr}.isNotEmpty`,GE=`${Gr}.isEqualTo`,zE=`${Gr}.isNotEqualTo`,YE=`${Gr}.beginsWith`,qE=`${Gr}.endsWith`,KE=`${Gr}.contains`,XE=`${Gr}.doesNotContain`,$7e=`${Gr}.byValue`,ZE=`${Gr}.greaterThan`,QE=`${Gr}.greaterThanOrEqualTo`,JE=`${Gr}.lessThan`,ex=`${Gr}.lessThanOrEqualTo`,tx=`${Gr}.isBetween`,nx=`${Gr}.isNotBetween`,rx=`${Gr}.after`,ix=`${Gr}.before`,ox=`${Gr}.today`,sx=`${Gr}.tomorrow`,ax=`${Gr}.yesterday`,lx=`${hs}labels.filterByCondition`,cx=`${hs}labels.filterByValue`,ux=`${hs}labels.conjunction`,ag=`${hs}labels.disjunction`,Ow=`${hs}values.blankCells`,dx=`${hs}buttons.selectAll`,hx=`${hs}buttons.clear`,fx=`${hs}buttons.ok`,mx=`${hs}buttons.cancel`,px=`${hs}buttons.placeholder.search`,gx=`${hs}buttons.placeholder.value`,vx=`${hs}buttons.placeholder.secondValue`,aW="CheckboxRenderer:",wx=`${aW}checked`,yx=`${aW}unchecked`;var G7e={languageCode:"en-US",[JS]:"No available options",[eE]:"Insert row above",[tE]:"Insert row below",[nE]:"Insert column left",[rE]:"Insert column right",[iE]:["Remove row","Remove rows"],[oE]:["Remove column","Remove columns"],[sE]:"Undo",[aE]:"Redo",[lE]:"Read only",[cE]:"Clear column",[EE]:"Alignment",[xE]:"Left",[bE]:"Center",[TE]:"Right",[RE]:"Justify",[DE]:"Top",[IE]:"Middle",[AE]:"Bottom",[pE]:"Freeze column",[gE]:"Unfreeze column",[ME]:"Borders",[OE]:"Top",[NE]:"Right",[PE]:"Bottom",[kE]:"Left",[FE]:"Remove border(s)",[yE]:"Add comment",[_E]:"Edit comment",[CE]:"Delete comment",[SE]:"Read-only comment",[vE]:"Merge cells",[wE]:"Unmerge cells",[uE]:"Copy",[dE]:["Copy with header","Copy with headers"],[hE]:["Copy with group header","Copy with group headers"],[fE]:["Copy header only","Copy headers only"],[mE]:"Cut",[LE]:"Insert child row",[HE]:"Detach from parent",[VE]:["Hide column","Hide columns"],[BE]:["Show column","Show columns"],[UE]:["Hide row","Hide rows"],[WE]:["Show row","Show rows"],[sg]:"None",[jE]:"Is empty",[$E]:"Is not empty",[GE]:"Is equal to",[zE]:"Is not equal to",[YE]:"Begins with",[qE]:"Ends with",[KE]:"Contains",[XE]:"Does not contain",[ZE]:"Greater than",[QE]:"Greater than or equal to",[JE]:"Less than",[ex]:"Less than or equal to",[tx]:"Is between",[nx]:"Is not between",[rx]:"After",[ix]:"Before",[ox]:"Today",[sx]:"Tomorrow",[ax]:"Yesterday",[Ow]:"Blank cells",[lx]:"Filter by condition",[cx]:"Filter by value",[ux]:"And",[ag]:"Or",[dx]:"Select all",[hx]:"Clear",[fx]:"OK",[mx]:"Cancel",[px]:"Search",[gx]:"Value",[vx]:"Second value",[wx]:"Checked",[yx]:"Unchecked"},lW=G7e;var Rae=Ot,cW=lW.languageCode,{register:z7e,getItem:Dae,hasItem:Y7e,getValues:q7e}=Ri("languagesDictionaries");uW(lW);function uW(t,e){let n=t,r=e;return Tt(t)&&(r=t,n=r.languageCode),K7e(n,r),z7e(n,vi(r)),vi(r)}function K7e(t,e){t!==cW&&xae(e,Dae(cW))}function dW(t){return MO(t)?vi(Dae(t)):null}function MO(t){return Y7e(t)}function Iae(){return q7e()}function OO(t,e,n){let r=dW(t);if(r===null)return null;let i=r[e];if(mn(i))return null;let o=X7e(i,n);return Array.isArray(o)?o[0]:o}function X7e(t,e){let n=t;return Z(bae(),r=>{n=r(t,e)}),n}function Aae(t){let e=IO(t);return MO(e)||(e=cW,AO(t)),e}var lPt=Q(De(),1);var PNt=Q(De(),1),kNt=Q(ze(),1);var qOt=Q(De(),1);function Z7e(t,e,n){return e=Q7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q7e(t){var e=J7e(t,"string");return typeof e=="symbol"?e:String(e)}function J7e(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var hW=class extends lO{constructor(e,n){super(e,null),Z7e(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:r}=e,i=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(r,-1);return i===null||o===null?null:((i.row>o.row||i.col>o.col)&&(i=n,o=r),this.settings.createCellRange(i,i,o))}getNearestNotHiddenCoords(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n,i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(i===null)return null;let o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return o===null?null:this.settings.createCellCoords(i,o)}getNearestNotHiddenIndex(e,n,r){return n<0?n:e.getNearestNotHiddenIndex(n,r)}commit(){if(this.visualCellRange===null)return this;let e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){let n=e.from.clone().normalize(),r=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),s=null;if((o===null||o.col===null||o.row===null)&&(s=this.getNearestNotHiddenCoords(n,r,i)),s!==null&&e.overlaps(s)){let a=e.highlight.clone();if(a.row>=0&&(a.row=s.row),a.col>=0&&(a.col=s.col),this.cellRange===null){let l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&o!==null&&s===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){let e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){let r=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(n);return r.row===null||r.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(r,r,i)}},bo=hW;function NO(t){let r=t,{activeHeaderClassName:e}=r,n=tr(r,["activeHeaderClassName"]);return new bo(ft(Ee({className:e},n),{selectionType:xw}))}function Mae(t){let r=t,{areaCornerVisible:e}=r,n=tr(r,["areaCornerVisible"]);return new bo(ft(Ee({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e}},n),{selectionType:Uf}))}function Oae(t){let e=tr(t,[]);return new bo(ft(Ee({className:"highlight"},e),{selectionType:Uf}))}function Nae(t){let r=t,{columnClassName:e}=r,n=tr(r,["columnClassName"]);return new bo(ft(Ee({className:e},n),{selectionType:dO}))}function Pae(t){let r=t,{cellCornerVisible:e}=r,n=tr(r,["cellCornerVisible"]);return new bo(ft(Ee({className:"current",headerAttributes:[rw()],border:{width:2,color:"#4b89ff",cornerVisible:e}},n),{selectionType:tg}))}function kae(t){let i=t,{border:e,visualCellRange:n}=i,r=tr(i,["border","visualCellRange"]);return new bo(ft(Ee(Ee({},e),r),{selectionType:hO}),n)}function Fae(t){let e=tr(t,[]);return new bo(ft(Ee({className:"fill",border:{width:1,color:"#ff0000"}},e),{selectionType:cO}))}function fW(t){let r=t,{headerClassName:e}=r,n=tr(r,["headerClassName"]);return new bo(ft(Ee({className:e},n),{selectionType:Bf}))}function Lae(t){let r=t,{rowClassName:e}=r,n=tr(r,["rowClassName"]);return new bo(ft(Ee({className:e},n),{selectionType:uO}))}var Hae;function eYe(t,e){tYe(t,e),e.add(t)}function tYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aa(t,e,n){return e=nYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nYe(t){var e=rYe(t,"string");return typeof e=="symbol"?e:String(e)}function rYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jd(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Du=new WeakSet;Hae=Symbol.iterator;var mW=class{constructor(e){eYe(this,Du),aa(this,"options",void 0),aa(this,"layerLevel",0),aa(this,"focus",void 0),aa(this,"fill",void 0),aa(this,"layeredAreas",new Map),aa(this,"areas",new Map),aa(this,"rowHeaders",new Map),aa(this,"columnHeaders",new Map),aa(this,"activeRowHeaders",new Map),aa(this,"activeColumnHeaders",new Map),aa(this,"activeCornerHeaders",new Map),aa(this,"rowHighlights",new Map),aa(this,"columnHighlights",new Map),aa(this,"customSelections",[]),this.options=e,this.focus=Pae(e),this.fill=Fae(e)}isEnabledFor(e,n){let r=e;e===tg&&(r="current");let i=this.options.disabledCellSelection(n.row,n.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(r)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return jd(this,Du,$d).call(this,this.layeredAreas,Mae)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return jd(this,Du,$d).call(this,this.areas,Oae)}getAreas(){return[...this.areas.values()]}createRowHeader(){return jd(this,Du,$d).call(this,this.rowHeaders,fW)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return jd(this,Du,$d).call(this,this.columnHeaders,fW)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return jd(this,Du,$d).call(this,this.activeRowHeaders,NO)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return jd(this,Du,$d).call(this,this.activeColumnHeaders,NO)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return jd(this,Du,$d).call(this,this.activeCornerHeaders,NO)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return jd(this,Du,$d).call(this,this.rowHighlights,Lae)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return jd(this,Du,$d).call(this,this.columnHighlights,Nae)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(kae(Ee(Ee({},this.options),e)))}clear(){this.focus.clear(),this.fill.clear(),Z(this.areas.values(),e=>void e.clear()),Z(this.layeredAreas.values(),e=>void e.clear()),Z(this.rowHeaders.values(),e=>void e.clear()),Z(this.columnHeaders.values(),e=>void e.clear()),Z(this.activeRowHeaders.values(),e=>void e.clear()),Z(this.activeColumnHeaders.values(),e=>void e.clear()),Z(this.activeCornerHeaders.values(),e=>void e.clear()),Z(this.rowHighlights.values(),e=>void e.clear()),Z(this.columnHighlights.values(),e=>void e.clear())}[Hae](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}};function $d(t,e){let n=this.layerLevel;if(t.has(n))return t.get(n);let r=e(Ee({layerLevel:n},this.options));return t.set(n,r),r}var Vae=mW;var KNt=Q(De(),1),XNt=Q(ze(),1),Uae;function Bae(t,e,n){return e=iYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iYe(t){var e=oYe(t,"string");return typeof e=="symbol"?e:String(e)}function oYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}Uae=Symbol.iterator;var pW=class{constructor(e){Bae(this,"ranges",[]),Bae(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(n=>n.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Uae](){return this.ranges[Symbol.iterator]()}},Wae=pW;var QNt=Q(De(),1);function _x(t,e){zae(t,e),e.add(t)}function gW(t,e,n){zae(t,e),e.set(t,n)}function zae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pn(t,e){var n=Yae(t,e,"get");return sYe(t,n)}function sYe(t,e){return e.get?e.get.call(t):e.value}function la(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function _W(t,e,n){var r=Yae(t,e,"set");return aYe(t,r,n),n}function Yae(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function aYe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var PO=new WeakMap,Jn=new WeakMap,Gf=new WeakMap,vW=new WeakSet,wW=new WeakSet,CW=new WeakSet,yW=new WeakSet,lg=new WeakSet,kO=class{constructor(e,n){_x(this,lg),_x(this,yW),_x(this,CW),_x(this,wW),_x(this,vW),gW(this,PO,{writable:!0,value:void 0}),gW(this,Jn,{writable:!0,value:void 0}),gW(this,Gf,{writable:!0,value:{x:0,y:0}}),_W(this,PO,e),_W(this,Jn,n)}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;la(this,vW,jae).call(this,{x:Pn(this,Jn).navigableHeaders()?Pn(this,Jn).countRowHeaders():0,y:Pn(this,Jn).navigableHeaders()?Pn(this,Jn).countColHeaders():0});let i=Pn(this,Jn).createCellCoords(e,n),o=Pn(this,PO).current().highlight,s=Pn(this,Jn).visualToRenderableCoords(o),a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),s.row!==null&&s.col!==null){let{width:c,height:u}=la(this,CW,qae).call(this),{row:d,col:h}=la(this,yW,Gae).call(this,o),f=Pn(this,Jn).fixedRowsBottom(),p=Pn(this,Jn).minSpareRows(),g=Pn(this,Jn).minSpareCols(),w=Pn(this,Jn).autoWrapRow(),_=Pn(this,Jn).autoWrapCol(),S=Pn(this,Jn).createCellCoords(d+i.row,h+i.col);if(S.row>=u){let k=ks(r&&p>0&&f===0),b=S.col+1,C=Pn(this,Jn).createCellCoords(S.row-u,b>=c?b-c:b);this.runLocalHooks("beforeColumnWrap",k,la(this,lg,Nw).call(this,C),b>=c),k.value?this.runLocalHooks("insertRowRequire",Pn(this,Jn).countRenderableRows()):_&&S.assign(C)}else if(S.row<0){let k=ks(_),b=S.col-1,C=Pn(this,Jn).createCellCoords(u+S.row,b<0?c+b:b);this.runLocalHooks("beforeColumnWrap",k,la(this,lg,Nw).call(this,C),b<0),_&&S.assign(C)}if(S.col>=c){let k=ks(r&&g>0),b=S.row+1,C=Pn(this,Jn).createCellCoords(b>=u?b-u:b,S.col-c);this.runLocalHooks("beforeRowWrap",k,la(this,lg,Nw).call(this,C),b>=u),k.value?this.runLocalHooks("insertColRequire",Pn(this,Jn).countRenderableColumns()):w&&S.assign(C)}else if(S.col<0){let k=ks(w),b=S.row-1,C=Pn(this,Jn).createCellCoords(b<0?u+b:b,c+S.col);this.runLocalHooks("beforeRowWrap",k,la(this,lg,Nw).call(this,C),b<0),w&&S.assign(C)}let{rowDir:x,colDir:P}=la(this,wW,$ae).call(this,S);a=x,l=P,o=la(this,lg,Nw).call(this,S)}return this.runLocalHooks("afterTransformStart",o,a,l),o}transformEnd(e,n){la(this,vW,jae).call(this,{x:Pn(this,Jn).navigableHeaders()?Pn(this,Jn).countRowHeaders():0,y:Pn(this,Jn).navigableHeaders()?Pn(this,Jn).countColHeaders():0});let r=Pn(this,Jn).createCellCoords(e,n),i=Pn(this,PO).current(),o=Pn(this,Jn).visualToRenderableCoords(i.highlight),s=i.to.clone(),a=0,l=0;if(this.runLocalHooks("beforeTransformEnd",r),o.row!==null&&o.col!==null){let{row:c,col:u}=la(this,yW,Gae).call(this,i.to),d=Pn(this,Jn).createCellCoords(c+r.row,u+r.col),{rowDir:h,colDir:f}=la(this,wW,$ae).call(this,d);a=h,l=f;let p=la(this,lg,Nw).call(this,d);r.row===0&&r.col!==0?s.col=p.col:r.row!==0&&r.col===0?s.row=p.row:(s.row=p.row,s.col=p.col)}return this.runLocalHooks("afterTransformEnd",s,a,l),s}};function jae(t){let{x:e,y:n}=t;_W(this,Gf,{x:e,y:n})}function $ae(t){let{width:e,height:n}=la(this,CW,qae).call(this),r=0,i=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=n&&(r=1,t.row=n-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:r,colDir:i}}function qae(){return{width:Pn(this,Gf).x+Pn(this,Jn).countRenderableColumns(),height:Pn(this,Gf).y+Pn(this,Jn).countRenderableRows()}}function Gae(t){let{row:e,col:n}=Pn(this,Jn).visualToRenderableCoords(t);return Pn(this,Jn).createCellCoords(Pn(this,Gf).y+e,Pn(this,Gf).x+n)}function Nw(t){let e=t.clone();return e.col=t.col-Pn(this,Gf).x,e.row=t.row-Pn(this,Gf).y,Pn(this,Jn).renderableToVisualCoords(e)}Jt(kO,xr);var Kae=kO;var nPt=Q(De(),1),rPt=Q(ze(),1);var Cx=0,Sx=1,Zae=2,EW=3,lYe=[EW,Zae],cYe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],SW=Symbol("root"),Xae=Symbol("child");function Gd(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:SW;if(e!==SW&&e!==Xae)throw new Error("The second argument is used internally only and cannot be overwritten.");let n=Array.isArray(t),r=e===SW,i=Cx;if(n){let o=t[0];t.length===0?i=Sx:r&&o instanceof Zp?i=EW:r&&Array.isArray(o)?i=Gd(o,Xae):t.length>=2&&t.length<=4&&!t.some((a,l)=>!cYe[l].includes(typeof a))&&(i=Zae)}return i}function zf(t){let{createCellCoords:e,createCellRange:n,keepDirection:r=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!lYe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){let s=t===EW,a=s?o.from.row:o[0],l=s?o.from.col:o[1],c=s?o.to.row:o[2],u=s?o.to.col:o[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof u=="string"&&(u=i(u))),mn(c)&&(c=a),mn(u)&&(u=l),!r){let f=a,p=l,g=c,w=u;a=Math.min(f,g),l=Math.min(p,w),c=Math.max(f,g),u=Math.max(p,w)}let d=e(a,l),h=e(c,u);return n(d,d,h)}}function Qae(t){let e=Gd(t.getSelected());if(e===Cx||e===Sx)return[];let n=zf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;Z(t.getSelected(),s=>{let{from:a,to:l}=n(s),c=Math.max(a.col,0),u=l.col-c+1;Z(Array.from(new Array(u),(d,h)=>c+h),d=>{r.has(d)||r.add(d)})});let i=Array.from(r).sort((s,a)=>s-a);return or(i,(s,a,l,c)=>(l!==0&&a===c[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function Jae(t){let e=Gd(t.getSelected());if(e===Cx||e===Sx)return[];let n=zf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;Z(t.getSelected(),s=>{let{from:a,to:l}=n(s),c=Math.max(a.row,0),u=l.row-c+1;Z(Array.from(new Array(u),(d,h)=>c+h),d=>{r.has(d)||r.add(d)})});let i=Array.from(r).sort((s,a)=>s-a);return or(i,(s,a,l,c)=>(l!==0&&a===c[l-1]+1?s[s.length-1][1]+=1:s.push([a,1]),s),[])}function uYe(t,e,n){dYe(t,e),e.set(t,n)}function dYe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yf(t,e,n){return e=hYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hYe(t){var e=fYe(t,"string");return typeof e=="symbol"?e:String(e)}function fYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ele(t,e,n){var r=nle(t,e,"set");return mYe(t,r,n),n}function mYe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function tle(t,e){var n=nle(t,e,"get");return pYe(t,n)}function nle(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pYe(t,e){return e.get?e.get.call(t):e.value}var Ex=new WeakMap,FO=class{constructor(e,n){var r=this;Yf(this,"settings",void 0),Yf(this,"tableProps",void 0),Yf(this,"inProgress",!1),Yf(this,"selectedRange",new Wae((i,o,s)=>this.tableProps.createCellRange(i,o,s))),Yf(this,"highlight",void 0),Yf(this,"transformation",void 0),Yf(this,"selectedByRowHeader",new Set),Yf(this,"selectedByColumnHeader",new Set),uYe(this,Ex,{writable:!0,value:!1}),this.settings=e,this.tableProps=n,this.highlight=new Vae({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[rw()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,o)=>this.tableProps.isDisabledCellSelection(i,o),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),createCellRange:(i,o,s)=>this.tableProps.createCellRange(i,o,s)}),this.transformation=new Kae(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,o)=>this.tableProps.createCellCoords(i,o),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformStart",...o)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformStart",...o)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeModifyTransformEnd",...o)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("afterModifyTransformEnd",...o)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertRowRequire",...o)}),this.transformation.addLocalHook("insertColRequire",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("insertColRequire",...o)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeRowWrap",...o)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.runLocalHooks("beforeColumnWrap",...o)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,o=this.settings.selectionMode==="multiple",s=mn(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${r?"Only":""}`,a),(!o||o&&!s&&mn(n))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;let n=e.clone(),r=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||i>0)&&(r===0&&n.col<0&&!o||i===0&&n.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",n),this.begin();let s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(n),r>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");let a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(tg,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);let l=this.getLayerLevel();l<this.highlight.layerLevel&&(Z(this.highlight.getAreas(),S=>void S.clear()),Z(this.highlight.getLayeredAreas(),S=>void S.clear()),Z(this.highlight.getRowHeaders(),S=>void S.clear()),Z(this.highlight.getColumnHeaders(),S=>void S.clear()),Z(this.highlight.getActiveRowHeaders(),S=>void S.clear()),Z(this.highlight.getActiveColumnHeaders(),S=>void S.clear()),Z(this.highlight.getActiveCornerHeaders(),S=>void S.clear()),Z(this.highlight.getRowHighlights(),S=>void S.clear()),Z(this.highlight.getColumnHighlights(),S=>void S.clear())),this.highlight.useLayerLevel(l);let c=this.highlight.createArea(),u=this.highlight.createLayeredArea(),d=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),f=this.highlight.createActiveRowHeader(),p=this.highlight.createActiveColumnHeader(),g=this.highlight.createActiveCornerHeader(),w=this.highlight.createRowHighlight(),_=this.highlight.createColumnHighlight();if(c.clear(),u.clear(),d.clear(),h.clear(),f.clear(),p.clear(),g.clear(),w.clear(),_.clear(),this.highlight.isEnabledFor(Uf,s.highlight)&&(this.isMultiple()||l>=1)&&(c.add(s.from).add(s.to).commit(),u.add(s.from).add(s.to).commit(),l===1)){let S=this.selectedRange.previous();this.highlight.useLayerLevel(l-1),this.highlight.createArea().add(S.from).commit().syncWith(S),this.highlight.createLayeredArea().add(S.from).commit().syncWith(S),this.highlight.useLayerLevel(l)}if(this.highlight.isEnabledFor(Bf,s.highlight)){if(!s.isSingleHeader()){let P=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),k=this.tableProps.createCellCoords(s.to.row,-1),b=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),C=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(d.add(P).commit(),h.add(b).commit(),w.add(P).commit(),_.add(b).commit()):(d.add(P).add(k).commit(),h.add(b).add(C).commit(),w.add(P).add(k).commit(),_.add(b).add(C).commit())}let S=!tle(this,Ex)&&this.isEntireRowSelected()&&(i>0&&i===s.getWidth()||i===0&&this.isSelectedByRowHeader()),x=!tle(this,Ex)&&this.isEntireColumnSelected()&&(r>0&&r===s.getHeight()||r===0&&this.isSelectedByColumnHeader());S&&f.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),x&&p.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),S&&x&&g.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){let e=ks(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,n,r))}transformEnd(e,n){this.setRangeEnd(this.transformation.transformEnd(e,n))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel(),n=i=>{let{col:o}=i.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&o<0||s===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));let r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel(),n=i=>{let{row:o}=i.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&o<0||s===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>n(i));let r=this.selectedRange.peekByIndex(e);return r?n(r):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){let n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},o=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),c=r?-l:0,u=n?-a:0;if(c===0&&u===0&&(o===0||s===0))return;let d=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight,{focusPosition:h,disableHeadersHighlight:f}=i;ele(this,Ex,f),h&&Number.isInteger(h?.row)&&Number.isInteger(h?.col)&&(d=this.tableProps.createCellCoords(eo(h.row,c,o-1),eo(h.col,u,s-1)));let p=this.tableProps.createCellCoords(c,u),g=this.tableProps.createCellCoords(o-1,s-1);this.clear(),this.setRangeStartOnly(p,void 0,d),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),ele(this,Ex,!1)}selectCells(e){var n=this;let r=Gd(e);if(r===Sx)return!1;if(r===Cx)throw new Error(Qt`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let i=zf(r,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),o=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},a=!e.some(l=>{let c=i(l),u=c.isValid(s);return!(u&&!c.containsHeaders()||u&&c.containsHeaders()&&c.isSingleHeader())});return a&&(this.clear(),Z(e,l=>{let{from:c,to:u}=i(l);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(u.clone()),this.finish()})),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,s=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),c=l===0?0:-l,u=this.tableProps.createCellCoords(c,i),d=this.tableProps.createCellCoords(s-1,o),h=this.tableProps.createCellRange(u,u,d).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:l});if(h){let f=l===0?0:eo(r,c,-1),p=s-1,g=this.tableProps.createCellCoords(f,i),w=this.tableProps.createCellCoords(p,o),_=this.tableProps.createCellCoords(eo(r,c,s-1),i);this.runLocalHooks("beforeSelectColumns",g,w,_),g.row=f,w.row=p,this.setRangeStartOnly(g,void 0,_),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(w),this.runLocalHooks("afterSelectColumns",g,w,_),this.finish()}return h}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,l=this.tableProps.createCellCoords(e,a),c=this.tableProps.createCellCoords(n,o-1),u=this.tableProps.createCellRange(l,l,c).isValid({countRows:i,countCols:o,countRowHeaders:s,countColHeaders:0});if(u){let d=s===0?0:eo(r,a,-1),h=o-1,f=this.tableProps.createCellCoords(e,d),p=this.tableProps.createCellCoords(n,h),g=this.tableProps.createCellCoords(e,eo(r,a,o-1));this.runLocalHooks("beforeSelectRows",f,p,g),f.col=d,p.col=h,this.setRangeStartOnly(f,void 0,g),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(p),this.runLocalHooks("afterSelectRows",f,p,g),this.finish()}return u}refresh(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;let n=this.highlight.getFocus(),r=this.getLayerLevel();n.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);let o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),d=this.highlight.createActiveCornerHeader(),h=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();o.commit(),s.commit(),a.commit(),l.commit(),c.commit(),u.commit(),d.commit(),h.commit(),f.commit()}this.highlight.useLayerLevel(r)}};Jt(FO,xr);var xW=FO;var DPt=Q(De(),1),IPt=Q(ze(),1);var rle=/^(\r\n|\n\r|\r|\n)/,gYe=/^[^\t\r\n]+/,ile=/^\t/;function bW(t){let e=[[""]];if(t.length===0)return e;let n=0,r=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(ile))t=t.replace(ile,""),n+=1,e[r][n]="";else if(t.match(rle))t=t.replace(rle,""),n=0,r+=1,e[r]=[""];else{let o="";if(t.startsWith('"')){let s=0,a=!0;for(;a;){let l=t.slice(0,1);l==='"'&&(s+=1),o+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&s%2===0)&&(a=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{let s=t.match(gYe);o=s?s[0]:"",t=t.slice(o.length)}e[r][n]=o}return e}function qf(t){let e,n,r,i,o="",s;for(e=0,n=t.length;e<n;e+=1){for(i=t[e].length,r=0;r<i;r+=1)r>0&&(o+="	"),s=t[e][r],typeof s=="string"?s.indexOf(`
`)>-1?o+=`"${s.replace(/"/g,'""')}"`:o+=s:s==null?o+="":o+=s;e!==n-1&&(o+=`
`)}return o}function cg(t,e,n){return e=vYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vYe(t){var e=wYe(t,"string");return typeof e=="symbol"?e:String(e)}function wYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var TW=class t{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,r){cg(this,"hot",void 0),cg(this,"metaManager",void 0),cg(this,"tableMeta",void 0),cg(this,"dataSource",void 0),cg(this,"duckSchema",void 0),cg(this,"colToPropCache",void 0),cg(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=n,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){let e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let n=this.tableMeta.columns,r;if(this.colToPropCache=[],this.propToColCache=new Map,n){let i=0,o=0,s=!1;if(typeof n=="function"){let a=cw(e);i=a>0?a:this.countFirstRowKeys(),s=!0}else{let a=this.tableMeta.maxCols;i=Math.min(a,n.length)}for(r=0;r<i;r++){let a=s?n(r):n[r];if(Tt(a)){if(typeof a.data<"u"){let l=s?o:r;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return SO(this.dataSource)}recursiveDuckColumns(e,n,r){let i=n,o=r,s;return typeof i>"u"&&(i=0,o=""),typeof e=="object"&&!Array.isArray(e)&&Rt(e,(a,l)=>{a===null?(s=o+l,this.colToPropCache.push(s),this.propToColCache.set(s,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;let n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&Ze(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){let n=this.propToColCache.get(e);if(Ze(n))return this.hot.toVisualColumn(n);let r=this.hot.toVisualColumn(e);return r===null?e:r}getSchema(){let e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?zp(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=this.hot.countSourceRows(),s=o,a=0,l=e;if((typeof l!="number"||l>=o)&&(l=o),l<this.hot.countRows()&&(s=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,r)===!1||s===null)return{delta:0};let u=this.tableMeta.maxRows,d=this.getSchema().length,h=[];for(;a<n&&o+a<u;){let p=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?p=vi(this.getSchema()):(p=[],st(d-1,()=>p.push(null))):this.hot.dataType==="function"?p=this.tableMeta.dataSchema(l+a):(p={},Yp(p,this.getSchema())),h.push(p),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(s=Math.min(s+1,o)),this.spliceData(s,0,h);let f=this.hot.toVisualRow(s);return this.hot.countSourceRows()===h.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):r!=="auto"&&this.metaManager.createRow(s,n)),this.hot.runHooks("afterCreateRow",f,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:r,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let o=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,n,r)===!1)return{delta:0};let u=a;l<this.hot.countCols()&&(u=this.hot.toPhysicalColumn(l));let d=this.hot.countSourceRows(),h=this.hot.countCols(),f=0,p=u;i==="end"&&(p=Math.min(p+1,a));let g=p;for(;f<n&&h<s;){if(typeof l!="number"||l>=h)if(d>0)for(let _=0;_<d;_+=1)typeof o[_]>"u"&&(o[_]=[]),o[_].push(null);else o.push([null]);else for(let _=0;_<d;_++)o[_].splice(p,0,null);f+=1,p+=1,h+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):r!=="auto"&&this.metaManager.createColumn(g,n));let w=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",w,f,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:g}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-n,o=this.visualRowsToPhysical(i,n),s=this.hot.countSourceRows();if(i=(s+i)%s,this.hot.runHooks("beforeRemoveRow",i,o.length,o,r)===!1)return!1;let l=o.length;if(this.filterData(i,l,o),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);let u=Ze(this.tableMeta.columns)||Ze(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&u===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((u,d)=>d-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.hot.runHooks("afterRemoveRow",i,l,o,r),this.hot.forceFullRender=!0,!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-n:e;i=(this.hot.countCols()+i)%this.hot.countCols();let o=this.visualColumnsToPhysical(i,n),s=o.slice(0).sort((d,h)=>h-d);if(this.hot.runHooks("beforeRemoveCol",i,n,o,r)===!1)return!1;let l=!0,c=s.length,u=this.dataSource;for(let d=0;d<c;d++)l&&o[0]!==o[d]-d&&(l=!1);if(l)for(let d=0,h=this.hot.countSourceRows();d<h;d++)u[d].splice(o[0],n),d===0&&this.metaManager.removeColumn(o[0],n);else for(let d=0,h=this.hot.countSourceRows();d<h;d++)for(let f=0;f<c;f++)u[d].splice(s[f],1),d===0&&this.metaManager.removeColumn(s[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,n,o,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,n,r){let i=this.hot.getDataAtCol(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];N4(l,s);let u=0;for(;u<r;)l.push(null),u+=1;return _ie(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),o}spliceRow(e,n,r){let i=this.hot.getSourceDataAtRow(e),o=i.slice(n,n+r),s=i.slice(n+r);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];N4(l,s);let u=0;for(;u<r;)l.push(null),u+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),o}spliceData(e,n,r){if(this.hot.runHooks("beforeDataSplice",e,n,r)!==!1){let o=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(s=>this.dataSource.push(s))}}filterData(e,n,r){let i=this.hot.runHooks("filterData",e,n,r);Array.isArray(i)===!1&&(i=this.dataSource.filter((o,s)=>r.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,n){let r=this.hot.toPhysicalRow(e),i=this.dataSource[r],o=this.hot.runHooks("modifyRowData",r);i=isNaN(o)?o:i;let s=null;if(i&&i.hasOwnProperty&&Kn(i,n))s=i[n];else if(typeof n=="string"&&n.indexOf(".")>-1){let a=n.split("."),l=i;if(!l)return null;for(let c=0,u=a.length;c<u;c++)if(l=l[a[c]],typeof l>"u")return null;s=l}else typeof n=="function"&&(s=n(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){let a=ks(s);this.hot.runHooks("modifyData",r,this.propToCol(n),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,r){let i=this.hot.toPhysicalRow(e),o=r,s=this.dataSource[i],a=this.hot.runHooks("modifyRowData",i);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){let l=ks(o);this.hot.runHooks("modifyData",i,this.propToCol(n),l,"set"),l.isTouched()&&(o=l.value)}if(s&&s.hasOwnProperty&&Kn(s,n))s[n]=o;else if(typeof n=="string"&&n.indexOf(".")>-1){let l=n.split("."),c=s,u=0,d;for(u=0,d=l.length-1;u<d;u++)typeof c[l[u]]>"u"&&(c[l[u]]={}),c=c[l[u]];c[l[u]]=o}else typeof n=="function"?n(this.dataSource.slice(i,i+1)[0],o):s[n]=o}visualRowsToPhysical(e,n){let r=this.hot.countSourceRows(),i=[],o=(r+e)%r,s=n,a;for(;o<r&&s;)a=this.hot.toPhysicalRow(o),i.push(a),s-=1,o+=1;return i}visualColumnsToPhysical(e,n){let r=this.hot.countCols(),i=[],o=(r+e)%r,s=n;for(;o<r&&s;){let a=this.hot.toPhysicalColumn(o);i.push(a),s-=1,o+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){let e=this.tableMeta.maxRows,n;e<0||e===0?n=0:n=e||1/0;let r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,n)}getAll(){let e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,t.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,r){let i=[],o,s,a,l=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(l===0||c===0)return[];let u=r===t.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,d=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),h=Math.min(Math.max(c-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=d;o++){a=[];let f=o>=0?this.hot.toPhysicalRow(o):o;for(s=Math.min(e.col,n.col);s<=h&&f!==null;s++)a.push(u.call(this,o,this.colToProp(s)));f!==null&&i.push(a)}return i}getText(e,n){return qf(this.getRange(e,n,t.DESTINATION_RENDERER))}getCopyableText(e,n){return qf(this.getRange(e,n,t.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}},ole=TW;var bkt=Q(De(),1);var QPt=Q(De(),1);var GPt=Q(De(),1);var LPt=Q(De(),1);var{register:yYe,getItem:_Ye,hasItem:RW,getNames:WPt,getValues:jPt}=Ri("cellTypes");function sle(t){if(!RW(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return _Ye(t)}function ka(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);let{editor:n,renderer:r,validator:i}=e;n&&Fs(t,n),r&&wc(t,r),i&&Kp(t,i),yYe(t,e)}function CYe(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!Kn(e,t)}function Kf(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,r=typeof e.type=="string"?sle(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Rt(e,(o,s)=>void t._automaticallyAssignedMetaProps.delete(s)),!Tt(r))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);let i={};Rt(r,(o,s)=>{if(CYe(s,n)){var a;i[s]=o,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Ln(t,i)}function ale(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}wu(n,t);for(let r=0;r<e.length;r++)n.prototype[e[r]]=void 0;return n}function Pw(t){return Number.isInteger(t)&&t>=0}function kw(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function xx(t){return t==null}var bx=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,r;for(e=0,n=this.countRows();e<n;e++)if(r=this.getDataAtCell(e,t),Er(r)===!1)return!1;return!0},isEmptyRow(t){let e,n,r,i;for(e=0,n=this.countCols();e<n;e++)if(r=this.getDataAtCell(t,e),Er(r)===!1)return typeof r=="object"?(i=this.getCellMeta(t,e),lw(this.getSchema()[i.prop],r)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function lle(t,e,n){return e=SYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SYe(t){var e=EYe(t,"string");return typeof e=="symbol"?e:String(e)}function EYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xYe(){return class{}}var LO=class{constructor(e){lle(this,"metaCtor",xYe()),lle(this,"meta",void 0),this.meta=this.metaCtor.prototype,Ln(this.meta,bx()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Ln(this.meta,e),Kf(this.meta,ft(Ee({},e),{type:(n=e.type)!==null&&n!==void 0?n:this.meta.type}),e)}};var okt=Q(De(),1);function bYe(t,e,n){return e=TYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TYe(t){var e=RYe(t,"string");return typeof e=="symbol"?e:String(e)}function RYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var HO=class{constructor(e){bYe(this,"meta",void 0);let n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Ln(this.meta,e),Kf(this.meta,e,e)}};var mkt=Q(De(),1);var ckt=Q(De(),1),ukt=Q(ze(),1);var cle;function VO(t,e,n){return e=DYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DYe(t){var e=IYe(t,"string");return typeof e=="symbol"?e:String(e)}function IYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}cle=Symbol.iterator;var Xf=class{constructor(e){VO(this,"valueFactory",void 0),VO(this,"data",[]),VO(this,"index",[]),VO(this,"holes",new Set),this.valueFactory=e}obtain(e){kw(()=>Pw(e),"Expecting an unsigned number.");let n=this._getStorageIndexByKey(e),r;if(n>=0)r=this.data[n],r===void 0&&(r=this.valueFactory(e),this.data[n]=r);else if(r=this.valueFactory(e),this.holes.size>0){let i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=r,this.index[e]=i}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;kw(()=>Pw(e)||xx(e),"Expecting an unsigned number or null/undefined argument.");let r=[],i=this.data.length;for(let s=0;s<n;s++)r.push(i+s),this.data.push(void 0);let o=xx(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...r,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;kw(()=>Pw(e)||xx(e),"Expecting an unsigned number or null/undefined argument.");let r=this.index.splice(xx(e)?this.index.length-n:e,n);for(let i=0;i<r.length;i++){let o=r[i];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return gi(this.data,(e,n)=>!this.holes.has(n))[Symbol.iterator]()}entries(){let e=[];for(let r=0;r<this.data.length;r++){let i=this._getKeyByStorageIndex(r);i!==-1&&e.push([i,this.data[r]])}let n=0;return{next:()=>{if(n<e.length){let r=e[n];return n+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[cle](){return this.entries()}};function ule(t,e,n){return e=AYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AYe(t){var e=MYe(t,"string");return typeof e=="symbol"?e:String(e)}function MYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var OYe=["data","width"],BO=class{constructor(e){ule(this,"globalMeta",void 0),ule(this,"metas",new Xf(()=>this._createMeta())),this.globalMeta=e,this.metas=new Xf(()=>this._createMeta())}updateMeta(e,n){let r=this.getMeta(e);Ln(r,n),Kf(r,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return ale(this.globalMeta.getMetaConstructor(),OYe).prototype}};var ykt=Q(ze(),1),_kt=Q(De(),1);function dle(t,e,n){return e=NYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NYe(t){var e=PYe(t,"string");return typeof e=="symbol"?e:String(e)}function PYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var UO=class{constructor(e){dle(this,"columnMeta",void 0),dle(this,"metas",new Xf(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,r){let i=this.getMeta(e,n);Ln(i,r),Kf(i,r)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,n)}getMeta(e,n,r){let i=this.metas.obtain(e).obtain(n);return r===void 0?i:i[r]}setMeta(e,n,r,i){var o;let s=this.metas.obtain(e).obtain(n);(o=s._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(r),s[r]=i}removeMeta(e,n,r){let i=this.metas.obtain(e).obtain(n);delete i[r]}getMetas(){let e=[],n=Array.from(this.metas.values());for(let r=0;r<n.length;r++)e.push(...n[r].values());return e}getMetasAtRow(e){kw(()=>Pw(e),"Expecting an unsigned number.");let n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Xf(e=>this._createMeta(e))}_createMeta(e){let n=this.columnMeta.getMetaConstructor(e);return new n}};var Fw=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new LO(e),this.tableMeta=new HO(this.globalMeta),this.columnMeta=new BO(this.globalMeta),this.cellMeta=new UO(this.columnMeta),r.forEach(i=>new i(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,r){let{visualRow:i,visualColumn:o}=r,s=this.cellMeta.getMeta(e,n);return s.visualRow=i,s.visualCol=o,s.row=e,s.col=n,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,n,r){if(typeof r!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,r)}setCellMeta(e,n,r,i){this.cellMeta.setMeta(e,n,r,i)}updateCellMeta(e,n,r){this.cellMeta.updateMeta(e,n,r)}removeCellMeta(e,n,r){this.cellMeta.removeMeta(e,n,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}};Jt(Fw,xr);var Nkt=Q(ze(),1),Pkt=Q(De(),1);function WO(t,e,n,r){let{hotInstance:i,dataMap:o,dataSource:s,internalSource:a,source:l,metaManager:c,firstRun:u}=r,d=Uo(a),h=i.getSettings();Array.isArray(h.dataSchema)?i.dataType="array":xn(h.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),t=i.runHooks(`before${d}`,t,u,l);let f=new ole(i,t,c);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){let p=f.getSchema();t=[];let g,w=0,_=0;for(w=0,_=h.startRows;w<_;w++)if((i.dataType==="object"||i.dataType==="function")&&h.dataSchema)g=vi(p),t.push(g);else if(i.dataType==="array")g=vi(p[0]),t.push(g);else{g=[];for(let S=0,x=h.startCols;S<x;S++)g.push(null);t.push(g)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),h.data=t,f.dataSource=t,s.data=t,s.dataType=i.dataType,s.colToProp=f.colToProp.bind(f),s.propToCol=f.propToCol.bind(f),s.countCachedColumns=f.countCachedColumns.bind(f),n(f),i.runHooks(`after${d}`,t,u,l),u||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&vt(i.rootElement,[fM(-1),tw(i.countCols()+(i.view?i.countRowHeaders():0))])}var Wkt=Q(De(),1);function hle(t,e,n){return e=kYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kYe(t){var e=FYe(t,"string");return typeof e=="symbol"?e:String(e)}function FYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Tx=class{constructor(e){hle(this,"metaManager",void 0),hle(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",n=>this.extendCellMeta(n)),ot.getSingleton().add("beforeRender",n=>{n&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;let{row:r,col:i}=e;if((n=this.metaSyncMemo.get(r))!==null&&n!==void 0&&n.has(i))return;let{visualRow:o,visualCol:s}=e,a=this.metaManager.hot,l=a.colToProp(s);e.prop=l,a.runHooks("beforeGetCellMeta",o,s,e);let c=Kn(e,"type")?e.type:null,u=xn(e.cells)?e.cells(r,i,l):null;if(c)if(u){var d;u.type=(d=u.type)!==null&&d!==void 0?d:c}else u={type:c};u&&this.metaManager.updateCellMeta(r,i,u),a.runHooks("afterGetCellMeta",o,s,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(i)}};var Ykt=Q(De(),1);function DW(t,e,n){return e=LYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LYe(t){var e=HYe(t,"string");return typeof e=="symbol"?e:String(e)}function HYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Rx=class{constructor(e){DW(this,"metaManager",void 0),DW(this,"usageTracker",new Set),DW(this,"propDescriptors",new Map([["ariaTags",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(n,r,i){if(!i)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{let{target:r,onChange:i=()=>{}}=e,o=typeof r=="string",s=o?r:n,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(n,a,i),o&&this.installPropWatcher(r,a,i)})}installPropWatcher(e,n,r){let i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){let s=!i.usageTracker.has(e);i.usageTracker.add(e),r.call(i,e,o,s),this[n]=o},enumerable:!0,configurable:!0})}};var jO="gridDefault",Lw="editorManager.handlingEditor";var fle={name:"editorCloseAndSave",callback(t,e,n){let r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(n.includes("shift"))}};var mle={name:"editorCloseWithoutSaving",callback(t){let e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}};var ple={name:"editorFastOpen",callback(t,e){let{highlight:n}=t.getSelectedRangeLast();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}};var gle={name:"editorOpen",callback(t,e,n){let r=t._getEditorManager(),{highlight:i}=t.getSelectedRangeLast();i.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter():r.openEditor(null,e,!0):r.moveSelectionAfterEnter(n.includes("shift")),wi(e))}};function vle(){return[fle,mle,ple,gle]}var wle={name:"extendCellsSelectionDown",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}};var yle={name:"extendCellsSelectionDownByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),n=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,-1);if(r!==null){let i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.min(i.row-o,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};var _le={name:"extendCellsSelectionLeft",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}};var Cle={name:"extendCellsSelectionRight",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}};var Sle={name:"extendCellsSelectionToColumns",callback(t){let{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(n.col,r.col,e.row)}};var Ele={name:"extendCellsSelectionToMostBottom",callback(t){let{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){let a=n.getNearestNotHiddenIndex(t.countRows()-1,-1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}};var xle={name:"extendCellsSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}};var ble={name:"extendCellsSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:n}=t,{highlight:r}=t.getSelectedRangeLast();r.isCell()&&e.setRangeEnd(t._createCellCoords(e.selectedRange.current().from.row,n.getNearestNotHiddenIndex(0,1)))}};var Tle={name:"extendCellsSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){let a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}};var Rle={name:"extendCellsSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByColumnHeader();if(r.isCell()||s){let a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);e.setRangeStart(i.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,a))}}};var Dle={name:"extendCellsSelectionToMostTop",callback(t){let{selection:e,rowIndexMapper:n}=t,{highlight:r,from:i,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&t.selection.isSelectedByRowHeader();if(r.isCell()||s){let a=n.getNearestNotHiddenIndex(0,1);e.setRangeStart(i.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,o.col))}}};var Ile={name:"extendCellsSelectionToRows",callback(t){let{highlight:e,from:n,to:r}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(n.row,r.row,e.col)}};var Ale={name:"extendCellsSelectionUp",callback(t){let{highlight:e}=t.getSelectedRangeLast();(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}};var Mle={name:"extendCellsSelectionUpByViewportHeight",callback(t){let{to:e}=t.getSelectedRangeLast(),n=Math.max(e.row-t.countVisibleRows(),0),r=t.rowIndexMapper.getNearestNotHiddenIndex(n,1);if(r!==null){let i=t._createCellCoords(r,e.col),o=e.row-t.view.getFirstFullyVisibleRow(),s=Math.max(i.row-o,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Ole(){return[wle,yle,_le,Cle,Sle,Ele,xle,ble,Tle,Rle,Dle,Ile,Ale,Mle]}var Nle={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}};var Ple={name:"moveCellSelectionDownByViewportHeight",callback(t){let{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,i=t.countVisibleRows()+n;r===t.countRows()-1?i=1:r+i>t.countRows()&&(i=t.countRows()-r-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};var kle={name:"moveCellSelectionInlineEnd",callback(t,e){let n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(-r.row,-r.col)}};var Fle={name:"moveCellSelectionInlineStart",callback(t,e){let n=t.getSettings(),r=typeof n.tabMoves=="function"?n.tabMoves(e):n.tabMoves;t.selection.transformStart(r.row,r.col)}};var Lle={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}};var Hle={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}};var Vle={name:"moveCellSelectionToMostBottom",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,n=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);n===null&&(n=-1),t.selection.setRangeStart(t._createCellCoords(n,e))}};var Ble={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){let{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-i-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(o,s))}};var Ule={name:"moveCellSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:n}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1)))}};var Wle={name:"moveCellSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:n}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,o=n.getNearestNotHiddenIndex(r,1);e.setRangeStart(t._createCellCoords(i,o))}};var jle={name:"moveCellSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:n}=t,r=t.getSelectedRangeLast().highlight.row,i=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(r,i))}};var $le={name:"moveCellSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:n}=t,{row:r}=t.getSelectedRangeLast().highlight,i=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(r,i))}};var Gle={name:"moveCellSelectionToMostTop",callback(t){let{col:e}=t.getSelectedRangeLast().highlight,n=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);n===null&&(n=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(n,e))}};var zle={name:"moveCellSelectionToMostTopInlineStart",callback(t){let{selection:e,rowIndexMapper:n,columnIndexMapper:r}=t,i=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=n.getNearestNotHiddenIndex(i,1),a=r.getNearestNotHiddenIndex(o,1);e.setRangeStart(t._createCellCoords(s,a))}};var Yle={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}};var qle={name:"moveCellSelectionUpByViewportHight",callback(t){let{navigableHeaders:e}=t.getSettings(),n=e?t.countColHeaders():0,{row:r}=t.getSelectedRangeLast().highlight,i=-(t.countVisibleRows()+n);r===-n?i=-1:r+i<n&&(i=-(r+n)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function Kle(){return[Nle,Ple,kle,Fle,Lle,Hle,Vle,Ble,Ule,Wle,jle,$le,Gle,zle,Yle,qle]}var Xle={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}};var Zle={name:"scrollToFocusedCell",callback(t){let{highlight:e}=t.getSelectedRangeLast(),n=t.view.getFirstFullyVisibleRow()-1,r=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,o=t.view.getLastFullyVisibleColumn()+1,s=t._createCellCoords(n,r),a=t._createCellCoords(i,o);if(!t._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){let c={};if(e.col>=0){let u=Math.floor(t.countVisibleCols()/2);c.col=Math.max(e.col-u,0)}if(e.row>=0){let u=Math.floor(t.countVisibleRows()/2);c.row=Math.max(e.row-u,0)}t.scrollViewportTo(ft(Ee({},c),{verticalSnap:"top",horizontalSnap:"start"}))}}};var Qle={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}};var Jle={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}};var ece={name:"populateSelectedCellsData",callback(t){let e=t.getSelectedRange(),{row:n,col:r}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(n,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==r)){let{readOnly:c}=t.getCellMeta(a,l);c||o.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(o.values()))}};var VYe=[...vle(),...Ole(),...Kle(),Xle,Zle,Qle,Jle,ece];function $O(t){let e={};return VYe.forEach(n=>{let{name:r,callback:i}=n;e[r]=function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return i(t,...s)}}),e}function tce(t){let e=t.getShortcutManager().addContext("editor"),n=$O(t),r={group:Lw};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,o)=>n.editorCloseAndSave(i,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],r)}function nce(t){let e=t.getShortcutManager().addContext("grid"),n=$O(t),r={runOnlyIf:()=>{let{navigableHeaders:i}=t.getSettings();return Ze(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:jO};e.addShortcuts([{keys:[["F2"]],callback:i=>n.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,o)=>n.editorOpen(i,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Lw,runOnlyIf:()=>Ze(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>!t.getSelectedRangeLast().highlight.isHeader()&&t.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>n.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],r)}function rce(t){[tce,nce].forEach(e=>e(t))}function oce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=t.rootElement,r=ice(t),i=ice(t);return r.addEventListener("focus",()=>e?.onFocusFromTop()),i.addEventListener("focus",()=>e?.onFocusFromBottom()),n.firstChild.before(r),n.lastChild.after(i),{activate(){t._registerTimeout(()=>{r.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,i.tabIndex=-1},10)}}}function ice(t){let n=t.rootDocument.createElement("input");return n.type="text",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&vt(n,[Ps(),wo()]),n}function lce(t){let e,{activate:n,deactivate:r}=oce(t,{onFocusFromTop(){var c;let u=(c=e)!==null&&c!==void 0?c:sce(t);u&&(t.runHooks("modifyFocusOnTabNavigation","from_above",u),t.selectCell(u.row,u.col)),t.listen()},onFocusFromBottom(){var c;let u=(c=e)!==null&&c!==void 0?c:ace(t);u&&(t.runHooks("modifyFocusOnTabNavigation","from_below",u),t.selectCell(u.row,u.col)),t.listen()}}),i={wrapped:!1,flipped:!1},o=!0,s=!1;t.addHook("afterListen",()=>r()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(c,u,d,h,f)=>{if(s&&i.wrapped&&i.flipped&&(f.value=!0),o){var p;e=(p=t.getSelectedRangeLast())===null||p===void 0?void 0:p.highlight}}),t.addHook("beforeRowWrap",(c,u,d)=>{i.wrapped=!0,i.flipped=d});function a(){i.wrapped=!1,i.flipped=!1,t.deselectCell(),t.unlisten()}let l={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:jO,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([ft(Ee({},l),{callback:()=>{s=!0,t.getSelectedRangeLast()&&!t.getSettings().tabNavigation&&(o=!1)},position:"before"}),ft(Ee({},l),{callback:c=>{let{tabNavigation:u,autoWrapRow:d}=t.getSettings();if(s=!1,o=!0,!u||!t.selection.isSelected()||d&&i.wrapped&&i.flipped||!d&&i.wrapped)return d&&i.wrapped&&i.flipped&&(e=c.shiftKey?sce(t):ace(t)),a(),!1;c.preventDefault()},position:"after"})])}function sce(t){let{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:r}=t.getSettings(),i=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),o===0&&(o=n.getVisualFromRenderableIndex(o)),i===null||o===null?null:t._createCellCoords(i,o)}function ace(t){var e,n;let{rowIndexMapper:r,columnIndexMapper:i}=t,{navigableHeaders:o}=t.getSettings(),s=r.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(s<0){if(!o||t.countColHeaders()===0)return null;s=-1}if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=r.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(n=i.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}var vLt=Q(De(),1);var eLt=Q(De(),1),tLt=Q(ze(),1);var cce=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Dx=t=>t.map(e=>{let n=e.toLowerCase();return cce.has(n)?cce.get(n):n}).sort().join("+"),dce=t=>t.split("+"),uce=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),BYe=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),GO=t=>{let{key:e,code:n}=t,r=e;return uce.test(n)?r=n.replace(uce,"$1"):BYe.has(n)&&(r=n),r.toLowerCase()};var hce=Symbol("shortcut-context");function IW(t){return Tt(t)&&t.__kindOf===hce}var fce=t=>{let e=kf({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),n=function(){let{keys:l,callback:c,group:u,runOnlyIf:d=()=>!0,captureCtrl:h=!1,preventDefault:f=!0,stopPropagation:p=!1,relativeToGroup:g,position:w,forwardToContext:_}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(mn(u))throw new Error("You need to define the shortcut's group.");if(xn(c)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Qt`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let S={callback:c,group:u,runOnlyIf:d,captureCtrl:h,preventDefault:f,stopPropagation:p};Ze(g)&&([S.relativeToGroup,S.position]=[g,w]),IW(_)&&(S.forwardToContext=_),l.forEach(x=>{let P=Dx(x);if(e.hasItem(P)){let b=e.getItem(P),C=b.findIndex(N=>N.group===g);C!==-1?w==="before"?C-=1:C+=1:C=b.length,b.splice(C,0,S)}else e.addItem(P,[S])})},r=function(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(u=>{Rt(c,(d,h)=>{Object.prototype.hasOwnProperty.call(u,h)===!1&&(u[h]=c[h])}),n(u)})},i=l=>{let c=Dx(l);e.removeItem(c)};return{__kindOf:hce,addShortcut:n,addShortcuts:r,getShortcuts:l=>{let c=Dx(l),u=e.getItem(c);return Ze(u)?u.slice():[]},hasShortcut:l=>{let c=Dx(l);return e.hasItem(c)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(u=>{let[d,h]=u,f=h.filter(p=>p.group!==l);f.length===0?i(dce(d)):(h.length=0,h.push(...f))})}}};var uLt=Q(ze(),1);function mce(){let t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}var UYe=["meta","alt","shift","control"],Ix=mce(),zO=0;function pce(t,e,n,r,i){let o=f=>UYe.includes(f),s=function(f){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=[];return f.altKey&&g.push("alt"),p&&(f.ctrlKey||f.metaKey)?g.push("control/meta"):(f.ctrlKey&&g.push("control"),f.metaKey&&g.push("meta")),f.shiftKey&&g.push("shift"),g},a=f=>{if(e(f)===!1)return;let p=n(f);if(f.keyCode===229||p===!1||_u(f))return;let g=GO(f),w=[];o(g)||(w=s(f));let _=[g].concat(w);!i(f,_)&&(uw()&&w.includes("meta")||!uw()&&w.includes("control"))&&i(f,[g].concat(s(f,!0))),r(f)},l=f=>{let p=GO(f);o(p)&&Ix.press(p)},c=f=>{let p=GO(f);o(p)&&Ix.release(p)},u=()=>{Ix.releaseAll()};return{mount:()=>{let f=t;for(zO+=1;f;)zO===1&&(f.document.documentElement.addEventListener("keydown",l),f.document.documentElement.addEventListener("keyup",c)),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",u),f=$p(f)},unmount:()=>{let f=t;for(zO-=1;f;)zO===0&&(f.document.documentElement.removeEventListener("keydown",l),f.document.documentElement.removeEventListener("keyup",c)),f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",u),f=$p(f)},isPressed:f=>Ix.isPressed(f),releasePressedKeys:()=>Ix.releaseAll()}}var AW=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:r,afterKeyDown:i}=t,o=kf({errorIdExists:p=>`The "${p}" context name is already registered.`}),s="grid",a=p=>{let g=fce(p);return o.addItem(p,g),g},l=()=>s,c=p=>o.getItem(p),u=p=>{if(!o.hasItem(p))throw new Error(Qt`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=p},d=!1,h=function(p,g){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l(),_=IW(w)?w:c(w),S=!1;if(!_.hasShortcut(g))return S;let x=_.getShortcuts(g);for(let P=0;P<x.length;P++){let{callback:k,runOnlyIf:b,preventDefault:C,stopPropagation:N,captureCtrl:B,forwardToContext:Y}=x[P];if(b(p)===!0){if(d=B,S=k(p,g)===!1,d=!1,C&&p.preventDefault(),N&&(wi(p),p.stopPropagation()),S)break;Y&&h(p,g,Y)}}return S},f=pce(e,n,r,i,h);return f.mount(),{addContext:a,getActiveContextName:l,getContext:c,setActiveContextName:u,isCtrlPressed:()=>!d&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};var MW=null,OW=new Map;function YO(t,e){var n,r=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=!1,s=this,a=new ei(s),l,c,u,d,h,f=!0;oae(i)&&iae(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let p=(n=e?.layoutDirection)!==null&&n!==void 0?n:"inherit",g=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",g),this.isRtl=function(){return g==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=Aae(e.language);let w=new Fw(s,e,[Tx,Rx]),_=w.getTableMeta(),S=w.getGlobalMeta(),x=kf();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Rw(this)&&Tie(e.licenseKey,t),this.guid=`ht_${aM()}`,OW.set(this.guid,this),this.columnIndexMapper=new og,this.rowIndexMapper=new og,this.columnIndexMapper.addLocalHook("indexesSequenceChange",y=>{s.runHooks("afterColumnSequenceChange",y)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",y=>{s.runHooks("afterRowSequenceChange",y)}),c=new gae(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);let P=y=>{let{row:E,col:R}=y;return s._createCellCoords(E>=0?s.rowIndexMapper.getRenderableFromVisualIndex(E):E,R>=0?s.columnIndexMapper.getRenderableFromVisualIndex(R):R)},k=y=>{let{row:E,col:R}=y;return s._createCellCoords(E>=0?s.rowIndexMapper.getVisualFromRenderableIndex(E):E,R>=0?s.columnIndexMapper.getVisualFromRenderableIndex(R):R)},b=new xW(_,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:y=>l.propToCol(y),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(y,E)=>s._createCellCoords(y,E),createCellRange:(y,E,R)=>s._createCellRange(y,E,R),visualToRenderableCoords:P,renderableToVisualCoords:k,isDisabledCellSelection:(y,E)=>y<0||E<0?s.getSettings().disableVisualSelection:s.getCellMeta(y,E).disableVisualSelection});this.selection=b;let C=y=>{let{hiddenIndexesChanged:E}=y;E&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",C),this.rowIndexMapper.addLocalHook("cacheUpdated",C),this.selection.addLocalHook("afterSetRangeEnd",y=>{let E=ks(!1),R=this.selection.getSelectedRange(),{from:D,to:A}=R.current(),O=R.size()-1;this.runHooks("afterSelection",D.row,D.col,A.row,A.col,E,O),this.runHooks("afterSelectionByProp",D.row,s.colToProp(D.col),A.row,s.colToProp(A.col),E,O);let U=!0;o&&(U=!1),E.isTouched()&&(U=!E.value);let ie=this.selection.selectedRange.current(),ue=this.selection.isSelectedByAnyHeader(),fe=this.selection.isSelectedByRowHeader(),de=this.selection.isSelectedByColumnHeader();if(U!==!1)if(ue)fe?this.scrollViewportTo({row:y.row}):de&&this.scrollViewportTo({col:y.col});else if(ie&&!this.selection.isMultiple()){let{row:ye,col:Pe}=ie.from;ye<0&&Pe>=0?this.scrollViewportTo({col:Pe}):Pe<0&&ye>=0?this.scrollViewportTo({row:ye}):this.scrollViewportTo({row:ye,col:Pe})}else this.scrollViewportTo(y.toObject());fe&&de?Ne(this.rootElement,["ht__selection--rows","ht__selection--columns"]):fe?(bt(this.rootElement,"ht__selection--columns"),Ne(this.rootElement,"ht__selection--rows")):de?(bt(this.rootElement,"ht__selection--rows"),Ne(this.rootElement,"ht__selection--columns")):bt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",y=>{let E=y.length-1,{from:R,to:D}=y[E];this.runHooks("afterSelectionEnd",R.row,R.col,D.row,D.col,E),this.runHooks("afterSelectionEndByProp",R.row,s.colToProp(R.col),D.row,s.colToProp(D.col),E)}),this.selection.addLocalHook("afterIsMultipleSelection",y=>{let E=this.runHooks("afterIsMultipleSelection",y.value);y.value&&(y.value=E)}),this.selection.addLocalHook("afterDeselect",()=>{d.destroyEditor(),this._refreshBorders(),bt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("beforeSetRangeStart",...E)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("beforeSetRangeStartOnly",...E)}).addLocalHook("beforeSetRangeEnd",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("beforeSetRangeEnd",...E)}).addLocalHook("beforeSelectColumns",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("beforeSelectColumns",...E)}).addLocalHook("afterSelectColumns",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("afterSelectColumns",...E)}).addLocalHook("beforeSelectRows",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("beforeSelectRows",...E)}).addLocalHook("afterSelectRows",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("afterSelectRows",...E)}).addLocalHook("beforeModifyTransformStart",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("modifyTransformStart",...E)}).addLocalHook("afterModifyTransformStart",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("afterModifyTransformStart",...E)}).addLocalHook("beforeModifyTransformEnd",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("modifyTransformEnd",...E)}).addLocalHook("afterModifyTransformEnd",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("afterModifyTransformEnd",...E)}).addLocalHook("beforeRowWrap",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("beforeRowWrap",...E)}).addLocalHook("beforeColumnWrap",function(){for(var y=arguments.length,E=new Array(y),R=0;R<y;R++)E[R]=arguments[R];return r.runHooks("beforeColumnWrap",...E)}).addLocalHook("insertRowRequire",y=>this.alter("insert_row_above",y,1,"auto")).addLocalHook("insertColRequire",y=>this.alter("insert_col_start",y,1,"auto")),u={alter(y,E){var R,D;let A=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,O=arguments.length>3?arguments[3]:void 0,U=arguments.length>4?arguments[4]:void 0,ie=ue=>{if(ue.length===0)return[];let fe=[...ue];return fe.sort((ye,Pe)=>{let[F]=ye,[Ke]=Pe;return F===Ke?0:F>Ke?1:-1}),or(fe,(ye,Pe)=>{let[F,Ke]=Pe,$e=ye[ye.length-1],[rt,Ye]=$e,Me=rt+Ye;if(F<=Me){let j=Math.max(Ke-(Me-F),0);$e[1]+=j}else ye.push([F,Ke]);return ye},[fe[0]])};switch(y){case"insert_row_below":case"insert_row_above":let ue=s.countSourceRows();if(_.maxRows===ue)return;let fe=y==="insert_row_below"?"below":"above";E=(R=E)!==null&&R!==void 0?R:fe==="below"?ue:0;let{delta:de,startPhysicalIndex:ye}=l.createRow(E,A,{source:O,mode:fe});if(de){let Ye=b.selectedRange.current(),Me=Ye?.from,j=Me?.row,z=s.toVisualRow(ye);if(b.isSelectedByCorner())b.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Ze(j)&&j>=z){let{row:J,col:pe}=Ye.to,he=Me.col;b.isSelectedByRowHeader()&&(he=-1),b.getSelectedRange().pop(),b.setRangeStartOnly(s._createCellCoords(j+de,he),!0),b.setRangeEnd(s._createCellCoords(J+de,pe))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":let Pe=y==="insert_col_end"?"end":"start";E=(D=E)!==null&&D!==void 0?D:Pe==="end"?s.countSourceCols():0;let{delta:F,startPhysicalIndex:Ke}=l.createCol(E,A,{source:O,mode:Pe});if(F){if(Array.isArray(_.colHeaders)){let J=[s.toVisualColumn(Ke),0];J.length+=F,Array.prototype.splice.apply(_.colHeaders,J)}let Ye=b.selectedRange.current(),Me=Ye?.from,j=Me?.col,z=s.toVisualColumn(Ke);if(b.isSelectedByCorner())b.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(Ze(j)&&j>=z){let{row:J,col:pe}=Ye.to,he=Me.row;b.isSelectedByColumnHeader()&&(he=-1),b.getSelectedRange().pop(),b.setRangeStartOnly(s._createCellCoords(he,j+F),!0),b.setRangeEnd(s._createCellCoords(J,pe+F))}else s._refreshBorders()}break;case"remove_row":let $e=Ye=>{let Me=0;Z(Ye,j=>{let[z,J]=j,pe=Er(z)?s.countRows()-1:Math.max(z-Me,0);if(Number.isInteger(z)&&(z=Math.max(z-Me,0)),!l.removeRow(z,J,O))return;let me=s.countRows(),ve=_.fixedRowsTop;ve>=pe+1&&(_.fixedRowsTop-=Math.min(J,ve-pe));let ne=_.fixedRowsBottom;ne&&pe>=me-ne&&(_.fixedRowsBottom-=Math.min(J,ne)),Me+=J})};Array.isArray(E)?$e(ie(E)):$e([[E,A]]),u.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":let rt=Ye=>{let Me=0;Z(Ye,j=>{let[z,J]=j,pe=Er(z)?s.countCols()-1:Math.max(z-Me,0),he=s.toPhysicalColumn(pe);if(Number.isInteger(z)&&(z=Math.max(z-Me,0)),!l.removeCol(z,J,O))return;let ve=_.fixedColumnsStart;ve>=pe+1&&(_.fixedColumnsStart-=Math.min(J,ve-pe)),Array.isArray(_.colHeaders)&&(typeof he>"u"&&(he=-1),_.colHeaders.splice(he,J)),Me+=J})};Array.isArray(E)?rt(ie(E)):rt([[E,A]]),u.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${y}"`)}U||u.adjustRowsAndCols()},adjustRowsAndCols(){let y=_.minRows,E=_.minSpareRows,R=_.minCols,D=_.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&b.deselect(),y){let A=s.countRows();A<y&&l.createRow(A,y-A,{source:"auto"})}if(E){let A=s.countEmptyRows(!0);if(A<E){let O=E-A,U=Math.min(O,_.maxRows-s.countSourceRows());l.createRow(s.countRows(),U,{source:"auto"})}}{let A;(R||D)&&(A=s.countEmptyCols(!0));let O=s.countCols();if(R&&!_.columns&&O<R){let U=R-O;A+=U,l.createCol(O,U,{source:"auto"})}if(D&&!_.columns&&s.dataType==="array"&&A<D){O=s.countCols();let U=D-A,ie=Math.min(U,_.maxCols-O);l.createCol(O,ie,{source:"auto"})}}if(b.isSelected()){let A=s.countRows(),O=s.countCols();Z(b.selectedRange,U=>{let ie=!1,ue=U.from.row,fe=U.from.col,de=U.to.row,ye=U.to.col;ue>A-1?(ue=A-1,ie=!0,de>ue&&(de=ue)):de>A-1&&(de=A-1,ie=!0,ue>de&&(ue=de)),fe>O-1?(fe=O-1,ie=!0,ye>fe&&(ye=fe)):ye>O-1&&(ye=O-1,ie=!0,fe>ye&&(fe=ye)),ie&&s.selectCell(ue,fe,de,ye)})}s.view&&s.view.adjustElementsSize()},populateFromArray(y,E,R,D,A){let O,U,ie,ue,fe=[],de={},ye=[],Pe=y.row,F=y.col;if(U=E.length,U===0)return!1;let Ke=0,$e=0;switch(Tt(R)&&(Ke=R.col-F+1,$e=R.row-Pe+1),A){case"shift_down":let rt=Jv(E),Ye=rt.length,Me=Math.max(Ye,Ke),j=s.getData().slice(Pe),z=Jv(j).slice(F,F+Me);for(ie=0;ie<Me;ie+=1)if(ie<Ye){for(O=0,U=rt[ie].length;O<$e-U;O+=1)rt[ie].push(rt[ie][O%U]);ie<z.length?ye.push(rt[ie].concat(z[ie])):ye.push(rt[ie].concat(new Array(j.length).fill(null)))}else ye.push(rt[ie%Ye].concat(z[ie]));s.populateFromArray(Pe,F,Jv(ye));break;case"shift_right":let J=E.length,pe=Math.max(J,$e),he=s.getData().slice(Pe).map(ke=>ke.slice(F));for(O=0;O<pe;O+=1)if(O<J){for(ie=0,ue=E[O].length;ie<Ke-ue;ie+=1)E[O].push(E[O][ie%ue]);if(O<he.length)for(let ke=0;ke<he[O].length;ke+=1)E[O].push(he[O][ke]);else E[O].push(...new Array(he[0].length).fill(null))}else E.push(E[O%U].slice(0,pe).concat(he[O]));s.populateFromArray(Pe,F,E);break;case"overwrite":default:de.row=y.row,de.col=y.col;let me=0,ve=0,ne=!0,ce,oe=function(Xe){let gt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,Mt=E[Xe%E.length];return gt!==null?Mt[gt%Mt.length]:Mt},ge=E.length,Ve=R?R.row-y.row+1:0;for(R?U=Ve:U=Math.max(ge,Ve),O=0;O<U&&!(R&&de.row>R.row&&Ve>ge||!_.allowInsertRow&&de.row>s.countRows()-1||de.row>=_.maxRows);O++){let ke=O-me,Xe=oe(ke).length,gt=R?R.col-y.col+1:0;if(R?ue=gt:ue=Math.max(Xe,gt),de.col=y.col,ce=s.getCellMeta(de.row,de.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&ce.skipRowOnPaste){me+=1,de.row+=1,U+=1;continue}for(ve=0,ie=0;ie<ue&&!(R&&de.col>R.col&&gt>Xe||!_.allowInsertColumn&&de.col>s.countCols()-1||de.col>=_.maxCols);ie++){if(ce=s.getCellMeta(de.row,de.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&ce.skipColumnOnPaste){ve+=1,de.col+=1,ue+=1;continue}if(ce.readOnly&&D!=="UndoRedo.undo"){de.col+=1;continue}let Mt=ie-ve,Nt=oe(ke,Mt),$t=s.getDataAtCell(de.row,de.col);if(Nt!==null&&typeof Nt=="object")if(Array.isArray(Nt)&&$t===null&&($t=[]),$t===null||typeof $t!="object")ne=!1;else{let Rn=zp(Array.isArray($t)?$t:$t[0]||$t),yr=zp(Array.isArray(Nt)?Nt:Nt[0]||Nt);lw(Rn,yr)||Array.isArray(Rn)&&Array.isArray(yr)?Nt=vi(Nt):ne=!1}else $t!==null&&typeof $t=="object"&&(ne=!1);ne&&fe.push([de.row,de.col,Nt]),ne=!0,de.col+=1}de.row+=1}s.setDataAtCell(fe,null,null,D||"populateFromArray");break}}};function N(y){let E=IO(y);MO(E)?(s.runHooks("beforeLanguageChange",E),S.language=E,s.runHooks("afterLanguageChange",E)):AO(y)}function B(y,E){let R=y==="className"?s.rootElement:s.table;if(f)Ne(R,E);else{let D=[],A=[];S[y]&&(D=Array.isArray(S[y])?S[y]:k4(S[y])),E&&(A=Array.isArray(E)?E:k4(E));let O=P4(D,A),U=P4(A,D);O.length&&bt(R,O),U.length&&Ne(R,U)}S[y]=E}this.init=function(){c.setData(_.data),s.runHooks("beforeInit"),(Oa()||TM())&&Ne(s.rootElement,"mobile"),this.updateSettings(_,!0),this.view=new dae(this),d=Loe.getInstance(s,_,b),h=new FM(s),Rw(this)&&lce(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&ooe(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function Y(){let y=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,y=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&y===!1&&(y=!0,this.onQueueEmpty(this.valid))}}}function ee(y){let E=y.replace(",",".");return isNaN(parseFloat(E))===!1?parseFloat(E):y}function te(y,E,R){if(!y.length)return;let D=s.getActiveEditor(),A=new Y,O=!0;A.onQueueEmpty=U=>{D&&O&&D.cancelChanges(),R(U)};for(let U=y.length-1;U>=0;U--){let[ie,ue,,fe]=y[U],de=l.propToCol(ue),ye=s.getCellMeta(ie,de);ye.type==="numeric"&&typeof fe=="string"&&Goe(fe)&&(y[U][3]=ee(fe)),s.getCellValidator(ye)&&(A.addValidatorToQueue(),s.validateCell(y[U][3],ye,function(Pe,F){return function(Ke){if(typeof Ke!="boolean")throw new Error("Validation error: result is not boolean");if(Ke===!1&&F.allowInvalid===!1){O=!1,y.splice(Pe,1),F.valid=!0;let $e=s.getCell(F.visualRow,F.visualCol);$e!==null&&bt($e,_.invalidCellClassName)}A.removeValidatorFormQueue()}}(U,ye),E))}A.checkIfQueueIsEmpty()}function Ce(y,E){let R=y.length-1;if(R<0)return;for(;R>=0;R--){let A=!1;if(y[R]===null){y.splice(R,1);continue}if(!((y[R][2]===null||y[R][2]===void 0)&&(y[R][3]===null||y[R][3]===void 0))){if(_.allowInsertRow)for(;y[R][0]>s.countRows()-1;){let{delta:O}=l.createRow(void 0,void 0,{source:E});if(O===0){A=!0;break}}if(s.dataType==="array"&&(!_.columns||_.columns.length===0)&&_.allowInsertColumn)for(;l.propToCol(y[R][1])>s.countCols()-1;){let{delta:O}=l.createCol(void 0,void 0,{source:E});if(O===0){A=!0;break}}A||l.set(y[R][0],y[R][1],y[R][3])}}s.forceFullRender=!0,u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",y,E),d.lockEditor(),s._refreshBorders(null),d.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",y,E||"edit");let D=s.getActiveEditor();D&&Ze(D.refreshValue)&&D.refreshValue()}this._createCellCoords=function(y,E){return s.view._wt.createCellCoords(y,E)},this._createCellRange=function(y,E,R){return s.view._wt.createCellRange(y,E,R)},this.validateCell=function(y,E,R,D){let A=s.getCellValidator(E);function O(U){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||E.hidden===!0){R(U);return}let ue=E.visualCol,fe=E.visualRow,de=s.getCell(fe,ue,!0);if(de&&de.nodeName!=="TH"){let ye=s.rowIndexMapper.getRenderableFromVisualIndex(fe),Pe=s.columnIndexMapper.getRenderableFromVisualIndex(ue);s.view._wt.getSetting("cellRenderer",ye,Pe,de)}R(U)}bie(A)&&(A=function(U){return function(ie,ue){ue(U.test(ie))}}(A)),xn(A)?(y=s.runHooks("beforeValidate",y,E.visualRow,E.prop,D),s._registerImmediate(()=>{A.call(E,y,U=>{s&&(U=s.runHooks("afterValidate",U,y,E.visualRow,E.prop,D),E.valid=U,O(U),s.runHooks("postAfterValidate",U,y,E.visualRow,E.prop,D))})})):s._registerImmediate(()=>{E.valid=!0,O(E.valid,!1)})};function Re(y,E,R){return Array.isArray(y)?y:[[y,E,R]]}function _e(y,E){let R=s.getActiveEditor(),D=s.runHooks("beforeChange",y,E||"edit"),A=y.filter(O=>O!==null);return D===!1||A.length===0?(R&&R.cancelChanges(),[]):A}this.setDataAtCell=function(y,E,R,D){let A=Re(y,E,R),O=[],U=D,ie,ue,fe;for(ie=0,ue=A.length;ie<ue;ie++){if(typeof A[ie]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof A[ie][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");A[ie][1]>=this.countCols()?fe=A[ie][1]:fe=l.colToProp(A[ie][1]),O.push([A[ie][0],fe,c.getAtCell(this.toPhysicalRow(A[ie][0]),A[ie][1]),A[ie][2]])}!U&&typeof y=="object"&&(U=E);let de=_e(O,D);s.runHooks("afterSetDataAtCell",de,U),te(de,U,()=>{Ce(de,U)})},this.setDataAtRowProp=function(y,E,R,D){let A=Re(y,E,R),O=[],U=D,ie,ue;for(ie=0,ue=A.length;ie<ue;ie++)O.push([A[ie][0],A[ie][1],c.getAtCell(this.toPhysicalRow(A[ie][0]),A[ie][1]),A[ie][2]]);!U&&typeof y=="object"&&(U=E);let fe=_e(O,D);s.runHooks("afterSetDataAtRowProp",fe,U),te(fe,U,()=>{Ce(fe,U)})},this.listen=function(){s&&!s.isListening()&&(OW.forEach(y=>{s!==y&&y.unlisten()}),MW=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(MW=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return MW===s.guid},this.destroyEditor=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(y,E)},this.populateFromArray=function(y,E,R,D,A,O,U){if(!(typeof R=="object"&&typeof R[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");let ie=typeof D=="number"?s._createCellCoords(D,A):null;return u.populateFromArray(s._createCellCoords(y,E),R,ie,O,U)},this.spliceCol=function(y,E,R){for(var D=arguments.length,A=new Array(D>3?D-3:0),O=3;O<D;O++)A[O-3]=arguments[O];return l.spliceCol(y,E,R,...A)},this.spliceRow=function(y,E,R){for(var D=arguments.length,A=new Array(D>3?D-3:0),O=3;O<D;O++)A[O-3]=arguments[O];return l.spliceRow(y,E,R,...A)},this.getSelected=function(){if(b.isSelected())return At(b.getSelectedRange(),y=>{let{from:E,to:R}=y;return[E.row,E.col,R.row,R.col]})},this.getSelectedLast=function(){let y=this.getSelected(),E;return y&&y.length>0&&(E=y[y.length-1]),E},this.getSelectedRange=function(){if(b.isSelected())return Array.from(b.getSelectedRange())},this.getSelectedRangeLast=function(){let y=this.getSelectedRange(),E;return y&&y.length>0&&(E=y[y.length-1]),E},this.emptySelectedCells=function(y){if(!b.isSelected()||this.countRows()===0||this.countCols()===0)return;let E=[];Z(b.getSelectedRange(),R=>{if(R.isSingleHeader())return;let D=R.getTopStartCorner(),A=R.getBottomEndCorner();st(D.row,A.row,O=>{st(D.col,A.col,U=>{this.getCellMeta(O,U).readOnly||E.push([O,U,null])})})}),E.length>0&&this.setDataAtCell(E,y)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let y=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(y,0),!this.isRenderSuspended()&&y===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(d.lockEditor(),this._refreshBorders(null),d.unlockEditor()))},this.batchRender=function(y){this.suspendRender();let E=y();return this.resumeRender(),E},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(E,0),(!this.isExecutionSuspended()&&E===this.executionSuspendedCounter||y)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(y){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();let R=y();return this.resumeExecution(E),R},this.batch=function(y){this.suspendRender(),this.suspendExecution();let E=y();return this.resumeExecution(),this.resumeRender(),E},this.refreshDimensions=function(){if(!s.view)return;let{width:y,height:E}=s.view.getLastSize(),{width:R,height:D}=s.rootElement.getBoundingClientRect(),A=R!==y||D!==E;s.runHooks("beforeRefreshDimensions",{width:y,height:E},{width:R,height:D},A)!==!1&&((A||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(R,D),s.render()),s.runHooks("afterRefreshDimensions",{width:y,height:E},{width:R,height:D},A))},this.updateData=function(y,E){WO(y,R=>{l=R},R=>{l=R,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols()},{hotInstance:s,dataMap:l,dataSource:c,internalSource:"updateData",source:E,metaManager:w,firstRun:f})},this.loadData=function(y,E){WO(y,R=>{l=R},()=>{w.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:l,dataSource:c,internalSource:"loadData",source:E,metaManager:w,firstRun:f})},this.getInitialColumnCount=function(){let y=_.columns,E=0;if(Array.isArray(y))E=y.length;else if(xn(y))if(s.dataType==="array"){let R=this.countSourceCols();for(let D=0;D<R;D+=1)y(D)&&(E+=1)}else(s.dataType==="object"||s.dataType==="function")&&(E=l.colToPropCache.length);else if(Ze(_.dataSchema)){let R=l.getSchema();E=Array.isArray(R)?R.length:cw(R)}else E=this.countSourceCols();return E},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(y,E,R,D){return mn(y)?l.getAll():l.getRange(s._createCellCoords(y,E),s._createCellCoords(R,D),l.DESTINATION_RENDERER)},this.getCopyableText=function(y,E,R,D){return l.getCopyableText(s._createCellCoords(y,E),s._createCellCoords(R,D))},this.getCopyableData=function(y,E){return l.getCopyable(y,l.colToProp(E))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(y){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,R=(f?s.loadData:s.updateData).bind(this),D=!1,A,O;if(Ze(y.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ze(y.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ze(y.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(A in y)A==="data"||(A==="language"?N(y.language):A==="className"?B("className",y.className):A==="tableClassName"&&s.table?(B("tableClassName",y.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):ot.getSingleton().isRegistered(A)||ot.getSingleton().isDeprecated(A)?(xn(y[A])||Array.isArray(y[A]))&&(y[A].initialHook=!0,s.addHook(A,y[A])):!E&&Kn(y,A)&&(S[A]=y[A]));y.data===void 0&&_.data===void 0?R(null,"updateSettings"):y.data!==void 0?R(y.data,"updateSettings"):y.columns!==void 0&&(l.createMap(),s.initIndexMappers());let U=s.countCols(),ie=_.columns;if(ie&&xn(ie)&&(D=!0),(y.cell!==void 0||y.cells!==void 0||y.columns!==void 0)&&w.clearCache(),U>0)for(A=0,O=0;A<U;A++){if(ie){let de=D?ie(A):ie[O];de&&w.updateColumnMeta(O,de)}O+=1}Ze(y.cell)&&Rt(y.cell,de=>{s.setCellMetaObject(de.row,de.col,de)}),s.runHooks("afterCellMetaReset");let ue=s.rootElement.style.height;ue!==""&&(ue=parseInt(s.rootElement.style.height,10));let fe=y.height;if(xn(fe)&&(fe=fe()),E&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),fe===null){let de=s.rootElement.getAttribute("data-initialstyle");de&&(de.indexOf("height")>-1||de.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",de):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else fe!==void 0&&(s.rootElement.style.height=isNaN(fe)?`${fe}`:`${fe}px`,s.rootElement.style.overflow="hidden");if(typeof y.width<"u"){let de=y.width;xn(de)&&(de=de()),s.rootElement.style.width=isNaN(de)?`${de}`:`${de}px`}E||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",y)),u.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,d.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),d.unlockEditor()),!E&&s.view&&(ue===""||fe===""||fe===void 0)&&ue!==fe&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let y=s.getSelectedLast();if(_.getValue){if(xn(_.getValue))return _.getValue.call(s);if(y)return s.getData()[y[0][0]][_.getValue]}else if(y)return s.getDataAtCell(y[0],y[1])},this.getSettings=function(){return _},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(y,E,R,D,A){u.alter(y,E,R,D,A)},this.getCell=function(y,E){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=E,A=y;if(E>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(E)))return null;D=this.columnIndexMapper.getRenderableFromVisualIndex(E)}if(y>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(y)))return null;A=this.rowIndexMapper.getRenderableFromVisualIndex(y)}return A===null||D===null?null:s.view.getCellAtCoords(s._createCellCoords(A,D),R)},this.getCoords=function(y){let E=this.view._wt.wtTable.getCoords(y);if(E===null)return null;let{row:R,col:D}=E,A=R,O=D;return R>=0&&(A=this.rowIndexMapper.getVisualFromRenderableIndex(R)),D>=0&&(O=this.columnIndexMapper.getVisualFromRenderableIndex(D)),s._createCellCoords(A,O)},this.colToProp=function(y){return l.colToProp(y)},this.propToCol=function(y){return l.propToCol(y)},this.toVisualRow=y=>this.rowIndexMapper.getVisualFromPhysicalIndex(y),this.toVisualColumn=y=>this.columnIndexMapper.getVisualFromPhysicalIndex(y),this.toPhysicalRow=y=>this.rowIndexMapper.getPhysicalFromVisualIndex(y),this.toPhysicalColumn=y=>this.columnIndexMapper.getPhysicalFromVisualIndex(y),this.getDataAtCell=function(y,E){return l.get(y,l.colToProp(E))},this.getDataAtRowProp=function(y,E){return l.get(y,E)},this.getDataAtCol=function(y){let E=[],R=l.getRange(s._createCellCoords(0,y),s._createCellCoords(_.data.length-1,y),l.DESTINATION_RENDERER);for(let D=0;D<R.length;D+=1)for(let A=0;A<R[D].length;A+=1)E.push(R[D][A]);return E},this.getDataAtProp=function(y){let E=[],R=l.getRange(s._createCellCoords(0,l.propToCol(y)),s._createCellCoords(_.data.length-1,l.propToCol(y)),l.DESTINATION_RENDERER);for(let D=0;D<R.length;D+=1)for(let A=0;A<R[D].length;A+=1)E.push(R[D][A]);return E},this.getSourceData=function(y,E,R,D){let A;return y===void 0?A=c.getData():A=c.getByRange(s._createCellCoords(y,E),s._createCellCoords(R,D)),A},this.getSourceDataArray=function(y,E,R,D){let A;return y===void 0?A=c.getData(!0):A=c.getByRange(s._createCellCoords(y,E),s._createCellCoords(R,D),!0),A},this.getSourceDataAtCol=function(y){return c.getAtColumn(y)},this.setSourceDataAtCell=function(y,E,R,D){let A=Re(y,E,R),O=this.hasHook("afterSetSourceDataAtCell"),U=[];O&&Z(A,ue=>{let[fe,de,ye]=ue;U.push([fe,de,c.getAtCell(fe,de),ye])}),Z(A,ue=>{let[fe,de,ye]=ue;c.setAtCell(fe,de,ye)}),O&&this.runHooks("afterSetSourceDataAtCell",U,D),this.render();let ie=s.getActiveEditor();ie&&Ze(ie.refreshValue)&&ie.refreshValue()},this.getSourceDataAtRow=function(y){return c.getAtRow(y)},this.getSourceDataAtCell=function(y,E){return c.getAtCell(y,E)},this.getDataAtRow=function(y){return l.getRange(s._createCellCoords(y,0),s._createCellCoords(y,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(y,E,R,D){let A=y===void 0?[0,0,this.countRows(),this.countCols()]:[y,E,R,D],[O,U]=A,[,,ie,ue]=A,fe=null,de=null;ie===void 0&&(ie=O),ue===void 0&&(ue=U);let ye="mixed";return st(Math.max(Math.min(O,ie),0),Math.max(O,ie),Pe=>{let F=!0;return st(Math.max(Math.min(U,ue),0),Math.max(U,ue),Ke=>(de=this.getCellMeta(Pe,Ke).type,fe?F=fe===de:fe=de,F)),ye=F?de:"mixed",F}),ye},this.removeCellMeta=function(y,E,R){let[D,A]=[this.toPhysicalRow(y),this.toPhysicalColumn(E)],O=w.getCellMetaKeyValue(D,A,R);s.runHooks("beforeRemoveCellMeta",y,E,R,O)!==!1&&(w.removeCellMeta(D,A,R),s.runHooks("afterRemoveCellMeta",y,E,R,O)),O=null},this.spliceCellsMeta=function(y){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var R=arguments.length,D=new Array(R>2?R-2:0),A=2;A<R;A++)D[A-2]=arguments[A];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");E>0&&w.removeRow(this.toPhysicalRow(y),E),D.length>0&&Z(D.reverse(),O=>{w.createRow(this.toPhysicalRow(y)),Z(O,(U,ie)=>this.setCellMetaObject(y,ie,U))}),s.render()},this.setCellMetaObject=function(y,E,R){typeof R=="object"&&Rt(R,(D,A)=>{this.setCellMeta(y,E,A,D)})},this.setCellMeta=function(y,E,R,D){if(s.runHooks("beforeSetCellMeta",y,E,R,D)===!1)return;let O=y,U=E;y<this.countRows()&&(O=this.toPhysicalRow(y)),E<this.countCols()&&(U=this.toPhysicalColumn(E)),w.setCellMeta(O,U,R,D),s.runHooks("afterSetCellMeta",y,E,R,D)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(y,E){let R=this.toPhysicalRow(y),D=this.toPhysicalColumn(E);return R===null&&(R=y),D===null&&(D=E),w.getCellMeta(R,D,{visualRow:y,visualColumn:E})},this.getCellMetaAtRow=function(y){return w.getCellsMetaAtRow(y)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||_.columns)},this.getCellRenderer=function(y,E){let R=typeof y=="number"?s.getCellMeta(y,E).renderer:y.renderer;return typeof R=="string"?uU(R):mn(R)?uU("text"):R},this.getCellEditor=function(y,E){let R=typeof y=="number"?s.getCellMeta(y,E).editor:y.editor;return typeof R=="string"?eU(R):mn(R)?eU("text"):R},this.getCellValidator=function(y,E){let R=typeof y=="number"?s.getCellMeta(y,E).validator:y.validator;return typeof R=="string"?Qoe(R):R},this.validateCells=function(y){this._validateCells(y)},this.validateRows=function(y,E){if(!Array.isArray(y))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(E,y)},this.validateColumns=function(y,E){if(!Array.isArray(y))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(E,void 0,y)},this._validateCells=function(y,E,R){let D=new Y;y&&(D.onQueueEmpty=y);let A=s.countRows()-1;for(;A>=0;){if(E!==void 0&&E.indexOf(A)===-1){A-=1;continue}let O=s.countCols()-1;for(;O>=0;){if(R!==void 0&&R.indexOf(O)===-1){O-=1;continue}D.addValidatorToQueue(),s.validateCell(s.getDataAtCell(A,O),s.getCellMeta(A,O),U=>{if(typeof U!="boolean")throw new Error("Validation error: result is not boolean");U===!1&&(D.valid=!1),D.removeValidatorFormQueue()},"validateCells"),O-=1}A-=1}D.checkIfQueueIsEmpty()},this.getRowHeader=function(y){let E=_.rowHeaders,R=y;return R!==void 0&&(R=s.runHooks("modifyRowHeader",R)),R===void 0?(E=[],st(s.countRows()-1,D=>{E.push(s.getRowHeader(D))})):Array.isArray(E)&&E[R]!==void 0?E=E[R]:xn(E)?E=E(R):E&&typeof E!="string"&&typeof E!="number"&&(E=R+1),E},this.hasRowHeaders=function(){return!!_.rowHeaders},this.hasColHeaders=function(){if(_.colHeaders!==void 0&&_.colHeaders!==null)return!!_.colHeaders;for(let y=0,E=s.countCols();y<E;y++)if(s.getColHeader(y))return!0;return!1},this.getColHeader=function(y){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1,R=s.runHooks("modifyColHeader",y);if(R===void 0){let ie=[],ue=s.countCols();for(let fe=0;fe<ue;fe++)ie.push(s.getColHeader(fe));return ie}let D=_.colHeaders,A=function(ie){let ue=[],fe=s.countCols(),de=0;for(;de<fe;de++)xn(_.columns)&&_.columns(de)&&ue.push(de);return ue[ie]},O=s.toPhysicalColumn(R),U=A(O);return _.colHeaders===!1?D=null:_.columns&&xn(_.columns)&&_.columns(U)&&_.columns(U).title?D=_.columns(U).title:_.columns&&_.columns[O]&&_.columns[O].title?D=_.columns[O].title:Array.isArray(_.colHeaders)&&_.colHeaders[O]!==void 0?D=_.colHeaders[O]:xn(_.colHeaders)?D=_.colHeaders(O):_.colHeaders&&typeof _.colHeaders!="string"&&typeof _.colHeaders!="number"&&(D=fae(R)),D=s.runHooks("modifyColumnHeaderValue",D,y,E),D},this._getColWidthFromSettings=function(y){let E;if(y>=0&&(E=s.getCellMeta(0,y).width),(E===void 0||E===_.width)&&(E=_.colWidths),E!=null){switch(typeof E){case"object":E=E[y];break;case"function":E=E(y);break;default:break}typeof E=="string"&&(E=parseInt(E,10))}return E},this.getColWidth=function(y){let E=s._getColWidthFromSettings(y);return E=s.runHooks("modifyColWidth",E,y),E===void 0&&(E=Ff.DEFAULT_WIDTH),E},this._getRowHeightFromSettings=function(y){let E=_.rowHeights;if(E!=null){switch(typeof E){case"object":E=E[y];break;case"function":E=E(y);break;default:break}typeof E=="string"&&(E=parseInt(E,10))}return E},this.getRowHeight=function(y){let E=s._getRowHeightFromSettings(y);return E=s.runHooks("modifyRowHeight",E,y),E},this.countSourceRows=function(){return c.countRows()},this.countSourceCols=function(){return c.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){let y=_.maxCols,E=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(y,E)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=0;return DS(s.countRows()-1,R=>{if(s.isEmptyRow(R))E+=1;else if(y===!0)return!1}),E},this.countEmptyCols=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=0;return DS(s.countCols()-1,R=>{if(s.isEmptyCol(R))E+=1;else if(y===!0)return!1}),E},this.isEmptyRow=function(y){return _.isEmptyRow.call(s,y)},this.isEmptyCol=function(y){return _.isEmptyCol.call(s,y)},this.selectCell=function(y,E,R,D){let A=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,O=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return mn(y)||mn(E)?!1:this.selectCells([[y,E,R,D]],A,O)},this.selectCells=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;E===!1&&(o=!0);let D=b.selectCells(y);return D&&R&&s.listen(),o=!1,D},this.selectColumns=function(y){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y,R=arguments.length>2?arguments[2]:void 0;return b.selectColumns(y,E,R)},this.selectRows=function(y){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y,R=arguments.length>2?arguments[2]:void 0;return b.selectRows(y,E,R)},this.deselectCell=function(){b.deselect()},this.selectAll=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y,R=arguments.length>2?arguments[2]:void 0;o=!0,b.selectAll(y,E,R),o=!1};let L=(y,E)=>y.getNearestNotHiddenIndex(E,1,!0);this.scrollViewportTo=function(y){var E;if(typeof y=="number"){var R;y={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(R=arguments[4])!==null&&R!==void 0?R:!0}}let{row:D,col:A,verticalSnap:O,horizontalSnap:U,considerHiddenIndexes:ie}=(E=y)!==null&&E!==void 0?E:{},ue,fe,de,ye;O!==void 0&&(ue=O==="top",fe=!ue),U!==void 0&&(de=U==="start",ye=!de);let Pe=D,F=A;if(ie===void 0||ie){let rt=Number.isInteger(D)&&D>=0,Ye=Number.isInteger(A)&&A>=0,Me=rt?L(this.rowIndexMapper,D):void 0,j=Ye?L(this.columnIndexMapper,A):void 0;if(Me===null||j===null)return!1;Pe=rt?s.rowIndexMapper.getRenderableFromVisualIndex(Me):D,F=Ye?s.columnIndexMapper.getRenderableFromVisualIndex(j):A}let Ke=Number.isInteger(Pe),$e=Number.isInteger(F);return Ke&&Pe>=0&&$e&&F>=0?s.view.scrollViewport(s._createCellCoords(Pe,F),ue,ye,fe,de):Ke&&Pe>=0&&($e&&F<0||!$e)?s.view.scrollViewportVertically(Pe,ue,fe):$e&&F>=0&&(Ke&&Pe<0||!Ke)?s.view.scrollViewportHorizontally(F,ye,de):!1},this.scrollToFocusedCell=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",y);let{highlight:E}=this.getSelectedRangeLast();this.scrollViewportTo(E.toObject())?this.view.render():(this.removeHook("afterScroll",y),this._registerImmediate(()=>y()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),c&&c.destroy(),c=null,this.getShortcutManager().destroy(),w.clearCache(),OW.delete(this.guid),Rw(s)){let y=this.rootDocument.querySelector(".hot-display-license-info");y&&y.parentNode.removeChild(y)}yo(s.rootElement),a.destroy(),d&&d.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),x.getItems().forEach(y=>{let[,E]=y;E.destroy()}),x.clear(),s.runHooks("afterDestroy")},!0),ot.getSingleton().destroy(s),Rt(s,(y,E,R)=>{xn(y)?R[E]=M(E):E!=="guid"&&(R[E]=null)}),s.isDestroyed=!0,l&&l.destroy(),l=null,u=null,b=null,d=null,s=null};function M(y){return()=>{throw new Error(`The "${y}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return d.getActiveEditor()},this.getPlugin=function(y){let E=Uo(y);return E==="UndoRedo"?this.undoRedo:x.getItem(E)},this.getPluginName=function(y){return y===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:x.getId(y)},this.getInstance=function(){return s},this.addHook=function(y,E){ot.getSingleton().add(y,E,s)},this.hasHook=function(y){return ot.getSingleton().has(y,s)||ot.getSingleton().has(y)},this.addHookOnce=function(y,E){ot.getSingleton().once(y,E,s)},this.removeHook=function(y,E){ot.getSingleton().remove(y,E,s)},this.runHooks=function(y,E,R,D,A,O,U){return ot.getSingleton().run(s,y,E,R,D,A,O,U)},this.getTranslatedPhrase=function(y,E){return OO(_.language,y,E)},this.toHTML=()=>iU(this),this.toTableElement=()=>{let y=this.rootDocument.createElement("div");return y.insertAdjacentHTML("afterbegin",iU(this)),y.firstElementChild},this.timeouts=[],this._registerTimeout=function(y){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,R=y;typeof R=="function"&&(R=setTimeout(R,E)),this.timeouts.push(R)},this._clearTimeouts=function(){Z(this.timeouts,y=>{clearTimeout(y)})},this.immediates=[],this._registerImmediate=function(y){this.immediates.push(setImmediate(y))},this._clearImmediates=function(){Z(this.immediates,y=>{clearImmediate(y)})},this._refreshBorders=function(){let y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;d.destroyEditor(y),s.view.render(),E&&b.isSelected()&&d.prepareEditor()},this._getEditorManager=function(){return d},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};let q=AW({handleEvent(){return s.isListening()},beforeKeyDown:y=>this.runHooks("beforeKeyDown",y),afterKeyDown:y=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",y)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",y=>{y.ctrlKey===!1&&y.metaKey===!1&&q.releasePressedKeys()}),this.getShortcutManager=function(){return q},this.getFocusManager=function(){return h},HM().forEach(y=>{let E=VM(y);x.addItem(y,new E(this))}),rce(s),q.setActiveContextName("grid"),ot.getSingleton().run(s,"construct")}var xHt=Q(De(),1);var dHt=Q(De(),1);var aHt=Q(ze(),1);var WYe="hooksRefRegisterer",gce={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){Z(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Rt(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};_o(gce,"MIXIN_NAME",WYe,{writable:!1,enumerable:!1});var vce=gce;function Tc(t,e,n){return e=jYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jYe(t){var e=$Ye(t,"string");return typeof e=="symbol"?e:String(e)}function $Ye(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var NW="base",ni=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"}),qO="baseEditor",ca=class{static get EDITOR_TYPE(){return NW}constructor(e){Tc(this,"hot",void 0),Tc(this,"state",ni.VIRGIN),Tc(this,"_opened",!1),Tc(this,"_fullEditMode",!1),Tc(this,"_closeCallback",null),Tc(this,"TD",null),Tc(this,"row",null),Tc(this,"col",null),Tc(this,"prop",null),Tc(this,"originalValue",null),Tc(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,r,i,o,s){this.TD=i,this.row=e,this.col=n,this.prop=r,this.originalValue=o,this.cellProperties=s,this.state=ni.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let r,i,o,s;if(n){let d=this.hot.getSelectedLast();r=Math.max(Math.min(d[0],d[2]),0),i=Math.max(Math.min(d[1],d[3]),0),o=Math.max(d[0],d[2]),s=Math.max(d[1],d[3])}else[r,i,o,s]=[this.row,this.col,null,null];let a=this.hot.runHooks("modifyGetCellCoords",r,i);Array.isArray(a)&&([r,i]=a);let c=this.hot.getShortcutManager().getContext("editor"),u={runOnlyIf:()=>Ze(this.hot.getSelected()),group:qO};this.isInFullEditMode()&&c.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{this.hot.selection.transformStart(-1,0)}},{keys:[["ArrowDown"]],callback:()=>{this.hot.selection.transformStart(1,0)}},{keys:[["ArrowLeft"]],callback:()=>{this.hot.selection.transformStart(0,-1*this.hot.getDirectionFactor())}},{keys:[["ArrowRight"]],callback:()=>{this.hot.selection.transformStart(0,this.hot.getDirectionFactor())}}],u),this.hot.populateFromArray(r,i,e,o,s,"edit")}beginEditing(e,n){if(this.state!==ni.VIRGIN)return;let r=this.hot,i=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(i,o)),this.state=ni.EDITING,this.isInFullEditMode()){let s=typeof e=="string"?e:Qn(this.originalValue);this.setValue(s)}this.open(n),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,n,r){let i;if(r){let a=this._closeCallback;this._closeCallback=l=>{a&&a(l),r(l),this.hot.view.render()}}if(this.isWaiting())return;let s=this.hot.getShortcutManager().getContext("editor");if(s.removeShortcutsByGroup(qO),s.removeShortcutsByGroup(qp),this.state===ni.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===ni.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}let a=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof a=="string"?String.prototype.trim.call(a||""):a]]:i=[[a]],this.state=ni.WAITING,this.saveValue(i,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",l=>{this.state=ni.FINISHED,this.discardEditor(l)}):(this.state=ni.FINISHED,this.discardEditor(!0))}}cancelChanges(){this.state=ni.FINISHED,this.discardEditor()}discardEditor(e){this.state===ni.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=ni.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=ni.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===ni.WAITING}getEditedCellRect(){var e;let n=this.getEditedCell();if(!n)return;let{wtOverlays:r,wtViewport:i}=this.hot.view._wt,o=this.hot.rootWindow,s=vr(n),a=pn(n),l=vr(this.hot.rootElement),c=pn(this.hot.rootElement),u=r.topOverlay.holder,d=r.inlineStartOverlay.holder,h=u!==o?u.scrollTop:0,f=d!==o?d.scrollLeft:0,p=o.innerWidth-l.left-c,{wtTable:g}=(e=r.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,w=g.name,_=["master","inline_start"].includes(w)?h:0,S=["master","top","bottom"].includes(w)?f:0,x=s.top===l.top?0:1,P=s.top-l.top-x-_,k=0;this.hot.isRtl()?k=o.innerWidth-s.left-a-p-1+S:k=s.left-l.left-1-S,["top","top_inline_start_corner"].includes(w)&&(P+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(w)&&(k+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));let b=this.hot.hasColHeaders(),C=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),N=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),Y=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(b&&C<=0||C===Y)&&(P+=1),N<=0&&(k+=1);let ee=i.rowsRenderCalculator.startPosition,te=i.columnsRenderCalculator.startPosition,Ce=Math.abs(r.inlineStartOverlay.getScrollPosition()),Re=r.topOverlay.getScrollPosition(),_e=dr(this.hot.rootDocument),L=n.offsetTop;if(["inline_start","master"].includes(w)&&(L+=ee-Re),["bottom","bottom_inline_start_corner"].includes(w)){let{wtViewport:fe,wtTable:de}=r.bottomOverlay.clone;L+=fe.getWorkspaceHeight()-de.getHeight()-_e}let M=n.offsetLeft;this.hot.isRtl()?(M>=0?M=g.getWidth()-n.offsetLeft:M=Math.abs(M),M+=te-Ce-a):["top","master","bottom"].includes(w)&&(M+=te-Ce);let q=yl(this.TD,this.hot.rootWindow),y=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",E=parseInt(q[y],10)>0?0:1,R=parseInt(q.borderTopWidth,10)>0?0:1,D=pn(n)+E,A=Nn(n)+R,O=roe(u)?_e:0,U=ioe(d)?_e:0,ie=this.hot.view.maximumVisibleElementWidth(M)-O+E,ue=Math.max(this.hot.view.maximumVisibleElementHeight(L)-U+R,23);return{top:P,start:k,height:A,maxHeight:ue,width:D,maxWidth:ie}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let e=this.hot.countRows(),n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}};Jt(ca,vce);function wce(t,e,n){t.addEventListener(e,n,!1)}function yce(t,e,n){t.removeEventListener(e,n,!1)}function _ce(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Cce(t){let e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},n=t.body,r=t.createTextNode(""),i=t.createElement("span"),o;function s(){r.textContent=o.value,i.style.position="absolute",i.style.fontSize=_ce(o).fontSize,i.style.fontFamily=_ce(o).fontFamily,i.style.whiteSpace="pre",n.appendChild(i);let u=i.clientWidth+2;n.removeChild(i);let d=o.style;d.height=`${e.minHeight}px`,e.minWidth>u?d.width=`${e.minWidth}px`:u>e.maxWidth?d.width=`${e.maxWidth}px`:d.width=`${u}px`;let h=o.scrollHeight?o.scrollHeight-1:0;e.minHeight>h?d.height=`${e.minHeight}px`:e.maxHeight<h?(d.height=`${e.maxHeight}px`,d.overflowY="visible"):d.height=`${h}px`}function a(){t.defaultView.setTimeout(s,0)}function l(u){if(u&&u.minHeight)if(u.minHeight==="inherit")e.minHeight=o.clientHeight;else{let d=parseInt(u.minHeight,10);isNaN(d)||(e.minHeight=d)}if(u&&u.maxHeight)if(u.maxHeight==="inherit")e.maxHeight=o.clientHeight;else{let d=parseInt(u.maxHeight,10);isNaN(d)||(e.maxHeight=d)}if(u&&u.minWidth)if(u.minWidth==="inherit")e.minWidth=o.clientWidth;else{let d=parseInt(u.minWidth,10);isNaN(d)||(e.minWidth=d)}if(u&&u.maxWidth)if(u.maxWidth==="inherit")e.maxWidth=o.clientWidth;else{let d=parseInt(u.maxWidth,10);isNaN(d)||(e.maxWidth=d)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(r))}function c(u,d){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=u,l(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.overflowY="",o.style.height=`${e.minHeight}px`,o.style.minWidth=`${e.minWidth}px`,o.style.maxWidth=`${e.maxWidth}px`,o.style.overflowY="hidden"),h&&(wce(o,"input",s),wce(o,"keydown",a)),s()}return{init:c,resize:s,unObserve(){yce(o,"input",s),yce(o,"keydown",a)}}}function PW(t,e){let n=pM(e),r=e.value.split(`
`),i=n,o=0;for(let s=0;s<r.length;s++){let a=r[s];s!==0&&(o+=r[s-1].length+1);let l=o+a.length;if(t==="home"?i=o:t==="end"&&(i=l),n<=l)break}If(e,i)}function ug(t,e,n){return e=GYe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GYe(t){var e=zYe(t,"string");return typeof e=="symbol"?e:String(e)}function zYe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var YYe="ht_editor_visible",KO="ht_editor_hidden",Sce="textEditor",kW="text",$o=class extends ca{static get EDITOR_TYPE(){return kW}constructor(e){super(e),ug(this,"eventManager",new ei(this)),ug(this,"autoResize",Cce(this.hot.rootDocument)),ug(this,"TEXTAREA",void 0),ug(this,"textareaStyle",void 0),ug(this,"TEXTAREA_PARENT",void 0),ug(this,"textareaParentStyle",void 0),ug(this,"layerClass",void 0),this.eventManager=new ei(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),Qie(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,r,i,o,s){let a=this.state;if(super.prepare(e,n,r,i,o,s),!s.readOnly){this.refreshDimensions(!0);let{allowInvalid:l}=s;l&&(this.TEXTAREA.value=""),a!==ni.FINISHED&&this.hideEditableElement()}}beginEditing(e,n){this.state===ni.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),If(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),vt(this.TEXTAREA,[["data-hot-input",""],ml(-1)]),this.hot.getSettings().ariaTags&&vt(this.TEXTAREA,[wo()]),Ne(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),Ne(this.TEXTAREA_PARENT,"handsontableInputHolder"),St(this.TEXTAREA_PARENT,this.layerClass)&&bt(this.TEXTAREA_PARENT,this.layerClass),Ne(this.TEXTAREA_PARENT,KO),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Roe()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",bt(this.TEXTAREA_PARENT,this.layerClass),Ne(this.TEXTAREA_PARENT,KO)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="",this.textareaStyle.overflowY="hidden";let e=this.TEXTAREA_PARENT.childNodes,n=!1;st(e.length-1,r=>{let i=e[r];if(St(i,"handsontableEditor"))return n=!0,!1}),St(this.TEXTAREA_PARENT,KO)&&bt(this.TEXTAREA_PARENT,KO),n?(this.layerClass=YYe,Ne(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),Ne(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){let e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==ni.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}let{top:n,start:r,width:i,maxWidth:o,height:s,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();let l=yl(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;let c=yl(this.TEXTAREA),u=parseInt(c.paddingLeft,10)+parseInt(c.paddingRight,10),d=parseInt(c.paddingTop,10)+parseInt(c.paddingBottom,10),h=i-u,f=s-d,p=o-u,g=a-d;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(h,p),minHeight:Math.min(f,g),maxWidth:p,maxHeight:g},!0)}bindEvents(){bM()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===ni.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===ni.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let e=this.hot.getShortcutManager(),n=e.getContext("editor"),r=e.getContext("grid"),i={runOnlyIf:()=>Ze(this.hot.getSelected()),group:Sce},o=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Tab"],["Shift","Tab"],["PageUp"],["PageDown"]],forwardToContext:r,callback:()=>{}},{keys:[["Control","Enter"]],callback:()=>(o(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(o(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(o(),!1)},{keys:[["Home"]],callback:(s,a)=>{let[l]=a;PW(l,this.TEXTAREA)}},{keys:[["End"]],callback:(s,a)=>{let[l]=a;PW(l,this.TEXTAREA)}}],i)}unregisterShortcuts(){let n=this.hot.getShortcutManager().getContext("editor");n.removeShortcutsByGroup(qp),n.removeShortcutsByGroup(Sce),n.removeShortcutsByGroup(qO)}};var VHt=Q(ze(),1);var FW="base";function Iu(t,e,n,r,i,o,s){let a=s.ariaTags,l=[],c=[],u=[],d=[];s.className&&Ne(e,s.className),s.readOnly?(l.push(s.readOnlyCellClassName),a&&d.push(V4())):a&&u.push(V4()[0]),s.valid===!1&&s.invalidCellClassName?(l.push(s.invalidCellClassName),a&&d.push(B4())):(c.push(s.invalidCellClassName),a&&u.push(B4()[0])),s.wordWrap===!1&&s.noWordWrapClassName&&l.push(s.noWordWrapClassName),!o&&s.placeholder&&l.push(s.placeholderCellClassName),bt(e,c),Ne(e,l),gl(e,u),vt(e,d)}Iu.RENDERER_TYPE=FW;var LW="text";function To(t,e,n,r,i,o,s){Iu.apply(this,[t,e,n,r,i,o,s]);let a=o;if(!a&&s.placeholder&&(a=s.placeholder),a=Qn(a),s.trimWhitespace&&(a=a.trim()),s.rendererTemplate){yo(e);let l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(n),e.appendChild(l)}else wl(e,a)}To.RENDERER_TYPE=LW;var HW="text",Ax={CELL_TYPE:HW,editor:$o,renderer:To};ka(Ax);Rc.editors={BaseEditor:ca};function Rc(t,e){let n=new YO(t,e||{},yO);return n.init(),n}Rc.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new YO(t,e,yO)};Rc.DefaultSettings=bx();Rc.hooks=ot.getSingleton();Rc.CellCoords=Lf;Rc.CellRange=Zp;Rc.packageName="handsontable";Rc.buildDate="30/11/2023 10:10:40";Rc.version="14.0.0";Rc.languages={dictionaryKeys:Rae,getLanguageDictionary:dW,getLanguagesDictionaries:Iae,registerLanguageDictionary:uW,getTranslatedPhrase:OO};var XO=Rc;var qYe=["container"],VW=new Map,bce="The Handsontable instance bound to this component was destroyed and cannot be used properly.",Dc=(()=>{class t{getInstance(n){let r=VW.get(n);return r.isDestroyed?(console.warn(bce),null):r}registerInstance(n,r){return VW.set(n,r)}removeInstance(n){return VW.delete(n)}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),KYe=Object.keys(XO.DefaultSettings),Ece=XO.hooks.getRegistered(),xce=(()=>{class t{mergeSettings(n){let r="settings"in n&&typeof n.settings=="object",i=r?n.settings:{};return Ece.concat(KYe).forEach(s=>{let a=Ece.indexOf(s)>-1,l;r&&a&&(l=n.settings[s]),n[s]!==void 0&&(l=n[s]),l!==void 0&&("ngZone"in n&&typeof l=="function"&&a?i[s]=function(...c){return n.ngZone.run(()=>l.apply(this,c))}:i[s]=l)}),i}prepareChanges(n){let r={};return Object.keys(n).forEach(o=>{n.hasOwnProperty(o)&&(r[o]=n[o].currentValue)}),r}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=ht({token:t,factory:t.\u0275fac}),t})(),Zf=(()=>{class t{constructor(n,r,i){this._hotTableRegisterer=n,this._hotSettingsResolver=r,this.ngZone=i,this.__hotInstance=null,this.columnsComponents=[],this.hotId=""}get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(this._hotTableRegisterer.removeInstance(this.hotId),console.warn(bce),null)}set hotInstance(n){this.__hotInstance=n}ngAfterViewInit(){let n=this._hotSettingsResolver.mergeSettings(this);if(this.columnsComponents.length>0){let r=[];this.columnsComponents.forEach(i=>{r.push(this._hotSettingsResolver.mergeSettings(i))}),n.columns=r}this.ngZone.runOutsideAngular(()=>{this.hotInstance=new XO.Core(this.container.nativeElement,n),this.hotId&&this._hotTableRegisterer.registerInstance(this.hotId,this.hotInstance),this.hotInstance.init()})}ngOnChanges(n){if(this.hotInstance===null)return;let r=this._hotSettingsResolver.prepareChanges(n);this.updateHotTable(r)}ngOnDestroy(){this.ngZone.runOutsideAngular(()=>{this.hotInstance&&this.hotInstance.destroy()}),this.hotId&&this._hotTableRegisterer.removeInstance(this.hotId)}updateHotTable(n){this.hotInstance&&this.ngZone.runOutsideAngular(()=>{this.hotInstance.updateSettings(n,!1)})}onAfterColumnsChange(){if(this.columnsComponents!==void 0&&this.columnsComponents.length>0){let n=[];this.columnsComponents.forEach(i=>{n.push(this._hotSettingsResolver.mergeSettings(i))});let r={columns:n};this.updateHotTable(r)}}onAfterColumnsNumberChange(){let n=[];this.columnsComponents.length>0&&this.columnsComponents.forEach(r=>{n.push(this._hotSettingsResolver.mergeSettings(r))}),this.updateHotTable({columns:n})}addColumn(n){this.columnsComponents.push(n),this.onAfterColumnsNumberChange()}removeColumn(n){let r=this.columnsComponents.indexOf(n);this.columnsComponents.splice(r,1),this.onAfterColumnsNumberChange()}}return t.\u0275fac=function(n){return new(n||t)(je(Dc),je(xce),je(nr))},t.\u0275cmp=jt({type:t,selectors:[["hot-table"]],viewQuery:function(n,r){if(n&1&&kD(qYe,5),n&2){let i;pd(i=gd())&&(r.container=i.first)}},inputs:{settings:"settings",hotId:"hotId",activeHeaderClassName:"activeHeaderClassName",allowEmpty:"allowEmpty",allowHtml:"allowHtml",allowInsertColumn:"allowInsertColumn",allowInsertRow:"allowInsertRow",allowInvalid:"allowInvalid",allowRemoveColumn:"allowRemoveColumn",allowRemoveRow:"allowRemoveRow",ariaTags:"ariaTags",autoColumnSize:"autoColumnSize",autoRowSize:"autoRowSize",autoWrapCol:"autoWrapCol",autoWrapRow:"autoWrapRow",bindRowsWithHeaders:"bindRowsWithHeaders",cell:"cell",cells:"cells",checkedTemplate:"checkedTemplate",className:"className",colHeaders:"colHeaders",collapsibleColumns:"collapsibleColumns",columnHeaderHeight:"columnHeaderHeight",columns:"columns",columnSorting:"columnSorting",columnSummary:"columnSummary",colWidths:"colWidths",commentedCellClassName:"commentedCellClassName",comments:"comments",contextMenu:"contextMenu",copyable:"copyable",copyPaste:"copyPaste",correctFormat:"correctFormat",currentColClassName:"currentColClassName",currentHeaderClassName:"currentHeaderClassName",currentRowClassName:"currentRowClassName",customBorders:"customBorders",data:"data",dataSchema:"dataSchema",dateFormat:"dateFormat",datePickerConfig:"datePickerConfig",defaultDate:"defaultDate",tabNavigation:"tabNavigation",disableVisualSelection:"disableVisualSelection",dragToScroll:"dragToScroll",dropdownMenu:"dropdownMenu",editor:"editor",enterBeginsEditing:"enterBeginsEditing",enterMoves:"enterMoves",fillHandle:"fillHandle",filter:"filter",filteringCaseSensitive:"filteringCaseSensitive",filters:"filters",fixedColumnsLeft:"fixedColumnsLeft",fixedColumnsStart:"fixedColumnsStart",fixedRowsBottom:"fixedRowsBottom",fixedRowsTop:"fixedRowsTop",formulas:"formulas",fragmentSelection:"fragmentSelection",height:"height",hiddenColumns:"hiddenColumns",hiddenRows:"hiddenRows",invalidCellClassName:"invalidCellClassName",imeFastEdit:"imeFastEdit",label:"label",language:"language",layoutDirection:"layoutDirection",licenseKey:"licenseKey",locale:"locale",manualColumnFreeze:"manualColumnFreeze",manualColumnMove:"manualColumnMove",manualColumnResize:"manualColumnResize",manualRowMove:"manualRowMove",manualRowResize:"manualRowResize",maxCols:"maxCols",maxRows:"maxRows",mergeCells:"mergeCells",minCols:"minCols",minRows:"minRows",minSpareCols:"minSpareCols",minSpareRows:"minSpareRows",multiColumnSorting:"multiColumnSorting",navigableHeaders:"navigableHeaders",nestedHeaders:"nestedHeaders",nestedRows:"nestedRows",noWordWrapClassName:"noWordWrapClassName",numericFormat:"numericFormat",observeDOMVisibility:"observeDOMVisibility",outsideClickDeselects:"outsideClickDeselects",persistentState:"persistentState",placeholder:"placeholder",placeholderCellClassName:"placeholderCellClassName",preventOverflow:"preventOverflow",preventWheel:"preventWheel",readOnly:"readOnly",readOnlyCellClassName:"readOnlyCellClassName",renderAllRows:"renderAllRows",renderer:"renderer",rowHeaders:"rowHeaders",rowHeaderWidth:"rowHeaderWidth",rowHeights:"rowHeights",search:"search",selectionMode:"selectionMode",selectOptions:"selectOptions",skipColumnOnPaste:"skipColumnOnPaste",skipRowOnPaste:"skipRowOnPaste",sortByRelevance:"sortByRelevance",source:"source",startCols:"startCols",startRows:"startRows",stretchH:"stretchH",strict:"strict",tableClassName:"tableClassName",tabMoves:"tabMoves",title:"title",trimDropdown:"trimDropdown",trimRows:"trimRows",trimWhitespace:"trimWhitespace",type:"type",uncheckedTemplate:"uncheckedTemplate",undo:"undo",validator:"validator",viewportColumnRenderingOffset:"viewportColumnRenderingOffset",viewportRowRenderingOffset:"viewportRowRenderingOffset",visibleRows:"visibleRows",width:"width",wordWrap:"wordWrap",afterAddChild:"afterAddChild",afterAutofill:"afterAutofill",afterBeginEditing:"afterBeginEditing",afterCellMetaReset:"afterCellMetaReset",afterChange:"afterChange",afterChangesObserved:"afterChangesObserved",afterColumnCollapse:"afterColumnCollapse",afterColumnExpand:"afterColumnExpand",afterColumnFreeze:"afterColumnFreeze",afterColumnMove:"afterColumnMove",afterColumnResize:"afterColumnResize",afterColumnSequenceChange:"afterColumnSequenceChange",afterColumnSort:"afterColumnSort",afterColumnUnfreeze:"afterColumnUnfreeze",afterContextMenuDefaultOptions:"afterContextMenuDefaultOptions",afterContextMenuHide:"afterContextMenuHide",afterContextMenuShow:"afterContextMenuShow",afterCopy:"afterCopy",afterCopyLimit:"afterCopyLimit",afterCreateCol:"afterCreateCol",afterCreateRow:"afterCreateRow",afterCut:"afterCut",afterDeselect:"afterDeselect",afterDestroy:"afterDestroy",afterDetachChild:"afterDetachChild",afterDocumentKeyDown:"afterDocumentKeyDown",afterDrawSelection:"afterDrawSelection",afterDropdownMenuDefaultOptions:"afterDropdownMenuDefaultOptions",afterDropdownMenuHide:"afterDropdownMenuHide",afterDropdownMenuShow:"afterDropdownMenuShow",afterFilter:"afterFilter",afterFormulasValuesUpdate:"afterFormulasValuesUpdate",afterGetCellMeta:"afterGetCellMeta",afterGetColHeader:"afterGetColHeader",afterGetColumnHeaderRenderers:"afterGetColumnHeaderRenderers",afterGetRowHeader:"afterGetRowHeader",afterGetRowHeaderRenderers:"afterGetRowHeaderRenderers",afterHideColumns:"afterHideColumns",afterHideRows:"afterHideRows",afterInit:"afterInit",afterLanguageChange:"afterLanguageChange",afterListen:"afterListen",afterLoadData:"afterLoadData",afterMergeCells:"afterMergeCells",afterModifyTransformEnd:"afterModifyTransformEnd",afterModifyTransformStart:"afterModifyTransformStart",afterMomentumScroll:"afterMomentumScroll",afterNamedExpressionAdded:"afterNamedExpressionAdded",afterNamedExpressionRemoved:"afterNamedExpressionRemoved",afterOnCellContextMenu:"afterOnCellContextMenu",afterOnCellCornerDblClick:"afterOnCellCornerDblClick",afterOnCellCornerMouseDown:"afterOnCellCornerMouseDown",afterOnCellMouseDown:"afterOnCellMouseDown",afterOnCellMouseOut:"afterOnCellMouseOut",afterOnCellMouseOver:"afterOnCellMouseOver",afterOnCellMouseUp:"afterOnCellMouseUp",afterPaste:"afterPaste",afterPluginsInitialized:"afterPluginsInitialized",afterRedo:"afterRedo",afterRedoStackChange:"afterRedoStackChange",afterRefreshDimensions:"afterRefreshDimensions",afterRemoveCellMeta:"afterRemoveCellMeta",afterRemoveCol:"afterRemoveCol",afterRemoveRow:"afterRemoveRow",afterRender:"afterRender",afterRenderer:"afterRenderer",afterRowMove:"afterRowMove",afterRowResize:"afterRowResize",afterRowSequenceChange:"afterRowSequenceChange",afterScrollHorizontally:"afterScrollHorizontally",afterScrollVertically:"afterScrollVertically",afterScroll:"afterScroll",afterSelectColumns:"afterSelectColumns",afterSelection:"afterSelection",afterSelectionByProp:"afterSelectionByProp",afterSelectionEnd:"afterSelectionEnd",afterSelectionEndByProp:"afterSelectionEndByProp",afterSelectRows:"afterSelectRows",afterSetCellMeta:"afterSetCellMeta",afterSetDataAtCell:"afterSetDataAtCell",afterSetDataAtRowProp:"afterSetDataAtRowProp",afterSetSourceDataAtCell:"afterSetSourceDataAtCell",afterSheetAdded:"afterSheetAdded",afterSheetRenamed:"afterSheetRenamed",afterSheetRemoved:"afterSheetRemoved",afterTrimRow:"afterTrimRow",afterUndo:"afterUndo",afterUndoStackChange:"afterUndoStackChange",afterUnhideColumns:"afterUnhideColumns",afterUnhideRows:"afterUnhideRows",afterUnlisten:"afterUnlisten",afterUnmergeCells:"afterUnmergeCells",afterUntrimRow:"afterUntrimRow",afterUpdateData:"afterUpdateData",afterUpdateSettings:"afterUpdateSettings",afterValidate:"afterValidate",afterViewportColumnCalculatorOverride:"afterViewportColumnCalculatorOverride",afterViewportRowCalculatorOverride:"afterViewportRowCalculatorOverride",afterViewRender:"afterViewRender",beforeAddChild:"beforeAddChild",beforeAutofill:"beforeAutofill",beforeCellAlignment:"beforeCellAlignment",beforeChange:"beforeChange",beforeChangeRender:"beforeChangeRender",beforeColumnCollapse:"beforeColumnCollapse",beforeColumnExpand:"beforeColumnExpand",beforeColumnFreeze:"beforeColumnFreeze",beforeColumnMove:"beforeColumnMove",beforeColumnResize:"beforeColumnResize",beforeColumnSort:"beforeColumnSort",beforeColumnWrap:"beforeColumnWrap",beforeColumnUnfreeze:"beforeColumnUnfreeze",beforeContextMenuSetItems:"beforeContextMenuSetItems",beforeContextMenuShow:"beforeContextMenuShow",beforeCopy:"beforeCopy",beforeCreateCol:"beforeCreateCol",beforeCreateRow:"beforeCreateRow",beforeCut:"beforeCut",beforeDetachChild:"beforeDetachChild",beforeDrawBorders:"beforeDrawBorders",beforeDropdownMenuSetItems:"beforeDropdownMenuSetItems",beforeDropdownMenuShow:"beforeDropdownMenuShow",beforeFilter:"beforeFilter",beforeGetCellMeta:"beforeGetCellMeta",beforeHideColumns:"beforeHideColumns",beforeHideRows:"beforeHideRows",beforeHighlightingColumnHeader:"beforeHighlightingColumnHeader",beforeHighlightingRowHeader:"beforeHighlightingRowHeader",beforeInit:"beforeInit",beforeInitWalkontable:"beforeInitWalkontable",beforeKeyDown:"beforeKeyDown",beforeLanguageChange:"beforeLanguageChange",beforeLoadData:"beforeLoadData",beforeMergeCells:"beforeMergeCells",beforeOnCellContextMenu:"beforeOnCellContextMenu",beforeOnCellMouseDown:"beforeOnCellMouseDown",beforeOnCellMouseOut:"beforeOnCellMouseOut",beforeOnCellMouseOver:"beforeOnCellMouseOver",beforeOnCellMouseUp:"beforeOnCellMouseUp",beforePaste:"beforePaste",beforeRedo:"beforeRedo",beforeRedoStackChange:"beforeRedoStackChange",beforeRefreshDimensions:"beforeRefreshDimensions",beforeRemoveCellClassNames:"beforeRemoveCellClassNames",beforeRemoveCellMeta:"beforeRemoveCellMeta",beforeRemoveCol:"beforeRemoveCol",beforeRemoveRow:"beforeRemoveRow",beforeRender:"beforeRender",beforeRenderer:"beforeRenderer",beforeRowMove:"beforeRowMove",beforeRowResize:"beforeRowResize",beforeRowWrap:"beforeRowWrap",beforeSelectColumns:"beforeSelectColumns",beforeSelectionHighlightSet:"beforeSelectionHighlightSet",beforeSelectRows:"beforeSelectRows",beforeSetCellMeta:"beforeSetCellMeta",beforeSetRangeEnd:"beforeSetRangeEnd",beforeSetRangeStart:"beforeSetRangeStart",beforeSetRangeStartOnly:"beforeSetRangeStartOnly",beforeStretchingColumnWidth:"beforeStretchingColumnWidth",beforeTouchScroll:"beforeTouchScroll",beforeTrimRow:"beforeTrimRow",beforeUndo:"beforeUndo",beforeUndoStackChange:"beforeUndoStackChange",beforeUnhideColumns:"beforeUnhideColumns",beforeUnhideRows:"beforeUnhideRows",beforeUnmergeCells:"beforeUnmergeCells",beforeUntrimRow:"beforeUntrimRow",beforeUpdateData:"beforeUpdateData",beforeValidate:"beforeValidate",beforeValueRender:"beforeValueRender",beforeViewportScroll:"beforeViewportScroll",beforeViewportScrollHorizontally:"beforeViewportScrollHorizontally",beforeViewportScrollVertically:"beforeViewportScrollVertically",beforeViewRender:"beforeViewRender",construct:"construct",init:"init",modifyAutoColumnSizeSeed:"modifyAutoColumnSizeSeed",modifyAutofillRange:"modifyAutofillRange",modifyColHeader:"modifyColHeader",modifyColumnHeaderHeight:"modifyColumnHeaderHeight",modifyColumnHeaderValue:"modifyColumnHeaderValue",modifyColWidth:"modifyColWidth",modifyCopyableRange:"modifyCopyableRange",modifyFocusedElement:"modifyFocusedElement",modifyData:"modifyData",modifyFocusOnTabNavigation:"modifyFocusOnTabNavigation",modifyGetCellCoords:"modifyGetCellCoords",modifyRowData:"modifyRowData",modifyRowHeader:"modifyRowHeader",modifyRowHeaderWidth:"modifyRowHeaderWidth",modifyRowHeight:"modifyRowHeight",modifySourceData:"modifySourceData",modifyTransformEnd:"modifyTransformEnd",modifyTransformStart:"modifyTransformStart",persistentStateLoad:"persistentStateLoad",persistentStateReset:"persistentStateReset",persistentStateSave:"persistentStateSave"},features:[ao([Dc,xce]),Yi],decls:2,vars:1,consts:[[3,"id"],["container",""]],template:function(n,r){n&1&&at(0,"div",0,1),n&2&&lt("id",r.hotId)},encapsulation:2}),t})();var Au=(()=>{class t{static forRoot(){return{ngModule:t,providers:[Dc]}}}return t.version="14.0.0",t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=so({type:t}),t.\u0275inj=oo({}),t})();function XYe(t,e){if(t&1){let n=Fn();W(0,"div",1)(1,"input",7),Ue("change",function(i){mt(n);let o=Le();return pt(o.onFileUpload(i))}),V()(),W(2,"div",1)(3,"button",8),Ue("click",function(){mt(n);let i=Le();return pt(i.onSubmit())}),re(4,"Submit"),V(),W(5,"button",9),Ue("click",function(){mt(n);let i=Le();return pt(i.onDelete())}),re(6," Delete "),V()(),W(7,"div")(8,"h3"),re(9,"Preview"),V(),at(10,"hot-table",10),V()}if(t&2){let n=Le();Te(10),lt("colHeaders",n.colHeader)("hotId",n.id)("settings",n.hotSettings)("hidden",!n.jsonData.length)}}var Tce=(()=>{let e=class e{constructor(r,i,o){this.service=r,this.toastService=i,this.ls=o,this.department="",this.dataSet=[],this.jsonData=[],this.hotRegisterer=new Dc,this.id="hotInstancePre",this.colHeader=[],this.hotSettings={className:"htCenter htMiddle",columnHeaderHeight:40,rowHeights:30,comments:!0,width:"100%",height:"35vh",viewportColumnRenderingOffset:40,viewportRowRenderingOffset:"auto",allowRemoveColumn:!0,allowInsertColumn:!1,allowInsertRow:!1,allowRemoveRow:!0,contextMenu:!0,colWidths:"150",multiColumnSorting:!0,manualColumnResize:!0,filters:!0,manualColumnMove:!0,rowHeaders:!0,dropdownMenu:["remove_col","remove_row","clear_column","undo","redo","filter_by_value","filter_operators","filter_action_bar"]},this.xlToMngKeys={BOARD:"board",SECTION:"section","KM/LINE":"lineNo","MACHINE TYPE & NO.":"machine","DISCONNECTION DEMAND HOURS":"dmd_duration","BLOCK DEMAND HOURS":"dmd_duration",QUANTUM:"quantum","DEPUTED SUPERVISOR":"deputedSupervisor",RESOURCES:"resources",CREW:"crew",LOCO:"loco","TYPE OF WORK":"typeOfWork","WHETHER NI WORK/PNI WORK OR NON-NI WORK":"ni",YARD:"yard","REMARKS IF ANY":"remarks","APPROVAL REQUIRED OR NOT":"approval","S&T STAFF REQUIRED (YES/NO)":"s_tStaff","TPC STAFF REQUIRED (YES/NO)":"tpcStaff","POINT/BPAC/OTHERS":"point","TOWER WAGON/MATERIAL TRAIN":"tower"}}ngOnInit(){this.userData=this.ls.getUser()}onFileUpload(r){let i=null,o=new FileReader,s=r.target.files[0];o.onload=a=>{let l=this.hotRegisterer.getInstance(this.id),c=o.result;i=TA(c,{type:"binary",raw:!1});let u=i.SheetNames[0],d=i.Sheets[u];this.jsonData=Hp.sheet_to_json(d,{raw:!1}),this.colHeader=Object.keys(this.jsonData[0]),l.updateData(this.jsonData)},o.readAsBinaryString(s)}onSubmit(){this.dataSet=this.jsonData.map(r=>{let i={};i.department=this.department,i.createdAt=new Date().toISOString(),i.createdBy=this.userData.username,i.updatedAt=new Date().toISOString(),i.updatedBy=this.userData.username,i.logs=[];for(let o of Object.keys(r)){if(!r[o])continue;let s=o.trim().toUpperCase();if(s==="AVAILABLE SLOT"){let a=r["AVAILABLE SLOT"].split(" "),l=ln.fromFormat(a[1],"HH:mm"),u=ln.fromFormat(a[3],"HH:mm").diff(l,"minutes").minutes;i.date=a[0],i.avl_start=a[1],i.avl_end=a[3],i.avl_duration=u}else this.xlToMngKeys[s]!==void 0&&(i[this.xlToMngKeys[s]]=r[o])}return i}),this.dataSet.length?this.service.addRailDetails("machineRolls",this.dataSet).subscribe(()=>{this.toastService.showSuccess("successfully submitted"),this.onDelete()}):this.toastService.showWarning("Please upload xlsx file"),console.log("\u{1F680} ~ this.dataSet:",this.dataSet)}onDelete(){this.department="";let r=this.hotRegisterer.getInstance(this.id);this.dataSet=[],this.jsonData=[],r.updateData(this.dataSet)}};e.\u0275fac=function(i){return new(i||e)(je(ui),je(lo),je(Ni))},e.\u0275cmp=jt({type:e,selectors:[["app-machine-upload-file"]],standalone:!0,features:[qt],decls:14,vars:2,consts:[[1,""],[1,"m-5"],[1,"form-select","w-25","mt-2","mb-5",3,"ngModel","ngModelChange"],["value","","disabled","","selected",""],["value","ENGINEERING"],["value","S&T"],["value","ELECTRIC"],["id","formFileLg","type","file",1,"form-control","form-control-lg","w-25",3,"change"],[1,"btn","btn-primary","ms-3",3,"click"],[1,"btn","btn-outline-danger","ms-3",3,"click"],["licenseKey","non-commercial-and-evaluation",1,"hot",3,"colHeaders","hotId","settings","hidden"]],template:function(i,o){i&1&&(W(0,"div",0)(1,"div",1)(2,"h4"),re(3,"DEPARTMENT"),V(),W(4,"select",2),Ue("ngModelChange",function(a){return o.department=a}),W(5,"option",3),re(6,"Select Department"),V(),W(7,"option",4),re(8,"ENGINEERING"),V(),W(9,"option",5),re(10,"S&T"),V(),W(11,"option",6),re(12,"ELECTRIC"),V()()(),rn(13,XYe,11,4),V()),i&2&&(Te(4),lt("ngModel",o.department),Te(9),rr(13,o.department!==""?13:-1))},dependencies:[Au,Zf,lv,Qh,Jh,su,ou,LC]});let t=e;return t})();var ZYe=(t,e,n,r,i,o,s)=>{let a=[];if(o?.length){for(let l of o)a.push(`user ${l.updatedBy} modified ${l.field} from ${l.oldValue} to ${l.newValue}.`);e.innerHTML=a.join(" | "),s.comment={value:a.join(`
`),readOnly:!0}}},BW=(t,e,n,r,i,o,s)=>{let a=[];if(o?.length){for(let l of o)a.push(`LENGTH : ${l.length}  |  SPEED : ${l.speed}.`);e.innerHTML=a.join(" | ")}},QYe=(t,e,n,r,i,o,s)=>{let a=[];if(o?.length){for(let l of o)a.push(`BLOCK : ${l.block}  |  DURATION : ${l.duration}.`);e.innerHTML=a.join(" | ")}},Rce=[{data:"_id",title:"id"},{data:"Avl_status",title:"AVAIL STATUS",type:"checkbox",defaultData:!0,width:120},{data:"Dmd_remarks",title:"DEMAND REMARKS",width:140},{data:"status",title:" APPROVE STATUS",type:"select",selectOptions:["Accept","Reject"],width:130},{data:"APL_remarks",title:"APPROVAL REMARKS",width:130},{data:"date",title:"DATE",type:"date",dateFormat:"DD/MM/YYYY",correctFormat:!0,width:95},{data:"department",title:"DEPARTMENT",readonly:!0,editor:!1,width:110},{data:"board",title:"BOARD",type:"text",width:70},{data:"section",title:"SECTION",type:"text",width:80},{data:"avl_start",title:" SLOT START",width:100},{data:"avl_end",title:" SLOT END",width:90},{data:"avl_duration",title:"AVL DUR...",width:100},{data:"dmd_duration",title:"DMD DUR...",width:100},{data:"machine",title:"Machine Type",type:"text",width:110},{data:"stationTo",title:"STATION TO",type:"text",width:100},{data:"stationFrom",title:"STATION FROM",type:"text",width:120},{data:"direction",title:"DIRECTION",type:"text",width:90},{data:"series",title:"SERIES",width:80},{data:"km",title:"KILOMETER",width:80},{data:"ni",title:" NI/Non-NI Work",width:130},{data:"lineNo",title:"KM/LINE",width:90},{data:"typeOfWork",title:"WORK TYPE",width:110},{data:"quantum",title:"QUANTUM",width:100},{data:"deputedSupervisor",title:"DEPUTED SUP...",width:120},{data:"resources",title:"RESOURCES",width:100},{data:"loco",title:"LOCO",width:70},{data:"crew",title:"CREW",width:70},{data:"remarks",title:" REMARKS",width:90},{data:"s_tStaff",title:"S&T STAFF",width:90},{data:"tpcStaff",title:"TPC STAFF",width:90},{data:"integrated",title:"INTEGRATED",width:160,renderer:QYe,editor:!1,readOnly:!0},{data:"grant_status",title:"GRANT STATUS",type:"select",selectOptions:["Pending","Granted","Not Granted"],width:120},{data:"caution",title:"CAUTION",width:160,renderer:BW,editor:!1,readOnly:!0},{data:"time_granted",title:"TIME GRANTED",width:120},{data:"slot",title:"SLOTS",width:70},{data:"output",title:"OUTPUT",width:100},{data:"OPTG_remarks",title:"OPTG REMARKS",width:120},{data:"logs",title:"EDIT HISTORY",editor:!1,width:300,renderer:ZYe}];var Hw={className:"htCenter htMiddle",rowHeaders:!0,columns:Rce,columnHeaderHeight:30,multiColumnSorting:!0,manualColumnResize:!0,filters:!0,manualColumnMove:!0,rowHeights:30,comments:!0,width:"100%",height:"100%",viewportColumnRenderingOffset:40,viewportRowRenderingOffset:"auto",dropdownMenu:["filter_by_value","filter_operators","filter_action_bar"],hiddenColumns:{columns:[0],indicators:!1}};var Dce=(()=>{let e=class e{constructor(r,i,o,s){this.service=r,this.ls=i,this.toastService=o,this.route=s,this.hotRegisterer=new Dc,this.id="hotInstance",this.dataSet=[],this.hotSettings=ft(Ee({},Hw),{height:"80vh",afterChange:a=>{a?.forEach(([l,c,u,d])=>{let h=c,f=this.hotRegisterer.getInstance(this.id),p=f.getDataAtRow(l)[0];if(u==d||d==""&&u==null)return;if(h==="date"&&!ln.fromFormat(d,"dd/MM/yyyy").isValid){this.toastService.showDanger("Date should be DD/MM/YYYY format");return}let g=this.dataSet.find(S=>S._id===p);g.logs.length||(g.logs=[]);let w={updatedBy:this.userData.username,updatedAt:new Date().toISOString(),field:h,oldValue:u,newValue:d},_={[h]:d,updatedBy:this.userData.username,updatedAt:new Date().toISOString(),logs:[...g.logs,w]};this.service.updateRailDetails(this.domain,p,_).subscribe(S=>{Object.assign(g,S),f.render();let x=f.propToCol(h),P=f.getCell(l,x);P.style.backgroundColor="lightblue",P.className="updatedCell",this.toastService.showSuccess("successfully Updated")})})}})}ngOnInit(){this.userData=this.ls.getUser(),this.route.params.subscribe(r=>{this.domain=r.domain,Promise.resolve().then(()=>{this.service.getAllMachineRoll(this.domain).subscribe(i=>{let o=this.hotRegisterer.getInstance(this.id);i=i.filter(s=>this.userData.department==="OPERATING"||s.department===this.userData.department),this.dataSet=i,o.updateData(i)})})})}};e.\u0275fac=function(i){return new(i||e)(je(ui),je(Ni),je(lo),je(Xl))},e.\u0275cmp=jt({type:e,selectors:[["app-machine-roll"]],standalone:!0,features:[qt],decls:5,vars:5,consts:[[1,"text-center","mt-5"],[1,"mt-5"],["licenseKey","non-commercial-and-evaluation",1,"hot",3,"hotId","settings"]],template:function(i,o){i&1&&(W(0,"h3",0),re(1),Ts(2,"uppercase"),V(),W(3,"div",1),at(4,"hot-table",2),V()),i&2&&(Te(1),Ki("EDIT ",Rs(2,3,o.domain),""),Te(3),lt("hotId",o.id)("settings",o.hotSettings))},dependencies:[Au,Zf,Mo,Vh],styles:[".updatedCell[_ngcontent-%COMP%]{background-color:#90ee90!important}"]});let t=e;return t})();var Ice=(()=>{let e=class e{constructor(r,i,o){this.service=r,this.toastService=i,this.ls=o,this.domain="",this.dataSet=[],this.hotRegisterer=new Dc,this.id="hotInstance_",this.columns=[{data:"_id",title:"_id"},{data:"Avl_status",title:"AVAIL STATUS",type:"checkbox",defaultData:!0,width:130},{data:"Dmd_remarks",title:"DEMAND REMARKS",width:130},{data:"status",title:" APPROVE STATUS",type:"select",selectOptions:["Accept","Reject","CHOOSE STATUS"],width:130},{data:"Apl_remarks",title:"APPROVAL REMARKS",width:153},{data:"date",title:"DATE",width:73},{data:"department",title:"DEPARTMENT",width:110},{data:"board",title:"BOARD",type:"select",selectOptions:["BG1","BG2","BG3","BG4","BG5"],width:73},{data:"section",title:"SECTION",width:80},{data:"avl_start",title:"SLOT START",width:100},{data:"avl_end",title:"SLOT END",width:90},{data:"avl_duration",title:"AVL DUR...",width:100},{data:"dmd_duration",title:"DMD DUR...",width:100},{data:"machine",title:"MACHINE TYPE",width:120},{data:"quantum",title:"QUANTUM",width:120},{data:"typeOfWork",title:"TYPE OF WORK",width:120},{data:"caution",title:"CAUTION",width:160,renderer:BW,editor:!1,readOnly:!0},{data:"grant_status",title:"GRANT STATUS",type:"select",selectOptions:["Pending","Granted","Not Granted"],width:120},{data:"time_granted",title:"TIME GRANTED",width:120},{data:"slots",title:"SLOTS",width:120},{data:"output",title:"OUTPUT",width:120},{data:"OPTG_remarks",title:"OPTG Remarks",width:120},{data:"rollfrom",title:"ROLL FROM",width:100},{data:"logs",title:"EDIT HISTORY",editor:!1,width:300,renderer:(s,a,l,c,u,d,h)=>{let f=[];if(d?.length){for(let p of d)f.push(`user ${p.updatedBy} modified ${p.field} from ${p.oldValue} to ${p.newValue}.`);a.innerHTML=f.join(" | "),h.comment={value:f.join(`
`),readOnly:!0}}}}],this.hotSettings=ft(Ee({},Hw),{height:"32vh",columns:this.columns,afterChange:s=>{s?.forEach(([a,l,c,u])=>{let d=l;d==="status"&&u==="CHOOSE STATUS"&&(u="");let h=this.hotRegisterer.getInstance(this.id),f=h.getDataAtRow(a)[0],p=h.getDataAtRow(a)[22];if(c==u||u==""&&c==null)return;let g=this.dataSet.find(S=>S._id===f),w={updatedBy:this.userData.username,updatedAt:new Date().toISOString(),field:d,oldValue:c,newValue:u},_={[d]:u,updatedBy:this.userData.username,updatedAt:new Date().toISOString(),logs:[...g.logs,w]};this.service.updateRailDetails(p,f,_).subscribe(()=>{let S=h.propToCol(d),x=h.getCell(a,S);x.style.backgroundColor="lightblue",x.className="updatedCell",this.toastService.showSuccess("successfully Updated")})})},cells:(s,a,l)=>{let c={className:s%2==0?"evenCell":"oddCell"};if(this.dataSet.length!==0)return(l==="grant_status"||l==="time_granted"||l==="remarks"||l==="status"||l==="Avl_status"||l==="OPTG_remarks"||l==="output"||l==="slots"||l==="Apl_remarks"||l==="Dmd_remarks")&&this.userData.department==="OPERATING"||(l==="Avl_status"||l==="Dmd_remarks")&&this.userData.department===this.dataSet[s]?.department?c.readOnly=!1:c.readOnly=!0,c}})}ngOnInit(){this.id+=this.domain,this.userData=this.ls.getUser();let r=[];this.domain==="rolling"?r=["machineRolls","maintenanceRolls"]:r=["machineNonRolls","maintenanceNonRolls"],Promise.resolve().then(()=>{for(let i of r)this.service.getAllMachineRoll(i).subscribe(o=>{o=o.map(s=>((s.status==null||s.status=="")&&(s.status="CHOOSE STATUS"),s)),this.setDataToRoll(o,i)})})}setDataToRoll(r,i){let o=this.hotRegisterer.getInstance(this.id);r=r.map(s=>(s.rollfrom=i,s)),this.userData.department!=="OPERATING"&&(r=r.filter(s=>s.department===this.userData.department)),this.dataSet.push(...r),o.updateSettings({data:this.dataSet})}selectStartDate(r){this.startDate=ln.fromISO(r.target.value)}selectEndDate(r){this.endDate=ln.fromISO(r.target.value)}filterDataWithDate(){if(!this.startDate&&!this.endDate)return;let r=this.hotRegisterer.getInstance(this.id),i=this.dataSet.filter(o=>{let s=ln.fromFormat(o.date,"dd/MM/yyyy");return this.startDate<=s&&this.endDate>=s||this.startDate!==void 0&&this.startDate<=s&&this.endDate==null?!0:this.endDate!==void 0&&this.endDate>=s&&this.startDate==null});r.updateData(i)}ResetDates(){this.hotRegisterer.getInstance(this.id).updateData(this.dataSet)}};e.\u0275fac=function(i){return new(i||e)(je(ui),je(lo),je(Ni))},e.\u0275cmp=jt({type:e,selectors:[["app-verify-demand-table"]],inputs:{domain:"domain"},standalone:!0,features:[qt],decls:24,vars:5,consts:[[1,"mt-3"],[1,"text-center"],[1,"row","mb-3","w-100"],[1,"col-2"],[1,"text-end","fw-semibold"],[1,"col-3"],["type","date",1,"form-control",3,"change"],[1,"btn","btn-primary",3,"click"],["licenseKey","non-commercial-and-evaluation",1,"hot",3,"hotId","settings"]],template:function(i,o){i&1&&(W(0,"div",0)(1,"h3",1),re(2),Ts(3,"uppercase"),V(),W(4,"div",2)(5,"div",3)(6,"h4",4),re(7,"Filter:"),V()(),W(8,"div",5)(9,"label"),re(10,"From: "),V(),W(11,"input",6),Ue("change",function(a){return o.selectStartDate(a)}),V()(),W(12,"div",5)(13,"label"),re(14,"To: "),V(),W(15,"input",6),Ue("change",function(a){return o.selectEndDate(a)}),V()(),W(16,"div",3)(17,"button",7),Ue("click",function(){return o.filterDataWithDate()}),re(18,"Submit"),V()(),W(19,"div",3)(20,"button",7),Ue("click",function(){return o.ResetDates()}),re(21,"Reset"),V()()(),at(22,"hot-table",8)(23,"hr"),V()),i&2&&(Te(2),Ki("",Rs(3,3,o.domain)," DEMAND"),Te(20),lt("hotId",o.id)("settings",o.hotSettings))},dependencies:[Mo,Vh,Au,Zf]});let t=e;return t})();var Ace=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-verify-demand"]],standalone:!0,features:[qt],decls:2,vars:2,consts:[[3,"domain"]],template:function(i,o){i&1&&at(0,"app-verify-demand-table",0)(1,"app-verify-demand-table",0),i&2&&(lt("domain","rolling"),Te(1),lt("domain","non-Rolling"))},dependencies:[Au,Ice],styles:[".updatedCell[_ngcontent-%COMP%]{background-color:#add8e6!important}"]});let t=e;return t})();function JYe(t,e){if(t&1){let n=Fn();W(0,"li")(1,"div",1)(2,"div",18),re(3),V(),W(4,"div",22)(5,"button",23),Ue("click",function(){let o=mt(n).$implicit,s=Le(2);return pt(s.editBoard(o))}),re(6,"edit"),V(),W(7,"button",24),Ue("click",function(){let o=mt(n).$implicit,s=Le(2);return pt(s.onDeleteBoard(o))}),re(8,"x"),V()()()()}if(t&2){let n=e.$implicit;Te(3),Ki(" ",n.board," ")}}function eqe(t,e){if(t&1){let n=Fn();W(0,"div",1)(1,"div",14)(2,"label"),re(3,"BOARD"),V(),W(4,"input",15),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectBoard(i))}),V(),W(5,"button",16),Ue("click",function(){mt(n);let i=Le();return pt(i.addBoard())}),re(6,"ADD"),V()(),W(7,"div",17)(8,"div",1)(9,"div",18)(10,"h3",2),re(11,"Already added BOARD"),V()(),W(12,"div",19)(13,"div",20),re(14,"EDIT"),V(),W(15,"div",2),re(16,"DELETE"),V()()(),W(17,"ol",21),Gn(18,JYe,9,1,"li",null,Mr),V()()()}if(t&2){let n=Le();Te(18),zn(n.boardDataset)}}function tqe(t,e){if(t&1&&(W(0,"option",29),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function nqe(t,e){if(t&1){let n=Fn();W(0,"li")(1,"div",1)(2,"div",18),re(3),V(),W(4,"div",22)(5,"button",23),Ue("click",function(){mt(n);let i=Le(),o=i.$implicit,s=i.$index,a=Le(2);return pt(a.editSection(o,s))}),re(6,"edit"),V(),W(7,"button",24),Ue("click",function(){mt(n);let i=Le().$implicit,o=Le(2);return pt(o.onDeleteSection(i._id,i.section))}),re(8,"x"),V()()()()}if(t&2){let n=Le().$implicit;Te(3),Ki(" ",n.section," ")}}function rqe(t,e){if(t&1&&rn(0,nqe,9,1,"li"),t&2){let n=e.$implicit,r=Le(2);rr(0,n.board===r.board?0:-1)}}function iqe(t,e){if(t&1){let n=Fn();W(0,"div",1)(1,"div",14)(2,"div",25)(3,"label"),re(4,"BOARD"),V(),W(5,"select",26),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectBoard(i))}),W(6,"option",27),re(7,"SELECT BOARD"),V(),Gn(8,tqe,2,2,"option",29,Mr),V()(),W(10,"label"),re(11,"SECTION"),V(),W(12,"input",28),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectSection(i))}),V(),W(13,"button",16),Ue("click",function(){mt(n);let i=Le();return pt(i.addSection())}),re(14,"ADD"),V()(),W(15,"div",17)(16,"div",1)(17,"div",18)(18,"h3",2),re(19),V()(),W(20,"div",19)(21,"div",20),re(22,"EDIT"),V(),W(23,"div",2),re(24,"DELETE"),V()()(),W(25,"ol",21),Gn(26,rqe,1,1,null,null,Mr),V()()()}if(t&2){let n=Le();Te(8),zn(n.boardList),Te(11),Ki("SECTION under: ",n.board,""),Te(7),zn(n.dataSet)}}function oqe(t,e){if(t&1&&(W(0,"option",29),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function sqe(t,e){if(t&1&&(W(0,"option",29),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function aqe(t,e){if(t&1){let n=Fn();W(0,"li")(1,"div",1)(2,"div",18),re(3),V(),W(4,"div",22)(5,"button",23),Ue("click",function(){let i=mt(n),o=i.$implicit,s=i.$index,a=Le(2);return pt(a.editStation(o,s))}),re(6,"edit"),V(),W(7,"button",24),Ue("click",function(){let o=mt(n).$implicit,s=Le(2);return pt(s.onDeleteStation(o))}),re(8,"x"),V()()()()}if(t&2){let n=e.$implicit;Te(3),Ki(" ",n," ")}}function lqe(t,e){if(t&1){let n=Fn();W(0,"div",1)(1,"div",14)(2,"div",25)(3,"label"),re(4,"BOARD"),V(),W(5,"select",26),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectBoard(i))}),W(6,"option",27),re(7,"SELECT BOARD"),V(),Gn(8,oqe,2,2,"option",29,Mr),V()(),W(10,"div",25)(11,"label"),re(12,"SECTION"),V(),W(13,"select",26),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectSection(i))}),Gn(14,sqe,2,2,"option",29,Mr),V()(),W(16,"label"),re(17,"STATION"),V(),W(18,"input",30),Ue("ngModelChange",function(i){mt(n);let o=Le();return pt(o.station=i)}),V(),W(19,"button",16),Ue("click",function(){mt(n);let i=Le();return pt(i.addStation())}),re(20,"ADD"),V()(),W(21,"div",17)(22,"div",1)(23,"div",18)(24,"h3",2),re(25),V()(),W(26,"div",19)(27,"div",20),re(28,"EDIT"),V(),W(29,"div",2),re(30,"DELETE"),V()()(),W(31,"ol",21),Gn(32,aqe,9,1,"li",null,Mr),V()()()}if(t&2){let n=Le();Te(8),zn(n.boardList),Te(6),zn(n.sectionList),Te(4),lt("ngModel",n.station),Te(7),z0("STATION under Board: ",n.board," | ",n.section,""),Te(7),zn(n.sectionSelected.stations)}}function cqe(t,e){if(t&1&&(W(0,"option",29),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function uqe(t,e){if(t&1&&(W(0,"option",29),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function dqe(t,e){if(t&1){let n=Fn();W(0,"input",38),Ue("ngModelChange",function(i){let s=mt(n).$index,a=Le(2);return pt(a.directions[s].checked=i)}),V(),W(1,"label",39),re(2),Ts(3,"uppercase"),V()}if(t&2){let n=e.$implicit,r=e.$index,i=Le(2);Oi("id",r),lt("ngModel",i.directions[r].checked),Te(1),Oi("for",r),Te(1),Hn(Rs(3,4,n.direction))}}function hqe(t,e){if(t&1){let n=Fn();W(0,"div",2)(1,"h3",2),re(2),Ts(3,"uppercase"),V(),W(4,"div",2),re(5,"Repeat on"),V(),W(6,"input",38),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.days[0]=i)}),V(),W(7,"label",39),re(8,"S"),V(),W(9,"input",38),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.days[1]=i)}),V(),W(10,"label",39),re(11,"M"),V(),W(12,"input",38),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.days[2]=i)}),V(),W(13,"label",39),re(14,"T"),V(),W(15,"input",38),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.days[3]=i)}),V(),W(16,"label",39),re(17,"W"),V(),W(18,"input",38),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.days[4]=i)}),V(),W(19,"label",39),re(20,"T"),V(),W(21,"input",38),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.days[5]=i)}),V(),W(22,"label",39),re(23,"F"),V(),W(24,"input",38),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.days[6]=i)}),V(),W(25,"label",39),re(26,"S"),V(),W(27,"div",41),re(28,"Timing"),V(),W(29,"div",1)(30,"div",17)(31,"label"),re(32,"Start:"),V(),W(33,"ngb-timepicker",42),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.start=i)}),V()(),W(34,"div",17)(35,"label"),re(36,"end:"),V(),W(37,"ngb-timepicker",42),Ue("ngModelChange",function(i){mt(n);let o=Le().$implicit;return pt(o.end=i)}),V()()(),at(38,"hr"),V()}if(t&2){let n=Le(),r=n.$implicit,i=n.$index,o=Le(2);Te(2),Hn(Rs(3,38,r.direction)),Te(4),Jo("id","Sunday",o.selectedAvl,"",i,""),lt("ngModel",r.days[0]),Te(1),Jo("for","Sunday",o.selectedAvl,"",i,""),Te(2),Jo("id","Monday",o.selectedAvl,"",i,""),lt("ngModel",r.days[1]),Te(1),Jo("for","Monday",o.selectedAvl,"",i,""),Te(2),Jo("id","Tuesday",o.selectedAvl,"",i,""),lt("ngModel",r.days[2]),Te(1),Jo("for","Tuesday",o.selectedAvl,"",i,""),Te(2),Jo("id","Wednesday",o.selectedAvl,"",i,""),lt("ngModel",r.days[3]),Te(1),Jo("for","Wednesday",o.selectedAvl,"",i,""),Te(2),Jo("id","Thursday",o.selectedAvl,"",i,""),lt("ngModel",r.days[4]),Te(1),Jo("for","Thursday",o.selectedAvl,"",i,""),Te(2),Jo("id","Friday",o.selectedAvl,"",i,""),lt("ngModel",r.days[5]),Te(1),Jo("for","Friday",o.selectedAvl,"",i,""),Te(2),Jo("id","Saturday",o.selectedAvl,"",i,""),lt("ngModel",r.days[6]),Te(1),Jo("for","Saturday",o.selectedAvl,"",i,""),Te(8),lt("ngModel",r.start),Te(4),lt("ngModel",r.end)}}function fqe(t,e){if(t&1&&rn(0,hqe,39,40,"div",40),t&2){let n=e.$implicit;rr(0,n.checked?0:-1)}}function mqe(t,e){if(t&1&&(W(0,"li",44),re(1),V()),t&2){let n=e.$implicit;Te(1),Ki(" ",n.value," ")}}function pqe(t,e){if(t&1&&(W(0,"ul",43)(1,"li",44)(2,"ul"),Gn(3,mqe,2,1,"li",45,Mr),Ts(5,"keyvalue"),V()()()),t&2){let n=e.$implicit;Te(3),zn(Rs(5,0,n.value))}}function gqe(t,e){if(t&1){let n=Fn();W(0,"li")(1,"div",1)(2,"div",36)(3,"div",2)(4,"h3"),re(5),V()(),Gn(6,pqe,6,2,"ul",46,Mr),Ts(8,"keyvalue"),V(),W(9,"div",37)(10,"button",24),Ue("click",function(){let o=mt(n).$implicit,s=Le(2);return pt(s.onDeleteAvlSlot(o.key))}),re(11,"x"),V()()()(),at(12,"hr")}if(t&2){let n=e.$implicit;Te(5),Hn(n.key),Te(1),zn(Rs(8,1,n.value))}}function vqe(t,e){if(t&1){let n=Fn();W(0,"div",1)(1,"div",31)(2,"div",25)(3,"label"),re(4,"BOARD"),V(),W(5,"select",32),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectBoard(i))}),W(6,"option",27),re(7,"SELECT BOARD"),V(),Gn(8,cqe,2,2,"option",29,Mr),V()(),W(10,"div",25)(11,"label"),re(12,"SECTION"),V(),W(13,"select",33),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectSection(i))})("ngModelChange",function(i){mt(n);let o=Le();return pt(o.section=i)}),Gn(14,uqe,2,2,"option",29,Mr),V()(),W(16,"div",2)(17,"div",2),re(18,"DIRECTION"),V(),Gn(19,dqe,4,6,null,null,Mr),V(),W(21,"label"),re(22,"AVAILABLE SLOT"),V(),at(23,"br"),W(24,"div",34),at(25,"hr"),W(26,"div",2),Gn(27,fqe,1,1,null,null,Mr),V()(),W(29,"button",35),Ue("click",function(){mt(n);let i=Le();return pt(i.onSubmitAvl())}),re(30,"ADD"),V()(),W(31,"div",17)(32,"div",1)(33,"div",36)(34,"h3",2),re(35),V()(),W(36,"div",37)(37,"div",2),re(38,"DELETE"),V()()(),W(39,"ol",21),Gn(40,gqe,13,3,null,null,Mr),Ts(42,"keyvalue"),V()()()}if(t&2){let n=Le();Te(8),zn(n.boardList),Te(5),lt("ngModel",n.section),Te(1),zn(n.sectionList),Te(5),zn(n.directions),Te(8),zn(n.directions),Te(8),z0("AVAILABLE SLOT under ",n.board,": ",n.section,""),Te(5),zn(Rs(42,3,n.sectionSelected.slots))}}function wqe(t,e){if(t&1&&(W(0,"option",29),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function yqe(t,e){if(t&1&&(W(0,"option",29),re(1),V()),t&2){let n=e.$implicit;Oi("value",n),Te(1),Hn(n)}}function _qe(t,e){if(t&1&&(W(0,"option",29),Ts(1,"json"),re(2),V()),t&2){let n=e.$implicit;Oi("value",Rs(1,2,n)),Te(2),Hn(n.station)}}function Cqe(t,e){if(t&1){let n=Fn();W(0,"li")(1,"div",1)(2,"div",18),re(3),V(),W(4,"div",22)(5,"button",23),Ue("click",function(){mt(n);let i=Le(2);return pt(i.addMPS(!1,!0))}),re(6,"edit"),V(),W(7,"button",24),Ue("click",function(){mt(n);let i=Le(2);return pt(i.addMPS(!1))}),re(8,"x"),V()()()()}if(t&2){let n=Le(2);Te(3),Ki(" ",n.stationSelected.mps," km/hr ")}}function Sqe(t,e){if(t&1){let n=Fn();W(0,"div",1)(1,"div",14)(2,"div",25)(3,"label"),re(4,"BOARD"),V(),W(5,"select",26),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectBoard(i))}),W(6,"option",27),re(7,"SELECT BOARD"),V(),Gn(8,wqe,2,2,"option",29,Mr),V()(),W(10,"div",25)(11,"label"),re(12,"SECTION"),V(),W(13,"select",26),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectSection(i))}),Gn(14,yqe,2,2,"option",29,Mr),V()(),W(16,"div",25)(17,"label"),re(18,"STATION"),V(),W(19,"select",26),Ue("change",function(i){mt(n);let o=Le();return pt(o.onSelectStation(i))}),W(20,"option",27),re(21,"SELECT STATION"),V(),Gn(22,_qe,3,4,"option",29,Mr),V()(),W(24,"div",25)(25,"label"),re(26,"MPS"),V(),W(27,"input",47),Ue("ngModelChange",function(i){mt(n);let o=Le();return pt(o.mps=i)}),V()(),W(28,"button",16),Ue("click",function(){mt(n);let i=Le();return pt(i.addMPS())}),re(29,"ADD"),V()(),W(30,"div",17)(31,"div",1)(32,"div",18)(33,"h3",2),re(34),V()(),W(35,"div",19)(36,"div",20),re(37,"EDIT"),V(),W(38,"div",2),re(39,"DELETE"),V()()(),W(40,"ol",21),rn(41,Cqe,9,1,"li"),V()()()}if(t&2){let n=Le();Te(8),zn(n.boardList),Te(6),zn(n.sectionList),Te(8),zn(n.stationList),Te(5),lt("ngModel",n.mps),Te(7),DL("MPS \u2013 Maximum Permission Speed under ",n.board," : ",n.section," : ",n.stationSelected.station,""),Te(7),rr(41,n.stationSelected.mps?41:-1)}}function Eqe(t,e){if(t&1){let n=Fn();W(0,"li")(1,"div",1)(2,"div",18),re(3),V(),W(4,"div",22)(5,"button",23),Ue("click",function(){let i=mt(n),o=i.$implicit,s=i.$index,a=Le(2);return pt(a.editMachine(o,s))}),re(6,"edit"),V(),W(7,"button",24),Ue("click",function(){let o=mt(n).$implicit,s=Le(2);return pt(s.onDeleteMachine(o))}),re(8,"x"),V()()()()}if(t&2){let n=e.$implicit;Te(3),Ki(" ",n.machine," ")}}function xqe(t,e){if(t&1){let n=Fn();W(0,"div",1)(1,"div",14)(2,"label"),re(3,"MACHINE"),V(),W(4,"input",48),Ue("ngModelChange",function(i){mt(n);let o=Le();return pt(o.machine=i)}),V(),W(5,"button",16),Ue("click",function(){mt(n);let i=Le();return pt(i.addMachine())}),re(6,"ADD"),V()(),W(7,"div",17)(8,"div",1)(9,"div",18)(10,"h3",2),re(11,"MACHINES"),V()(),W(12,"div",19)(13,"div",20),re(14,"EDIT"),V(),W(15,"div",2),re(16,"DELETE"),V()()(),W(17,"ol",21),Gn(18,Eqe,9,1,"li",null,Mr),V()()()}if(t&2){let n=Le();Te(4),lt("ngModel",n.machine),Te(14),zn(n.machineList)}}var Mce=(()=>{let e=class e{constructor(r,i,o,s){this.service=r,this.toastService=i,this.router=o,this.ls=s,this.active="board",this.board="",this.section="",this.mps="",this.station="",this.machine="",this.slot="",this.sectionSelected={},this.stationSelected={},this.boardList=[],this.sectionList=[],this.machineList=[],this.dataSet=[],this.directions=[{id:1,direction:"up",days:[],start:{},end:{},checked:!1},{id:2,direction:"down",days:[],start:{},end:{},checked:!1},{id:3,direction:"both",days:[],start:{},end:{},checked:!1},{id:4,direction:"north",days:[],start:{},end:{},checked:!1},{id:5,direction:"south",days:[],start:{},end:{},checked:!1}],this.stationList=[],this.railForm=[],this.avlPreview={},this.weekdays=["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"],this.boardDataset=[],this.ls.getUser().department!=="OPERATING"&&this.router.navigate(["/lmg"])}ngOnInit(){Promise.resolve().then(()=>{this.service.getAllRailDetails("boards").subscribe(r=>{this.boardDataset=r;for(let i of r)this.boardList.push(i.board)})}),Promise.resolve().then(()=>{this.service.getAllRailDetails("railDetails").subscribe(r=>{this.dataSet=r})}),Promise.resolve().then(()=>{this.service.getAllRailDetails("machines").subscribe(r=>{this.machineList=r})})}onSelectBoard(r){this.board=r.target.value,this.sectionList=[];for(let i of this.dataSet)i.board===this.board&&this.sectionList.push(i.section);this.onSelectSection(this.sectionList[0])}onSelectSection(r){r.target!=null?this.section=r.target.value:this.section=r;for(let i in this.dataSet)this.dataSet[i].board===this.board&&this.dataSet[i].section===this.section&&(this.sectionSelected=this.dataSet[i],this.selectIndex=+i);(this.active=="mps"||this.active=="station")&&this.service.getAllRailDetails("stations?stations="+this.sectionSelected.stations).subscribe(i=>{this.stationList=i})}onSelectStation(r){this.stationSelected=JSON.parse(r.target.value)}onSubmitAvl(){if(this.board==""||this.section==""){this.toastService.showWarning("enter valid Details");return}for(let o of this.directions){if(!o.checked)continue;let s=o.start.hour<10?"0"+o.start.hour:o.start.hour,a=o.start.minute<10?"0"+o.start.minute:o.start.minute,l=o.end.hour<10?"0"+o.end.hour:o.end.hour,c=o.end.minute<10?"0"+o.end.minute:o.end.minute;for(let u in o.days)o.days[u]&&(this.sectionSelected.slots||(this.sectionSelected.slots={}),this.sectionSelected.slots[o.direction]||(this.sectionSelected.slots[o.direction]={}),this.sectionSelected.slots[o.direction][u]||(this.sectionSelected.slots[o.direction][u]=[]),this.sectionSelected.slots[o.direction][u].push(`${s}:${a} to ${l}:${c} hrs ${this.weekdays[u]}`));this.avlPreview[o.direction]=this.sectionSelected.slots[o.direction]}if(this.board==""||this.section==""||Object.keys(this.avlPreview).length==0){this.toastService.showWarning("enter valid Details");return}let i={directions:[...new Set([...this.sectionSelected.directions,...Object.keys(this.avlPreview)])],slots:Ee(Ee({},this.sectionSelected.slots),this.avlPreview)};this.updateAvlSlot(i),this.avlPreview=[]}addBoard(){if(this.board==""){this.toastService.showWarning("enter valid Details");return}if(this.boardList.includes(this.board)){this.toastService.showDanger(this.board+" is already existed");return}let r={board:this.board};this.service.addRailDetails("boards",r).subscribe(i=>{this.toastService.showSuccess("successfully submitted"),this.boardList.push(this.board),this.board="",this.boardDataset.push(i)})}addSection(){if(this.board==""||this.section==""){this.toastService.showWarning("enter valid Details");return}let r={board:this.board,section:this.section};this.service.addRailDetails("railDetails",r).subscribe(i=>{i.code==11e3?this.toastService.showDanger(this.section+" is already existed"):(this.dataSet[this.dataSet.length]=i,this.sectionList.push(this.section),this.toastService.showSuccess("successfully submitted"))})}addMPS(r=!0,i=!1){if((this.board==""||this.section==""||this.mps=="")&&r&&!i){this.toastService.showWarning("enter valid Details");return}if(this.stationSelected.mps!==0&&!i){this.toastService.showDanger(this.mps+" is couldn't update");return}let o={mps:0};if(!(i&&(this.mps=prompt("enter the new MPS",this.stationSelected.mps),this.mps===null||this.mps=="0"||this.mps===this.stationSelected.mps))){if(r||i)o.mps=+this.mps;else if(!confirm("Are you sure to delete :"+this.mps))return;this.service.updateRailDetails("stations",this.stationSelected._id,o).subscribe(s=>{this.stationSelected=s,this.toastService.showSuccess("successfully submitted")})}}addStation(){if(this.board==""||this.section==""||this.station==""){this.toastService.showWarning("enter valid Details");return}let r={stations:[...this.sectionSelected.stations,this.station]},i={station:this.station,mps:0};this.service.addRailDetails("stations",i).subscribe(o=>{if(o.code==11e3){this.toastService.showDanger(this.station+" is already existed");return}else this.stationList.push(o),this.updateStation(r)})}addMachine(){if(this.machine==""){this.toastService.showWarning("enter valid Details");return}if(this.machineList.includes(this.machine)){this.toastService.showDanger(this.machine+" is already existed");return}let r={machine:this.machine};this.service.addRailDetails("machines",r).subscribe(i=>{this.toastService.showSuccess("successfully submitted"),this.machineList.push(i),this.machine=""})}onDeleteBoard(r){if(confirm("entire data of "+r.board+" is deleted")){for(let o of this.dataSet)o.board==r.board&&this.service.deleteRailDetails("railDetails",o._id).subscribe(s=>{});this.service.deleteRailDetails("boards",r._id).subscribe(()=>{this.boardList=this.boardList.filter(o=>o!=r.board),this.boardDataset=this.boardDataset.filter(o=>o.board!==r.board),this.toastService.showSuccess("successfully deleted")})}}onDeleteSection(r,i){confirm("entire data of "+i+" is deleted")&&this.service.deleteRailDetails("railDetails",r).subscribe(s=>{this.dataSet=this.dataSet.filter(a=>a._id!=r),this.toastService.showSuccess("successfully deleted")})}onDeleteMachine(r){confirm("Are you sure to delete :"+r.machine)&&this.service.deleteRailDetails("machines",r._id).subscribe(o=>{this.machineList=this.machineList.filter(s=>s._id!=r._id),this.toastService.showSuccess("successfully deleted")})}onDeleteStation(r){if(!confirm("Are you sure to delete : "+r))return;let s={stations:this.sectionSelected.stations.filter(l=>l!==r)},a=this.stationList.find(l=>l.station==r);this.service.deleteRailDetails("stations",a._id).subscribe(),this.updateStation(s)}onDeleteAvlSlot(r){if(!confirm("Are you sure to delete :"+r))return;let o=this.sectionSelected.directions.filter(l=>l!==r),s=Ee({},this.sectionSelected.slots);delete s[r];let a={directions:o,slots:s};this.updateAvlSlot(a)}updateAvlSlot(r){this.service.updateRailDetails("railDetails",this.sectionSelected._id,r).subscribe(i=>{this.toastService.showSuccess("successfully submitted"),this.dataSet[this.selectIndex]=i,this.sectionSelected=i})}updateStation(r){this.service.updateRailDetails("railDetails",this.sectionSelected._id,r).subscribe(i=>{i.code==11e3?this.toastService.showDanger(this.station+" is already existed"):(this.toastService.showSuccess("successfully submitted"),this.dataSet[this.selectIndex]=i,this.sectionSelected=i)})}editBoard(r){let i=prompt("Rename the board:",r.board);if(!(i===null||i===r.board)){for(let o of this.dataSet)o.board==r.board&&this.service.updateRailDetails("railDetails",o._id,{board:i}).subscribe(s=>{this.dataSet=this.dataSet.map(a=>(a._id===s._id&&(a.board=s.board),a))});console.log("\u{1F680} ~ dataSet:",this.dataSet),this.service.updateRailDetails("boards",r._id,{board:i}).subscribe(()=>{this.boardList=this.boardList.map(o=>(o==r.board&&(o=i),o)),this.boardDataset=this.boardDataset.map(o=>(o.board===r.board&&(o.board=i),o)),console.log("\u{1F680} ~ boardDataset:",this.boardDataset),this.toastService.showSuccess("successfully Updated")})}}editSection(r,i){let o=prompt("Rename the section:",r.section);if(o==null||o===r.section)return;let s={section:o};this.service.updateRailDetails("railDetails",r._id,s).subscribe(a=>{a.code==11e3?this.toastService.showDanger(o+" is already existed"):(this.dataSet[i]=a,this.sectionList.splice(this.sectionList.indexOf(r.section),1,o),this.toastService.showSuccess("successfully Updated"))})}editStation(r,i){let o=prompt("Rename the Station:",r);if(o===null||o===r)return;let s=[...this.sectionSelected.stations];s.splice(i,1);let a={stations:[...s,o]},l={station:o},c=this.stationList.find(u=>u.station==r);this.service.updateRailDetails("stations",c._id,l).subscribe(u=>{if(u.code==11e3){this.toastService.showDanger(o+" is already existed");return}else this.stationList=this.stationList.map(d=>(d.station==r&&(d.station=o),d)),this.sectionSelected.stations[i]=o,this.updateStation(a)})}editMachine(r,i){let o=prompt("Rename the Machine:",r.machine);if(o===null||o===r.machine)return;let s={machine:o};this.service.updateRailDetails("machines",r._id,s).subscribe(a=>{this.machineList[i]=a,this.toastService.showSuccess("successfully Updated")})}onTabChange(){this.board="",this.section="",this.sectionList=[],this.directions=[{id:1,direction:"up",days:[],start:{},end:{},checked:!1},{id:2,direction:"down",days:[],start:{},end:{},checked:!1},{id:3,direction:"both",days:[],start:{},end:{},checked:!1},{id:4,direction:"north",days:[],start:{},end:{},checked:!1},{id:5,direction:"south",days:[],start:{},end:{},checked:!1}],this.sectionSelected={}}};e.\u0275fac=function(i){return new(i||e)(je(ui),je(lo),je(Ds),je(Ni))},e.\u0275cmp=jt({type:e,selectors:[["app-add-details"]],standalone:!0,features:[qt],decls:30,vars:2,consts:[[1,"m-3"],[1,"row"],[1,""],["ngbNav","",1,"nav-pills",3,"activeId","activeIdChange"],["nav","ngbNav"],["ngbNavItem","board"],["ngbNavLink","",3,"click"],["ngbNavContent",""],["ngbNavItem","section"],["ngbNavItem","station"],["ngbNavItem","slot"],["ngbNavItem","mps"],["ngbNavItem","machine"],[1,"ms-4",3,"ngbNavOutlet"],[1,"col-6","AddDetails"],["id","typeahead-format","type","text","name","board",1,"form-control","mt-3","mb-3",3,"change"],[1,"btn","btn-primary","form-control","mt-3",3,"click"],[1,"col-6"],[1,"col-8"],[1,"col-4","d-flex"],[1,"me-3","ms-3"],[1,"fs-5"],[1,"col-4"],[1,"btn","btn-success","me-3",3,"click"],[1,"btn","btn-outline-danger",3,"click"],[1,"form-group"],[1,"form-select","mt-3","mb-3",3,"change"],["value","","selected","","disabled",""],["id","typeahead-format","type","text","name","section",1,"form-control","mt-3","mb-3",3,"change"],[3,"value"],["id","typeahead-format","type","text","name","station",1,"form-control","mt-3","mb-3",3,"ngModel","ngModelChange"],[1,"col-6","avlslot"],["required","",1,"form-select","mt-3","mb-3",3,"change"],["required","",1,"form-select","mt-3","mb-3",3,"ngModel","change","ngModelChange"],[1,"avl-slot"],["type","button",1,"btn","btn-primary","form-control",3,"click"],[1,"col-9"],[1,"col-3"],["type","checkbox",1,"btn-check",3,"id","ngModel","ngModelChange"],[1,"btn","btn-outline-primary","ms-3",3,"for"],["class",""],[1,"mt-3"],[3,"ngModel","ngModelChange"],[1,"list-group"],[1,"list-group-item"],["class","list-group-item"],["class","list-group"],["id","typeahead-format","type","number","name","mps",1,"form-control","mt-3","mb-3",3,"ngModel","ngModelChange"],["id","typeahead-format","type","text","name","machine",1,"form-control","mt-3","mb-3",3,"ngModel","ngModelChange"]],template:function(i,o){if(i&1&&(W(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3,4),Ue("activeIdChange",function(a){return o.active=a}),ea(5,5),W(6,"button",6),Ue("click",function(){return o.onTabChange()}),re(7,"BOARD"),V(),rn(8,eqe,20,0,"ng-template",7),ta(),ea(9,8),W(10,"button",6),Ue("click",function(){return o.onTabChange()}),re(11,"SECTION"),V(),rn(12,iqe,28,1,"ng-template",7),ta(),ea(13,9),W(14,"button",6),Ue("click",function(){return o.onTabChange()}),re(15,"STATION"),V(),rn(16,lqe,34,3,"ng-template",7),ta(),ea(17,10),W(18,"button",6),Ue("click",function(){return o.onTabChange()}),re(19,"SLOT"),V(),rn(20,vqe,43,5,"ng-template",7),ta(),ea(21,11),W(22,"button",6),Ue("click",function(){return o.onTabChange()}),re(23,"MPS"),V(),rn(24,Sqe,42,5,"ng-template",7),ta(),ea(25,12),W(26,"button",6),Ue("click",function(){return o.onTabChange()}),re(27,"MACHINE"),V(),rn(28,xqe,20,1,"ng-template",7),ta(),V(),at(29,"div",13),V()()()),i&2){let s=rC(4);Te(3),lt("activeId",o.active),Te(26),lt("ngbNavOutlet",s)}},dependencies:[Mo,Vh,FY,LY,lv,Qh,Jh,iu,HC,kC,su,ou,ip,LC,nX,tX,XK,SV,HI,LI,qK,VI,KK],styles:[".station[_ngcontent-%COMP%]{border:2px solid;margin:10px 0;padding:10px 2px}.AddDetails[_ngcontent-%COMP%]{border-right:2px solid;height:80vh;margin-top:30px}.avlslot[_ngcontent-%COMP%]{border-right:2px solid}li[_ngcontent-%COMP%]{margin-top:10px}"]});let t=e;return t})();var XVt=Q(ze(),1),ZVt=Q(De(),1);var Oce="handsontableEditor",UW="handsontable",zd=class extends $o{static get EDITOR_TYPE(){return UW}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),If(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);let a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(c,u){let d=this.getSourceData(u.row,u.col);d!==void 0&&a.setValue(d),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Ln(l,s.handsontable),this.htOptions=l}beginEditing(e,n){let r=this.hot.getSettings().onBeginEditing;r&&r()===!1||super.beginEditing(e,n)}createElements(){super.createElements();let e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){let i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,n,r)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){let n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();let r={group:Oce,relativeToGroup:qp,position:"before"},i=(o,s)=>{let a=this.htEditor;if(o!==void 0&&(o<0||a.flipped&&o>a.countRows()-1?a.deselectCell():a.selectCell(o,0),a.getData().length))return s.preventDefault(),wi(s),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{let s=this.htEditor,a,l;return!s.getSelectedLast()&&s.flipped?a=s.countRows()-1:s.getSelectedLast()&&(s.flipped?(l=s.getSelectedLast()[0],a=Math.max(0,l-1)):(l=s.getSelectedLast()[0],a=l-1)),i(a,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{let s=this.htEditor,a,l;if(!s.getSelectedLast()&&!s.flipped)a=0;else if(s.getSelectedLast()){if(s.flipped)a=s.getSelectedLast()[0]+1;else if(!s.flipped){let c=s.countRows()-1;l=s.getSelectedLast()[0],a=Math.min(c,l+1)}}return i(a,o)},preventDefault:!1}],r)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Oce)}};function bqe(t,e,n){Tqe(t,e),e.set(t,n)}function Tqe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QO(t,e,n){return e=Rqe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rqe(t){var e=Dqe(t,"string");return typeof e=="symbol"?e:String(e)}function Dqe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nce(t,e){var n=Iqe(t,e,"get");return Aqe(t,n)}function Iqe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Aqe(t,e){return e.get?e.get.call(t):e.value}var jW="autocomplete",WW=new WeakMap,Yd=class extends zd{constructor(){super(...arguments),QO(this,"query",null),QO(this,"strippedChoices",[]),QO(this,"rawChoices",[]),bqe(this,WW,{writable:!0,value:this.hot.guid.slice(0,9)}),QO(this,"sortByRelevance",function(e,n,r){let i=[],o=[],s=e.length,a=n.length,l,c,u,d;if(s===0){for(u=0;u<a;u++)o.push(u);return o}for(u=0;u<a;u++){if(c=H4(Qn(n[u])),r)d=c.indexOf(e);else{let h=this.cellProperties.locale;d=c.toLocaleLowerCase(h).indexOf(e.toLocaleLowerCase(h))}d!==-1&&(l=c.length-d-s,i.push({baseIndex:u,index:d,charsLeft:l,value:c}))}for(i.sort((h,f)=>{if(f.index===-1)return-1;if(h.index===-1)return 1;if(h.index<f.index)return-1;if(f.index<h.index)return 1;if(h.index===f.index){if(h.charsLeft<f.charsLeft)return-1;if(h.charsLeft>f.charsLeft)return 1}return 0}),u=0,a=i.length;u<a;u++)o.push(i[u].baseIndex);return o})}static get EDITOR_TYPE(){return jW}getValue(){let e=this.rawChoices.find(n=>this.stripValueIfNeeded(n)===this.TEXTAREA.value);return Ze(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),Ne(this.htContainer,"autocompleteEditor"),Ne(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&vt(this.TEXTAREA,[Vie(),Pie(),hM("listbox"),$ie()])}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.hot.getSettings().ariaTags&&vt(this.TEXTAREA,[Wo("false"),Gie(`${Nce(this,WW)}-listbox-${e}-${n}`)])}open(){super.open();let e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=r?.length,{row:o,col:s}=this;this.showEditableElement(),this.focus();let a=dr();a===0&&uw()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[pn(this.TEXTAREA)-2]:void 0,width:e?pn(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,c,u,d,h,f,p)=>{To(l,c,u,d,h,f,p);let{filteringCaseSensitive:g,allowHtml:w,locale:_}=this.cellProperties,S=this.query,x=Qn(f),P,k;x&&!w&&(P=g===!0?x.indexOf(S):x.toLocaleLowerCase(_).indexOf(S.toLocaleLowerCase(_)),P!==-1&&(k=x.substr(P,S.length),x=x.replace(k,`<strong>${k}</strong>`))),n&&vt(c,[kie(),...r?[Kie(i)]:[],...r?[Xie(r.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${u}-${d}`]]),c.innerHTML=x},afterSelection:(l,c)=>{if(n){let u=this.htEditor.getCell(l,c,!0);vt(u,[rw()]),vt(this.TEXTAREA,...zie(u.id))}}}),n&&(vt(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ps()),vt(this.htEditor.rootElement,[dM(),Yie("polite"),qie("text"),["id",`${Nce(this,WW)}-listbox-${o}-${s}`]]),vt(this.TEXTAREA,...Wo("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&vt(this.TEXTAREA,[Wo("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){let n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,r=>{this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){let n=pM(this.TEXTAREA),r=noe(this.TEXTAREA),i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,s=null,a=null,l=e;i&&(s=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));let c=Array.isArray(s)?s.length:0;if(o===!1)c&&(a=s[0]);else{let u=[];for(let d=0,h=l.length;d<h&&!(i&&c<=d);d++)c?u.push(l[s[d]]):u.push(l[d]);a=0,l=u}this.strippedChoices=l,this.htEditor.loadData(Jv([l])),l.length===0?this.htEditor.rootElement.style.display="none":(this.htEditor.rootElement.style.display="",this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),If(this.TEXTAREA,n,n===r?void 0:r)}flipDropdownIfNeeded(){let e=gc(this.hot.view._wt.wtTable.TABLE),n=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(n||!n&&(r||r==="horizontal"))return!1;let i=vr(this.TEXTAREA),o=Nn(this.TEXTAREA),s=this.getDropdownHeight(),a=e.scrollTop,l=Nn(this.hot.view._wt.wtTable.THEAD),c=vr(e),u=i.top-c.top-l+a,d=e.scrollHeight-u-l-o,h=s>d&&u>d;return h?this.flipDropdown(s):this.unflipDropdown(),this.limitDropdownIfNeeded(h?u:d,s),h}limitDropdownIfNeeded(e,n){if(n>e){let r=0,i=0,o=0,s=null;do o=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=o,i+=1;while(r<e);s=r-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(r-o)}}flipDropdown(e){let n=this.htEditor.rootElement.style;n.position="absolute",n.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){let e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownHeight(){let e=this.htEditor.getColWidth(0)+dr(this.hot.rootDocument)+2,n=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:n?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){let e=this.htEditor.getRowHeight(0)||23,n=this.cellProperties.visibleRows;return this.strippedChoices.length>=n?n*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){let{allowHtml:n}=this.cellProperties,r=At(e,o=>Qn(o));return At(r,o=>n?o:H4(o))}allowKeyEventPropagation(e){let n=this.htEditor.getSelectedRangeLast(),r={row:n?n.from.row:-1},i=!1;return e===Ft.ARROW_DOWN&&r.row>0&&r.row<this.htEditor.countRows()-1&&(i=!0),e===Ft.ARROW_UP&&r.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(Doe(e.keyCode)||e.keyCode===Ft.BACKSPACE||e.keyCode===Ft.DELETE||e.keyCode===Ft.INSERT){let n=10;if(e.keyCode===Ft.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}};var $W="checkbox",dg=class extends ca{static get EDITOR_TYPE(){return $W}beginEditing(e,n){if(n&&n.type==="mouseup"){let r=this.TD.querySelector('input[type="checkbox"]');St(r,"htBadValue")||r.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}};var pBt=Q(De(),1),hg=Q(Ma(),1),zW=Q(kce(),1);function JO(t,e,n){return e=Mqe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mqe(t){var e=Oqe(t,"string");return typeof e=="symbol"?e:String(e)}function Oqe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Mx="date",Fce="dateEditor",fg=class extends $o{constructor(){super(...arguments),JO(this,"defaultDateFormat","DD/MM/YYYY"),JO(this,"isCellEdited",!1),JO(this,"parentDestroyed",!1),JO(this,"$datePicker",null)}static get EDITOR_TYPE(){return Mx}init(){if(typeof hg.default!="function")throw new Error("You need to include moment.js to your project.");if(typeof zW.default!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),Ne(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker);let e=new ei(this);e.addEventListener(this.datePicker,"mousedown",n=>{St(n.target,"pika-day")&&this.hideDatepicker(),n.stopPropagation()}),e.addEventListener(this.TEXTAREA,"keydown",n=>{["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(n.code)&&n.preventDefault()})}destroyElements(){let e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=this.hot.getShortcutManager().getContext("editor");super.open(),this.showDatepicker(e),r.addShortcut({keys:[["Enter"]],callback:i=>{i.stopPropagation()},group:Fce})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{this.hot._refreshBorders()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Fce),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e){let r=this.originalValue;r!==void 0&&this.setValue(r)}super.finishEditing(e,n)}showDatepicker(e){let n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,i=this.hot.view.isMouseDown(),o=e?RM(e.keyCode):!1,s;this.datePicker.style.display="block",this.$datePicker=new zW.default(this.getDatePickerConfig()),this.$datePicker._onInputFocus=function(){},this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+n.top+Nn(this.TD)}px`;let a=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?a=n.right-pn(this.datePicker):a=n.left,this.datePickerStyle.left=`${a}px`,this.originalValue?(s=this.originalValue,(0,hg.default)(s,r,!0).isValid()&&this.$datePicker.setMoment((0,hg.default)(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!o&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,(0,hg.default)(s,r,!0).isValid()&&this.$datePicker.setMoment((0,hg.default)(s,r),!0),!o&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){let e=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&Yp(n,this.cellProperties.datePickerConfig);let r=n.onSelect,i=n.onClose;return n.field=e,n.trigger=e,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.isRTL=!1,n.onSelect=o=>{let s=o;isNaN(s.getTime())||(s=(0,hg.default)(s).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(s),r&&r()},n.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},n}};var YW="dropdown",Qf=class extends Yd{static get EDITOR_TYPE(){return YW}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}};ot.getSingleton().add("beforeValidate",function(t,e,n){let r=this.getCellMeta(e,this.propToCol(n));r.editor===Qf&&r.strict===void 0&&(r.filter=!1,r.strict=!0)});var qW="numeric",mg=class extends $o{static get EDITOR_TYPE(){return qW}};var KW="password",pg=class extends $o{static get EDITOR_TYPE(){return KW}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&vt(this.TEXTAREA,[wo()]),yo(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}};var XW="ht_editor_visible",Lce="selectEditor",ZW="select",gg=class extends ca{static get EDITOR_TYPE(){return ZW}init(){this.select=this.hot.rootDocument.createElement("SELECT"),Ne(this.select,"htSelectEditor"),this.select.style.display="none",this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",St(this.select,XW)&&bt(this.select,XW),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s);let a=this.cellProperties.selectOptions,l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),yo(this.select),Rt(l,(c,u)=>{let d=this.hot.rootDocument.createElement("OPTION");d.value=u,vl(d,c),this.select.appendChild(d)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let r=0,i=e.length;r<i;r++)n[e[r]]=e[r];else typeof e=="object"&&(n=e);return n}refreshValue(){let e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==ni.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}let{top:e,start:n,width:r,height:i}=this.getEditedCellRect(),o=this.select.style;o.height=`${i}px`,o.width=`${r}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",Ne(this.select,XW)}registerShortcuts(){let n=this.hot.getShortcutManager().getContext("editor"),r={group:Lce};this.isInFullEditMode()!==!1&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{let i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{let i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Lce)}};var QW="time",vg=class extends $o{static get EDITOR_TYPE(){return QW}prepare(e,n,r,i,o,s){super.prepare(e,n,r,i,o,s),this.TEXTAREA.dir="ltr"}};function Hce(){Fs(ca),Fs(Yd),Fs(dg),Fs(fg),Fs(Qf),Fs(zd),Fs(mg),Fs(pg),Fs(gg),Fs($o),Fs(vg)}var JW="html";function Vw(t,e,n,r,i,o,s){Iu.apply(this,[t,e,n,r,i,o,s]),vl(e,o??"",!1)}Vw.RENDERER_TYPE=JW;var e8="autocomplete";function Il(t,e,n,r,i,o,s){let{rootDocument:a}=t,l=s.allowHtml?Vw:To,c=a.createElement("DIV"),u=t.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute(...wo()),c.appendChild(a.createTextNode(String.fromCharCode(9660))),l.apply(this,[t,e,n,r,i,o,s]),e.firstChild||e.appendChild(a.createTextNode(String.fromCharCode(160))),e.insertBefore(c,e.firstChild),Ne(e,"htAutocomplete"),!t.acArrowListener){let d=new ei(t);t.acArrowListener=function(h){St(h.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,r),e)},d.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{d.destroy()})}}Il.RENDERER_TYPE=e8;var C3t=Q(ze(),1);var Vce=new WeakMap,Bce=new WeakMap,Nqe="htBadValue",Bw="data-row",Uw="data-col",Pqe="checkboxRenderer",eN="checkbox";ot.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){let{label:r,type:i,row:o,column:s,prop:a}=e;if(i===eN){if(r){let{value:l,property:c}=r,u=n;if(l)u=typeof l=="function"?l(o,s,a,n):l;else if(c){let d=this.getDataAtRowProp(o,c);u=d!==null?d:n}t=u}return t}});function Ww(t,e,n,r,i,o,s){let{rootDocument:a}=t,l=t.getSettings().ariaTags;Iu.apply(this,[t,e,n,r,i,o,s]),kqe(t);let c=Fqe(a),u=s.label,d=!1;if(typeof s.checkedTemplate>"u"&&(s.checkedTemplate=!0),typeof s.uncheckedTemplate>"u"&&(s.uncheckedTemplate=!1),yo(e),o===s.checkedTemplate||Qn(o).toLocaleLowerCase(s.locale)===Qn(s.checkedTemplate).toLocaleLowerCase(s.locale)?c.checked=!0:o===s.uncheckedTemplate||Qn(o).toLocaleLowerCase(s.locale)===Qn(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?c.checked=!1:Er(o)?Ne(c,"noValue"):(c.style.display="none",Ne(c,Nqe),d=!0),vt(c,[[Bw,n],[Uw,r]]),l&&vt(c,[ew(c.checked?t.getTranslatedPhrase(wx):t.getTranslatedPhrase(yx)),jie(c.checked),Fie()]),!d&&u){let g="";if(u.value)g=typeof u.value=="function"?u.value.call(this,n,r,i,o):u.value;else if(u.property){let _=t.getDataAtRowProp(n,u.property);g=_!==null?_:""}let w=Lqe(a,g,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(w),e.appendChild(c)):(w.appendChild(c),c=w):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(c),e.appendChild(w)):(w.insertBefore(c,w.firstChild),c=w))}(!u||u&&!u.separated)&&e.appendChild(c),d&&e.appendChild(a.createTextNode("#bad-value#")),Vce.has(t)||(Vce.set(t,!0),h());function h(){let w=t.getShortcutManager().getContext("grid"),_={group:Pqe};w.addShortcuts([{keys:[["space"]],callback:()=>(f(),!p())},{keys:[["enter"]],callback:()=>(f(),!p()),runOnlyIf:()=>t.getSettings().enterBeginsEditing},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!p()),relativeToGroup:Lw,position:"before"}],_)}function f(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,w=t.getSelectedRange();if(w)for(let _=0;_<w.length;_++){let{row:S,col:x}=w[_].getTopStartCorner(),{row:P,col:k}=w[_].getBottomEndCorner(),b=[];for(let C=S;C<=P;C+=1)for(let N=x;N<=k;N+=1){let B=t.getCellMeta(C,N);if(B.type!=="checkbox")return;if(B.readOnly===!0)continue;typeof B.checkedTemplate>"u"&&(B.checkedTemplate=!0),typeof B.uncheckedTemplate>"u"&&(B.uncheckedTemplate=!1);let Y=t.getDataAtCell(C,N);g===!1?[B.checkedTemplate,B.checkedTemplate.toString()].includes(Y)?b.push([C,N,B.uncheckedTemplate]):[B.uncheckedTemplate,B.uncheckedTemplate.toString(),null,void 0].includes(Y)&&b.push([C,N,B.checkedTemplate]):b.push([C,N,B.uncheckedTemplate])}b.length>0&&t.setDataAtCell(b)}}function p(){let g=t.getSelectedRange();if(g){for(let w=0;w<g.length;w++){let _=g[w].getTopStartCorner(),S=g[w].getBottomEndCorner();for(let x=_.row;x<=S.row;x++)for(let P=_.col;P<=S.col;P++){let k=t.getCellMeta(x,P);if(k.type!=="checkbox")return!1;let b=t.getCell(x,P);if(b==null)return!0;if(b.querySelectorAll("input[type=checkbox]").length>0&&!k.readOnly)return!0}}return!1}}}Ww.RENDERER_TYPE=eN;function kqe(t){let e=Bce.get(t);if(!e){let{rootElement:n}=t;e=new ei(t),e.addEventListener(n,"click",r=>Vqe(r,t)),e.addEventListener(n,"mouseup",r=>Hqe(r,t)),e.addEventListener(n,"change",r=>Bqe(r,t)),Bce.set(t,e)}return e}function Fqe(t){let e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Lqe(t,e,n){let r=t.createElement("label");return r.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`,r.appendChild(t.createTextNode(e)),r.cloneNode(!0)}function Hqe(t,e){let{target:n}=t;t8(n)&&(!n.hasAttribute(Bw)||!n.hasAttribute(Uw)||setTimeout(e.listen,10))}function Vqe(t,e){let{target:n}=t;if(!t8(n)||!n.hasAttribute(Bw)||!n.hasAttribute(Uw))return;let r=parseInt(n.getAttribute(Bw),10),i=parseInt(n.getAttribute(Uw),10);e.getCellMeta(r,i).readOnly&&t.preventDefault()}function Bqe(t,e){let{target:n}=t;if(!t8(n)||!n.hasAttribute(Bw)||!n.hasAttribute(Uw))return;let r=parseInt(n.getAttribute(Bw),10),i=parseInt(n.getAttribute(Uw),10),o=e.getCellMeta(r,i);if(!o.readOnly){let s=null;t.target.checked?s=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:s=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(r,i,s)}}function t8(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}var P3t=Q(ze(),1),Jf=Q(Wce(),1);var r8="numeric";function jw(t,e,n,r,i,o,s){let a=o;if(Vi(a)){let l=s.numericFormat,c=l&&l.culture||"-",u=l&&l.pattern,d=s.className||"",h=d.length?d.split(" "):[];if(typeof c<"u"&&!Jf.default.languages()[c]){let f=c.replace("-",""),p=Jf.default.allLanguages?Jf.default.allLanguages[c]:Jf.default[f];p&&Jf.default.registerLanguage(p)}Jf.default.setLanguage(c),a=(0,Jf.default)(a).format(u||"0"),h.indexOf("htLeft")<0&&h.indexOf("htCenter")<0&&h.indexOf("htRight")<0&&h.indexOf("htJustify")<0&&h.push("htRight"),h.indexOf("htNumeric")<0&&h.push("htNumeric"),s.className=h.join(" "),e.dir="ltr"}To(t,e,n,r,i,a,s)}jw.RENDERER_TYPE=r8;var i8="password";function $w(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s]);let a=s.hashLength||e.innerHTML.length,l=s.hashSymbol||"*",c="";st(a-1,()=>{c+=l}),vl(e,c)}$w.RENDERER_TYPE=i8;var o8="time";function Gw(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s]),e.dir="ltr"}Gw.RENDERER_TYPE=o8;function jce(){wc(Il),wc(Iu),wc(Ww),wc(Vw),wc(jw),wc($w),wc(To),wc(Gw)}var s8="autocomplete";function em(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,$ce(n,e)):$ce(n,e)(this.source):e(!0)}em.VALIDATOR_TYPE=s8;function $ce(t,e){let n=t;return function(r){let i=!1;for(let o=0,s=r.length;o<s;o++)if(n===r[o]){i=!0;break}e(i)}}var Ox=Q(Ma(),1);function Gce(t){let e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}var a8="date";function zw(t,e){let n=IM(Mx,this.instance),r=t,i=!0;r==null&&(r="");let o=(0,Ox.default)(r,this.dateFormat||n.defaultDateFormat,!0).isValid(),s=(0,Ox.default)(new Date(r)).isValid()||o;if(this.allowEmpty&&r===""&&(s=!0,o=!0),s||(i=!1),!s&&o&&(i=!0),s&&!o)if(this.correctFormat===!0){let a=zce(r,this.dateFormat),l=this.instance.toVisualRow(this.row),c=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(l,c,a,"dateValidator"),i=!0}else i=!1;e(i)}zw.VALIDATOR_TYPE=a8;function zce(t,e){let n=(0,Ox.default)(Gce(t)),r=(0,Ox.default)(t,e),i=t.search(/[A-z]/g)>-1,o;return n.isValid()&&n.format("x")===r.format("x")||!r.isValid()||i?o=n:o=r,o.format(e)}var l8="numeric";function Yw(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Vi(t))}Yw.VALIDATOR_TYPE=l8;var Nx=Q(Ma(),1),Uqe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],c8="time";function qw(t,e){let n=this.timeFormat||"h:mm:ss a",r=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;let o=/^\d{1,2}$/.test(i);o&&(i+=":00");let s=(0,Nx.default)(i,Uqe,!0).isValid()?(0,Nx.default)(i):(0,Nx.default)(i,n),a=s.isValid(),l=(0,Nx.default)(i,n,!0).isValid()&&!o;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(r=!1),!a&&l&&(r=!0),a&&!l)if(this.correctFormat===!0){let c=s.format(n),u=this.instance.toVisualRow(this.row),d=this.instance.toVisualColumn(this.col);this.instance.setDataAtCell(u,d,c,"timeValidator"),r=!0}else r=!1;e(r)}qw.VALIDATOR_TYPE=c8;function Yce(){Kp(em),Kp(zw),Kp(Yw),Kp(qw)}var u8="autocomplete",d8={CELL_TYPE:u8,editor:Yd,renderer:Il,validator:em};var h8="checkbox",f8={CELL_TYPE:h8,editor:dg,renderer:Ww};var qce="date";function tN(t,e,n,r,i,o,s){Il.apply(this,[t,e,n,r,i,o,s])}tN.RENDERER_TYPE=qce;var m8="date",p8={CELL_TYPE:m8,editor:fg,renderer:tN,validator:zw};var g8="dropdown",v8={CELL_TYPE:g8,editor:Qf,renderer:Il,validator:em};var Kce="handsontable";function nN(t,e,n,r,i,o,s){Il.apply(this,[t,e,n,r,i,o,s])}nN.RENDERER_TYPE=Kce;var w8="handsontable",y8={CELL_TYPE:w8,editor:zd,renderer:nN};var _8="numeric",C8={CELL_TYPE:_8,editor:mg,renderer:jw,validator:Yw,dataType:"number"};var S8="password",E8={CELL_TYPE:S8,editor:pg,renderer:$w,copyable:!1};var Xce="select";function rN(t,e,n,r,i,o,s){To.apply(this,[t,e,n,r,i,o,s])}rN.RENDERER_TYPE=Xce;var x8="select",b8={CELL_TYPE:x8,editor:gg,renderer:rN};var T8="time",R8={CELL_TYPE:T8,editor:vg,renderer:Gw,validator:qw};function Zce(){ka(d8),ka(f8),ka(p8),ka(v8),ka(y8),ka(C8),ka(E8),ka(b8),ka(Ax),ka(R8)}var yWt=Q(ze(),1),_Wt=Q(De(),1);var KUt=Q(De(),1),XUt=Q(ze(),1);function Wqe(t,e){eue(t,e),e.add(t)}function jqe(t,e,n){eue(t,e),e.set(t,n)}function eue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kw(t,e,n){return e=$qe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $qe(t){var e=Gqe(t,"string");return typeof e=="symbol"?e:String(e)}function Gqe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zqe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Xw(t,e){var n=Yqe(t,e,"get");return qqe(t,n)}function Yqe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function qqe(t,e){return e.get?e.get.call(t):e.value}var Qce=new Map([["plugin",Zoe],["cell-type",RW],["editor",J4],["renderer",cU],["validator",dU]]),tue="base",D8=[],Mu=null,wg=new WeakMap,Jce=new WeakSet,Dt=class{static get PLUGIN_KEY(){return tue}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){Wqe(this,Jce),Kw(this,"eventManager",new ei(this)),Kw(this,"pluginName",null),Kw(this,"pluginsInitializedCallbacks",[]),Kw(this,"isPluginsReady",!1),Kw(this,"enabled",!1),Kw(this,"initialized",!1),jqe(this,wg,{writable:!0,value:{}}),_o(this,"hot",e,{writable:!1}),Mu=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){let i=[];if(n.forEach(o=>{let[s,a]=o.split(":");if(!Qce.has(s))throw new Error(`Unknown plugin dependency type "${s}" was found.`);Qce.get(s)(a)||i.push(` - ${a} (${s})`)}),i.length>0){let o=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");D8.push(o)}}if(Mu||(Mu=HM()),Mu.indexOf("UndoRedo")>=0&&Mu.splice(Mu.indexOf("UndoRedo"),1),Mu.indexOf(this.pluginName)>=0&&Mu.splice(Mu.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Mu.length===0){if(D8.length>0){let i=[`${D8.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,n){Xw(this,wg)[e]=Xw(this,wg)[e]||[];let r=Xw(this,wg)[e];this.hot.addHook(e,n),r.push(n),Xw(this,wg)[e]=r}removeHooks(e){Z(Xw(this,wg)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){let e=Xw(this,wg);Rt(e,(n,r)=>this.removeHooks(r)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Z(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){let n=zqe(this,Jce,Kqe).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Rt(this,(n,r)=>{r!=="hot"&&(this[r]=null)}),delete this.t,delete this.hot}};function Kqe(t){if(!t)return!1;let e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}var lWt=Q(De(),1),cWt=Q(ze(),1);function yg(t,e,n){return e=Xqe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xqe(t){var e=Zqe(t,"string");return typeof e=="symbol"?e:String(e)}function Zqe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var I8=class{constructor(e){yg(this,"hot",null),yg(this,"container",null),yg(this,"injected",!1),yg(this,"rows",[]),yg(this,"columns",[]),yg(this,"samples",null),yg(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let r={row:e};this.rows.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){let n=this.hot.getColHeader(0);if(n!=null){let r={row:-1};this.rows.push(r),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let r={col:e};this.columns.push(r),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Z(this.rows,n=>{e(n.row,Nn(n.table)-1)})}getWidths(e){this.injected||this.injectTable(),Z(this.columns,n=>{let{width:r}=n.table.getBoundingClientRect();e(n.col,Math.ceil(r))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){let n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(r=>{Z(r.strings,i=>{n.appendChild(this.createColElement(i.col,e))})}),n}createRow(e){let{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),r.appendChild(i)),this.samples.forEach(o=>{Z(o.strings,s=>{let a=s.col,l=this.hot.getCellMeta(e,a);l.col=a,l.row=e;let c=this.hot.getCellRenderer(l),u=n.createElement("td");u.setAttribute("ghost-table",1),c(this.hot,u,e,a,this.hot.colToProp(a),s.value,l),r.appendChild(u)})}),r}appendColumnHeadersRow(){let{rootDocument:e}=this.hot,n=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){let i=e.createElement("th");r.push([-1,i]),n.appendChild(i)}this.samples.forEach(i=>{Z(i.strings,o=>{let s=o.col,a=e.createElement("th");r.push([s,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),Z(r,i=>{let[o,s]=i;this.hot.view.appendColHeader(o,s)})}createCol(e){let{rootDocument:n}=this.hot,r=n.createDocumentFragment();return this.samples.forEach(i=>{Z(i.strings,o=>{let s=o.row,a=this.hot.getCellMeta(s,e);a.col=e,a.row=s;let l=this.hot.getCellRenderer(a),c=n.createElement("td"),u=n.createElement("tr");c.setAttribute("ghost-table",1),l(this.hot,c,s,e,this.hot.colToProp(e),o.value,a),u.appendChild(c),r.appendChild(u)})}),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){let r=this.hot.rootDocument.createElement("col"),i=0;n>=0&&e>=0&&(i=this.hot.getCellMeta(n,e).colspan);let o=this.hot.view._wt.wtTable.getStretchedColumnWidth(e);if(i>1)for(let s=e+1;s<e+i;s++)o+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s);return r.style.width=`${o}px`,r}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("table"),o=n.createElement("thead"),s=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(c),o.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(o),this.isVertical()&&s.appendChild(l),i.appendChild(s),Ne(i,e),r.appendChild(i),{fragment:r,table:i,tHead:o,tBody:s,colGroup:a,tr:l,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",{rootDocument:n}=this.hot,r=n.createDocumentFragment(),i=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return Ne(i,o),r.appendChild(i),{fragment:r,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}},iN=I8;var fWt=Q(De(),1),mWt=Q(ze(),1);function oN(t,e,n){return e=Qqe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qqe(t){var e=Jqe(t,"string");return typeof e=="symbol"?e:String(e)}function Jqe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var A8=class t{static get SAMPLE_COUNT(){return 3}constructor(e){oN(this,"samples",null),oN(this,"dataFactory",null),oN(this,"customSampleCount",null),oN(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:t.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,r){let i=new Map,{from:o,to:s}=typeof r=="number"?{from:r,to:r}:r;return st(o,s,a=>{let l=this.generateSample(e,n,a);i.set(a,l)}),i}generateSample(e,n,r){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");let i=new Map,o=e==="row"?"col":"row",s=[];return st(n.from,n.to,a=>{let l=e==="row"?this.dataFactory(r,a):this.dataFactory(a,r);if(l===!1)return;let{value:c,bundleSeed:u}=l,d=typeof u=="string"&&u.length>0,h;d?h=u:Tt(c)?h=`${Object.keys(c).length}`:Array.isArray(c)?h=`${c.length}`:h=`${Qn(c).length}`,i.has(h)||i.set(h,{needed:this.getSampleCount(),strings:[]});let f=i.get(h);f.needed&&(!(s.indexOf(c)>-1)||this.allowDuplicates||d)&&(f.strings.push({value:c,[o]:a}),s.push(c),f.needed-=1)}),i}},sN=A8;function Zw(t,e){lue(t,e),e.add(t)}function eKe(t,e,n){lue(t,e),e.set(t,n)}function lue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qw(t,e,n){return e=tKe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tKe(t){var e=nKe(t,"string");return typeof e=="symbol"?e:String(e)}function nKe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rKe(t,e,n){var r=cue(t,e,"set");return iKe(t,r,n),n}function iKe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function aN(t,e){var n=cue(t,e,"get");return oKe(t,n)}function cue(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function oKe(t,e){return e.get?e.get.call(t):e.value}function _g(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ot.getSingleton().register("modifyAutoColumnSizeSeed");var Jw="autoColumnSize",uue=10,sKe="autoColumnSize",ey=new WeakMap,nue=new WeakSet,rue=new WeakSet,iue=new WeakSet,M8=new WeakSet,oue=new WeakSet,sue=new WeakSet,Px=class t extends Dt{static get PLUGIN_KEY(){return Jw}static get PLUGIN_PRIORITY(){return uue}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Zw(this,sue),Zw(this,oue),Zw(this,M8),Zw(this,iue),Zw(this,rue),Zw(this,nue),Qw(this,"ghostTable",new iN(this.hot)),Qw(this,"samplesGenerator",new sN((n,r)=>{let i=this.hot.getCellMeta(n,r),o="";i.spanned||(o=this.hot.getDataAtCell(n,r));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,i,o)),{value:o,bundleSeed:s}})),Qw(this,"firstCalculation",!0),Qw(this,"inProgress",!1),Qw(this,"measuredColumns",0),Qw(this,"columnWidthsMap",new xo),eKe(this,ey,{writable:!0,value:[]}),this.hot.columnIndexMapper.registerMap(sKe,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,r,i)=>_g(this,M8,aue).call(this,n,r,i))}isEnabled(){return this.hot.getSettings()[Jw]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;let n=this.hot.getSettings()[Jw];n&&n.useHeaders!==null&&n.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",n.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return _g(e,rue,lKe).call(e,...i)}),this.addHook("beforeChangeRender",r=>_g(this,iue,cKe).call(this,r)),this.addHook("afterFormulasValuesUpdate",r=>_g(this,sue,dKe).call(this,r)),this.addHook("beforeViewRender",r=>_g(this,nue,aKe).call(this,r)),this.addHook("modifyColWidth",(r,i)=>this.getColumnWidth(i,r)),this.addHook("afterInit",()=>_g(this,oue,uKe).call(this)),super.enablePlugin()}updatePlugin(){let e=this.findColumnsWhereHeaderWasChanged();e.length&&(this.clearCache(e),this.calculateVisibleColumnsWidth()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,r)=>_g(this,M8,aue).call(this,e,n,r))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;let n=this.hot.renderCall,r=this.getFirstVisibleColumn(),i=this.getLastVisibleColumn();r===-1||i===-1||this.calculateColumnsWidth({from:r,to:i},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;st(i.from,i.to,s=>{let a=this.hot.toPhysicalColumn(s);if(a===null&&(a=s),r||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a)){let l=this.samplesGenerator.generateColumnSamples(s,o);Z(l,c=>{let[u,d]=c;return this.ghostTable.addColumn(u,d)})}}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((s,a)=>{let l=this.hot.toPhysicalColumn(s);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=0,r=this.hot.countCols()-1,i=null;this.inProgress=!0;let o=()=>{if(!this.hot){yw(i),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+t.CALCULATION_STEP,r)},e),n=n+t.CALCULATION_STEP+1,n<r?i=ww(o):(yw(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateColumnsWidth({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():this.inProgress=!1}setSamplingOptions(){let e=this.hot.getSettings()[Jw],n=e&&Kn(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Kn(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view&&this.hot.view._wt.wtTable.isVisible()&&(this.clearCache(),this.calculateAllColumnsWidth())}getSyncCalculationLimit(){let e=this.hot.getSettings()[Jw],n=t.SYNC_CALCULATION_LIMIT,r=this.hot.countCols()-1;return Tt(e)&&(n=e.syncLimit,lM(n)?n=LM(r,n):n>>=0),Math.min(n,r)}getColumnWidth(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=n;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&typeof i=="number"&&(i=Math.max(i,Ff.DEFAULT_WIDTH))),i}getFirstVisibleColumn(){let e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){let n=e.wtTable.getFirstVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){let n=e.wtTable.getFirstRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}getLastVisibleColumn(){let e=this.hot.view._wt;if(e.wtViewport.columnsVisibleCalculator){let n=e.wtTable.getLastVisibleColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}if(e.wtViewport.columnsRenderCalculator){let n=e.wtTable.getLastRenderedColumn();if(n!==-1)return this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)}return-1}findColumnsWhereHeaderWasChanged(){let e=this.hot.getColHeader();return or(e,(r,i,o)=>{let s=aN(this,ey).length;return(s-1<o||aN(this,ey)[o]!==i)&&r.push(o),s-1<o?aN(this,ey).push(i):aN(this,ey)[o]=i,r},[])}clearCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];e.length?this.hot.batchExecution(()=>{Z(e,n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!gi(this.columnWidthsMap.getValues().slice(0,this.measuredColumns),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}};function aKe(){this.calculateVisibleColumnsWidth(),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth()}function lKe(){this.hot.view?this.recalculateAllColumnsWidth():setTimeout(()=>{this.hot&&this.recalculateAllColumnsWidth()},0)}function cKe(t){let e=At(t,n=>{let[,r]=n;return this.hot.toPhysicalColumn(this.hot.propToCol(r))});this.clearCache(Array.from(new Set(e)))}function aue(t,e,n){let r=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function uKe(){rKe(this,ey,this.hot.getColHeader())}function dKe(t){let e=gi(t,r=>{var i;return Ze((i=r.address)===null||i===void 0?void 0:i.col)}),n=At(e,r=>r.address.col);this.clearCache(Array.from(new Set(n)))}var VWt=Q(ze(),1),BWt=Q(De(),1);var tm={horizontal:"horizontal",vertical:"vertical"};function due(t,e,n){let r,i,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",r=n(e[0],e[1]),i=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",r=n(e[0],t[3]+1),i=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",r=n(e[0],e[1]),i=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",r=n(t[2]+1,e[1]),i=n(e[2],e[3])),r&&r.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:r,endOfDragCoords:i}}function hue(t){let e={};return t===!0?(e.directions=Object.keys(tm),e.autoInsertRow=!0):Tt(t)?(Ze(t.autoInsertRow)?t.direction===tm.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Ze(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(tm)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function kx(t,e){hKe(t,e),e.add(t)}function hKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ty(t,e,n){return e=fKe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fKe(t){var e=mKe(t,"string");return typeof e=="symbol"?e:String(e)}function mKe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fx(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ot.getSingleton().register("modifyAutofillRange");ot.getSingleton().register("beforeAutofill");ot.getSingleton().register("afterAutofill");var O8="autofill",wue=20,pKe=["fillHandle"],gKe="insert_row_below",vKe=200,fue=new WeakSet,mue=new WeakSet,pue=new WeakSet,gue=new WeakSet,vue=new WeakSet,Lx=class extends Dt{constructor(){super(...arguments),kx(this,vue),kx(this,gue),kx(this,pue),kx(this,mue),kx(this,fue),ty(this,"addingStarted",!1),ty(this,"mouseDownOnCellCorner",!1),ty(this,"mouseDragOutside",!1),ty(this,"handleDraggedCells",0),ty(this,"directions",[]),ty(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return O8}static get PLUGIN_PRIORITY(){return wue}static get SETTING_KEYS(){return[O8,...pKe]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Fx(this,mue,yKe).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Fx(this,fue,wKe).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Fx(this,pue,_Ke).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=this.hot.getSelectedRangeLast(),{row:n,col:r}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),s=this.hot.runHooks("modifyCopyableRange",[{startRow:n,startCol:r,endRow:i,endCol:o}]),a=[],l=[],c=[];return Z(s,u=>{for(let d=u.startRow;d<=u.endRow;d+=1)a.indexOf(d)===-1&&a.push(d);for(let d=u.startCol;d<=u.endCol;d+=1)l.indexOf(d)===-1&&l.push(d)}),Z(a,u=>{let d=[];Z(l,h=>{d.push(this.hot.getCopyableData(u,h))}),c.push(d)}),c}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[e,n,r,i]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),s=o.getTopStartCorner(),a=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();let l=[s.row,s.col,a.row,a.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(s.row,e),Math.min(s.col,n),Math.max(a.row,r),Math.max(a.col,i)],l),{directionOfDrag:u,startOfDragCoords:d,endOfDragCoords:h}=due(l,c,(f,p)=>this.hot._createCellCoords(f,p));if(d&&d.row>-1&&d.col>-1){let f=this.getSelectionData(),p=o.clone(),g=this.hot._createCellRange(d,d,h),w=this.hot.runHooks("beforeAutofill",f,p,g,u);if(w===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let _=w,S=w;if(["up","left"].indexOf(u)>-1&&!(S.length===1&&S[0].length===0))if(_=[],u==="up"){let x=h.row-d.row+1,P=x%S.length;for(let k=0;k<x;k++)_.push(S[(k+(S.length-P))%S.length])}else{let x=h.col-d.col+1,P=x%S[0].length;for(let k=0;k<S.length;k++){_.push([]);for(let b=0;b<x;b++)_[k].push(S[k][(b+(S[k].length-P))%S[k].length])}}this.hot.populateFromArray(d.row,d.col,_,h.row,h.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",_,p,g,u),this.hot.render()}else this.hot._refreshBorders();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){let n=this.hot.getSelectedRangeLast(),r=n.getBottomEndCorner(),i=e;if(this.directions.includes(tm.vertical)&&this.directions.includes(tm.horizontal)){let o=n.getTopStartCorner();(r.col<=e.col||o.col>=e.col)&&(i=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||o.row>e.row)&&(i=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(tm.vertical))i=this.hot._createCellCoords(e.row,r.col);else if(this.directions.includes(tm.horizontal))i=this.hot._createCellCoords(r.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){let n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(gKe,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},vKe)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){let e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&n[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){let n=this.hot.getData(),r=this.hot.countRows(),i;for(let o=e[2]+1;o<r;o++){for(let l=e[1];l<=e[3];l++)if(n[o][l])return-1;let s=n[o][e[1]-1],a=n[o][e[3]+1];(s||a)&&(i=o)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...At(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){let e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){let{documentElement:n}=this.hot.rootDocument,r=vr(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Nn(this.hot.table),i=vr(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+pn(this.hot.table);return e.clientY>r&&e.clientX<=i}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Fx(this,gue,CKe).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Fx(this,vue,SKe).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let e=hue(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}};function wKe(){this.selectAdjacent()&&this.fillIn()}function yKe(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _Ke(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function CKe(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function SKe(t){let e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}var KWt=Q(De(),1);function lN(t,e){EKe(t,e),e.add(t)}function EKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Cg(t,e,n){return e=xKe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xKe(t){var e=bKe(t,"string");return typeof e=="symbol"?e:String(e)}function bKe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hx(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Vx="autoRowSize",Eue=40,TKe="autoRowSize",yue=new WeakSet,N8=new WeakSet,_ue=new WeakSet,Cue=new WeakSet,Bx=class t extends Dt{static get PLUGIN_KEY(){return Vx}static get PLUGIN_PRIORITY(){return Eue}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),lN(this,Cue),lN(this,_ue),lN(this,N8),lN(this,yue),Cg(this,"headerHeight",null),Cg(this,"ghostTable",new iN(this.hot)),Cg(this,"samplesGenerator",new sN((n,r)=>{if(n>=0&&r>=0&&this.hot.getCellMeta(n,r).hidden)return!1;let i;return n>=0?i=this.hot.getDataAtCell(n,r):n===-1&&(i=this.hot.getColHeader(r)),{value:i}})),Cg(this,"firstCalculation",!0),Cg(this,"inProgress",!1),Cg(this,"measuredRows",0),Cg(this,"rowHeightsMap",new xo),this.hot.rowIndexMapper.registerMap(TKe,this.rowHeightsMap),this.addHook("beforeRowResize",(n,r,i)=>Hx(this,N8,Sue).call(this,n,r,i))}isEnabled(){let e=this.hot.getSettings()[Vx];return e===!0||Tt(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Hx(e,_ue,DKe).call(e,...r)}),this.addHook("beforeChangeRender",n=>Hx(this,Cue,IKe).call(this,n)),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("beforeViewRender",n=>Hx(this,yue,RKe).call(this,n)),this.addHook("modifyRowHeight",(n,r)=>this.getRowHeight(r,n)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,n,r)=>Hx(this,N8,Sue).call(this,e,n,r))}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){let s=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(s.get(-1))}st(i.from,i.to,s=>{if(r||this.rowHeightsMap.getValueAtIndex(s)===null){let a=this.samplesGenerator.generateRowSamples(s,o);Z(a,l=>{let[c,u]=l;return this.ghostTable.addRow(c,u)})}}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((s,a)=>{s<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(s),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=0,r=this.hot.countRows()-1,i=null;this.inProgress=!0;let o=()=>{if(!this.hot){yw(i),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+t.CALCULATION_STEP,r)},e),n=n+t.CALCULATION_STEP+1,n<r?i=ww(o):(yw(i),this.inProgress=!1,this.hot.view.adjustElementsSize(!0),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},s=this.getSyncCalculationLimit();this.firstCalculation&&s>=0&&(this.calculateRowsHeight({from:0,to:s},e),this.firstCalculation=!1,n=s+1),n<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize(!1))}setSamplingOptions(){let e=this.hot.getSettings()[Vx],n=e&&Kn(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&Kn(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){pl(this.hot.view._wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())}getSyncCalculationLimit(){let e=this.hot.getSettings()[Vx],n=t.SYNC_CALCULATION_LIMIT,r=this.hot.countRows()-1;return Tt(e)&&(n=e.syncLimit,lM(n)?n=LM(r,n):n>>=0),Math.min(n,r)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0,r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),i=n;return r!==null&&r>(n||0)&&(i=r),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){let e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1}getLastVisibleRow(){let e=this.hot.view._wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1}clearCache(){this.headerHeight=null,this.rowHeightsMap.init()}clearCacheByRange(e){let{from:n,to:r}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{st(Math.min(n,r),Math.max(n,r),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!gi(this.rowHeightsMap.getValues().slice(0,this.measuredRows),e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}};function RKe(){let t=this.hot.renderCall,e=this.hot.getSettings().fixedRowsBottom,n=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(!(n===-1||r===-1)){if(this.calculateRowsHeight({from:n,to:r},void 0,t),e){let i=this.hot.countRows()-1;this.calculateRowsHeight({from:i-e,to:i})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()}}function Sue(t,e,n){let r=t;return n&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function DKe(){this.hot.view?this.recalculateAllRowsHeight():this.hot._registerTimeout(()=>{this.hot&&this.recalculateAllRowsHeight()})}function IKe(t){let e=null;t.length===1?e=t[0][0]:t.length>1&&(e={from:t[0][0],to:t[t.length-1][0]}),e!==null&&this.clearCacheByRange(e)}var f8t=Q(De(),1);var{getListWithInsertedItems:AKe,getListWithRemovedItems:MKe}=qS("physicallyIndexed"),P8=class extends Ls{constructor(){super(e=>e)}insert(e,n){let r=$f(this.indexedValues,n);this.indexedValues=AKe(r,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){let n=MKe(this.indexedValues,e);this.indexedValues=jf(n,e),super.remove(e)}},xue=P8;var{getListWithInsertedItems:OKe,getListWithRemovedItems:NKe}=qS("physicallyIndexed"),k8=class extends Ls{constructor(){super(e=>e)}insert(e,n){this.indexedValues=OKe(this.indexedValues,e,n,(r,i)=>this.getNextValue(i)),super.insert(e,n)}remove(e){this.indexedValues=NKe(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}},bue=k8;function PKe(t,e){kKe(t,e),e.add(t)}function kKe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FKe(t,e,n){return e=LKe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LKe(t){var e=HKe(t,"string");return typeof e=="symbol"?e:String(e)}function HKe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VKe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var cN="bindRowsWithHeaders",Rue=210,BKe="loose",UKe=new Map([["loose",xue],["strict",bue]]),Tue=new WeakSet,Ux=class extends Dt{constructor(){super(...arguments),PKe(this,Tue),FKe(this,"headerIndexes",null)}static get PLUGIN_KEY(){return cN}static get PLUGIN_PRIORITY(){return Rue}isEnabled(){return!!this.hot.getSettings()[cN]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[cN];typeof e!="string"&&(e=BKe);let n=UKe.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",r=>VKe(this,Tue,WKe).call(this,r)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}};function WKe(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}var _8t=Q(De(),1),C8t=Q(ze(),1);function uN(t,e){Fue(t,e),e.add(t)}function jKe(t,e,n){Fue(t,e),e.set(t,n)}function Fue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Due(t,e,n){return e=$Ke(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Ke(t){var e=GKe(t,"string");return typeof e=="symbol"?e:String(e)}function GKe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Iue(t,e){var n=Lue(t,e,"get");return zKe(t,n)}function zKe(t,e){return e.get?e.get.call(t):e.value}function dN(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function F8(t,e,n){var r=Lue(t,e,"set");return YKe(t,r,n),n}function Lue(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function YKe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Wx="collapsibleColumns",Hue=290,qKe=["nestedHeaders"],ry="collapsibleIndicator",Aue=Wx,Mue=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]),ny=new WeakMap,Oue=new WeakSet,Nue=new WeakSet,Pue=new WeakSet,kue=new WeakSet,jx=class extends Dt{constructor(){super(...arguments),uN(this,kue),uN(this,Pue),uN(this,Nue),uN(this,Oue),Due(this,"nestedHeadersPlugin",null),Due(this,"headerStateManager",null),jKe(this,ny,{writable:!0,value:null})}static get PLUGIN_KEY(){return Wx}static get PLUGIN_PRIORITY(){return Hue}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[Wx,...qKe]}isEnabled(){return!!this.hot.getSettings()[Wx]}enablePlugin(){var e=this;if(this.enabled)return;let{nestedHeaders:n}=this.hot.getSettings();n||Sn("You need to configure the Nested Headers plugin in order to use collapsible headers."),F8(this,ny,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>dN(this,Pue,ZKe).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return dN(e,kue,QKe).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return dN(e,Oue,KKe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(r,i,o)=>dN(this,Nue,XKe).call(this,r,i,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){let{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),F8(this,ny,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;let{row:n,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:o,columnIndex:s}=(e=this.headerStateManager.getHeaderTreeNodeData(n,r))!==null&&e!==void 0?e:{};i&&(o?this.expandSection({row:n,col:s}):this.collapseSection({row:n,col:s}))},runOnlyIf:()=>{var e;return(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight.isHeader()},group:Aue})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Aue)}clearButtons(){if(!this.hot.view)return;let e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(s){s&&s.parentNode.removeChild(s)};st(0,e-1,s=>{let a=n.childNodes[s],l=r.childNodes[s],c=i?i.childNodes[s]:null;st(0,a.childNodes.length-1,u=>{let d=a.childNodes[u].querySelector(`.${ry}`);o(d),l&&l.childNodes[u]&&(d=l.childNodes[u].querySelector(`.${ry}`),o(d)),i&&c&&c.childNodes[u]&&(d=c.childNodes[u].querySelector(`.${ry}`),o(d))})},!0)}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){let n=this.headerStateManager.mapNodes(r=>{let{collapsible:i,origColspan:o,headerLevel:s,columnIndex:a,isCollapsed:l}=r;if(i===!0&&o>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(s),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!Mue.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;let r=gi(e,h=>{let{row:f}=h;return f<0}),i=r.length>0;Z(r,h=>{var f;let{row:p,col:g}=h,{collapsible:w,isCollapsed:_}=(f=this.headerStateManager.getHeaderSettings(p,g))!==null&&f!==void 0?f:{};if(!w||_&&n==="collapse"||!_&&n==="expand")return i=!1,!1});let o=[],s=[];i&&Z(r,h=>{let{row:f,col:p}=h,{colspanCompensation:g,affectedColumns:w,rollbackModification:_}=this.headerStateManager.triggerNodeModification(n,f,p);g>0&&(s.push(...w),o.push(_))});let a=this.getCollapsedColumns(),l=[];n==="collapse"?l=oM([...a,...s]):n==="expand"&&(l=gi(a,h=>!s.includes(h)));let c=Mue.get(n);if(this.hot.runHooks(c.beforeHook,a,l,i)===!1){Z(o,h=>{h()});return}this.hot.batchExecution(()=>{Z(s,h=>{Iue(this,ny).setValueAtIndex(this.hot.toPhysicalColumn(h),c.hideColumn)})},!0);let d=this.getCollapsedColumns().length!==a.length;this.hot.runHooks(c.afterHook,a,l,i,d),this.hot.render(),this.hot.view.adjustElementsSize(!0)}getCollapsedColumns(){return Iue(this,ny).getHiddenIndexes()}destroy(){F8(this,ny,null),super.destroy()}};function KKe(t,e,n){var r;let{collapsible:i,origColspan:o,isCollapsed:s}=(r=this.headerStateManager.getHeaderSettings(n,t))!==null&&r!==void 0?r:{},a=i&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags,c=e.querySelector(`.${ry}`);if(gl(e,[Wo("")[0]]),a)c||(c=this.hot.rootDocument.createElement("div"),Ne(c,ry),e.querySelector("div:first-child").appendChild(c)),bt(c,["collapsed","expanded"]),s?(Ne(c,"collapsed"),wl(c,"+"),l&&vt(e,...Wo(!1))):(Ne(c,"expanded"),wl(c,"-"),l&&vt(e,...Wo(!0))),l&&vt(c,...wo());else{var u;(u=c)===null||u===void 0||u.remove()}}function XKe(t,e){St(t.target,ry)&&(St(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):St(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),wi(t))}function ZKe(){this.updatePlugin()}function QKe(t,e){e||this.updatePlugin()}var v6t=Q(ze(),1),w6t=Q(De(),1);var O8t=Q(De(),1);function Sg(t,e,n){return e=JKe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JKe(t){var e=eXe(t,"string");return typeof e=="symbol"?e:String(e)}function eXe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var tXe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],nXe=!1,rXe=!0,iXe=!0,hN=class{constructor(e,n){Sg(this,"hot",void 0),Sg(this,"sortingStates",new Ru),Sg(this,"sortEmptyCells",nXe),Sg(this,"indicator",rXe),Sg(this,"headerAction",iXe),Sg(this,"compareFunctionFactory",void 0),Sg(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Tt(e)&&Rt(e,(n,r)=>{tXe.includes(r)&&(this[r]=n)})}getAllColumnsProperties(){let e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[r]=n;return r===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Tt(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[r,i]=n;return Ee({column:this.hot.toVisualColumn(r)},i)})}getColumnSortState(e){let n=this.getSortOrderOfColumn(e);if(Ze(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}};var $x="asc",Gx="desc",L8="colHeader";function oXe(t){if(Tt(t)===!1)return!1;let{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[$x,Gx].includes(n)}function Vue(t){if(t.some(n=>oXe(n)===!1))return!1;let e=t.map(n=>{let{column:r}=n;return r});return new Set(e).size===e.length}function H8(t){if(t!==Gx)return t===$x?Gx:$x}function V8(t){return t.querySelector(`.${L8}`)}function B8(t,e){if(t<0||!e.parentNode)return!1;let n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function zx(t,e,n){return t===-1&&e>=0&&Na(n)===!1}var U8t=Q(ze(),1);var sXe="ascending",aXe="descending",Bue="indicatorDisabled",Uue="columnSorting",Wue="sortAction",jue=new Map([[$x,sXe],[Gx,aXe]]);function $ue(t,e,n,r){let i=[Uue];if(r&&i.push(Wue),n===!1)return i.push(Bue),i;let o=t.getSortOrderOfColumn(e);return Ze(o)&&i.push(jue.get(o)),i}function Gue(){return Array.from(jue.values()).concat(Wue,Bue,Uue)}function fN(t,e,n){let r=e.locale;return function(i,o){let{sortEmptyCells:s}=n;return typeof i=="string"&&(i=i.toLocaleLowerCase(r)),typeof o=="string"&&(o=o.toLocaleLowerCase(r)),i===o?fs:Er(i)?Er(o)?fs:s?t==="asc"?br:Tr:Tr:Er(o)?s?t==="asc"?Tr:br:br:isNaN(i)&&!isNaN(o)?t==="asc"?Tr:br:!isNaN(i)&&isNaN(o)?t==="asc"?br:Tr:(isNaN(i)||isNaN(o)||(i=parseFloat(i),o=parseFloat(o)),i<o?t==="asc"?br:Tr:i>o?t==="asc"?Tr:br:fs)}}var U8="default";function zue(t,e,n){return function(r,i){let o=parseFloat(r),s=parseFloat(i),{sortEmptyCells:a}=n;if(o===s||isNaN(o)&&isNaN(s))return fs;if(a){if(Er(r))return t==="asc"?br:Tr;if(Er(i))return t==="asc"?Tr:br}return isNaN(o)?Tr:isNaN(s)?br:o<s?t==="asc"?br:Tr:o>s?t==="asc"?Tr:br:fs}}var Yue="numeric";function que(t,e,n){let r=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(s,a){let l=Er(s),c=Er(a),u=l?i:s,d=c?i:a,h=u===i||u===r,f=d===i||d===r;if(o===!1){if(l&&c===!1)return Tr;if(l===!1&&c)return br}return h===!1&&f?t==="asc"?br:Tr:h&&f===!1?t==="asc"?Tr:br:h===!1&&f===!1?fN(t,e,n)(s,a):u===i&&d===r?t==="asc"?br:Tr:u===r&&d===i?t==="asc"?Tr:br:fs}}var Kue="checkbox";var W8=Q(Ma(),1);function Xue(t,e,n){return function(r,i){let{sortEmptyCells:o}=n;if(r===i)return fs;if(Er(r))return Er(i)?fs:o?t==="asc"?br:Tr:Tr;if(Er(i))return o?t==="asc"?Tr:br:br;let s=e.dateFormat,a=(0,W8.default)(r,s),l=(0,W8.default)(i,s);return a.isValid()?l.isValid()?l.isAfter(a)?t==="asc"?br:Tr:l.isBefore(a)?t==="asc"?Tr:br:fs:br:Tr}}var Zue="date";var{register:mN,getItem:Que,hasItem:lXe}=Ri("sorting.compareFunctionFactory"),{register:Yx,getItem:j8}=Ri("sorting.mainSortComparator");function qx(t){return lXe(t)?Que(t):Que(U8)}mN(Yue,zue);mN(Kue,que);mN(Zue,Xue);mN(U8,fN);var fs=0,br=-1,Tr=1;function $8(t,e){let n=j8(e);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];t.sort(n(...i))}function Jue(t,e){return function(n,r){let[,...i]=n,[,...o]=r;return function(a){let l=t[a],c=e[a],u=i[a],d=o[a],h=c.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:qx(c.type))(l,c,h)(u,d)}(0)}}function pN(t,e){cXe(t,e),e.add(t)}function cXe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gN(t,e,n){return e=uXe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uXe(t){var e=dXe(t,"string");return typeof e=="symbol"?e:String(e)}function dXe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function iy(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Kx="columnSorting",ide=50,oy="append",ode="replace",ede=Kx;Yx(Kx,Jue);ot.getSingleton().register("beforeColumnSort");ot.getSingleton().register("afterColumnSort");var vN=new WeakSet,tde=new WeakSet,nde=new WeakSet,rde=new WeakSet,Eg=class extends Dt{constructor(){super(...arguments),pN(this,rde),pN(this,nde),pN(this,tde),pN(this,vN),gN(this,"columnStatesManager",null),gN(this,"columnMetaCache",null),gN(this,"pluginKey",Kx),gN(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return Kx}static get PLUGIN_PRIORITY(){return ide}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new hN(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new xo(n=>{let r=this.hot.toVisualColumn(n);return r===null&&(r=n),this.getMergedPluginSettings(r)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,r)=>iy(this,tde,hXe).call(this,n,r)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return iy(e,rde,mXe).call(e,...r)}),this.addHook("afterOnCellMouseDown",(n,r)=>this.onAfterOnCellMouseDown(n,r)),this.addHook("afterInit",()=>iy(this,vN,G8).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return iy(e,nde,fXe).call(e,...r)}),this.hot.view&&iy(this,vN,G8).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){let e=(n,r)=>{let i=V8(r);B8(n,r)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey))},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getColumnNextConfig(e.col))},runOnlyIf:()=>{var e;let n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:ede})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ede)}sort(e){let n=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(r);this.hot.runHooks("beforeColumnSort",n,r,i)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new Mw),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",n,i?r:n,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Ze(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){let n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){let n=this.hot.countCols();return Vue(e)&&e.every(r=>{let{column:i}=r;return i<=n&&i>=0})}saveAllSortSettings(e){let n=this.columnStatesManager.getAllColumnsProperties(),r=i=>{let a=i,{column:o}=a,s=tr(a,["column"]);return Ee({column:this.hot.toPhysicalColumn(o)},s)};n.initialConfig=At(e,r),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){let e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);let n=e.value,r=i=>{let a=i,{column:o}=a,s=tr(a,["column"]);return Ee({column:this.hot.toVisualColumn(o)},s)};return Ze(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=At(n.initialConfig,r)),n}getColumnNextConfig(e){let n=this.columnStatesManager.getSortOrderOfColumn(e);if(Ze(n)){let i=H8(n);return Ze(i)?{column:e,sortOrder:i}:void 0}let r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:H8()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:oy,r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=r!==-1,o=this.getSortConfig(),s=this.getColumnNextConfig(e);if(i){if(mn(s))return[...o.slice(0,r),...o.slice(r+1)];if(n===oy)return[...o.slice(0,r),...o.slice(r+1),s];if(n===ode)return[...o.slice(0,r),s,...o.slice(r+1)]}return Ze(s)?o.concat(s):o}getPluginColumnConfig(e){if(Tt(e)){let n=e[this.pluginKey];if(Tt(n))return n}return{}}getMergedPluginSettings(e){let n=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(i);return Array.isArray(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns[e])):xn(o.columns)?Object.assign(r,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(r,n)}getFirstCellSettings(e){let n=this.hot.getCellMeta(0,e),r=Object.create(n);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){let n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(e.length===0){this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues());return}let n=[],r=this.hot.countRows(),i=c=>At(e,u=>this.hot.getDataAtCell(c,u.column));for(let c=0;c<this.getNumberOfRowsToSort(r);c+=1)n.push([this.hot.toPhysicalRow(c)].concat(i(c)));let o=At(n,c=>c[0]);$8(n,this.pluginKey,At(e,c=>c.sortOrder),At(e,c=>this.getFirstCellSettings(c.column)));for(let c=n.length;c<r;c+=1)n.push([c].concat(i(c)));let s=At(n,c=>c[0]),a=new Map(At(o,(c,u)=>[c,s[u]])),l=At(this.hot.rowIndexMapper.getIndexesSequence(),c=>a.has(c)?a.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Tt(e)){this.columnStatesManager.updateAllColumnsProperties(e);let n=e.initialConfig;(Array.isArray(n)||Tt(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(bt(e,Gue(e)),this.enabled!==!1){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];Ne(e,$ue(...r))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Ze(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&St(e.target,L8)}onAfterOnCellMouseDown(e,n){zx(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col)),this.sort(this.getColumnNextConfig(n.col)))}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}};function G8(){let t=this.getAllSavedSortSettings();if(Tt(t))this.sortBySettings(t);else{let e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function hXe(t,e){let n=V8(e);if(B8(t,e)===!1||n===null)return;let r=this.getFirstCellSettings(t)[this.pluginKey],i=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,i,o),this.hot.getSettings().ariaTags){let s=this.columnStatesManager.getSortOrderOfColumn(t);vt(e,...Wie(s?`${s}ending`:"none"))}}function fXe(t){t===!0&&this.hot.view&&iy(this,vN,G8).call(this)}function mXe(t,e,n,r){zx(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}var j6t=Q(De(),1);var L6t=Q(De(),1),H6t=Q(ze(),1);function xg(t,e,n){return e=pXe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pXe(t){var e=gXe(t,"string");return typeof e=="symbol"?e:String(e)}function gXe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var z8=class{constructor(e,n){xg(this,"plugin",void 0),xg(this,"hot",void 0),xg(this,"endpoints",[]),xg(this,"settings",void 0),xg(this,"settingsType","array"),xg(this,"currentEndpoint",null),xg(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){let n=[],r=e;if(!r&&typeof this.settings=="function"){this.settingsType="function";return}return r||(r=this.settings),Z(r,i=>{let o={};this.assignSetting(i,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,o,"reversedRowCoords",!1),this.assignSetting(i,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,o,"sourceColumn",i.destinationColumn),this.assignSetting(i,o,"type","sum"),this.assignSetting(i,o,"forceNumeric",!1),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"suppressDataTypeErrors",!0),this.assignSetting(i,o,"customFunction",null),this.assignSetting(i,o,"readOnly",!0),this.assignSetting(i,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,r,i){if(r==="ranges"&&e[r]===void 0){n[r]=i;return}else if(r==="ranges"&&e[r].length===0)return;if(e[r]===void 0){if(i instanceof Error)throw i;n[r]=i}else r==="destinationRow"&&n.reversedRowCoords?n[r]=this.hot.countRows()-e[r]-1:n[r]=e[r]}resetSetupBeforeStructureAlteration(e,n,r){if(this.settingsType!=="function")return;let i=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();Z(o,s=>{i==="row"&&s.destinationRow>=n&&(e==="insert_row"?s.alterRowOffset=r:e==="remove_row"&&(s.alterRowOffset=-1*r)),i==="col"&&s.destinationColumn>=n&&(e==="insert_col"?s.alterColumnOffset=r:e==="remove_col"&&(s.alterColumnOffset=-1*r))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,r,i,o){let s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){let h=()=>(this.hot.removeHook("beforeViewRender",h),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",h);return}let a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),u=e.indexOf("move_row")===0,d=n;Z(c,h=>{a==="row"&&h.destinationRow>=d&&(h.alterRowOffset=l*r),a==="col"&&h.destinationColumn>=d&&(h.alterColumnOffset=l*r)}),this.resetAllEndpoints(c,!u),u?Z(c,h=>{this.extendEndpointRanges(h,d,i[0],i.length),this.recreatePhysicalRanges(h),this.clearOffsetInformation(h)}):Z(c,h=>{this.shiftEndpointCoordinates(h,d)}),s&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,r,i){Z(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?r>o[1]?o[1]+=i:r<o[0]&&(o[0]-=i):r>=o[0]&&r<=o[1]&&(o[1]-=i,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){let n=e.ranges,r=[],i=[];Z(n,o=>{let s=[];if(o[1])for(let a=o[0];a<=o[1];a++)s.push(this.hot.toPhysicalRow(a));else s.push(this.hot.toPhysicalRow(o[0]));i.push(s)}),Z(i,o=>{let s=[];Z(o,(a,l)=>{l===0?s.push(a):o[l]!==o[l-1]+1&&(s.push(o[l-1]),r.push(s),s=[],s.push(a)),l===o.length-1&&(s.push(a),r.push(s))})}),e.ranges=r}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,Z(e.ranges,r=>{Z(r,(i,o)=>{i>=n&&(r[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{let o=i.alterRowOffset||0,s=i.alterColumnOffset||0;return i.destinationRow+o>=this.hot.countRows()||i.destinationColumn+s>=this.hot.countCols()})||(this.cellsToSetCache=[],Z(e,i=>{this.resetEndpointValue(i,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Z(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){let n=[];this.cellsToSetCache=[],Z(e,(r,i,o)=>{`${r[2]||""}`!=`${r[3]}`&&Z(this.getAllEndpoints(),(s,a)=>{this.hot.propToCol(o[i][1])===s.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),Z(n,r=>{this.refreshEndpoint(this.getEndpoint(r))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?r:0)),this.hot.toVisualColumn(e.destinationColumn+(n?i:0)),""])}setEndpointValue(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}let o=this.hot.toVisualRow(e.destinationRow);if(o!==null){let s=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||s.readOnly!==e.readOnly)&&(s.readOnly=e.readOnly,s.className="columnSummaryResult")}e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),r?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Sn("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}},sde=z8;function wN(t){return t==null||isNaN(t)}function Y8(t,e){vXe(t,e),e.add(t)}function vXe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wXe(t,e,n){return e=yXe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yXe(t){var e=_Xe(t,"string");return typeof e=="symbol"?e:String(e)}function _Xe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function q8(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var yN="columnSummary",ude=220,ade=new WeakSet,lde=new WeakSet,cde=new WeakSet,Xx=class extends Dt{constructor(){super(...arguments),Y8(this,cde),Y8(this,lde),Y8(this,ade),wXe(this,"endpoints",null)}static get PLUGIN_KEY(){return yN}static get PLUGIN_PRIORITY(){return ude}isEnabled(){return!!this.hot.getSettings()[yN]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[yN],this.endpoints=new sde(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return q8(e,ade,CXe).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return q8(e,lde,SXe).call(e,...r)}),this.addHook("beforeCreateRow",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,r,null,i)),this.addHook("beforeCreateCol",(n,r,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,r,null,i)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)}),this.addHook("afterCreateRow",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,r,null,i)),this.addHook("afterCreateCol",(n,r,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,r,null,i)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return q8(e,cde,EXe).call(e,...r)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break;default:break}}calculateSum(e){let n=0;return Rt(e.ranges,r=>{n+=this.getPartialSum(r,e.sourceColumn)}),n}getPartialSum(e,n){let r=0,i=e[1]||e[0],o=null,s=0;do{if(o=this.getCellValue(i,n),o=wN(o)?null:o,o!==null){let a=(`${o}`.split(".")[1]||[]).length||1;a>s&&(s=a)}r+=o||0,i-=1}while(i>=e[0]);return Math.round(r*10**s)/10**s}calculateMinMax(e,n){let r=null;return Rt(e.ranges,i=>{let o=this.getPartialMinMax(i,e.sourceColumn,n);if(r===null&&o!==null&&(r=o),o!==null)switch(n){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break;default:break}}),r===null?"Not enough data":r}getPartialMinMax(e,n,r){let i=null,o=e[1]||e[0],s;do{if(s=this.getCellValue(o,n),s=wN(s)?null:s,i===null)i=s;else if(s!==null)switch(r){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break;default:break}o-=1}while(o>=e[0]);return i}countEmpty(e,n){let r,i=0,o=e[1]||e[0];do r=this.getCellValue(o,n),r=wN(r)?null:r,r===null&&(i+=1),o-=1;while(o>=e[0]);return i}countEntries(e){let n=0,r=e.ranges;return Rt(r,i=>{let o=i[1]===void 0?1:i[1]-i[0]+1,s=this.countEmpty(i,e.sourceColumn);n+=o,n-=s}),n}calculateAverage(e){let n=this.calculateSum(e),r=this.countEntries(e);return n/r}getCellValue(e,n){let r=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(n),o=this.hot.getSourceDataAtCell(e,n),s="";if(r!==null&&i!==null&&(s=this.hot.getCellMeta(r,i).className||""),s.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Qt`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}};function CXe(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)}function SXe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function EXe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}var ajt=Q(De(),1),ljt=Q(ze(),1);var Q6t=Q(De(),1);function sy(t,e,n){return e=xXe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xXe(t){var e=bXe(t,"string");return typeof e=="symbol"?e:String(e)}function bXe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var K8=class t{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n){sy(this,"rootDocument",void 0),sy(this,"isRtl",!1),sy(this,"container",null),sy(this,"editor",void 0),sy(this,"editorStyle",void 0),sy(this,"hidden",!0),this.rootDocument=e,this.isRtl=n,this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hide()}setPosition(e,n){this.editorStyle.left=`${e}px`,this.editorStyle.top=`${n}px`}setSize(e,n){if(e&&n){let r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${n}px`}}getSize(){return{width:pn(this.getInputElement()),height:Nn(this.getInputElement())}}resetSize(){let e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){let n=this.getInputElement();n.readOnly=e}show(){this.editorStyle.display="block",this.hidden=!1}hide(){this.hidden||(this.editorStyle.display="none"),this.hidden=!0}isVisible(){return this.editorStyle.display==="block"}setValue(){let n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return this.rootDocument.activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){let e=this.rootDocument.createElement("div"),n=this.rootDocument.createElement("textarea");return e.style.display="none",this.container=this.rootDocument.createElement("div"),this.container.setAttribute("dir",this.isRtl?"rtl":"ltr"),Ne(this.container,t.CLASS_EDITOR_CONTAINER),this.rootDocument.body.appendChild(this.container),Ne(e,t.CLASS_EDITOR),Ne(n,t.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),this.container.appendChild(e),e}getInputElement(){return this.editor.querySelector(`.${t.CLASS_INPUT}`)}destroy(){let e=this.container?this.container.parentNode:null;this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null,e&&e.removeChild(this.container)}},dde=K8;var t5t=Q(De(),1);function X8(t,e,n){return e=TXe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TXe(t){var e=RXe(t,"string");return typeof e=="symbol"?e:String(e)}function RXe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var DXe=250,IXe=250,_N=class{constructor(e){X8(this,"wasLastActionShow",!0),X8(this,"showDebounced",null),X8(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},IXe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DXe;this.showDebounced=aw(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}};Jt(_N,xr);var hde=_N;function AXe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function MXe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function nm(t,e){let n={};return Z(t,r=>{r.forAll((i,o)=>{i>=0&&o>=0&&(n[i]||(n[i]=[]),n[i][o]=e(i,o))})}),n}function Ou(t,e,n,r,i){Z(t,o=>{o.forAll((s,a)=>{s>=0&&a>=0&&OXe(s,a,e,n,r,i)})})}function OXe(t,e,n,r,i,o){let s=i(t,e),a=r;s.className&&(n==="vertical"?a=AXe(s.className,r):a=MXe(s.className,r)),o(t,e,"className",a)}function Al(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Fa(t,e){let n=!1;return Array.isArray(t)&&Z(t,r=>(r.forAll((i,o)=>{if(i>=0&&o>=0&&e(i,o))return n=!0,!1}),n)),n}function ay(t,e){let n={top:0,left:0};if(e!==t.ownerDocument){let{frameElement:r}=e.defaultView,{top:i,left:o}=r.getBoundingClientRect();n.top=i,n.left=o}return n}var Bt="---------";function Z8(){return{name:Bt}}var ms="alignment";function Q8(){return{key:ms,name(){return this.getTranslatedPhrase(EE)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${ms}:left`,name(){let t=this.getTranslatedPhrase(xE);return Fa(this.getSelectedRange(),(n,r)=>{let i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htLeft")!==-1)return!0})&&(t=Al(t)),t},callback(){let t=this.getSelectedRange(),e=nm(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,n,r),Ou(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ms}:center`,name(){let t=this.getTranslatedPhrase(bE);return Fa(this.getSelectedRange(),(n,r)=>{let i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htCenter")!==-1)return!0})&&(t=Al(t)),t},callback(){let t=this.getSelectedRange(),e=nm(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,n,r),Ou(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ms}:right`,name(){let t=this.getTranslatedPhrase(TE);return Fa(this.getSelectedRange(),(n,r)=>{let i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htRight")!==-1)return!0})&&(t=Al(t)),t},callback(){let t=this.getSelectedRange(),e=nm(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,n,r),Ou(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ms}:justify`,name(){let t=this.getTranslatedPhrase(RE);return Fa(this.getSelectedRange(),(n,r)=>{let i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htJustify")!==-1)return!0})&&(t=Al(t)),t},callback(){let t=this.getSelectedRange(),e=nm(t,(i,o)=>this.getCellMeta(i,o).className),n="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,n,r),Ou(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{name:Bt},{key:`${ms}:top`,name(){let t=this.getTranslatedPhrase(DE);return Fa(this.getSelectedRange(),(n,r)=>{let i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htTop")!==-1)return!0})&&(t=Al(t)),t},callback(){let t=this.getSelectedRange(),e=nm(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,n,r),Ou(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ms}:middle`,name(){let t=this.getTranslatedPhrase(IE);return Fa(this.getSelectedRange(),(n,r)=>{let i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htMiddle")!==-1)return!0})&&(t=Al(t)),t},callback(){let t=this.getSelectedRange(),e=nm(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,r),Ou(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1},{key:`${ms}:bottom`,name(){let t=this.getTranslatedPhrase(AE);return Fa(this.getSelectedRange(),(n,r)=>{let i=this.getCellMeta(n,r).className;if(i&&i.indexOf("htBottom")!==-1)return!0})&&(t=Al(t)),t},callback(){let t=this.getSelectedRange(),e=nm(t,(i,o)=>this.getCellMeta(i,o).className),n="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,n,r),Ou(t,n,r,(i,o)=>this.getCellMeta(i,o),(i,o,s,a)=>this.setCellMeta(i,o,s,a)),this.render()},disabled:!1}]}}}var bg="clear_column";function J8(){return{key:bg,name(){return this.getTranslatedPhrase(cE)},callback(t,e){let n=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}var qd="col_left";function e6(){return{key:qd,name(){return this.getTranslatedPhrase(nE)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}var Kd="col_right";function t6(){return{key:Kd,name(){return this.getTranslatedPhrase(rE)},callback(){let t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}var Xd="make_read_only";function n6(){return{key:Xd,name(){let t=this.getTranslatedPhrase(lE);return Fa(this.getSelectedRange(),(n,r)=>this.getCellMeta(n,r).readOnly)&&(t=Al(t)),t},callback(){let t=this.getSelectedRange(),e=Fa(t,(n,r)=>this.getCellMeta(n,r).readOnly);Z(t,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&this.setCellMeta(r,i,"readOnly",!e)})}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}var Tg="redo";function r6(){return{key:Tg,name(){return this.getTranslatedPhrase(aE)},callback(){this.redo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}var Zd="remove_col";function i6(){return{key:Zd,name(){let t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{let[,n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(oE,e)},callback(){this.alter("remove_col",Qae(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;let e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}var Rg="remove_row";function o6(){return{key:Rg,name(){let t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{let[n,,r]=t[0];n-r!==0&&(e=1)}return this.getTranslatedPhrase(iE,e)},callback(){this.alter("remove_row",Jae(this),1,"ContextMenu.removeRow")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;let e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}var Dg="row_above";function s6(){return{key:Dg,name(){return this.getTranslatedPhrase(eE)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}var Ig="row_below";function a6(){return{key:Ig,name(){return this.getTranslatedPhrase(tE)},callback(){let t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){let t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}var rm="no_items";function l6(){return{key:rm,name(){return this.getTranslatedPhrase(JS)},disabled:!0,isCommand:!1}}var Ag="undo";function c6(){return{key:Ag,name(){return this.getTranslatedPhrase(sE)},callback(){this.undo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}var fde=[Dg,Ig,qd,Kd,bg,Rg,Zd,Ag,Tg,Xd,ms,Bt,rm],NXe={[Bt]:Z8,[rm]:l6,[Dg]:s6,[Ig]:a6,[qd]:e6,[Kd]:t6,[bg]:J8,[Rg]:o6,[Zd]:i6,[Ag]:c6,[Tg]:r6,[Xd]:n6,[ms]:Q8};function CN(){let t={};return Rt(NXe,(e,n)=>{t[n]=e()}),t}function u6(t){return{key:"commentsAddEdit",name(){var e;let n=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(_E):this.getTranslatedPhrase(yE)},callback(){let e=this.getSelectedRangeLast();this.deselectCell(),t.setRange(e),t.show(),t.focusEditor()},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function d6(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(CE)},callback(){this.getSelectedRangeLast().forAll((n,r)=>{n>=0&&r>=0&&t.removeCommentAtCell(n,r,!1)}),this.render()},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function h6(t){return{key:"commentsReadOnly",name(){let e=this.getTranslatedPhrase(SE);return Fa(this.getSelectedRange(),(r,i)=>t.getCommentMeta(r,i,Zx))?Al(e):e},callback(){this.getSelectedRangeLast().forAll((n,r)=>{if(n>=0&&r>=0){let i=!!t.getCommentMeta(n,r,Zx);t.updateCommentMeta(n,r,{[Zx]:!i})}})},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Nu(t,e){xde(t,e),e.add(t)}function Mg(t,e,n){xde(t,e),e.set(t,n)}function xde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PXe(t,e,n){return e=kXe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kXe(t){var e=FXe(t,"string");return typeof e=="symbol"?e:String(e)}function FXe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pu(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Jd(t,e,n){var r=bde(t,e,"set");return LXe(t,r,n),n}function LXe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function An(t,e){var n=bde(t,e,"get");return HXe(t,n)}function bde(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function HXe(t,e){return e.get?e.get.call(t):e.value}var ly="comments",Tde=60,Qd="comment",Qx="value",Rde="style",Zx="readOnly",SN=ly,f6=`plugin:${ly}`,Vr=new WeakMap,Ic=new WeakMap,TN=new WeakMap,EN=new WeakMap,xN=new WeakMap,m6=new WeakMap,bN=new WeakMap,mde=new WeakSet,pde=new WeakSet,gde=new WeakSet,vde=new WeakSet,wde=new WeakSet,yde=new WeakSet,_de=new WeakSet,Cde=new WeakSet,Sde=new WeakSet,Ede=new WeakSet,Jx=class extends Dt{constructor(){super(...arguments),Nu(this,Ede),Nu(this,Sde),Nu(this,Cde),Nu(this,_de),Nu(this,yde),Nu(this,wde),Nu(this,vde),Nu(this,gde),Nu(this,pde),Nu(this,mde),PXe(this,"range",{}),Mg(this,Vr,{writable:!0,value:null}),Mg(this,Ic,{writable:!0,value:null}),Mg(this,TN,{writable:!0,value:!1}),Mg(this,EN,{writable:!0,value:!1}),Mg(this,xN,{writable:!0,value:{}}),Mg(this,m6,{writable:!0,value:null}),Mg(this,bN,{writable:!0,value:""})}static get PLUGIN_KEY(){return ly}static get PLUGIN_PRIORITY(){return Tde}isEnabled(){return!!this.hot.getSettings()[ly]}enablePlugin(){this.enabled||(An(this,Vr)||Jd(this,Vr,new dde(this.hot.rootDocument,this.hot.isRtl())),An(this,Ic)||Jd(this,Ic,new hde(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,n,r,i,o,s)=>Pu(this,vde,WXe).call(this,e,s)),this.addHook("afterScroll",()=>Pu(this,Ede,qXe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>Pu(this,Sde,YXe).call(this,e)),An(this,Ic).addLocalHook("hide",()=>this.hide()),An(this,Ic).addLocalHook("show",(e,n)=>this.showAtCell(e,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){An(this,Ic).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let e=this.hot.getShortcutManager(),n=e.getContext("grid"),r=e.addContext(f6);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{let i=this.hot.getSelectedRangeLast();Jd(this,EN,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(f6),this.hot._registerTimeout(()=>{Jd(this,EN,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!An(this,Vr).isVisible()},group:SN}),r.addShortcut({keys:[["Escape"]],callback:()=>{An(this,Vr).setValue(An(this,bN)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&An(this,Vr).isVisible()},group:SN}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&An(this,Vr).isVisible()},group:SN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SN)}registerListeners(){let{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",r=>Pu(this,pde,BXe).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Pu(this,mde,VXe).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Pu(this,gde,UXe).call(this)),this.eventManager.addEventListener(n,"focus",()=>Pu(this,yde,$Xe).call(this)),this.eventManager.addEventListener(n,"blur",()=>Pu(this,wde,jXe).call(this)),this.eventManager.addEventListener(n,"mousedown",r=>Pu(this,_de,GXe).call(this,r)),this.eventManager.addEventListener(n,"mouseup",r=>Pu(this,Cde,zXe).call(this,r))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){let n=mc(e.target,"TD","TBODY");return!!(n&&St(n,"htCommentCell")&&mc(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let n=An(this,Vr).getValue(),r="";e!=null?r=e:n!=null&&(r=n);let i=this.range.from.row,o=this.range.from.col;this.updateCommentMeta(i,o,{[Qx]:r}),this.hot.render()}setCommentAtCell(e,n,r){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(r)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Qd),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(r)}getComment(){let e=this.range.from.row,n=this.range.from.col;return this.getCommentMeta(e,n,Qx)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Qx)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let{from:{row:n,col:r}}=this.range;if(n<0||n>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;let i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return An(this,Ic).cancelHiding(),An(this,Vr).setValue((e=i[Qd]?i[Qd][Qx]:null)!==null&&e!==void 0?e:""),An(this,Vr).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){An(this,Vr).hide()}refreshEditor(){var e,n;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!An(this,Vr).isVisible()))return;let{rowIndexMapper:i,columnIndexMapper:o}=this.hot,{row:s,col:a}=this.range.from,l=i.getRenderableFromVisualIndex(s),c=o.getRenderableFromVisualIndex(a),u=l===null;An(this,Vr).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1))),c===null&&(c=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(a,-1)));let d=l===null,h=c===null;l=(e=l)!==null&&e!==void 0?e:0,c=(n=c)!==null&&n!==void 0?n:0;let{rootWindow:f,view:{_wt:p}}=this.hot,{wtTable:g}=p,w=p.getCell({row:l,col:c},!0),_=this.getCommentMeta(s,a,Rde);_?An(this,Vr).setSize(_.width,_.height):An(this,Vr).resetSize();let S=h?0:g.getStretchedColumnWidth(c),x=u&&!d?Nn(w):0,{left:P,top:k,width:b,height:C}=w.getBoundingClientRect(),{width:N,height:B}=An(this,Vr).getSize(),{innerWidth:Y,innerHeight:ee}=this.hot.rootWindow,te=this.hot.rootDocument.documentElement,Ce=P+f.scrollX+S,Re=k+f.scrollY+x;this.hot.isRtl()&&(Ce-=N+S),this.hot.isLtr()&&P+b+N>Y?Ce=P+f.scrollX-N-1:this.hot.isRtl()&&Ce<-(te.scrollWidth-te.clientWidth)&&(Ce=P+f.scrollX+S+1),k+B>ee&&(Re-=B-C+1),An(this,Vr).setPosition(Ce,Re),An(this,Vr).setReadOnlyState(this.getCommentMeta(s,a,Zx))}focusEditor(){An(this,Vr).focus()}updateCommentMeta(e,n,r){let i=this.hot.getCellMeta(e,n)[Qd],o;i?(o=vi(i),Yp(o,r)):o=r,this.hot.setCellMeta(e,n,Qd,o)}getCommentMeta(e,n,r){let i=this.hot.getCellMeta(e,n);if(i[Qd])return i[Qd][r]}addToContextMenu(e){e.items.push({name:Bt},u6(this),d6(this),h6(this))}getDisplayDelaySetting(){let e=this.hot.getSettings()[ly];if(Tt(e))return e.displayDelay}getEditorInputElement(){return An(this,Vr).getInputElement()}destroy(){An(this,Vr)&&An(this,Vr).destroy(),An(this,Ic)&&An(this,Ic).destroy(),super.destroy()}};function VXe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!An(this,TN)&&!this.targetIsCommentTextArea(t)){let e=mc(t.target,"TD","TBODY"),n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function BXe(t){let{rootDocument:e}=this.hot;if(!(An(this,TN)||An(this,Vr).isFocused()||St(t.target,"wtBorder")||An(this,m6)===t.target||!An(this,Vr)))if(Jd(this,m6,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){let n=this.hot._createCellRange(this.hot.getCoords(t.target));An(this,Ic).show(n)}else pc(t.target,e)&&!this.targetIsCommentTextArea(t)&&An(this,Ic).hide()}function UXe(){Jd(this,TN,!1)}function WXe(t,e){e[Qd]&&e[Qd][Qx]&&Ne(t,e.commentedCellClassName)}function jXe(){Jd(this,bN,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function $Xe(){Jd(this,bN,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(f6)}function GXe(t){Jd(this,xN,{width:pn(t.target),height:Nn(t.target)})}function zXe(t){let e=pn(t.target),n=Nn(t.target);(e!==An(this,xN).width+1||n!==An(this,xN).height+2)&&this.updateCommentMeta(this.range.from.row,this.range.from.col,{[Rde]:{width:e,height:n}})}function YXe(t){An(this,Vr).isVisible()&&wi(t)}function qXe(){An(this,EN)||this.hide()}var T$t=Q(De(),1);var bjt=Q(De(),1),Tjt=Q(ze(),1),Rjt=Q(Mde(),1);function p6(t,e,n){return e=oZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oZe(t){var e=sZe(t,"string");return typeof e=="symbol"?e:String(e)}function sZe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cy=class{constructor(e){p6(this,"hot",void 0),p6(this,"commands",{}),p6(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];let o=e.split(":"),s=o[0],a=o.length===2?o[1]:null,l=this.commands[s];if(!l)throw new Error(`Menu command '${s}' not exists.`);if(a&&l.submenu&&(l=aZe(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||Kn(l,"submenu"))return;let c=[];typeof l.callback=="function"&&c.push(l.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),r.unshift(o.join(":")),Z(c,u=>u.apply(this.hot,r))}};function aZe(t,e){let n;return Z(e,r=>{let i=r.key?r.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return n=r,!1}),n}var Mjt=Q(ze(),1),Ojt=Q(De(),1);function g6(t,e,n){return e=lZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lZe(t){var e=cZe(t,"string");return typeof e=="symbol"?e:String(e)}function cZe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uy=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;g6(this,"hot",void 0),g6(this,"predefinedItems",CN()),g6(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){let n={};this.defaultOrderPattern.length=0,Rt(e,(r,i)=>{let o="";r.name===Bt?(n[Bt]=r,o=Bt):isNaN(parseInt(i,10))?(r.key=r.key===void 0?i:r.key,n[i]=r,o=r.key):(n[r.key]=r,o=r.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return uZe(e,this.defaultOrderPattern,this.predefinedItems)}};function uZe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=[],i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),Tt(i)?Rt(i,(o,s)=>{let a=n[typeof o=="string"?o:s];a||(a=o),Tt(o)?Ln(a,o):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=s),r.push(a)}):Z(i,(o,s)=>{let a=n[o];!a&&fde.indexOf(o)>=0||(a||(a={name:o,key:`${s}`}),Tt(o)&&Ln(a,o),a.key===void 0&&(a.key=s),r.push(a))}),r}var a$t=Q(ze(),1),l$t=Q(De(),1);var Vjt=Q(De(),1);var Ljt=Q(De(),1);function im(t,e,n){return e=dZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dZe(t){var e=hZe(t,"string");return typeof e=="symbol"?e:String(e)}function hZe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var RN=class{constructor(e,n){im(this,"top",void 0),im(this,"topRelative",void 0),im(this,"left",void 0),im(this,"leftRelative",void 0),im(this,"scrollTop",void 0),im(this,"scrollLeft",void 0),im(this,"cellHeight",void 0),im(this,"cellWidth",void 0);let r=n.scrollY,i=n.scrollX,o,s,a,l,c,u;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),a=parseInt(e.left,10),c=e.height||0,u=e.width||0,s=o,l=a,o+=r,a+=i):this.type==="event"&&(o=parseInt(e.pageY,10),a=parseInt(e.pageX,10),c=e.target.clientHeight,u=e.target.clientWidth,s=o-r,l=a-i),this.top=o,this.topRelative=s,this.left=a,this.leftRelative=l,this.scrollTop=r,this.scrollLeft=i,this.cellHeight=c,this.cellWidth=u}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}};function eb(t,e,n){fZe(t,e),e.set(t,n)}function fZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tn(t,e){var n=Ode(t,e,"get");return mZe(t,n)}function mZe(t,e){return e.get?e.get.call(t):e.value}function DN(t,e,n){var r=Ode(t,e,"set");return pZe(t,r,n),n}function Ode(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function pZe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Vs=new WeakMap,om=new WeakMap,Go=new WeakMap,v6=new WeakMap,dy=new WeakMap,IN=class{constructor(e){eb(this,Vs,{writable:!0,value:void 0}),eb(this,om,{writable:!0,value:void 0}),eb(this,Go,{writable:!0,value:void 0}),eb(this,v6,{writable:!0,value:!1}),eb(this,dy,{writable:!0,value:{above:0,below:0,left:0,right:0}}),DN(this,v6,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Tn(this,dy)[e]=n,this}setElement(e){return DN(this,Vs,e),this}setParentElement(e){return DN(this,om,e),this}updatePosition(e){DN(this,Go,new RN(e,Tn(this,Vs).ownerDocument.defaultView)),Tn(this,v6)?(Tn(this,Go).fitsBelow(Tn(this,Vs))?this.setPositionBelowCursor():Tn(this,Go).fitsAbove(Tn(this,Vs))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Tn(this,Vs).dir==="rtl"?Tn(this,Go).fitsOnLeft(Tn(this,Vs))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Tn(this,Go).fitsOnRight(Tn(this,Vs))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Tn(this,dy).above+Tn(this,Go).top-Tn(this,Vs).offsetHeight;Tn(this,om)&&(e=Tn(this,Go).top+Tn(this,Go).cellHeight-Tn(this,Vs).offsetHeight+3),Tn(this,Vs).style.top=`${e}px`}setPositionBelowCursor(){let e=Tn(this,dy).below+Tn(this,Go).top+1;Tn(this,om)&&(e=Tn(this,Go).top-1),Tn(this,Vs).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Tn(this,Go).left;if(Tn(this,om)){let{right:n}=Tn(this,om).getBoundingClientRect();e+=Tn(this,Go).cellWidth+n-(Tn(this,Go).left+Tn(this,Go).cellWidth)}else e+=Tn(this,dy).right;Tn(this,Vs).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Tn(this,dy).left+Tn(this,Go).left-Tn(this,Vs).offsetWidth;if(Tn(this,om)){let{left:n}=Tn(this,om).getBoundingClientRect();e-=Tn(this,Go).left-n}Tn(this,Vs).style.left=`${e}px`}};function AN(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:r=()=>{},onClear:i=()=>{}}=t,o=new Set,s=eo(e,-1,p()-1);function a(w,_){let S=p()-1;return w<0&&(w=S),w>S&&(w=0),o.has(w)?-1:(o.add(w),r(w,!1)===!1&&(w=a(_===1?++w:--w,_)),w)}function l(w){w>-1&&w<p()&&r(w,!0)!==!1&&(s=w)}function c(){return s}function u(){p()>0&&(o.clear(),s=a(0,1))}function d(){p()>0&&(o.clear(),s=a(p()-1,-1))}function h(){p()>0&&(o.clear(),s=a(++s,1))}function f(){p()>0&&(o.clear(),s=a(--s,-1))}function p(){return Math.max(n(),0)}function g(){o.clear(),s=e,i()}return{setCurrentPage:l,getCurrentPage:c,toFirstItem:u,toLastItem:d,toNextItem:h,toPreviousItem:f,getSize:p,clear:g}}var $jt=Q(ze(),1);function Nde(t){return At(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function tb(t){return Kn(t,"submenu")}function nb(t){return new RegExp(Bt,"i").test(t.name)}function hy(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function w6(t){return Kn(t,"disableSelection")}function Pde(t){return St(t,"htSeparator")}function kde(t){return St(t,"htSubmenu")}function Fde(t){return St(t,"htDisabled")}function Lde(t){return St(t,"htSelectionDisabled")}function Hde(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function Vde(t,e){let n=t.slice(0);for(let r=0;r<n.length&&n[r].name===e;)n.shift();return n}function gZe(t,e){let n=t.slice(0);return n.reverse(),n=Vde(n,e),n.reverse(),n}function vZe(t){let e=[];return Z(t,(n,r)=>{r>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function Bde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Bt,n=t.slice(0);return n=Vde(n,e),n=gZe(n,e),n=vZe(n),n}function Ude(t){return AN({size:()=>t.countRows(),onItemSelect(e,n){let r=t.getCell(e,0);if(!r||Pde(r)||Fde(r)||Lde(r))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}var e$t=Q(ze(),1);function Wde(t){return[{keys:[["Tab"],["Shift","Tab"],["Control/Meta","A"]],forwardToContext:t.hot.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{let e=t.hotMenu.getSelectedLast();if(e){let n=t.openSubMenu(e[0]);n&&n.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{t.hotMenu.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{let n=t.hotMenu.getSelectedLast();n&&(t.hotMenu.getSourceDataAtRow(n[0]).submenu?t.openSubMenu(n[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(-t.hotMenu.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{t.hotMenu.getSelectedLast()?t.hotMenu.selection.transformStart(t.hotMenu.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}var $de="menu",jde=$de;function Gde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[];r(Wde(t)),e.forEach(c=>{let{shortcuts:u,contextName:d}=c;i(u,d)});function r(c,u){a(u).addShortcuts(c,{group:$de})}function i(c,u){let d=a(u);c.forEach(h=>{let{keys:f}=h;f.forEach(p=>d.removeShortcutsByKeys(p))}),n.push({shortcuts:c,contextName:u}),r(c,u)}function o(){return[...n]}function s(c){return c?`${jde}:${c}`:jde}function a(c){var u;let d=t.hotMenu.getShortcutManager(),h=s(c);return(u=d.getContext(h))!==null&&u!==void 0?u:d.addContext(h)}function l(c){t.hotMenu.getShortcutManager().setActiveContextName(s(c))}return{addCustomShortcuts:i,getCustomShortcuts:o,getContext:a,listen:l}}function zde(t){return(e,n,r,i,o,s)=>{if(n.hasAttribute("ghost-table"))return;let a=e.getSourceDataAtRow(r),l=t.rootDocument.createElement("div"),c=typeof s=="function"?s.call(t):s;if(yo(n),Ne(l,"htItemWrapper"),t.getSettings().ariaTags){let u=!hy(a,t)&&!w6(a)&&!nb(a);vt(n,[Nie(),ew(c),...u?[ml(-1)]:[],...hy(a,t)?[Bie()]:[],...tb(a)?[Wo(!1)]:[]])}n.className="",n.appendChild(l),nb(a)?Ne(n,"htSeparator"):typeof a.renderer=="function"?(Ne(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,r,i,o,c))):vl(l,c),hy(a,t)?Ne(n,"htDisabled"):w6(a)?Ne(n,"htSelectionDisabled"):tb(a)&&Ne(n,"htSubmenu")}}function Yde(t,e,n){wZe(t,e),e.set(t,n)}function wZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ku(t,e,n){return e=yZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yZe(t){var e=_Ze(t,"string");return typeof e=="symbol"?e:String(e)}function _Ze(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qde(t,e,n){var r=Xde(t,e,"set");return CZe(t,r,n),n}function CZe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function rb(t,e){var n=Xde(t,e,"get");return SZe(t,n)}function Xde(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function SZe(t,e){return e.get?e.get.call(t):e.value}var Kde=215,ib=new WeakMap,MN=new WeakMap,eh=class t{constructor(e,n){var r=this;ku(this,"hot",void 0),ku(this,"options",void 0),ku(this,"eventManager",new ei(this)),ku(this,"container",void 0),ku(this,"positioner",void 0),ku(this,"hotMenu",null),ku(this,"hotSubMenus",{}),ku(this,"parentMenu",void 0),ku(this,"menuItems",null),ku(this,"origOutsideClickDeselects",null),Yde(this,ib,{writable:!0,value:void 0}),Yde(this,MN,{writable:!0,value:void 0}),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:Kde,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new IN(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return r.parentMenu.runLocalHooks("afterSelectionChange",...o)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=$p(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return rb(this,ib)}getKeyboardShortcutsCtrl(){return rb(this,MN)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let e=aw(a=>this.openSubMenu(a),300),n=this.options.minWidth||Kde,r=!1,i=gi(this.menuItems,a=>(a.key===rm&&(r=!0),Hde(a,this.hot)));if(i.length<1&&!r)i.push(CN()[rm]);else if(i.length===0)return;i=Bde(i,Bt);let o=!1,s={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return Ze(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:zde(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{rb(this,ib).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===Bt?1:23,afterOnCellContextMenu:a=>{a.preventDefault(),q4()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,c,u,d)=>{this.hotMenu.view.isMouseDown()&&(d.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!q4()||!Na(a))&&o&&this.hasSelectedItem()&&(Oa()||TM()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,s),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),qde(this,ib,Ude(this.hotMenu)),qde(this,MN,Gde(this)),rb(this,MN).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(rb(this,ib).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let n=this.parentMenu.hotMenu.getSelectedLast();if(n){let r=this.parentMenu.hotMenu.getCell(n[0],0);vt(r,[Wo(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;let n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!kde(n))return!1;let r=this.hotMenu.getSourceDataAtRow(e),i=new t(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(r.submenu.items),i.open(),i.setPosition(n.getBoundingClientRect()),this.hotSubMenus[r.key]=i,this.hot.getSettings().ariaTags&&vt(n,[Wo(!0)]),i}closeSubMenu(e){let n=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[n.key];if(r){r.destroy(),delete this.hotSubMenus[n.key];let i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&vt(i,[Wo(!1)])}}closeAllSubMenus(){Z(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;let n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;let r=this.hot.getSelectedRange(),i=r?Nde(r):[];this.runLocalHooks("executeCommand",n.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,i,e)}isCommandPassive(e){return e.isCommand===!1||nb(e)||hy(e,this.hot)||tb(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=this.options.container.ownerDocument,r=e,i;return r&&(xn(r)&&(r=r.call(this.hot),r===null||mn(r)?r="":r=r.toString()),r=r.replace(/[^A-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,i=n.querySelector(`.${this.options.className}.${r}`)),i||(i=n.createElement("div"),Ne(i,`htMenu ${this.options.className}`),r&&Ne(i,r),this.options.container.appendChild(i)),i}onAfterInit(){let{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,r=e.hider.style,i=e.holder.style,o=parseInt(r.width,10),s=or(n,(a,l)=>a+(l.name===Bt?1:26),0);i.width=`${o+3}px`,i.height=`${s+3}px`,r.height=i.height,this.hot.getSettings().ariaTags&&vt(this.hotMenu.rootElement,[Oie(),ml(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!pc(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!pc(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&St(e.target,"htCore")&&pc(e.target,this.hotMenu.rootElement)&&e.preventDefault()}};Jt(eh,xr);function ON(t,e){EZe(t,e),e.add(t)}function EZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function y6(t,e,n){return e=xZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xZe(t){var e=bZe(t,"string");return typeof e=="symbol"?e:String(e)}function bZe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NN(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var fy="contextMenu",nhe=70,Zde=fy;ot.getSingleton().register("afterContextMenuDefaultOptions");ot.getSingleton().register("beforeContextMenuShow");ot.getSingleton().register("afterContextMenuShow");ot.getSingleton().register("afterContextMenuHide");ot.getSingleton().register("afterContextMenuExecute");var Qde=new WeakSet,Jde=new WeakSet,ehe=new WeakSet,the=new WeakSet,my=class t extends Dt{constructor(){super(...arguments),ON(this,the),ON(this,ehe),ON(this,Jde),ON(this,Qde),y6(this,"commandExecutor",new cy(this.hot)),y6(this,"itemsFactory",null),y6(this,"menu",null)}static get PLUGIN_KEY(){return fy}static get PLUGIN_PRIORITY(){return nhe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Dg,Ig,Bt,qd,Kd,Bt,Rg,Zd,Bt,Ag,Tg,Bt,Xd,Bt,ms]}isEnabled(){return!!this.hot.getSettings()[fy]}enablePlugin(){var e=this;if(this.enabled)return;let n=this.hot.getSettings()[fy];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new eh(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>NN(this,Jde,RZe).call(this)),this.menu.addLocalHook("afterOpen",()=>NN(this,ehe,DZe).call(this)),this.menu.addLocalHook("afterClose",()=>NN(this,the,IZe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",r=>NN(this,Qde,TZe).call(this,r)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=ay(this.menu.container,this.hot.rootDocument);this.open({left:n.left+r.left,top:n.top+r.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;let n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:Zde})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Zde)}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Rt(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new uy(this.hot,t.DEFAULT_ITEMS);let e=this.hot.getSettings()[fy],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);let r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),Z(r,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function TZe(t){let e=this.hot.getSettings(),n=e.rowHeaders,r=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}let o=t.target;if(this.close(),St(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||r)&&!i(o)&&!(St(o,"current")&&St(o,"wtBorder"))))return;let s=ay(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+s.top,left:t.clientX+s.left})}function RZe(){this.hot.runHooks("beforeContextMenuShow",this)}function DZe(){this.hot.runHooks("afterContextMenuShow",this)}function IZe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}my.SEPARATOR={name:Bt};var sGt=Q(ze(),1),aGt=Q(De(),1);function _6(t){return{key:"copy",name(){return this.getTranslatedPhrase(uE)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1}}function C6(t){return{key:"copy_column_headers_only",name(){let e=this.getSelectedRangeLast(),n=e?eo(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(fE,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1}}function S6(t){return{key:"copy_with_column_group_headers",name(){let e=this.getSelectedRangeLast(),n=e?eo(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(hE,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1}}function E6(t){return{key:"copy_with_column_headers",name(){let e=this.getSelectedRangeLast(),n=e?eo(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(dE,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1}}function x6(t){return{key:"cut",name(){return this.getTranslatedPhrase(mE)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let n=this.getSelected();return!n||n.length>1},hidden:!1}}var PN=class{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}};var kN=class{constructor(){this.clipboardData=new PN}};var tGt=Q(ze(),1),nGt=Q(De(),1);function rhe(t,e){ohe(t,e),e.add(t)}function py(t,e,n){ohe(t,e),e.set(t,n)}function ohe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FN(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Bs(t,e){var n=she(t,e,"get");return AZe(t,n)}function AZe(t,e){return e.get?e.get.call(t):e.value}function gy(t,e,n){var r=she(t,e,"set");return MZe(t,r,n),n}function she(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function MZe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var sm=new WeakMap,b6=new WeakMap,ob=new WeakMap,R6=new WeakMap,D6=new WeakMap,sb=new WeakMap,LN=new WeakSet,ihe=new WeakSet,HN=class{constructor(e){let{countRows:n,countColumns:r,rowsLimit:i,columnsLimit:o,countColumnHeaders:s}=e;rhe(this,ihe),rhe(this,LN),py(this,sm,{writable:!0,value:void 0}),py(this,b6,{writable:!0,value:void 0}),py(this,ob,{writable:!0,value:void 0}),py(this,R6,{writable:!0,value:void 0}),py(this,D6,{writable:!0,value:void 0}),py(this,sb,{writable:!0,value:void 0}),gy(this,b6,n),gy(this,ob,r),gy(this,R6,i),gy(this,D6,o),gy(this,sb,s)}setSelectedRange(e){gy(this,sm,e)}getCellsRange(){if(Bs(this,b6).call(this)===0||Bs(this,ob).call(this)===0)return null;let{row:e,col:n}=Bs(this,sm).getTopStartCorner(),{row:r,col:i}=Bs(this,sm).getBottomEndCorner(),o=FN(this,ihe,OZe).call(this,e,r),s=FN(this,LN,T6).call(this,n,i);return{isRangeTrimmed:r!==o||i!==s,startRow:e,startCol:n,endRow:o,endCol:s}}getMostBottomColumnHeadersRange(){if(Bs(this,ob).call(this)===0||Bs(this,sb).call(this)===0)return null;let{col:e}=Bs(this,sm).getTopStartCorner(),{col:n}=Bs(this,sm).getBottomEndCorner(),r=FN(this,LN,T6).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(Bs(this,ob).call(this)===0||Bs(this,sb).call(this)===0)return null;let{col:e}=Bs(this,sm).getTopStartCorner(),{col:n}=Bs(this,sm).getBottomEndCorner(),r=FN(this,LN,T6).call(this,e,n);return{isRangeTrimmed:n!==r,startRow:-Bs(this,sb).call(this),startCol:e,endRow:-1,endCol:r}}};function T6(t,e){return Math.min(e,Math.max(t+Bs(this,D6).call(this)-1,t))}function OZe(t,e){return Math.min(e,Math.max(t+Bs(this,R6).call(this)-1,t))}function I6(t){let e=[],n=[];return Z(t,r=>{let i=Math.min(r.startRow,r.endRow),o=Math.max(r.startRow,r.endRow);st(i,o,l=>{e.indexOf(l)===-1&&e.push(l)});let s=Math.min(r.startCol,r.endCol),a=Math.max(r.startCol,r.endCol);st(s,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function th(t,e){phe(t,e),e.add(t)}function Og(t,e,n){phe(t,e),e.set(t,n)}function phe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ab(t,e,n){return e=NZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function NZe(t){var e=PZe(t,"string");return typeof e=="symbol"?e:String(e)}function PZe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function La(t,e){var n=ghe(t,e,"get");return kZe(t,n)}function kZe(t,e){return e.get?e.get.call(t):e.value}function Ac(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function nh(t,e,n){var r=ghe(t,e,"set");return FZe(t,r,n),n}function ghe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function FZe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ot.getSingleton().register("afterCopyLimit");ot.getSingleton().register("modifyCopyableRange");ot.getSingleton().register("beforeCut");ot.getSingleton().register("afterCut");ot.getSingleton().register("beforePaste");ot.getSingleton().register("afterPaste");ot.getSingleton().register("beforeCopy");ot.getSingleton().register("afterCopy");var lb="copyPaste",vhe=80,LZe=["fragmentSelection"],ahe=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join(""),M6=new WeakMap,O6=new WeakMap,N6=new WeakMap,vy=new WeakMap,VN=new WeakMap,BN=new WeakMap,wy=new WeakMap,A6=new WeakSet,lhe=new WeakSet,whe=new WeakSet,P6=new WeakSet,che=new WeakSet,uhe=new WeakSet,dhe=new WeakSet,hhe=new WeakSet,fhe=new WeakSet,cb=class extends Dt{constructor(){super(...arguments),th(this,fhe),th(this,hhe),th(this,dhe),th(this,uhe),th(this,che),th(this,P6),th(this,whe),th(this,lhe),th(this,A6),ab(this,"columnsLimit",1/0),ab(this,"rowsLimit",1/0),ab(this,"pasteMode","overwrite"),ab(this,"uiContainer",this.hot.rootDocument.body),Og(this,M6,{writable:!0,value:!1}),Og(this,O6,{writable:!0,value:!1}),Og(this,N6,{writable:!0,value:!1}),Og(this,vy,{writable:!0,value:"cells-only"}),Og(this,VN,{writable:!0,value:!1}),Og(this,BN,{writable:!0,value:!1}),Og(this,wy,{writable:!0,value:new HN({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})}),ab(this,"copyableRanges",[])}static get PLUGIN_KEY(){return lb}static get SETTING_KEYS(){return[lb,...LZe]}static get PLUGIN_PRIORITY(){return vhe}isEnabled(){return!!this.hot.getSettings()[lb]}enablePlugin(){var e=this;if(this.enabled)return;let{[lb]:n}=this.hot.getSettings();if(typeof n=="object"){var r,i;this.pasteMode=(r=n.pasteMode)!==null&&r!==void 0?r:this.pasteMode,this.rowsLimit=isNaN(n.rowsLimit)?this.rowsLimit:n.rowsLimit,this.columnsLimit=isNaN(n.columnsLimit)?this.columnsLimit:n.columnsLimit,nh(this,M6,!!n.copyColumnHeaders),nh(this,O6,!!n.copyColumnGroupHeaders),nh(this,N6,!!n.copyColumnHeadersOnly),this.uiContainer=(i=n.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",o=>Ac(this,che,BZe).call(this,o)),this.addHook("afterSelectionEnd",()=>Ac(this,uhe,UZe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),Y4()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Ac(e,dhe,WZe).call(e,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return Ac(e,hhe,jZe).call(e,...s)}),this.addHook("afterSelection",()=>Ac(this,fhe,$Ze).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";nh(this,vy,e),nh(this,VN,!0),Ac(this,A6,mhe).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){nh(this,BN,!0),Ac(this,A6,mhe).call(this,"cut")}getRangedCopyableData(e){return qf(this.getRangedData(e))}getRangedData(e){let n=[],{rows:r,columns:i}=I6(e);return Z(r,o=>{let s=[];Z(i,a=>{o<0?s.push(this.hot.getColHeader(a,o)):s.push(this.hot.getCopyableData(o,a))}),n.push(s)}),n}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;let r=new kN;e&&r.clipboardData.setData("text/plain",e),n&&r.clipboardData.setData("text/html",n),this.onPaste(r)}setCopyableText(){let e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}La(this,wy).setSelectedRange(e);let n=new Map([["headers",null],["cells",null]]);La(this,vy)==="column-headers-only"?n.set("headers",La(this,wy).getMostBottomColumnHeadersRange()):(La(this,vy)==="with-column-headers"?n.set("headers",La(this,wy).getMostBottomColumnHeadersRange()):La(this,vy)==="with-column-group-headers"&&n.set("headers",La(this,wy).getAllColumnHeadersRange()),n.set("cells",La(this,wy).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(i=>i!==null).map(i=>{let{startRow:o,startCol:s,endRow:a,endCol:l}=i;return{startRow:o,startCol:s,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let r=n.get("cells");if(r!==null&&r.isRangeTrimmed){let{startRow:i,startCol:o,endRow:s,endCol:a}=r;this.hot.runHooks("afterCopyLimit",s-i+1,a-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;let r=e.length,i=e[0].length,o=[],{row:s,col:a}=n.getTopStartCorner(),{row:l,col:c}=n.getBottomEndCorner(),u=s,d=a,h=s,f=a;for(;o.length<r||u<=l;){let{skipRowOnPaste:p,visualRow:g}=this.hot.getCellMeta(u,a);if(u=g+1,p===!0)continue;h=g,d=a;let w=[],_=o.length%r;for(;w.length<i||d<=c;){let{skipColumnOnPaste:S,visualCol:x}=this.hot.getCellMeta(s,d);if(d=x+1,S===!0)continue;f=x;let P=w.length%i;w.push(e[_][P])}o.push(w)}return this.hot.populateFromArray(s,a,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[s,a,h,f]}onCopy(e){if(!this.hot.isListening()&&!La(this,VN)||this.isEditorOpened())return;this.setCopyableText(),nh(this,VN,!1);let n=this.getRangedData(this.copyableRanges),r=Ac(this,lhe,HZe).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",n,this.copyableRanges,r)){let o=qf(n);if(e&&e.clipboardData){let s=oU(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",o),e.clipboardData.setData("text/html",[ahe,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",o);this.hot.runHooks("afterCopy",n,this.copyableRanges,r)}nh(this,vy,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!La(this,BN)||this.isEditorOpened())return;this.setCopyableText(),nh(this,BN,!1);let n=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",n,this.copyableRanges)){let i=qf(n);if(e&&e.clipboardData){let o=oU(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",i),e.clipboardData.setData("text/html",[ahe,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;e&&e.preventDefault&&e.preventDefault();let n;if(e&&typeof e.clipboardData<"u"){let a=vS(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});a&&/(<table)|(<TABLE)/g.test(a)?n=$oe(a,this.hot.rootDocument).data:n=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(n=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof n=="string"&&(n=bW(n)),n===void 0||n&&n.length===0||this.hot.runHooks("beforePaste",n,this.copyableRanges)===!1)return;let[r,i,o,s]=this.populateValues(n);this.hot.selectCell(r,i,Math.min(this.hot.countRows()-1,o),Math.min(this.hot.countCols()-1,s)),this.hot.runHooks("afterPaste",n,this.copyableRanges)}destroy(){super.destroy()}};function mhe(t){if(Y4()){let e=this.hot.getSelectedRangeLast();if(e){let{row:n,col:r}=e.highlight,i=this.hot.getCell(n,r,!0);i&&soe(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function HZe(t){let{rows:e}=I6(t),n=0;for(let r=0;r<e.length&&!(e[r]>=0);r++)n+=1;return{columnHeadersCount:n}}function VZe(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r&&G4(r)}}}function yhe(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:n}=t.highlight,r=this.hot.getCell(e,n,!0);r!=null&&r.hasAttribute("contenteditable")&&z4(r)}}}function BZe(t){t.items.push({name:"---------"},_6(this)),La(this,M6)&&t.items.push(E6(this)),La(this,O6)&&t.items.push(S6(this)),La(this,N6)&&t.items.push(C6(this)),t.items.push(x6(this))}function UZe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function WZe(){Ac(this,P6,yhe).call(this)}function jZe(){Ac(this,whe,VZe).call(this)}function $Ze(){Ac(this,P6,yhe).call(this)}var zGt=Q(ze(),1),YGt=Q(De(),1);function k6(t,e){return`border_row${t}col${e}`}function yy(){return{width:1,color:"#000"}}function Fu(){return{hide:!0}}function GZe(){return{width:1,color:"#000",cornerVisible:!1}}function UN(t){if(Ze(t.start)||Ze(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Ze(t.end)||Ze(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function _y(t){return Ze(t.start)&&(t.left=t.start),Ze(t.end)&&(t.right=t.end),t}function WN(t,e){return{id:k6(t,e),border:GZe(),row:t,col:e,top:Fu(),bottom:Fu(),start:Fu(),end:Fu()}}function _he(t,e){return Kn(e,"border")&&e.border&&(t.border=e.border),Kn(e,"top")&&Ze(e.top)&&(e.top?(Tt(e.top)||(e.top=yy()),t.top=e.top):(e.top=Fu(),t.top=e.top)),Kn(e,"bottom")&&Ze(e.bottom)&&(e.bottom?(Tt(e.bottom)||(e.bottom=yy()),t.bottom=e.bottom):(e.bottom=Fu(),t.bottom=e.bottom)),Kn(e,"start")&&Ze(e.start)&&(e.start?(Tt(e.start)||(e.start=yy()),t.start=e.start):(e.start=Fu(),t.start=e.start)),Kn(e,"end")&&Ze(e.end)&&(e.end?(Tt(e.end)||(e.end=yy()),t.end=e.end):(e.end=Fu(),t.end=e.end)),t}function ua(t,e){let n=!1;return Z(t.getSelectedRange(),r=>{r.forAll((i,o)=>{if(i<0||o<0)return;let s=t.getCellMeta(i,o).borders;if(s)if(e){if(!Kn(s[e],"hide")||s[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function am(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function Che(t){return t.some(e=>Ze(e.left)||Ze(e.right))}function She(t){return t.some(e=>Ze(e.start)||Ze(e.end))}var zZe=new Map([["left","start"],["right","end"]]);function Ehe(t){var e;return(e=zZe.get(t))!==null&&e!==void 0?e:t}function jN(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(PE);return ua(this,"bottom")&&(e=am(e)),e},callback(e,n){let r=ua(this,"bottom");t.prepareBorder(n,"bottom",r)}}}function $N(t){let e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(kE);return ua(this,e)&&(n=am(n)),n},callback(n,r){let i=ua(this,e);t.prepareBorder(r,e,i)}}}function GN(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(FE)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!ua(this)}}}function zN(t){let e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(NE);return ua(this,e)&&(n=am(n)),n},callback(n,r){let i=ua(this,e);t.prepareBorder(r,e,i)}}}function YN(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(OE);return ua(this,"top")&&(e=am(e)),e},callback(e,n){let r=ua(this,"top");t.prepareBorder(n,"top",r)}}}function xhe(t,e){YZe(t,e),e.add(t)}function YZe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qZe(t,e,n){return e=KZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KZe(t){var e=XZe(t,"string");return typeof e=="symbol"?e:String(e)}function XZe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bhe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var ub="customBorders",Dhe=90,The=new WeakSet,Rhe=new WeakSet,db=class extends Dt{constructor(){super(...arguments),xhe(this,Rhe),xhe(this,The),qZe(this,"savedBorders",[])}static get PLUGIN_KEY(){return ub}static get PLUGIN_PRIORITY(){return Dhe}isEnabled(){return!!this.hot.getSettings()[ub]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>bhe(this,The,ZZe).call(this,e)),this.addHook("init",()=>bhe(this,Rhe,QZe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let r=["top","bottom","start","end"],i=null;n&&(this.checkSettingsCohesion([n]),r=Object.keys(n),i=UN(n));let o=Gd(e),s=zf(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Z(e,a=>{s(a).forAll((l,c)=>{Z(r,u=>{this.prepareBorderFromCustomAdded(l,c,i,Ehe(u))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;let n=Gd(e),r=zf(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return Z(e,o=>{r(o).forAll((s,a)=>{Z(this.savedBorders,l=>{l.row===s&&l.col===a&&i.push(_y(l))})})}),i}clearBorders(e){e?this.setBorders(e):(Z(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);let i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,n,r,i){let o=this.hot.countRows(),s=this.hot.countCols();if(e>=o||n>=s)return;let a=WN(e,n);r&&(a=_he(a,r),Z(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,r),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",_y(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,n){let r=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);st(e.from.row,r,o=>{st(e.from.col,i,s=>{let a=WN(o,s),l=0;o===e.from.row&&Kn(n,"top")&&(l+=1,a.top=n.top),o===e.to.row&&Kn(n,"bottom")&&(l+=1,a.bottom=n.bottom),s===e.from.col&&Kn(n,"start")&&(l+=1,a.start=n.start),s===e.to.col&&Kn(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(o,s,"borders",_y(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){let r=k6(e,n);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,r,i){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=WN(e,n):o=UN(o),i?(o[r]=Fu(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",_y(o)))):(o[r]=yy(),this.checkCustomSelectionsFromContextMenu(o,r,i)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",_y(o)))}prepareBorder(e,n,r){Z(e,i=>{let{start:o,end:s}=i;if(o.row===s.row&&o.col===s.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,r);else switch(n){case"noBorders":st(o.col,s.col,a=>{st(o.row,s.row,l=>{this.removeAllBorders(l,a)})});break;case"top":st(o.col,s.col,a=>{this.setBorder(o.row,a,n,r)});break;case"bottom":st(o.col,s.col,a=>{this.setBorder(s.row,a,n,r)});break;case"start":st(o.row,s.row,a=>{this.setBorder(a,o.col,n,r)});break;case"end":st(o.row,s.row,a=>{this.setBorder(a,s.col,n,r)});break;default:break}})}createCustomBorders(e){Z(e,n=>{let r=UN(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,r):this.prepareBorderFromCustomAdded(n.row,n.col,r)})}countHide(e){let{top:n,bottom:r,start:i,end:o}=e;return or([n,r,i,o],(a,l)=>{let c=a;return l&&l.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){let n=At(this.hot.selection.highlight.customSelections,r=>r.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){Z(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){Z(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){let n=At(this.savedBorders,r=>r.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):Z(this.savedBorders,(i,o)=>{if(e.id===i.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,r){let i=!1;return Z(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){let s=this.hot.view._wt.selectionManager.getBorderInstances(o);return Z(s,a=>{a.toggleHiddenClass(n,r)}),i=!0,!1}}),i}checkCustomSelections(e,n,r){let i=this.countHide(e),o=!1;return i===4?(this.removeAllBorders(e.row,e.col),o=!0):Z(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){if(s.visualCellRange=n,s.commit(),r){let a=this.hot.view._wt.selectionManager.getBorderInstances(s);Z(a,l=>{l.changeBorderStyle(r,e)})}return o=!0,!1}}),o}changeBorderSettings(){let e=this.hot.getSettings()[ub];if(Array.isArray(e)){let n=vi(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){let n=Che(e),r=She(e);if(n&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}};function ZZe(t){this.hot.getSettings()[ub]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(ME)},disabled(){let e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[YN(this),zN(this),jN(this),$N(this),GN(this)]}})}function QZe(){this.changeBorderSettings()}var izt=Q(De(),1);function JZe(t,e){eQe(t,e),e.add(t)}function eQe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function F6(t,e,n){return e=tQe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tQe(t){var e=nQe(t,"string");return typeof e=="symbol"?e:String(e)}function nQe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ihe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var H6="dragToScroll",Mhe=100,L6=new WeakSet,hb=class extends Dt{constructor(){super(...arguments),JZe(this,L6),F6(this,"boundaries",null),F6(this,"callback",null),F6(this,"listening",!1)}static get PLUGIN_KEY(){return H6}static get PLUGIN_PRIORITY(){return Mhe}isEnabled(){return!!this.hot.getSettings()[H6]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>Ihe(this,L6,Ahe).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>Ihe(this,L6,Ahe).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(e){this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let r=0,i=0;n<this.boundaries.top?i=n-this.boundaries.top:n>this.boundaries.bottom&&(i=n-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){let{rootWindow:e}=this.hot,n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",r=>this.onMouseMove(r)),n=$p(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}};function Ahe(t){if(Na(t))return;let e=this.hot.view._wt.wtTable.holder;e!==this.hot.rootWindow&&(this.setBoundaries(e.getBoundingClientRect()),this.setCallback((n,r)=>{n<0?e.scrollLeft-=50:n>0&&(e.scrollLeft+=50),r<0?e.scrollTop-=20:r>0&&(e.scrollTop+=20)}),this.listen())}var dzt=Q(De(),1);function Ng(t,e){rQe(t,e),e.add(t)}function rQe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function V6(t,e,n){return e=iQe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iQe(t){var e=oQe(t,"string");return typeof e=="symbol"?e:String(e)}function oQe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lm(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ot.getSingleton().register("afterDropdownMenuDefaultOptions");ot.getSingleton().register("beforeDropdownMenuShow");ot.getSingleton().register("afterDropdownMenuShow");ot.getSingleton().register("afterDropdownMenuHide");ot.getSingleton().register("afterDropdownMenuExecute");var fb="dropdownMenu",Hhe=230,U6="changeType",B6=fb,W6=new WeakSet,Ohe=new WeakSet,Nhe=new WeakSet,Phe=new WeakSet,khe=new WeakSet,Fhe=new WeakSet,Lhe=new WeakSet,Cy=class t extends Dt{static get PLUGIN_KEY(){return fb}static get PLUGIN_PRIORITY(){return Hhe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[qd,Kd,Bt,Zd,Bt,bg,Bt,Xd,Bt,ms]}constructor(e){super(e),Ng(this,Lhe),Ng(this,Fhe),Ng(this,khe),Ng(this,Phe),Ng(this,Nhe),Ng(this,Ohe),Ng(this,W6),V6(this,"commandExecutor",new cy(this.hot)),V6(this,"itemsFactory",null),V6(this,"menu",null),this.hot.addHook("afterGetColHeader",(n,r)=>lm(this,Nhe,aQe).call(this,n,r))}isEnabled(){return this.hot.getSettings()[fb]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new uy(this.hot,t.DEFAULT_ITEMS);let n=this.hot.getSettings()[fb],r={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);let i=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new eh(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>lm(this,Phe,lQe).call(this)),this.menu.addLocalHook("afterOpen",()=>lm(this,khe,cQe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>lm(this,Fhe,uQe).call(this,o)),this.menu.addLocalHook("afterClose",()=>lm(this,Lhe,dQe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return e.executeCommand.call(e,...s)}),Z(i,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let e=this.hot.getShortcutManager().getContext("grid"),n=()=>{let{highlight:r}=this.hot.getSelectedRangeLast();if((r.isHeader()&&r.row===-1||r.isCell())&&r.col>=0){this.hot.selectColumns(r.col,r.col,-1);let{from:i}=this.hot.getSelectedRangeLast(),o=ay(this.menu.container,this.hot.rootDocument),s=this.hot.getCell(-1,i.col,!0),a=s.getBoundingClientRect();this.open({left:a.left+o.left,top:a.top+s.offsetHeight+o.top},{left:a.width}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var r;let i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:B6},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var r;let i=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:B6}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(B6)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>lm(this,Ohe,sQe).call(this,e))}open(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Rt(r,(i,o)=>{this.menu.setOffset(o,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];this.commandExecutor.execute(e,...r)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}};function Vhe(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function sQe(t){if(t.stopPropagation(),St(t.target,U6)){let e=ay(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+3+e.top},{left:n.width})}}function aQe(t,e){let n=e.parentNode;if(!n)return;let r=n.parentNode.childNodes,i=Array.prototype.indexOf.call(r,n);if(t<0||i!==r.length-1)return;let o=e.querySelector(`.${U6}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}let s=this.hot.rootDocument.createElement("button");s.className=U6,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&(vt(s,[wo(),ew(" ")]),vt(e,[hM("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function lQe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function cQe(){this.hot.runHooks("afterDropdownMenuShow",this),lm(this,W6,Vhe).call(this,this.menu)}function uQe(t){lm(this,W6,Vhe).call(this,t)}function dQe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}Cy.SEPARATOR={name:Bt};var Bzt=Q(De(),1);var Tzt=Q(ze(),1),Rzt=Q(De(),1);function Bhe(t,e,n){return e=hQe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hQe(t){var e=fQe(t,"string");return typeof e=="symbol"?e:String(e)}function fQe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var j6=class{constructor(e){Bhe(this,"hot",void 0),Bhe(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){let{startRow:e,startCol:n,endRow:r,endCol:i}=this._getDataRange(),o=this.options,s=[];return st(e,r,a=>{let l=[];!o.exportHiddenRows&&this._isHiddenRow(a)||(st(n,i,c=>{!o.exportHiddenColumns&&this._isHiddenColumn(c)||l.push(this.hot.getDataAtCell(a,c))}),s.push(l))}),s}getRowHeaders(){let e=[];if(this.options.rowHeaders){let{startRow:n,endRow:r}=this._getDataRange(),i=this.hot.getRowHeader();st(n,r,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(i[o])})}return e}getColumnHeaders(){let e=[];if(this.options.columnHeaders){let{startCol:n,endCol:r}=this._getDataRange(),i=this.hot.getColHeader();st(n,r,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(i[o])})}return e}_getDataRange(){let e=this.hot.countCols()-1,n=this.hot.countRows()-1,[r=0,i=0,o=n,s=e]=this.options.range;return r=Math.max(r,0),i=Math.max(i,0),o=Math.min(o,n),s=Math.min(s,e),{startRow:r,startCol:i,endRow:o,endCol:s}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}},Uhe=j6;var Azt=Q(De(),1);function Whe(t,e,n){return e=mQe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mQe(t){var e=pQe(t,"string");return typeof e=="symbol"?e:String(e)}function pQe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $6=class t{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){Whe(this,"dataProvider",void 0),Whe(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=$r(this.constructor.DEFAULT_OPTIONS),r=new Date;return n=Ln($r(t.DEFAULT_OPTIONS),n),n=Ln(n,e),n.filename=cM(n.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),n}},jhe=$6;var gQe=String.fromCharCode(13),vQe=String.fromCharCode(34),wQe=String.fromCharCode(10),G6=class extends jhe{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){let e=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),i=r.length>0,o=this.dataProvider.getRowHeaders(),s=o.length>0,a=e.bom?String.fromCharCode(65279):"";return i&&(r=At(r,l=>this._escapeCell(l,!0)),s&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),Z(n,(l,c)=>{c>0&&(a+=e.rowDelimiter),s&&(a+=this._escapeCell(o[c])+e.columnDelimiter),a+=l.map(u=>this._escapeCell(u)).join(e.columnDelimiter)}),a}_escapeCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=Qn(e);return r!==""&&(n||r.indexOf(gQe)>=0||r.indexOf(vQe)>=0||r.indexOf(wQe)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}},$he=G6;var yQe="csv";var qN={[yQe]:$he};function z6(t,e,n){return typeof qN[t]=="function"?new qN[t](e,n):null}var Ghe="exportFile",zhe=240,mb=class extends Dt{static get PLUGIN_KEY(){return Ghe}static get PLUGIN_PRIORITY(){return zhe}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{rootDocument:r,rootWindow:i}=this.hot,o=this._createTypeFormatter(e,n),s=this._createBlob(o),a=i.URL||i.webkitURL,l=r.createElement("a"),c=`${o.options.filename}.${o.options.fileExtension}`;if(l.download!==void 0){let u=a.createObjectURL(s);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",c),r.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),r.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(s,c)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!qN[e])throw new Error(`Export format type "${e}" is not supported.`);return z6(e,new Uhe(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}};var sKt=Q(VU(),1),aKt=Q(ze(),1),lKt=Q(De(),1);var hYt=Q(ze(),1),fYt=Q(De(),1);var Yzt=Q(De(),1);function Sy(t,e,n){return e=_Qe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Qe(t){var e=CQe(t,"string");return typeof e=="symbol"?e:String(e)}function CQe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Mc=class{constructor(e,n){let{id:r,stateless:i=!0}=n;Sy(this,"hot",void 0),Sy(this,"id",void 0),Sy(this,"elements",[]),Sy(this,"hidden",!1),Sy(this,"stateId",""),Sy(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ru)}getElements(){return this.elements}reset(){Z(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Z(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}};Jt(Mc,xr);var p7t=Q(ze(),1);var Jzt=Q(De(),1),pb={};function da(t,e){if(!pb[t])throw Error(`Filter condition "${t}" does not exist.`);let{condition:n,descriptor:r}=pb[t],i=e;return r.inputValuesDecorator&&(i=r.inputValuesDecorator(i)),function(o){return n.apply(o.meta.instance,[].concat([o],[i]))}}function Lu(t){if(!pb[t])throw Error(`Filter condition "${t}" does not exist.`);return pb[t].descriptor}function gn(t,e,n){n.key=t,pb[t]={condition:e,descriptor:n}}var yi="none";function SQe(){return!0}gn(yi,SQe,{name:sg,inputsCount:0,showOperators:!1});var Pg="empty";function EQe(t){return Er(t.value)}gn(Pg,EQe,{name:jE,inputsCount:0,showOperators:!0});var gb="not_empty";function xQe(t,e){return!da(Pg,e)(t)}gn(gb,xQe,{name:$E,inputsCount:0,showOperators:!0});var kg="eq";function bQe(t,e){let[n]=e;return Qn(t.value).toLocaleLowerCase(t.meta.locale)===Qn(n)}gn(kg,bQe,{name:GE,inputsCount:1,showOperators:!0});var vb="neq";function TQe(t,e){return!da(kg,e)(t)}gn(vb,TQe,{name:zE,inputsCount:1,showOperators:!0});var Y6="gt";function RQe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>r}gn(Y6,RQe,{name:ZE,inputsCount:1,showOperators:!0});var q6="gte";function DQe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value>=r}gn(q6,DQe,{name:QE,inputsCount:1,showOperators:!0});var K6="lt";function IQe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<r}gn(K6,IQe,{name:JE,inputsCount:1,showOperators:!0});var X6="lte";function AQe(t,e){let[n]=e,r=n;return t.meta.type==="numeric"&&(r=parseFloat(r,10)),t.value<=r}gn(X6,AQe,{name:ex,inputsCount:1,showOperators:!0});var Z6=Q(Ma(),1);var wb="date_after";function MQe(t,e){let[n]=e,r=(0,Z6.default)(t.value,t.meta.dateFormat),i=(0,Z6.default)(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)>=0}gn(wb,MQe,{name:rx,inputsCount:1,showOperators:!0});var Q6=Q(Ma(),1);var yb="date_before";function OQe(t,e){let[n]=e,r=(0,Q6.default)(t.value,t.meta.dateFormat),i=(0,Q6.default)(n,t.meta.dateFormat);return!r.isValid()||!i.isValid()?!1:r.diff(i)<=0}gn(yb,OQe,{name:ix,inputsCount:1,showOperators:!0});var Ey="between";function NQe(t,e){let[n,r]=e,i=n,o=r;if(t.meta.type==="numeric"){let s=parseFloat(i,10),a=parseFloat(o,10);i=Math.min(s,a),o=Math.max(s,a)}else if(t.meta.type==="date"){let s=da(yb,[o]),a=da(wb,[i]);return s(t)&&a(t)}return t.value>=i&&t.value<=o}gn(Ey,NQe,{name:tx,inputsCount:2,showOperators:!0});var J6="not_between";function PQe(t,e){return!da(Ey,e)(t)}gn(J6,PQe,{name:nx,inputsCount:2,showOperators:!0});var e5="begins_with";function kQe(t,e){let[n]=e;return Qn(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Qn(n))}gn(e5,kQe,{name:YE,inputsCount:1,showOperators:!0});var t5="ends_with";function FQe(t,e){let[n]=e;return Qn(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Qn(n))}gn(t5,FQe,{name:qE,inputsCount:1,showOperators:!0});var _b="contains";function LQe(t,e){let[n]=e;return Qn(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Qn(n))>=0}gn(_b,LQe,{name:KE,inputsCount:1,showOperators:!0});var n5="not_contains";function HQe(t,e){return!da(_b,e)(t)}gn(n5,HQe,{name:XE,inputsCount:1,showOperators:!0});var r5=Q(Ma(),1);var i5="date_tomorrow";function VQe(t){let e=(0,r5.default)(t.value,t.meta.dateFormat);return e.isValid()?e.isSame((0,r5.default)().subtract(-1,"days").startOf("day"),"d"):!1}gn(i5,VQe,{name:sx,inputsCount:0});var o5=Q(Ma(),1);var s5="date_today";function BQe(t){let e=(0,o5.default)(t.value,t.meta.dateFormat);return e.isValid()?e.isSame((0,o5.default)().startOf("day"),"d"):!1}gn(s5,BQe,{name:ox,inputsCount:0});var a5=Q(Ma(),1);var l5="date_yesterday";function UQe(t){let e=(0,a5.default)(t.value,t.meta.dateFormat);return e.isValid()?e.isSame((0,a5.default)().subtract(1,"days").startOf("day"),"d"):!1}gn(l5,UQe,{name:ax,inputsCount:0});var Q9t=Q(ze(),1);var t7t=_se();function WQe(t,e){let n=t;return n===""&&(n=`(${e})`),n}var c5=new Set([1]).has(1),jQe=c5&&typeof Array.from=="function";function rh(t){let e=t;return c5&&(e=new Set(e)),function(n){let r;return c5?r=e.has(n):r=!!~e.indexOf(n),r}}function KN(t){return t??""}function Cb(t){let e=t;return jQe?e=Array.from(new Set(e)):e=oM(e),e=e.sort((n,r)=>typeof n=="number"&&typeof r=="number"?n-r:n===r?0:n>r?1:-1),e}function u5(t,e,n,r){let i=[],o=t===e,s;return o||(s=rh(e)),Z(t,a=>{let l=!1;(o||s(a))&&(l=!0);let c={checked:l,value:a,visualValue:WQe(a,n)};r&&r(c),i.push(c)}),i}var Hu="by_value";function $Qe(t,e){let[n]=e;return n(t.value)}gn(Hu,$Qe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[rh(e)]},showOperators:!1});var s7t=Q(De(),1),xy={};function Yhe(t){if(!xy[t])throw Error(`Operation with id "${t}" does not exist.`);let e=xy[t].func;return function(n,r){return e(n,r)}}function qhe(t){return xy[t].name}function by(t,e,n){xy[t]={name:e,func:n}}var Ml="conjunction",GQe=ux;function zQe(t,e){return t.every(n=>n.func(e))}by(Ml,GQe,zQe);var Fg="disjunction",YQe=ag;function qQe(t,e){return t.some(n=>n.func(e))}by(Fg,YQe,qQe);var h7t=Q(De(),1);var Ty="disjunctionWithExtraCondition",KQe=ag;function XQe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}by(Ty,KQe,XQe);var ZQe="numeric",Xhe="text",QQe="date",Khe={[ZQe]:[yi,Bt,Pg,gb,Bt,kg,vb,Bt,Y6,q6,K6,X6,Ey,J6],[Xhe]:[yi,Bt,Pg,gb,Bt,kg,vb,Bt,e5,t5,Bt,_b,n5],[QQe]:[yi,Bt,Pg,gb,Bt,kg,vb,Bt,yb,wb,Ey,Bt,i5,s5,l5]};function d5(t){let e=[],n=t;return Khe[n]||(n=Xhe),Z(Khe[n],r=>{let i;r===Bt?i={name:Bt}:i=$r(Lu(r)),e.push(i)}),e}var Q7t=Q(De(),1);var G7t=Q(De(),1);function Sb(t,e,n){return e=JQe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JQe(t){var e=eJe(t,"string");return typeof e=="symbol"?e:String(e)}function eJe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var h5="built",f5="building",Zhe=["click","input","keydown","keypress","keyup","focus","blur","change"],to=class t{static get DEFAULTS(){return $r({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){Sb(this,"hot",void 0),Sb(this,"eventManager",new ei(this)),Sb(this,"options",void 0),Sb(this,"_element",void 0),Sb(this,"buildState",void 0),this.hot=e,this.options=Ln(t.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===f5?this._element:this.buildState===h5?(this.update(),this._element):(this.buildState=f5,this.build(),this.buildState=h5,this._element)}isBuilt(){return this.buildState===h5}translateIfPossible(e){return typeof e=="string"&&e.startsWith(hs)?this.hot.getTranslatedPhrase(e):e}build(){let e=(n,r)=>{this.eventManager.addEventListener(n,r,i=>this.runLocalHooks(r,i,this))};if(this.buildState||(this.buildState=f5),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&Ne(this._element,this.options.className),this.options.children.length)Z(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){let n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Rt(this.options,(r,i)=>{n[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(n[i]=this.translateIfPossible(r))}),this._element.appendChild(n),Z(Zhe,r=>e(n,r))}else Z(Zhe,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Jt(to,xr);function tJe(t,e){Jhe(t,e),e.add(t)}function nJe(t,e,n){Jhe(t,e),e.set(t,n)}function Jhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XN(t,e){var n=efe(t,e,"get");return rJe(t,n)}function rJe(t,e){return e.get?e.get.call(t):e.value}function iJe(t,e,n){var r=efe(t,e,"set");return oJe(t,r,n),n}function efe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function oJe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function sJe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Ry=new WeakMap,Qhe=new WeakSet,Oc=class t extends to{static get DEFAULTS(){return $r({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Ln(t.DEFAULTS,n)),tJe(this,Qhe),nJe(this,Ry,{writable:!0,value:void 0}),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>sJe(this,Qhe,aJe).call(this,e))}build(){super.build();let e=this.hot.rootDocument.createElement("div");iJe(this,Ry,this._element.firstChild),Ne(this._element,"htUIInput"),Ne(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(XN(this,Ry).type=this.options.type,XN(this,Ry).placeholder=this.translateIfPossible(this.options.placeholder),XN(this,Ry).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&XN(this,Ry).focus()}};function aJe(t){this.options.value=t.target.value}var rYt=Q(De(),1);function m5(t,e){ife(t,e),e.add(t)}function Eb(t,e,n){ife(t,e),e.set(t,n)}function ife(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dy(t,e,n){var r=ofe(t,e,"set");return lJe(t,r,n),n}function lJe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function p5(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ri(t,e){var n=ofe(t,e,"get");return cJe(t,n)}function ofe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function cJe(t,e){return e.get?e.get.call(t):e.value}var no=new WeakMap,ZN=new WeakMap,QN=new WeakMap,g5=new WeakMap,JN=new WeakMap,tfe=new WeakSet,nfe=new WeakSet,rfe=new WeakSet,Lg=class t extends to{static get DEFAULTS(){return $r({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Ln(t.DEFAULTS,n)),m5(this,rfe),m5(this,nfe),m5(this,tfe),Eb(this,no,{writable:!0,value:null}),Eb(this,ZN,{writable:!0,value:[]}),Eb(this,QN,{writable:!0,value:void 0}),Eb(this,g5,{writable:!0,value:void 0}),Eb(this,JN,{writable:!0,value:void 0}),this.registerHooks()}getMenu(){return ri(this,no)}registerHooks(){this.addLocalHook("click",()=>p5(this,rfe,hJe).call(this))}setItems(e){Dy(this,ZN,this.translateNames(e)),ri(this,no)&&ri(this,no).setMenuItems(ri(this,ZN))}translateNames(e){return Z(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Dy(this,no,new eh(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),ri(this,no).setMenuItems(ri(this,ZN));let e=new to(this.hot,{className:"htUISelectCaption"}),n=new to(this.hot,{className:"htUISelectDropdown"});Dy(this,QN,e),Dy(this,g5,e.element),Dy(this,JN,n),this.hot.getSettings().ariaTags&&(vt(n.element,[wo()]),vt(this._element,[dM()])),Z([e,n],r=>this._element.appendChild(r.element)),ri(this,no).addLocalHook("select",r=>p5(this,tfe,uJe).call(this,r)),ri(this,no).addLocalHook("afterClose",()=>p5(this,nfe,dJe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=ri(this,no).hot.getTranslatedPhrase(sg),ri(this,g5).textContent=e,super.update()}openOptions(){let e=this.element.getBoundingClientRect();ri(this,no)&&(ri(this,no).open(),ri(this,no).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),ri(this,no).getNavigator().toFirstItem(),ri(this,no).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){ri(this,no)&&ri(this,no).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){ri(this,no)&&(ri(this,no).destroy(),Dy(this,no,null)),ri(this,QN)&&ri(this,QN).destroy(),ri(this,JN)&&ri(this,JN).destroy(),super.destroy()}};function uJe(t){t.name!==Bt&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function dJe(){this.runLocalHooks("afterClose")}function hJe(){this.openOptions()}function sfe(t,e){fJe(t,e),e.add(t)}function fJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function afe(t,e,n){return e=mJe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mJe(t){var e=pJe(t,"string");return typeof e=="symbol"?e:String(e)}function pJe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lfe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var cfe=new WeakSet,ufe=new WeakSet,Iy=class extends Mc{constructor(e,n){super(e,{id:n.id,stateless:!1}),sfe(this,ufe),sfe(this,cfe),afe(this,"name",""),afe(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Lg(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new Oc(this.hot,{placeholder:gx})),this.elements.push(new Oc(this.hot,{placeholder:vx})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>lfe(this,cfe,gJe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),Z(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>lfe(this,ufe,vJe).call(this,n))})}setState(e){if(this.reset(),!e)return;let n=$r(e.command);n.name.startsWith(Gr)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),Z(e.args,(r,i)=>{if(i>n.inputsCount-1)return!1;let o=this.getInputElement(i);o.setValue(r),o[n.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){let e=this.getSelectElement().getValue()||Lu(yi),n=[];return Z(this.getInputElements(),(r,i)=>{e.inputsCount>i&&n.push(r.getValue())}),{command:e,args:n}}updateState(e,n){let r=e?Lu(e.name):Lu(yi);this.state.setValueAtIndex(n,{command:r,args:e?e.args:[]}),e||Z(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Lg)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof Oc)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Ne(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&Ne(n.parentNode,"border");let a=this.hot.rootDocument.createElement("div");return Ne(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),Z(this.elements,l=>n.appendChild(l.element)),n}}}reset(){let e=this.hot.getPlugin("filters").getSelectedColumn(),n=[Lu(yi)];if(e!==null){let{visualIndex:r}=e;n=d5(this.hot.getDataType(0,r,this.hot.countRows(),r))}Z(this.getInputElements(),r=>r.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}};function gJe(t){Z(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function vJe(t){yu(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wi(t))}var IYt=Q(ze(),1),AYt=Q(De(),1);var bYt=Q(De(),1);function dfe(t,e,n){wJe(t,e),e.set(t,n)}function wJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xb(t,e){var n=ffe(t,e,"get");return yJe(t,n)}function yJe(t,e){return e.get?e.get.call(t):e.value}function hfe(t,e,n){var r=ffe(t,e,"set");return _Je(t,r,n),n}function ffe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function _Je(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Ay=new WeakMap,v5=new WeakMap,bb=class t extends to{static get DEFAULTS(){return $r({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Ln(t.DEFAULTS,n)),dfe(this,Ay,{writable:!0,value:void 0}),dfe(this,v5,{writable:!0,value:void 0})}build(){super.build();let e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),hfe(this,v5,e),hfe(this,Ay,this._element.firstChild),xb(this,Ay).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(xb(this,v5).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return xb(this,Ay).checked}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(xb(this,Ay).checked=e)}focus(){this.isBuilt()&&xb(this,Ay).focus()}};function CJe(t,e){SJe(t,e),e.add(t)}function SJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EJe(t,e,n){return e=xJe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xJe(t){var e=bJe(t,"string");return typeof e=="symbol"?e:String(e)}function bJe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function TJe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var mfe=0,pfe=new WeakSet,eP=class extends Mc{constructor(e,n){super(e,{id:n.id,stateless:!1}),CJe(this,pfe),EJe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Ne(n.parentNode,"htFiltersMenuOperators"),Z(this.elements,r=>n.appendChild(r.element)),n)}}buildOperatorsElement(){let e=[Ml,Fg];Z(e,n=>{let r=new bb(this.hot,{name:"operator",label:{htmlFor:n,textContent:qhe(n)},value:n,checked:n===e[mfe],id:n});r.addLocalHook("change",i=>TJe(this,pfe,RJe).call(this,i)),this.elements.push(r)})}setChecked(e){if(this.elements.length<e)throw Error(Qt`Radio button with index ${e} doesn't exist.`);Z(this.elements,(n,r)=>{n.setChecked(r===e)})}getActiveOperationId(){let e=this.elements.find(n=>n instanceof bb&&n.isChecked());return e?e.getValue():Ml}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Z(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ml,n=arguments.length>1?arguments[1]:void 0,r=e;r===Ty&&(r=Fg),this.state.setValueAtIndex(n,r)}reset(){this.setChecked(mfe)}};function RJe(t){this.setState(t.target.value)}var oqt=Q(ze(),1),sqt=Q(De(),1);var GYt=Q(ze(),1),zYt=Q(De(),1);var UYt=Q(De(),1);function DJe(t,e,n){IJe(t,e),e.set(t,n)}function IJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function w5(t,e){var n=gfe(t,e,"get");return AJe(t,n)}function AJe(t,e){return e.get?e.get.call(t):e.value}function MJe(t,e,n){var r=gfe(t,e,"set");return OJe(t,r,n),n}function gfe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function OJe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Tb=new WeakMap,Hg=class t extends to{static get DEFAULTS(){return $r({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Ln(t.DEFAULTS,n)),DJe(this,Tb,{writable:!0,value:void 0})}build(){super.build(),MJe(this,Tb,this._element.firstChild)}update(){this.isBuilt()&&(w5(this,Tb).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&w5(this,Tb).focus()}activate(){w5(this,Tb).click()}};function tP(t,e){Sfe(t,e),e.add(t)}function My(t,e,n){Sfe(t,e),e.set(t,n)}function Sfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nP(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function on(t,e){var n=Efe(t,e,"get");return NJe(t,n)}function NJe(t,e){return e.get?e.get.call(t):e.value}function Nc(t,e,n){var r=Efe(t,e,"set");return PJe(t,r,n),n}function Efe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function PJe(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var vfe="multipleSelect.itemBox",Pc=new WeakMap,zr=new WeakMap,y5=new WeakMap,ih=new WeakMap,cm=new WeakMap,um=new WeakMap,wfe=new WeakSet,yfe=new WeakSet,_fe=new WeakSet,Cfe=new WeakSet,Vg=class t extends to{static get DEFAULTS(){return $r({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Ln(t.DEFAULTS,n)),tP(this,Cfe),tP(this,_fe),tP(this,yfe),tP(this,wfe),My(this,Pc,{writable:!0,value:[]}),My(this,zr,{writable:!0,value:void 0}),My(this,y5,{writable:!0,value:void 0}),My(this,ih,{writable:!0,value:void 0}),My(this,cm,{writable:!0,value:void 0}),My(this,um,{writable:!0,value:void 0}),Nc(this,ih,new Oc(this.hot,{placeholder:px,className:"htUIMultipleSelectSearch"})),Nc(this,cm,new Hg(this.hot,{textContent:dx,className:"htUISelectAll"})),Nc(this,um,new Hg(this.hot,{textContent:hx,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return on(this,zr)}registerHooks(){on(this,ih).addLocalHook("keydown",e=>nP(this,yfe,FJe).call(this,e)),on(this,ih).addLocalHook("input",e=>nP(this,wfe,kJe).call(this,e)),on(this,cm).addLocalHook("click",e=>nP(this,_fe,LJe).call(this,e)),on(this,um).addLocalHook("click",e=>nP(this,Cfe,HJe).call(this,e))}setItems(e){Nc(this,Pc,e),on(this,zr)&&on(this,zr).loadData(on(this,Pc))}setLocale(e){Nc(this,y5,e)}getLocale(){return on(this,y5)}getItems(){return[...on(this,Pc)]}getValue(){return BJe(on(this,Pc))}getSearchInputElement(){return on(this,ih)}getSelectAllElement(){return on(this,cm)}getClearAllElement(){return on(this,um)}isSelectedAllValues(){return on(this,Pc).length===this.getValue().length}build(){super.build();let{rootDocument:e}=this.hot,n=e.createElement("div"),r=new to(this.hot,{className:"htUISelectionControls",children:[on(this,cm),on(this,um)]});this._element.appendChild(on(this,ih).element),this._element.appendChild(r.element),this._element.appendChild(n);let i=o=>{if(!this._element)return;on(this,zr)&&on(this,zr).destroy(),Ne(o,"htUIMultipleSelectHot"),Nc(this,zr,new this.hot.constructor(o,{data:on(this,Pc),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(l,c,u,d,h,f)=>{l.title=f.instance.getDataAtRowProp(c,f.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{on(this,zr).listen()},maxCols:1,autoWrapCol:!0,height:110,colWidths:()=>on(this,zr).container.scrollWidth-dr(e),copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),on(this,zr).init();let a=on(this,zr).getShortcutManager().getContext("grid");a.removeShortcutsByKeys(["Tab"]),a.removeShortcutsByKeys(["Shift","Tab"]),a.addShortcut({keys:[["Escape"]],callback:l=>{this.runLocalHooks("keydown",l,this)},group:vfe}),a.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:l=>{on(this,zr).deselectCell(),this.runLocalHooks("keydown",l,this),this.runLocalHooks("listTabKeydown",l,this)},group:vfe})};i(n),this.hot._registerTimeout(()=>i(n),100)}focus(){this.isBuilt()&&on(this,zr).listen()}reset(){on(this,ih).reset(),on(this,cm).reset(),on(this,um).reset()}update(){this.isBuilt()&&(on(this,zr).loadData(VJe(on(this,Pc),this.options.value)),super.update())}destroy(){on(this,zr)&&on(this,zr).destroy(),on(this,ih).destroy(),on(this,um).destroy(),on(this,cm).destroy(),Nc(this,ih,null),Nc(this,um,null),Nc(this,cm,null),Nc(this,zr,null),Nc(this,Pc,null),super.destroy()}};function kJe(t){let e=t.target.value.toLocaleLowerCase(this.getLocale()),n;e===""?n=[...on(this,Pc)]:n=gi(on(this,Pc),r=>`${r.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),on(this,zr).loadData(n)}function FJe(t){this.runLocalHooks("keydown",t,this),yM(yu,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),wi(t),on(this,zr).listen(),on(this,zr).selectCell(0,0))}function LJe(t){let e=[];t.preventDefault(),Z(on(this,zr).getSourceData(),(n,r)=>{n.checked=!0,e.push(tW(n,r)[0])}),on(this,zr).setSourceDataAtCell(e)}function HJe(t){let e=[];t.preventDefault(),Z(on(this,zr).getSourceData(),(n,r)=>{n.checked=!1,e.push(tW(n,r)[0])}),on(this,zr).setSourceDataAtCell(e)}function VJe(t,e){let n=rh(e);return At(t,r=>(r.checked=n(r.value),r))}function BJe(t){let e=[];return Z(t,n=>{n.checked&&e.push(n.value)}),e}function UJe(t,e){WJe(t,e),e.add(t)}function WJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jJe(t,e,n){return e=$Je(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Je(t){var e=GJe(t,"string");return typeof e=="symbol"?e:String(e)}function GJe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zJe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var xfe=new WeakSet,rP=class extends Mc{constructor(e,n){super(e,{id:n.id,stateless:!1}),UJe(this,xfe),jJe(this,"name",""),this.name=n.name,this.elements.push(new Vg(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>zJe(this,xfe,YJe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e))}getElements(){let e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===Hu){let n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){let e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?yi:Hu},args:[e.getValue()],itemsSnapshot:n}}updateState(e){let n=(r,i,o,s,a)=>{let[l]=gi(i,d=>d.name===Hu),c={},u=this.hot.getTranslatedPhrase(Ow);if(l){let d=Cb(At(s(r,a),g=>g.value));o&&(l.args[0]=o);let h=[],f=u5(d,l.args[0],u,g=>{g.checked&&h.push(g.value)}),p=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,p).locale,c.args=[h],c.command=Lu(Hu),c.itemsSnapshot=f}else c.args=[],c.command=Lu(yi);this.state.setValueAtIndex(r,c)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Vg)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,r,i,o,s)=>{Ne(n.parentNode,"htFiltersMenuValue");let a=this.hot.rootDocument.createElement("div");return Ne(a,"htFiltersMenuLabel"),a.textContent=s,n.appendChild(a),Z(this.elements,l=>n.appendChild(l.element)),n}}}reset(){let e=this.hot.getTranslatedPhrase(Ow),n=Cb(this._getColumnVisibleValues()),r=u5(n,n,e);this.getMultipleSelectElement().setItems(r),super.reset(),this.getMultipleSelectElement().setValue(n);let i=this.hot.getPlugin("filters").getSelectedColumn();i!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,i.visualIndex).locale)}_getColumnVisibleValues(){let e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:At(this.hot.getDataAtCol(e.visualIndex),n=>KN(n))}};function YJe(t){yu(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),wi(t))}var vqt=Q(De(),1),wqt=Q(ze(),1);var Tfe;function qJe(t,e){KJe(t,e),e.add(t)}function KJe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XJe(t,e,n){return e=ZJe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZJe(t){var e=QJe(t,"string");return typeof e=="symbol"?e:String(e)}function QJe(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JJe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var bfe=new WeakSet,Rb=class t extends Mc{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),qJe(this,bfe),XJe(this,"name",""),this.name=n.name,this.elements.push(new Oc(this.hot,{type:"button",value:fx,className:"htUIButton htUIButtonOK",identifier:t.BUTTON_OK})),this.elements.push(new Oc(this.hot,{type:"button",value:mx,className:"htUIButton htUIButtonCancel",identifier:t.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Z(this.elements,e=>{e.addLocalHook("click",(n,r)=>JJe(this,bfe,eet).call(this,n,r))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(Ne(n.parentNode,"htFiltersMenuActionBar"),Z(this.elements,r=>n.appendChild(r.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}};Tfe=Rb;function eet(t,e){e.options.identifier===Tfe.BUTTON_OK?this.accept():this.cancel()}var xqt=Q(De(),1),bqt=Q(ze(),1);function _5(t,e,n){return e=tet(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tet(t){var e=net(t,"string");return typeof e=="symbol"?e:String(e)}function net(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Rfe="ConditionCollection.filteringStates",iP=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_5(this,"hot",void 0),_5(this,"isMapRegistrable",void 0),_5(this,"filteringStates",new Ru),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(Rfe,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var r;let i=this.filteringStates.getValueAtIndex(n),o=(r=i?.conditions)!==null&&r!==void 0?r:[],s=i?.operation;return this.isMatchInConditions(o,e,s)}isMatchInConditions(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ml;return e.length?Yhe(r)(e,n):!0}addCondition(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ml,i=arguments.length>3?arguments[3]:void 0,o=this.hot.getCellMeta(0,e).locale,s=At(n.args,u=>typeof u=="string"?u.toLocaleLowerCase(o):u),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);let l=this.getOperation(e);if(l){if(l!==r)throw Error(Qt`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(mn(xy[r]))throw new Error(Qt`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:s,func:da(a,s)}]},i):c.push({name:a,args:s,func:da(a,s)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,r;return(n=(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return or(this.filteringStates.getEntries(),(e,n)=>{let[r,{operation:i,conditions:o}]=n;return e.push({column:r,operation:i,conditions:At(o,s=>{let{name:a,args:l}=s;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),Z(e,n=>{Z(n.conditions,r=>this.addCondition(n.column,r))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){let r=this.getConditions(e);return n?r.some(i=>i.name===n):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(Rfe),this.filteringStates=null,this.clearLocalHooks()}};Jt(iP,xr);var oP=iP;var Fqt=Q(ze(),1),Lqt=Q(De(),1);function Dfe(t,e,n){return e=ret(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ret(t){var e=iet(t,"string");return typeof e=="symbol"?e:String(e)}function iet(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var C5=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];Dfe(this,"conditionCollection",void 0),Dfe(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return Z(this.conditionCollection.getFilteredColumns(),(n,r)=>{let i=this.columnDataFactory(n);r&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(n,i)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=[];return Z(n,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&r.push(i)}),r}_getIntersectData(e,n){let r=[];return Z(n,i=>{let o=i.meta.visualRow;e[o]!==void 0&&(r[o]=e[o])}),r}},sP=C5;var Bqt=Q(ze(),1),Uqt=Q(De(),1);function S5(t,e){oet(t,e),e.add(t)}function oet(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bg(t,e,n){return e=set(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function set(t){var e=aet(t,"string");return typeof e=="symbol"?e:String(e)}function aet(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function E5(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Ife=new WeakSet,Afe=new WeakSet,Mfe=new WeakSet,aP=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];S5(this,Mfe),S5(this,Afe),S5(this,Ife),Bg(this,"hot",void 0),Bg(this,"conditionCollection",void 0),Bg(this,"columnDataFactory",void 0),Bg(this,"changes",[]),Bg(this,"grouping",!1),Bg(this,"latestEditedColumnPosition",-1),Bg(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",i=>E5(this,Ife,cet).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>E5(this,Afe,uet).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>E5(this,Mfe,det).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Z(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var r=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}let i=this.conditionCollection.exportAllConditions(),o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);let s=i.slice(0,o),a=i.slice(o);a.length&&a[0].column===e&&a.shift();let l=aoe(function(u,d){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],f=new oP(r.hot,!1),p=[].concat(u,h);f.importAllConditions(p);let g=r.columnDataFactory(d),w;f.isEmpty()?w=g:w=new sP(f,S=>r.columnDataFactory(S)).filter(),w=At(w,S=>S.meta.visualRow);let _=rh(w);return f.destroy(),gi(g,S=>_(S.meta.visualRow))})(s),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Rt(this,(e,n)=>{this[n]=null})}};function cet(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function uet(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function det(){Z(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Jt(aP,xr);var Ofe=aP;function Nfe(t){return AN({initialPage:0,size:()=>t.length,onItemSelect:(n,r)=>{let i=t[n];if(i instanceof Vg)return r;if(i.element&&!pl(i.element))return!1;i.focus()}})}var Db="filters";function Pfe(t,e){let n=-1,r=Nfe(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Db),r.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof to&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||r.clear()});function o(l){let c=t.getKeyboardShortcutsCtrl(),u=l.getKeyboardShortcutsCtrl();r.clear(),u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:c.getContext(Db),callback:()=>{l.isSubMenu()&&l.close(),c.listen(Db)}}]),!l.isSubMenu()&&c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:d=>{let h=t.getNavigator();h.getCurrentPage()>-1&&(n=h.getCurrentPage()),h.clear(),d.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:d=>{let h=e[r.getCurrentPage()];h instanceof Lg&&(h.openOptions(),d.preventDefault()),h instanceof Hg&&(h.activate(),d.preventDefault()),h instanceof to||d.preventDefault()}}],Db)}t.addLocalHook("afterSubmenuOpen",o),t.addLocalHook("afterOpen",o);function s(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Db)}function a(){return n}return ft(Ee({},r),{listen:s,getLastMenuPage:a})}function oh(t,e){Gfe(t,e),e.add(t)}function het(t,e,n){Gfe(t,e),e.set(t,n)}function Gfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ib(t,e,n){return e=fet(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fet(t){var e=met(t,"string");return typeof e=="symbol"?e:String(e)}function met(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pet(t,e,n){var r=zfe(t,e,"set");return get(t,r,n),n}function get(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ab(t,e){var n=zfe(t,e,"get");return vet(t,n)}function zfe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vet(t,e){return e.get?e.get.call(t):e.value}function kc(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var lP="filters",Yfe=250,kfe=lP,Ug=new WeakMap,Ffe=new WeakSet,Lfe=new WeakSet,Hfe=new WeakSet,Vfe=new WeakSet,x5=new WeakSet,Bfe=new WeakSet,b5=new WeakSet,Ufe=new WeakSet,Wfe=new WeakSet,Mb=class extends Dt{static get PLUGIN_KEY(){return lP}static get PLUGIN_PRIORITY(){return Yfe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),oh(this,Wfe),oh(this,Ufe),oh(this,b5),oh(this,Bfe),oh(this,x5),oh(this,Vfe),oh(this,Hfe),oh(this,Lfe),oh(this,Ffe),Ib(this,"dropdownMenuPlugin",null),Ib(this,"conditionCollection",null),Ib(this,"conditionUpdateObserver",null),Ib(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Ib(this,"filtersRowsMap",null),het(this,Ug,{writable:!0,value:void 0}),this.hot.addHook("afterGetColHeader",(n,r)=>kc(this,Ufe,xet).call(this,n,r))}isEnabled(){return!!this.hot.getSettings()[lP]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Rl),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let e=this.hot.getSettings().dropdownMenu,n=e&&e.uiContainer||this.hot.rootDocument.body,r=s=>(s.addLocalHook("accept",()=>kc(this,x5,jfe).call(this,"accept")),s.addLocalHook("cancel",()=>kc(this,x5,jfe).call(this,"cancel")),s.addLocalHook("change",a=>kc(this,Bfe,Eet).call(this,s,a)),s),i=()=>`${this.hot.getTranslatedPhrase(lx)}:`,o=()=>`${this.hot.getTranslatedPhrase(cx)}:`;if(!this.components.get("filter_by_condition")){let s=new Iy(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:n});s.addLocalHook("afterClose",()=>kc(this,b5,$fe).call(this)),this.components.set("filter_by_condition",r(s))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new eP(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let s=new Iy(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:n});s.addLocalHook("afterClose",()=>kc(this,b5,$fe).call(this)),this.components.set("filter_by_condition2",r(s))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new rP(this.hot,{id:"filter_by_value",name:o}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Rb(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new oP(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new Ofe(this.hot,this.conditionCollection,s=>this.getDataMapAtColumn(s)),this.conditionUpdateObserver.addLocalHook("update",s=>kc(this,Wfe,bet).call(this,s))),this.components.forEach(s=>s.show()),this.addHook("afterDropdownMenuDefaultOptions",s=>kc(this,Vfe,Cet).call(this,s)),this.addHook("afterDropdownMenuShow",()=>kc(this,Lfe,yet).call(this)),this.addHook("afterDropdownMenuHide",()=>kc(this,Hfe,_et).call(this)),this.addHook("afterChange",s=>kc(this,Ffe,wet).call(this,s)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Ab(this,Ug)&&this.dropdownMenuPlugin.enabled){let s=this.dropdownMenuPlugin.menu,a=[{focus:()=>{let c=s.getNavigator(),u=Ab(this,Ug).getLastMenuPage();s.focus(),u>0?c.setCurrentPage(u):c.toFirstItem()}},...Array.from(this.components).map(c=>{let[,u]=c;return u.getElements()}).flat()];pet(this,Ug,Pfe(s,a));let l=c=>{Ab(this,Ug).listen(),c.preventDefault(),yu(c.keyCode,"TAB")&&(c.shiftKey?Ab(this,Ug).toPreviousItem():Ab(this,Ug).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,r)=>{n.destroy(),this.components.set(r,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:kfe})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(kfe)}addCondition(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Ml,o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:r},i)}removeConditions(e){let n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{let n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}filter(){let{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),r=!this.conditionCollection.isEmpty(),i=[],o=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",o)!==!1)if(r){let a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=At(n.filter(),c=>c.meta.visualRow);let l=rh(i);st(this.hot.countSourceRows()-1,c=>{l(c)||a.push(c)}),Z(a,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(!0),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;let n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){let n=this.hot.toVisualColumn(e),r=[];return Z(this.hot.getSourceDataAtCol(n),(i,o)=>{var s;let{row:a,col:l,visualCol:c,visualRow:u,type:d,instance:h,dateFormat:f,locale:p}=this.hot.getCellMeta(o,n),g=(s=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&s!==void 0?s:i;r.push({meta:{row:a,col:l,visualCol:c,visualRow:u,type:d,instance:h,dateFormat:f,locale:p},value:KN(g)})}),r}updateValueComponentCondition(e){let n=this.hot.getDataAtCol(e),r=Cb(n);this.conditionUpdateObserver.updateStatesAtColumn(e,r)}restoreComponents(e){var n;let r=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(r)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,r,i){let o=e;return o===Fg&&n.command.key!==yi&&r.command.key!==yi&&i.command.key!==yi?o=Ty:i.command.key!==yi&&(n.command.key===yi||r.command.key===yi)&&(o=Ml),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let e=this.components.get("filter_by_condition"),{command:n}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new sP(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){let e=[];if(!this.dropdownMenuPlugin)return e;let n=this.dropdownMenuPlugin.menu;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Z(i,s=>{Z(n.menuItems,(a,l)=>{a.key===s.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;let r=this.dropdownMenuPlugin.menu.hotMenu,i=r.getPlugin("hiddenRows");for(var o=arguments.length,s=new Array(o>1?o-1:0),a=1;a<o;a++)s[a-1]=arguments[a];let l=this.getIndexesOfComponents(...s);e?i.showRows(l):i.hideRows(l),r.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}};function wet(t){t&&Z(t,e=>{let[,n]=e,r=this.hot.propToCol(n);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)})}function yet(){this.restoreComponents(Array.from(this.components.values()))}function _et(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function Cet(t){t.items.push({name:Bt}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function jfe(t){var e;if(t==="accept"){let r=this.getSelectedColumn();if(r===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}let{physicalIndex:i}=r,o=this.components.get("filter_by_condition").getState(),s=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,s,a);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(i);c===-1&&(c=void 0),this.conditionCollection.removeConditions(i),o.command.key!==yi&&(this.conditionCollection.addCondition(i,o,l,c),s.command.key!==yi&&this.conditionCollection.addCondition(i,s,l,c)),a.command.key!==yi&&this.conditionCollection.addCondition(i,a,l,c),this.conditionUpdateObserver.flush(),this.components.forEach(u=>u.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function Eet(t,e){this.updateDependentComponentsVisibility(),t.constructor===Iy&&!e.inputsCount&&this.setListeningDropdownMenu()}function $fe(){this.setListeningDropdownMenu()}function xet(t,e){let n=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(n)?Ne(e,"htFiltersActive"):bt(e,"htFiltersActive")}function bet(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;let{editedConditionStack:{conditions:n,column:r}}=t,i=n.filter(s=>s.name===Hu),o=n.filter(s=>s.name!==Hu);if(i.length>=2||o.length>=3)Sn(Qt`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let s=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(o[0],r),this.components.get("filter_by_condition2").updateState(o[1],r),this.components.get("filter_operators").updateState(s,r),this.components.get("filter_by_value").updateState(t)}}var ZKt=Q(CM(),1),QKt=Q(ze(),1),JKt=Q(De(),1);var PKt=Q(ze(),1);var T5="internal-use-in-handsontable",cP={licenseKey:T5,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function qfe(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[ro])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function Kfe(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function Xfe(t){var e;let n=t[ro],r=Kfe(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=qfe(t);return Ee(Ee(Ee({},cP),r),i)}function Zfe(t){var e;let n=t[ro],r=Kfe(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),i=qfe(t);return Ee(Ee({},r),i)}function Qfe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function uP(){let t="engine_relationship",e=Ri(ro);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function R5(){let t="shared_engine_usage",e=Ri(ro);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Jfe(t){let e=t.getSettings(),n=e[ro],r=n?.engine;if(n===!0||mn(r))return null;if(typeof r.hyperformula=="function"||typeof r=="function"){var i;return Tet((i=r.hyperformula)!==null&&i!==void 0?i:r,e,t)}else if(typeof r=="object"&&mn(r.hyperformula)){let o=uP(),s=R5().get(r);return o.has(r)||o.set(r,[]),o.get(r).push(t),s&&s.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:T5}),(r.getConfig().leapYear1900!==cP.leapYear1900||lw(r.getConfig().nullDate,cP.nullDate)===!1)&&Sn(Qt`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}function Tet(t,e,n){let r=e[ro],i=Xfe(e),o=uP(),s=R5();Ret(t,r.functions),Det(t,r.language);let a=t.buildEmpty(i);return o.set(a,[n]),s.set(a,[n.guid]),Iet(a,r.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function D5(t){var e;let n=uP(),r=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(r.map(i=>[i.getPlugin("formulas").sheetId,i]))}function I5(t,e){if(t){let n=uP(),r=n.get(t),i=R5(),o=i.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),r.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(i.delete(t),t.destroy()))}}function Ret(t,e){e&&e.forEach(n=>{let{name:r,plugin:i,translations:o}=n;try{t.registerFunction(r,i,o)}catch(s){Sn(s.message)}})}function Det(t,e){if(e){let{langCode:n}=e;try{t.registerLanguage(n,e)}catch(r){Sn(r.message)}}}function Iet(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{let{name:r,expression:i,scope:o,options:s}=n;try{t.addNamedExpression(r,i,o,s)}catch(a){Sn(a.message)}}),t.resumeEvaluation())}function eme(t,e){return(mn(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}var Ob=Q(Ma(),1),tme="DD/MM/YYYY";function A5(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function nme(t){return A5(t)?t.substr(1):t}function rme(t){return typeof t=="string"&&t.startsWith("=")}function dP(t,e){return typeof t=="string"&&e==="date"}function M5(t,e){return(0,Ob.default)(t,e,!0).isValid()}function O5(t,e){return(0,Ob.default)(t,e,!0).format(tme)}function ime(t,e){return(0,Ob.default)(t,tme,!0).format(e)}function N5(t,e){let r=new Date(Date.UTC(0,0,t+-1));return(0,Ob.default)(r).format(e)}var qKt=Q(De(),1);var $Kt=Q(ze(),1),GKt=Q(De(),1);function Wg(t,e,n){Aet(t,e),e.set(t,n)}function Aet(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Br(t,e){var n=ome(t,e,"get");return Met(t,n)}function Met(t,e){return e.get?e.get.call(t):e.value}function dm(t,e,n){var r=ome(t,e,"set");return Oet(t,r,n),n}function ome(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Oet(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Nb=new WeakMap,hm=new WeakMap,Ha=new WeakMap,hP=new WeakMap,P5=new WeakMap,k5=new WeakMap,fP=new WeakMap,F5=class{constructor(e,n,r){Wg(this,Nb,{writable:!0,value:void 0}),Wg(this,hm,{writable:!0,value:void 0}),Wg(this,Ha,{writable:!0,value:void 0}),Wg(this,hP,{writable:!0,value:[]}),Wg(this,P5,{writable:!0,value:[]}),Wg(this,k5,{writable:!0,value:void 0}),Wg(this,fP,{writable:!0,value:[]}),dm(this,Nb,e),dm(this,hm,n),dm(this,Ha,r)}setRemovedHfIndexes(e){return dm(this,fP,e.map(n=>{let r=Br(this,hm).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(r)})),Br(this,fP)}getRemovedHfIndexes(){return Br(this,fP)}getHfIndexFromVisualIndex(e){let n=Br(this,hm).getIndexesSequence(),r=Br(this,hm).getNotTrimmedIndexes();return n.indexOf(r[e])}syncMoves(e){let r=`move${Uo(Br(this,Nb))}s`;Br(this,Ha).getEngine().batch(()=>{e.forEach(i=>{let o=i.from!==i.to,s=i.from+1!==i.to;o&&s&&Br(this,Ha).getEngine()[r](Br(this,Ha).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,n,r){r!==!1&&(dm(this,P5,e.map(i=>this.getHfIndexFromVisualIndex(i))),dm(this,k5,this.getHfIndexFromVisualIndex(n)))}getMoveLine(e,n){let r=Br(this,hm).getNumberOfIndexes(),i=Array.from(Array(r).keys()).filter(s=>e.includes(s)===!1);if(n===0){var o;return(o=i[n])!==null&&o!==void 0?o:0}return i[n-1]+1}getInitiallyCalculatedMoves(e,n){let r=this.getMoveLine(e,n),i=[];return e.forEach(o=>{let s={from:o,to:r};i.forEach(a=>{let l=a.from>a.to,c=a.to<=s.from;a.from>s.from&&c&&l&&(s.from+=1)}),s.from>=r&&(r+=1),i.push(s)}),i}adjustedCalculatedMoves(e){return e.forEach((n,r)=>{e.slice(r+1).forEach(o=>{let s=o.from<o.to;o.from>n.from&&s&&(o.from-=1)})}),e}calculateAndSyncMoves(e,n){if(Br(this,Ha).isPerformingUndoRedo()||e===!1||n===!1)return;let r=this.adjustedCalculatedMoves(this.getInitiallyCalculatedMoves(Br(this,P5),Br(this,k5)));Br(this,Ha).getSheetId()===null?Br(this,Ha).getPostponeAction(()=>this.syncMoves(r)):this.syncMoves(r)}getIndexesChangeSyncMethod(){let e=`set${Uo(Br(this,Nb))}Order`;return n=>{if(Br(this,Ha).isPerformingUndoRedo())return;let r=Br(this,hm).getIndexesSequence();if(n==="update"){let i=Br(this,hP).map(l=>r.indexOf(l)),o=Br(this,Ha).getEngine().getSheetDimensions(Br(this,Ha).getSheetId()),s;Br(this,Nb)==="row"?s=o.height:s=o.width;let a=i.length;for(let l=a;l<s;l+=1)i.push(l);Br(this,Ha).getEngine()[e](Br(this,Ha).getSheetId(),i)}dm(this,hP,r)}}init(){dm(this,hP,Br(this,hm).getIndexesSequence())}},L5=F5;function jg(t,e,n){Net(t,e),e.set(t,n)}function Net(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sh(t,e){var n=sme(t,e,"get");return Pet(t,n)}function Pet(t,e){return e.get?e.get.call(t):e.value}function $g(t,e,n){var r=sme(t,e,"set");return ket(t,r,n),n}function sme(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ket(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var mP=new WeakMap,pP=new WeakMap,H5=new WeakMap,V5=new WeakMap,B5=new WeakMap,U5=new WeakMap,W5=new WeakMap,j5=class{constructor(e,n,r){jg(this,mP,{writable:!0,value:void 0}),jg(this,pP,{writable:!0,value:void 0}),jg(this,H5,{writable:!0,value:void 0}),jg(this,V5,{writable:!0,value:!1}),jg(this,B5,{writable:!0,value:!1}),jg(this,U5,{writable:!0,value:null}),jg(this,W5,{writable:!0,value:null}),$g(this,mP,new L5("row",e,this)),$g(this,pP,new L5("column",n,this)),$g(this,H5,r)}getForAxis(e){return e==="row"?sh(this,mP):sh(this,pP)}setPerformUndo(e){$g(this,V5,e)}setPerformRedo(e){$g(this,B5,e)}isPerformingUndoRedo(){return sh(this,V5)||sh(this,B5)}getSheetId(){return sh(this,W5)}getEngine(){return sh(this,U5)}getPostponeAction(){return sh(this,H5)}setupSyncEndpoint(e,n){$g(this,U5,e),$g(this,W5,n),sh(this,mP).init(),sh(this,pP).init()}},ame=j5;function Yr(t,e){Ome(t,e),e.add(t)}function Oy(t,e,n){return e=Fet(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fet(t){var e=Let(t,"string");return typeof e=="symbol"?e:String(e)}function Let(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $5(t,e,n){Ome(t,e),e.set(t,n)}function Ome(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fm(t,e,n){var r=Nme(t,e,"set");return Het(t,r,n),n}function Het(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ny(t,e){var n=Nme(t,e,"get");return Vet(t,n)}function Nme(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Vet(t,e){return e.get?e.get.call(t):e.value}function Dr(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var ro="formulas",Bet=["maxRows","maxColumns","language"],Pme=260;ot.getSingleton().register("afterNamedExpressionAdded");ot.getSingleton().register("afterNamedExpressionRemoved");ot.getSingleton().register("afterSheetAdded");ot.getSingleton().register("afterSheetRemoved");ot.getSingleton().register("afterSheetRenamed");ot.getSingleton().register("afterFormulasValuesUpdate");var Py=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto",ah=new WeakMap,q5=new WeakMap,Pb=new WeakMap,lme=new WeakSet,cme=new WeakSet,G5=new WeakSet,ume=new WeakSet,z5=new WeakSet,dme=new WeakSet,hme=new WeakSet,Y5=new WeakSet,fme=new WeakSet,mme=new WeakSet,pme=new WeakSet,gme=new WeakSet,vme=new WeakSet,wme=new WeakSet,yme=new WeakSet,_me=new WeakSet,Cme=new WeakSet,Sme=new WeakSet,Eme=new WeakSet,xme=new WeakSet,bme=new WeakSet,Tme=new WeakSet,Rme=new WeakSet,Dme=new WeakSet,kb=class extends Dt{constructor(){var e;super(...arguments),e=this,Yr(this,Dme),Yr(this,Rme),Yr(this,Tme),Yr(this,bme),Yr(this,xme),Yr(this,Eme),Yr(this,Sme),Yr(this,Cme),Yr(this,_me),Yr(this,yme),Yr(this,wme),Yr(this,vme),Yr(this,gme),Yr(this,pme),Yr(this,mme),Yr(this,fme),Yr(this,Y5),Yr(this,hme),Yr(this,dme),Yr(this,z5),Yr(this,ume),Yr(this,G5),Yr(this,cme),Yr(this,lme),$5(this,ah,{writable:!0,value:!1}),$5(this,q5,{writable:!0,value:!1}),$5(this,Pb,{writable:!0,value:[["valuesUpdated",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dr(e,Eme,ntt).call(e,...r)}],["namedExpressionAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dr(e,xme,rtt).call(e,...r)}],["namedExpressionRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dr(e,bme,itt).call(e,...r)}],["sheetAdded",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dr(e,Tme,ott).call(e,...r)}],["sheetRenamed",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dr(e,Rme,stt).call(e,...r)}],["sheetRemoved",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Dr(e,Dme,att).call(e,...r)}]]}),Oy(this,"staticRegister",Ri("formulas")),Oy(this,"engine",null),Oy(this,"sheetName",null),Oy(this,"indexSyncer",null),Oy(this,"rowAxisSyncer",null),Oy(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return ro}static get PLUGIN_PRIORITY(){return Pme}static get SETTING_KEYS(){return[ro,...Bet]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[ro]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=Jfe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Sn("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){let r=this.addSheet(this.sheetName,this.hot.getSourceDataArray());r!==!1&&(this.sheetName=r)}this.addHook("beforeLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,G5,Ime).call(n,...i)}),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,z5,Ame).call(n,...i)}),this.addHook("beforeUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,G5,Ime).call(n,...i)}),this.addHook("afterUpdateData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,z5,Ame).call(n,...i)}),this.addHook("modifyData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,dme,$et).call(n,...i)}),this.addHook("modifySourceData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,hme,Get).call(n,...i)}),this.addHook("beforeValidate",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,lme,Uet).call(n,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,fme,zet).call(n,...i)}),this.addHook("afterSetDataAtCell",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,Y5,Mme).call(n,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,Y5,Mme).call(n,...i)}),this.addHook("beforeCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,mme,Yet).call(n,...i)}),this.addHook("beforeCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,pme,qet).call(n,...i)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,wme,Zet).call(n,...i)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,yme,Qet).call(n,...i)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,gme,Ket).call(n,...i)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,vme,Xet).call(n,...i)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,_me,Jet).call(n,...i)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,Cme,ett).call(n,...i)}),this.indexSyncer=new ame(this.hot.rowIndexMapper,this.hot.columnIndexMapper,r=>{this.hot.addHookOnce("init",()=>{r()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(r,i,o,s)=>{this.rowAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("beforeColumnMove",(r,i,o,s)=>{this.columnAxisSyncer.storeMovesInformation(r,i,s)}),this.hot.addHook("afterRowMove",(r,i,o,s,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("afterColumnMove",(r,i,o,s,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(s,a)}),this.hot.addHook("beforeColumnFreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.storeMovesInformation([r],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(r,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,ume,jet).call(n,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,Sme,ttt).call(n,...i)}),this.addHook("beforeAutofill",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Dr(n,cme,Wet).call(n,...i)}),Ny(this,Pb).forEach(r=>{let[i,o]=r;return this.engine.on(i,o)}),super.enablePlugin()}}disablePlugin(){Ny(this,Pb).forEach(e=>{let[n,r]=e;return this.engine.off(n,r)}),I5(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){let n=Zfe(this.hot.getSettings());Qfe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);let r=this.hot.getSettings()[ro];if(Ze(r)&&Ze(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&this.sheetName===null){let i=this.hot.getSettings()[ro].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){Ny(this,Pb).forEach(e=>{var n;let[r,i]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(r,i)}),fm(this,Pb,null),I5(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(Ze(n)&&!mae(n))return Sn("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Sn("Sheet with the provided name already exists."),!1;try{let r=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(r),n),r}catch(r){return Sn(r.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){hw(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;let n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Uo(ro)}.switchSheet`)}getCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId,i=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return i!==null&&o!==null?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=new Set;e.forEach(i=>{var o;let s=i==null||(o=i.address)===null||o===void 0?void 0:o.sheet;s!==void 0&&(r.has(s)||r.add(s))}),D5(this.engine).forEach((i,o)=>{if((n||o!==this.sheetId)&&r.has(o)){var s;i.render(),(s=i.view)===null||s===void 0||s.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=o=>{var s;let{row:a,col:l,sheet:c}=(s=o?.address)!==null&&s!==void 0?s:{};return Ze(c)?`${c}:${a}x${l}`:""},i=new Set(n.map(o=>r(o)));e.forEach(o=>{var s,a;let{row:l,col:c}=(s=o.address)!==null&&s!==void 0?s:{};if(Ze(l)===!1||Ze(c)===!1||l>=this.hot.countRows()||c>=this.hot.countCols())return;let u=o==null||(a=o.address)===null||a===void 0?void 0:a.sheet,d=r(o);if(u!==void 0&&!i.has(d)){let h=D5(this.engine).get(u);if(!h)return;h.validateCell(h.getDataAtCell(l,c),h.getCellMeta(l,c),()=>{})}})}syncChangeWithEngine(e,n,r){let i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){Sn(`Not possible to set cell data at ${JSON.stringify(i)}`);return}let o=this.hot.getCellMeta(e,n);return dP(r,o.type)&&(M5(r,o.dateFormat)?r=O5(r,o.dateFormat):rme(r)===!1&&(r=`'${r}`)),this.engine.setCellContents(i,r)}};function Uet(t,e,n){let r=this.hot.propToCol(n);if(this.isFormulaCellType(e,r)){let i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},o=this.hot.getCellMeta(e,r),s=this.engine.getCellValue(i);return o.type==="date"&&Vi(s)&&(s=N5(s,o.dateFormat)),typeof s=="object"&&s!==null?s.value:s}return t}function Wet(t,e,n){let{row:r,col:i}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:c,col:u}=n.getBottomEndCorner(),d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(h)===!1)return!1;let f=this.engine.getFillRangeData(d,h),{row:p,col:g}=d.start,{row:w,col:_}=d.end,S=w-p+1,x=_-g+1;for(let P=0;P<f.length;P+=1)for(let k=0;k<f[P].length;k+=1){let b=f[P][k],C=P%S,N=k%x,B=this.hot.getCellMeta(C,N);dP(b,B.type)&&(b.startsWith("'")?f[P][k]=b.slice(1):this.isFormulaCellType(C,N,this.sheetId)===!1&&(f[P][k]=ime(b,B.dateFormat)))}return f}function Ime(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Uo(ro))||fm(this,q5,mn(this.hot.getSettings().data))}function jet(){let t=this.hot.getSourceDataArray(),e=!1;t.forEach((n,r)=>{n.forEach((i,o)=>{let s=this.hot.getCellMeta(r,o),a=s.dateFormat;dP(i,s.type)&&(e=!0,M5(i,a)?t[r][o]=O5(i,a):this.isFormulaCellType(r,o)===!1&&(t[r][o]=`'${i}`))})}),e===!0&&(fm(this,ah,!0),this.engine.setSheetContent(this.sheetId,t),fm(this,ah,!1))}function Ame(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Uo(ro)))if(this.sheetName=eme(this.engine,this.hot.getSettings()[ro].sheetName),Ny(this,q5))this.switchSheet(this.sheetName);else{let r=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){fm(this,ah,!0);let i=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),fm(this,ah,!1)}}}function $et(t,e,n,r){if(r!=="get"||Ny(this,ah)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;let i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){A5(n.value)&&(n.value=nme(n.value));return}let s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},a=this.engine.getCellValue(s),l=this.hot.getCellMeta(i,e);l.type==="date"&&Vi(a)&&(a=N5(a,l.dateFormat));let c=typeof a=="object"&&a!==null?a.value:a;n.value=c}function Get(t,e,n,r){if(r!=="get"||Ny(this,ah)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;let i=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(i===null||o===null||!this.isFormulaCellType(i,o)&&this.getCellType(i,o)!=="ARRAY")return;let a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;let l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function Mme(t,e){if(Py(e))return;let n=[],r=[],i=this.engine.batch(()=>{t.forEach(o=>{let[s,a,,l]=o,c=this.hot.propToCol(a),u=this.hot.toPhysicalRow(s),d=this.hot.toPhysicalColumn(c),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};u!==null&&d!==null?this.syncChangeWithEngine(s,c,l):n.push([s,c,l]),r.push({address:h})})});n.length&&this.hot.addHookOnce("afterChange",()=>{let o=this.engine.batch(()=>{n.forEach(s=>{let[a,l,c]=s;this.syncChangeWithEngine(a,l,c)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function zet(t,e){if(Py(e))return;let n=[],r=[];t.forEach(i=>{let[o,s,,a]=i,l=this.hot.propToCol(s);if(!Vi(l))return;let c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){Sn(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}r.push({address:c}),n.push(...this.engine.setCellContents(c,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function Yet(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function qet(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function Ket(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function Xet(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function Zet(t,e,n){if(Py(n))return;let r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Qet(t,e,n){if(Py(n))return;let r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function Jet(t,e,n,r){if(Py(r))return;let i=this.rowAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeRows(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function ett(t,e,n,r){if(Py(r))return;let i=this.columnAxisSyncer.getRemovedHfIndexes().sort().reverse(),o=this.engine.batch(()=>{i.forEach(s=>{this.engine.removeColumns(this.sheetId,[s,1])})});this.renderDependentSheets(o)}function ttt(t,e,n){var r;fm(this,ah,!0);let i=this.hot.getSourceDataArray(n,0,n+(((r=e.__children)===null||r===void 0?void 0:r.length)||0),this.hot.countSourceCols());fm(this,ah,!1),i.forEach((o,s)=>{o.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+s,sheet:this.sheetId},[[a]])})})}function ntt(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function rtt(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function itt(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function ott(t){this.hot.runHooks("afterSheetAdded",t)}function stt(t,e){this.hot.runHooks("afterSheetRenamed",t,e)}function att(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}var _Xt=Q(ze(),1),CXt=Q(De(),1);var pXt=Q(ze(),1);function K5(t){return{key:"hidden_columns_hide",name(){let e=this.getSelectedLast(),n=0;if(Array.isArray(e)){let[,r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(VE,n)},callback(){let{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,n.col),0),i=Math.max(e.col,n.col),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideColumns(o);let s=o[o.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}var vXt=Q(ze(),1);function X5(t){let e=[];return{key:"hidden_columns_show",name(){let n=e.length>1?1:0;return this.getTranslatedPhrase(BE,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){let n=At(t.getHiddenColumns(),d=>this.toPhysicalColumn(d));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),i=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),c=s.getNotTrimmedIndexes(),u=[];if(i!==o){let d=o-i+1,h=l-a+1;if(d>h){let f=c.slice(i,o+1);u.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<i)u.push(...c.slice(0,i));else if(a===null)u.push(...c.slice(0,this.countCols()));else{let d=this.countCols()-1,h=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===h&&d>o&&u.push(...c.slice(o+1))}return Z(u,d=>{e.push(this.toVisualColumn(d))}),e.length===0}}}function ky(t,e){Wme(t,e),e.add(t)}function kme(t,e,n){Wme(t,e),e.set(t,n)}function Wme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fy(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Va(t,e){var n=jme(t,e,"get");return ltt(t,n)}function ltt(t,e){return e.get?e.get.call(t):e.value}function Fb(t,e,n){var r=jme(t,e,"set");return ctt(t,r,n),n}function jme(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function ctt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ot.getSingleton().register("beforeHideColumns");ot.getSingleton().register("afterHideColumns");ot.getSingleton().register("beforeUnhideColumns");ot.getSingleton().register("afterUnhideColumns");var gP="hiddenColumns",$me=310,Bu=new WeakMap,Vu=new WeakMap,Fme=new WeakSet,Lme=new WeakSet,Hme=new WeakSet,Vme=new WeakSet,Bme=new WeakSet,Ume=new WeakSet,Lb=class extends Dt{constructor(){super(...arguments),ky(this,Ume),ky(this,Bme),ky(this,Vme),ky(this,Hme),ky(this,Lme),ky(this,Fme),kme(this,Bu,{writable:!0,value:{}}),kme(this,Vu,{writable:!0,value:null})}static get PLUGIN_KEY(){return gP}static get PLUGIN_PRIORITY(){return $me}isEnabled(){return!!this.hot.getSettings()[gP]}enablePlugin(){var e=this;if(this.enabled)return;let n=this.hot.getSettings()[gP];Tt(n)&&(Fb(this,Bu,n),mn(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Fb(this,Vu,new Tu),Va(this,Vu).addLocalHook("init",()=>Fy(this,Ume,ptt).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Va(this,Vu)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Fy(e,Bme,mtt).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Fy(this,Lme,dtt).call(this,r,i,o)),this.addHook("modifyColWidth",(r,i)=>Fy(this,Fme,utt).call(this,r,i)),this.addHook("afterGetColHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Fy(e,Vme,ftt).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Fy(this,Hme,htt).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Fb(this,Bu,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){let n=this.getHiddenColumns(),r=this.isValidConfig(e),i=n,o=Va(this,Vu).getValues().slice(),s=e.length>0;if(r&&s){let l=e.map(c=>this.hot.toPhysicalColumn(c));Z(l,c=>{o[c]=!1}),i=or(o,(c,u,d)=>(u&&c.push(this.hot.toVisualColumn(d)),c),[])}this.hot.runHooks("beforeUnhideColumns",n,i,r&&s)!==!1&&(r&&s&&Va(this,Vu).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,i,r&&s,r&&i.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showColumns(n)}hideColumns(e){let n=this.getHiddenColumns(),r=this.isValidConfig(e),i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{Z(e,s=>{Va(this,Vu).setValueAtIndex(this.hot.toPhysicalColumn(s),!0)})},!0),this.hot.runHooks("afterHideColumns",n,i,r,r&&i.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideColumns(n)}getHiddenColumns(){return At(Va(this,Vu).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Va(this,Vu).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){let n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){Z(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Fb(this,Bu,null),Fb(this,Vu,null),super.destroy()}};function utt(t,e){if(this.isHidden(e))return 0;if(Va(this,Bu).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function dtt(t,e,n){if(Va(this,Bu).copyPasteEnabled===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){let r=n.className.split(" ");if(r.length>0){let i=r.indexOf("afterHiddenColumn");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function htt(t){if(Va(this,Bu).copyPasteEnabled)return t;let e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return Z(t,r=>{let i=!0,o=0;st(r.startCol,r.endCol,s=>{this.isHidden(s)?(i||n(r.startRow,r.endRow,o,s-1),i=!0):(i&&(o=s),s===r.endCol&&n(r.startRow,r.endRow,o,s),i=!1)})}),e}function ftt(t,e){if(!Va(this,Bu).indicators||t<0)return;let n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),Ne(e,n)}function mtt(t){t.items.push({name:Bt},K5(this),X5(this))}function ptt(){Array.isArray(Va(this,Bu).columns)&&this.hideColumns(Va(this,Bu).columns)}var UXt=Q(ze(),1),WXt=Q(De(),1);var FXt=Q(ze(),1);function Z5(t){return{key:"hidden_rows_hide",name(){let e=this.getSelectedLast(),n=0;if(Array.isArray(e)){let[r,,i]=e;r-i!==0&&(n=1)}return this.getTranslatedPhrase(UE,n)},callback(){let{from:e,to:n}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,n.row),0),i=Math.max(e.row,n.row),o=[];for(let l=r;l<=i;l+=1)o.push(l);t.hideRows(o);let s=o[o.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize(!0)},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}var HXt=Q(ze(),1);function Q5(t){let e=[];return{key:"hidden_rows_show",name(){let n=e.length>1?1:0;return this.getTranslatedPhrase(WE,n)},callback(){var n,r;if(e.length===0)return;let i=e[0],o=e[e.length-1];i=(n=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&n!==void 0?n:0,o=(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&r!==void 0?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(!0),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){let n=At(t.getHiddenRows(),d=>this.toPhysicalRow(d));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),i=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,a=s.getRenderableFromVisualIndex(i),l=s.getRenderableFromVisualIndex(o),c=s.getNotTrimmedIndexes(),u=[];if(i!==o){let d=o-i+1,h=l-a+1;if(d>h){let f=c.slice(i,o+1);u.push(...f.filter(p=>n.includes(p)))}}else if(a===0&&a<i)u.push(...c.slice(0,i));else if(a===null)u.push(...c.slice(0,this.countRows()));else{let d=this.countRows()-1,h=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(d,-1));l===h&&d>o&&u.push(...c.slice(o+1))}return Z(u,d=>{e.push(this.toVisualRow(d))}),e.length===0}}}function Ly(t,e){Qme(t,e),e.add(t)}function Gme(t,e,n){Qme(t,e),e.set(t,n)}function Qme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hy(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function Ol(t,e){var n=Jme(t,e,"get");return gtt(t,n)}function gtt(t,e){return e.get?e.get.call(t):e.value}function Hb(t,e,n){var r=Jme(t,e,"set");return vtt(t,r,n),n}function Jme(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function vtt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}ot.getSingleton().register("beforeHideRows");ot.getSingleton().register("afterHideRows");ot.getSingleton().register("beforeUnhideRows");ot.getSingleton().register("afterUnhideRows");var vP="hiddenRows",epe=320,lh=new WeakMap,Uu=new WeakMap,zme=new WeakSet,Yme=new WeakSet,qme=new WeakSet,Kme=new WeakSet,Xme=new WeakSet,Zme=new WeakSet,Vb=class extends Dt{constructor(){super(...arguments),Ly(this,Zme),Ly(this,Xme),Ly(this,Kme),Ly(this,qme),Ly(this,Yme),Ly(this,zme),Gme(this,lh,{writable:!0,value:{}}),Gme(this,Uu,{writable:!0,value:null})}static get PLUGIN_KEY(){return vP}static get PLUGIN_PRIORITY(){return epe}isEnabled(){return!!this.hot.getSettings()[vP]}enablePlugin(){var e=this;if(this.enabled)return;let n=this.hot.getSettings()[vP];Tt(n)&&(Hb(this,lh,n),mn(n.copyPasteEnabled)&&(n.copyPasteEnabled=!0)),Hb(this,Uu,new Tu),Ol(this,Uu).addLocalHook("init",()=>Hy(this,Zme,Ett).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ol(this,Uu)),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Hy(e,Xme,Stt).call(e,...i)}),this.addHook("afterGetCellMeta",(r,i,o)=>Hy(this,Yme,ytt).call(this,r,i,o)),this.addHook("modifyRowHeight",(r,i)=>Hy(this,zme,wtt).call(this,r,i)),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Hy(e,Kme,Ctt).call(e,...i)}),this.addHook("modifyCopyableRange",r=>Hy(this,qme,_tt).call(this,r)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Hb(this,lh,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){let n=this.getHiddenRows(),r=this.isValidConfig(e),i=n,o=Ol(this,Uu).getValues().slice(),s=e.length>0;if(r&&s){let l=e.map(c=>this.hot.toPhysicalRow(c));Z(l,c=>{o[c]=!1}),i=or(o,(c,u,d)=>(u&&c.push(this.hot.toVisualRow(d)),c),[])}this.hot.runHooks("beforeUnhideRows",n,i,r&&s)!==!1&&(r&&s&&Ol(this,Uu).setValues(o),this.hot.runHooks("afterUnhideRows",n,i,r&&s,r&&i.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.showRows(n)}hideRows(e){let n=this.getHiddenRows(),r=this.isValidConfig(e),i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{Z(e,s=>{Ol(this,Uu).setValueAtIndex(this.hot.toPhysicalRow(s),!0)})},!0),this.hot.runHooks("afterHideRows",n,i,r,r&&i.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.hideRows(n)}getHiddenRows(){return At(Ol(this,Uu).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Ol(this,Uu).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){let n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(r=>Number.isInteger(r)&&r>=0&&r<n):!1}resetCellsMeta(){Z(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Hb(this,lh,null),Hb(this,Uu,null),super.destroy()}};function wtt(t,e){return this.isHidden(e)?0:t}function ytt(t,e,n){if(Ol(this,lh).copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){let r=n.className.split(" ");if(r.length>0){let i=r.indexOf("afterHiddenRow");i>-1&&r.splice(i,1),n.className=r.join(" ")}}}function _tt(t){if(Ol(this,lh).copyPasteEnabled)return t;let e=[],n=(r,i,o,s)=>{e.push({startRow:r,endRow:i,startCol:o,endCol:s})};return Z(t,r=>{let i=!0,o=0;st(r.startRow,r.endRow,s=>{this.isHidden(s)?(i||n(o,s-1,r.startCol,r.endCol),i=!0):(i&&(o=s),s===r.endRow&&n(o,s,r.startCol,r.endCol),i=!1)})}),e}function Ctt(t,e){if(!Ol(this,lh).indicators||t<0)return;let n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),Ne(e,n)}function Stt(t){t.items.push({name:Bt},Z5(this),Q5(this))}function Ett(){Array.isArray(Ol(this,lh).rows)&&this.hideRows(Ol(this,lh).rows)}var oZt=Q(ze(),1),sZt=Q(De(),1);function J5(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(pE)},callback(e,n){let[{start:{col:r}}]=n;t.freezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){let e=this.getSelectedRange(),n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function ej(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(gE)},callback(e,n){let[{start:{col:r}}]=n;t.unfreezeColumn(r),this.render(),this.view.adjustElementsSize(!0)},hidden(){let e=this.getSelectedRange(),n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function tpe(t,e){ope(t,e),e.add(t)}function xtt(t,e,n){ope(t,e),e.set(t,n)}function ope(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nj(t,e){var n=spe(t,e,"get");return btt(t,n)}function btt(t,e){return e.get?e.get.call(t):e.value}function tj(t,e,n){var r=spe(t,e,"set");return Ttt(t,r,n),n}function spe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ttt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function npe(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ot.getSingleton().register("beforeColumnFreeze");ot.getSingleton().register("afterColumnFreeze");ot.getSingleton().register("beforeColumnUnfreeze");ot.getSingleton().register("afterColumnUnfreeze");var rj="manualColumnFreeze",ape=110,Gg=new WeakMap,rpe=new WeakSet,ipe=new WeakSet,Bb=class extends Dt{constructor(){super(...arguments),tpe(this,ipe),tpe(this,rpe),xtt(this,Gg,{writable:!0,value:!1})}static get PLUGIN_KEY(){return rj}static get PLUGIN_PRIORITY(){return ape}isEnabled(){return!!this.hot.getSettings()[rj]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>npe(this,rpe,Rtt).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>npe(this,ipe,Dtt).call(this,e,n)),super.enablePlugin())}disablePlugin(){tj(this,Gg,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){let n=this.hot.getSettings(),r=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;nj(this,Gg)||tj(this,Gg,!0),this.hot.runHooks("beforeColumnFreeze",e,r)!==!1&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){let n=this.hot.getSettings(),r=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;nj(this,Gg)||tj(this,Gg,!0),this.hot.runHooks("beforeColumnUnfreeze",e,r)!==!1&&(r&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}};function Rtt(t){t.items.push({name:"---------"},J5(this),ej(this))}function Dtt(t,e){if(nj(this,Gg)){let n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(r=>r<n))return!1}}var xZt=Q(ze(),1),bZt=Q(De(),1);var mZt=Q(De(),1);function wP(t,e,n){return e=Itt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Itt(t){var e=Att(t,"string");return typeof e=="symbol"?e:String(e)}function Att(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ij=0,lpe=1,cpe=2,Vy="px",oj=class{constructor(e){wP(this,"hot",void 0),wP(this,"_element",null),wP(this,"state",ij),wP(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=cpe}build(){this.state===ij&&(this._element=this.hot.rootDocument.createElement("div"),this.state=lpe)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ij}isAppended(){return this.state===cpe}isBuilt(){return this.state>=lpe}setPosition(e,n){Vi(e)&&(this._element.style.top=e+Vy),Vi(n)&&(this._element.style[this.inlineProperty]=n+Vy)}getPosition(){let e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Vi(e)&&(this._element.style.width=e+Vy),Vi(n)&&(this._element.style.height=n+Vy)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Vi(e)&&(this._element.style.marginTop=e+Vy),Vi(n)&&(this._element.style[`margin${Uo(this.inlineProperty)}`]=n+Vy)}getOffset(){let e=this._element.style,n=`margin${Uo(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}},yP=oj;var Mtt="ht__manualColumnMove--backlight",sj=class extends yP{build(){super.build(),Ne(this._element,Mtt)}},upe=sj;var Ott="ht__manualColumnMove--guideline",aj=class extends yP{build(){super.build(),Ne(this._element,Ott)}},dpe=aj;function By(t,e){ype(t,e),e.add(t)}function Fc(t,e,n){ype(t,e),e.set(t,n)}function ype(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ha(t,e,n){var r=_pe(t,e,"set");return Ntt(t,r,n),n}function Ntt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function It(t,e){var n=_pe(t,e,"get");return Ptt(t,n)}function _pe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ptt(t,e){return e.get?e.get.call(t):e.value}function Uy(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ot.getSingleton().register("beforeColumnMove");ot.getSingleton().register("afterColumnMove");var CP="manualColumnMove",Cpe=120,hpe="ht__manualColumnMove",EP="show-ui",lj="on-moving--columns",cj="after-selection--columns",Ws=new WeakMap,mm=new WeakMap,ch=new WeakMap,SP=new WeakMap,pm=new WeakMap,Us=new WeakMap,_P=new WeakMap,Nl=new WeakMap,Wy=new WeakMap,xP=new WeakMap,Ub=new WeakMap,fpe=new WeakSet,mpe=new WeakSet,ppe=new WeakSet,gpe=new WeakSet,vpe=new WeakSet,wpe=new WeakSet,Wb=class extends Dt{constructor(){super(...arguments),By(this,wpe),By(this,vpe),By(this,gpe),By(this,ppe),By(this,mpe),By(this,fpe),Fc(this,Ws,{writable:!0,value:new upe(this.hot)}),Fc(this,mm,{writable:!0,value:new dpe(this.hot)}),Fc(this,ch,{writable:!0,value:[]}),Fc(this,SP,{writable:!0,value:0}),Fc(this,pm,{writable:!0,value:!1}),Fc(this,Us,{writable:!0,value:{}}),Fc(this,_P,{writable:!0,value:void 0}),Fc(this,Nl,{writable:!0,value:void 0}),Fc(this,Wy,{writable:!0,value:void 0}),Fc(this,xP,{writable:!0,value:void 0}),Fc(this,Ub,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return CP}static get PLUGIN_PRIORITY(){return Cpe}isEnabled(){return!!this.hot.getSettings()[CP]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uy(e,fpe,ktt).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uy(e,ppe,Ltt).call(e,...r)}),this.addHook("afterScrollVertically",()=>Uy(this,vpe,Vtt).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Uy(e,wpe,Btt).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Ne(this.hot.rootElement,hpe),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){bt(this.hot.rootElement,hpe),this.unregisterEvents(),It(this,Ws).destroy(),It(this,mm).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){let r=It(this,_P),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,r,i);if(ha(this,_P,void 0),o===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,n);let s=i&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,r,i,s),s}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){let r=this.countFinalIndex(e,n);return ha(this,_P,n),this.moveColumns(e,r)}isMovePossible(e,n){let r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isColumnOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){let r=or(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getColumnsWidth(e,n){let r=this.hot.columnIndexMapper,i=0;for(let o=e;o<=n;o+=1){let s=r.getRenderableFromVisualIndex(o);o<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:s!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(s)||0)}return i}moveBySettingsOrLoad(){let e=this.hot.getSettings()[CP];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){let n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){let e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){let r=[];return st(e,n,i=>{r.push(i)}),r}refreshPositions(){let e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(It(this,Nl))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});let n=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof r.scrollX=="number"?r.scrollX:r.scrollLeft,o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,It(this,Nl)-1),s=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=It(this,Ws).getOffset().start,c=It(this,Ws).getSize().width,u=0,d=0;if(this.hot.isRtl()){let p=this.hot.rootWindow,g=pn(this.hot.rootElement),w=p.innerWidth-It(this,Wy)-g;d=p.innerWidth-It(this,Us).eventPageX-w-(r.scrollX===void 0?i:0)}else d=It(this,Us).eventPageX-(It(this,Wy)-(r.scrollX===void 0?i:0));if(It(this,xP)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(It(this,Nl))&&(o+=i),o+=u,It(this,Nl)<0)It(this,Ub)>0?It(this,Us).col=0:It(this,Us).col=e>0?e-1:e;else if(It(this,Us).TD.offsetWidth/2+o<=d){let p=It(this,Nl)>=It(this,SP)?It(this,SP)-1:It(this,Nl);It(this,Us).col=p+1,o+=It(this,Us).TD.offsetWidth}else It(this,Us).col=It(this,Nl);let h=d,f=o;d+c+l>=s?h=s-c-l:d+l<a+u&&(h=a+u+Math.abs(l)),o>=s-1?f=s-1:f===0?f=1:r.scrollX!==void 0&&It(this,Nl)<It(this,Ub)&&(f-=It(this,Wy)<=r.scrollX?It(this,Wy):0),It(this,Ws).setPosition(null,h),It(this,mm).setPosition(null,f)}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Uy(this,mpe,Ftt).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Uy(this,gpe,Htt).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){It(this,Ws).build(),It(this,mm).build()}destroy(){It(this,Ws).destroy(),It(this,mm).destroy(),super.destroy()}};function ktt(t,e,n,r){let i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),a=St(t.target,"sortAction");if(!s||!o||It(this,pm)||t.button!==0||a){ha(this,pm,!1),It(this,ch).length=0,bt(this.hot.rootElement,[lj,EP]);return}let l=It(this,mm).isBuilt()&&!It(this,mm).isAppended(),c=It(this,Ws).isBuilt()&&!It(this,Ws).isAppended();l&&c&&(It(this,mm).appendTo(i.hider),It(this,Ws).appendTo(i.hider));let{from:u,to:d}=s,h=Math.min(u.col,d.col),f=Math.max(u.col,d.col);if(e.row<0&&e.col>=h&&e.col<=f){r.column=!0,ha(this,pm,!0);let p=n.firstChild?Aoe(t,n.firstChild).x:t.offsetX;It(this,Us).eventPageX=t.pageX,ha(this,Nl,e.col),It(this,Us).TD=n,It(this,Us).col=e.col,ha(this,ch,this.prepareColumnsToMoving(h,f)),ha(this,xP,!!this.hot.getSettings().rowHeaders),ha(this,SP,this.hot.countCols()),ha(this,Ub,this.hot.getSettings().fixedColumnsStart),ha(this,Wy,vr(this.hot.rootElement).left);let g=It(this,xP)?-1:0,w=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,_=e.col<It(this,Ub),S=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),x=Math.abs(p-(this.hot.isRtl()?n.offsetWidth:0)),P=this.getColumnsWidth(h,e.col-1)+x,k=this.getColumnsWidth(g,h-1)+(_?S:0)+P;It(this,Ws).setPosition(w,k),It(this,Ws).setSize(this.getColumnsWidth(h,f),i.hider.offsetHeight-w),It(this,Ws).setOffset(null,-P),Ne(this.hot.rootElement,lj)}else bt(this.hot.rootElement,cj),ha(this,pm,!1),It(this,ch).length=0}function Ftt(t){It(this,pm)&&(It(this,Us).eventPageX=t.pageX,this.refreshPositions())}function Ltt(t,e,n,r){!this.hot.getSelectedRangeLast()||!It(this,pm)||(It(this,ch).indexOf(e.col)>-1?bt(this.hot.rootElement,EP):Ne(this.hot.rootElement,EP),r.row=!0,r.column=!0,r.cell=!0,ha(this,Nl,e.col),It(this,Us).TD=n)}function Htt(){let t=It(this,Us).col,e=It(this,ch).length;if(ha(this,Nl,void 0),ha(this,pm,!1),bt(this.hot.rootElement,[lj,EP,cj]),this.hot.selection.isSelectedByColumnHeader()&&Ne(this.hot.rootElement,cj),e<1||t===void 0)return;let n=It(this,ch)[0],r=this.hot.toPhysicalColumn(n),i=this.dragColumns(It(this,ch),t);if(It(this,ch).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);let o=this.hot.toVisualColumn(r),s=o+e-1;this.hot.selectColumns(o,s)}}function Vtt(){let t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,r=e+n;It(this,Ws).setPosition(r),It(this,Ws).setSize(null,t.hider.offsetHeight-r)}function Btt(){this.moveBySettingsOrLoad()}var LZt=Q(ze(),1),HZt=Q(De(),1);function uh(t,e){Ope(t,e),e.add(t)}function ps(t,e,n){Ope(t,e),e.set(t,n)}function Ope(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dh(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function _i(t,e,n){var r=Npe(t,e,"set");return Utt(t,r,n),n}function Utt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function _t(t,e){var n=Npe(t,e,"get");return Wtt(t,n)}function Npe(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Wtt(t,e){return e.get?e.get.call(t):e.value}var zb="manualColumnResize",Ppe=130,Spe="manualColumnWidths",fh=new WeakMap,bP=new WeakMap,Ba=new WeakMap,RP=new WeakMap,Wu=new WeakMap,jtt=new WeakMap,jy=new WeakMap,TP=new WeakMap,fa=new WeakMap,hh=new WeakMap,zg=new WeakMap,DP=new WeakMap,jb=new WeakMap,$b=new WeakMap,Ua=new WeakMap,Gb=new WeakMap,Epe=new WeakSet,xpe=new WeakSet,bpe=new WeakSet,Tpe=new WeakSet,Rpe=new WeakSet,Dpe=new WeakSet,Ipe=new WeakSet,Ape=new WeakSet,Mpe=new WeakSet,Yb=class extends Dt{static get PLUGIN_KEY(){return zb}static get PLUGIN_PRIORITY(){return Ppe}constructor(e){super(e),uh(this,Mpe),uh(this,Ape),uh(this,Ipe),uh(this,Dpe),uh(this,Rpe),uh(this,Tpe),uh(this,bpe),uh(this,xpe),uh(this,Epe),ps(this,fh,{writable:!0,value:null}),ps(this,bP,{writable:!0,value:null}),ps(this,Ba,{writable:!0,value:[]}),ps(this,RP,{writable:!0,value:null}),ps(this,Wu,{writable:!0,value:null}),ps(this,jtt,{writable:!0,value:null}),ps(this,jy,{writable:!0,value:null}),ps(this,TP,{writable:!0,value:null}),ps(this,fa,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),ps(this,hh,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),ps(this,zg,{writable:!0,value:null}),ps(this,DP,{writable:!0,value:!1}),ps(this,jb,{writable:!0,value:0}),ps(this,$b,{writable:!0,value:null}),ps(this,Ua,{writable:!0,value:void 0}),ps(this,Gb,{writable:!0,value:void 0}),Ne(_t(this,fa),"manualColumnResizer"),Ne(_t(this,hh),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[zb]}enablePlugin(){this.enabled||(_i(this,Ua,new xo),_t(this,Ua).addLocalHook("init",()=>dh(this,Epe,$tt).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_t(this,Ua)),this.addHook("modifyColWidth",(e,n)=>dh(this,Ipe,Xtt).call(this,e,n)),this.addHook("beforeStretchingColumnWidth",(e,n)=>dh(this,Ape,Ztt).call(this,e,n)),this.addHook("beforeColumnResize",(e,n,r)=>dh(this,Mpe,Qtt).call(this,e,n,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_i(this,Gb,_t(this,Ua).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",Spe,_t(this,Ua).getValues())}loadManualColumnWidths(){let e={};return this.hot.runHooks("persistentStateLoad",Spe,e),e.value}setManualSize(e,n){let r=Math.max(n,20),i=this.hot.toPhysicalColumn(e);return _t(this,Ua).setValueAtIndex(i,r),r}clearManualSize(e){let n=this.hot.toPhysicalColumn(e);_t(this,Ua).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode)return;_i(this,fh,e);let{_wt:n}=this.hot.view,r=n.wtTable.getCoords(_t(this,fh)),i=r.col;if(i<0)return;let o=Nn(_t(this,fh)),s=_t(this,fh).getBoundingClientRect(),a=i<n.getSetting("fixedColumnsStart"),l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_t(this,fh),r.row,r.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(_t(this,fh),r.row,r.col)),_i(this,bP,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),_i(this,Ba,[]);let c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){let u=this.hot.getSelectedRange();Z(u,d=>{let h=d.getTopStartCorner().col,f=d.getBottomEndCorner().col;st(h,f,p=>{_t(this,Ba).includes(p)||_t(this,Ba).push(p)})})}_t(this,Ba).includes(_t(this,bP))||_i(this,Ba,[_t(this,bP)]),_i(this,TP,l.start-6),_i(this,jy,parseInt(s.width,10)),_t(this,fa).style.top=`${l.top}px`,_t(this,fa).style[this.inlineDir]=`${_t(this,TP)+_t(this,jy)}px`,_t(this,fa).style.height=`${o}px`,this.hot.rootElement.appendChild(_t(this,fa))}refreshHandlePosition(){_t(this,fa).style[this.inlineDir]=`${_t(this,TP)+_t(this,RP)}px`}setupGuidePosition(){let e=parseInt(Nn(_t(this,fa)),10),n=parseInt(_t(this,fa).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);Ne(_t(this,fa),"active"),Ne(_t(this,hh),"active"),_t(this,hh).style.top=`${n}px`,this.refreshGuidePosition(),_t(this,hh).style.height=`${r-e}px`,this.hot.rootElement.appendChild(_t(this,hh))}refreshGuidePosition(){_t(this,hh).style[this.inlineDir]=_t(this,fa).style[this.inlineDir]}hideHandleAndGuide(){bt(_t(this,fa),"active"),bt(_t(this,hh),"active")}checkIfColumnHeader(e){return!!mc(e,["THEAD"],this.hot.rootElement)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){let e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{let o=this.hot.runHooks("beforeColumnResize",_t(this,Wu),r,!0);o!==void 0&&_i(this,Wu,o),this.hot.getSettings().stretchH==="all"?this.clearManualSize(r):this.setManualSize(r,_t(this,Wu)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_t(this,Wu),r,!0),i&&e()};_t(this,jb)>=2&&(_t(this,Ba).length>1?(Z(_t(this,Ba),i=>{n(i)}),e()):Z(_t(this,Ba),i=>{n(i,!0)})),_i(this,jb,0),_i(this,$b,null)}bindEvents(){let{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",r=>dh(this,xpe,Gtt).call(this,r)),this.eventManager.addEventListener(n,"mousedown",r=>dh(this,bpe,ztt).call(this,r)),this.eventManager.addEventListener(e,"mousemove",r=>dh(this,Tpe,Ytt).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>dh(this,Rpe,qtt).call(this)),this.eventManager.addEventListener(_t(this,fa),"contextmenu",()=>dh(this,Dpe,Ktt).call(this))}destroy(){super.destroy()}};function $tt(){let t=this.hot.getSettings()[zb],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,r)=>{_t(this,Ua).setValueAtIndex(r,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,r)=>{_t(this,Ua).setValueAtIndex(r,n)})},!0),_i(this,Gb,t)):t===!0&&Array.isArray(_t(this,Gb))&&this.hot.batchExecution(()=>{_t(this,Gb).forEach((n,r)=>{_t(this,Ua).setValueAtIndex(r,n)})},!0)}function Gtt(t){if(!wM(t.target)&&_t(this,DP)!==!0&&this.checkIfColumnHeader(t.target)){let e=this.getClosestTHParent(t.target);if(!e)return;let n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(_t(this,zg)||this.setupHandlePosition(e))}}function ztt(t){St(t.target,"manualColumnResizer")&&(this.setupHandlePosition(_t(this,fh)),this.setupGuidePosition(),_i(this,zg,!0),_t(this,$b)===null&&(_i(this,$b,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_t(this,$b))),_i(this,jb,_t(this,jb)+1),this.startX=t.pageX,_i(this,Wu,_t(this,jy)))}function Ytt(t){if(_t(this,zg)){let e=(t.pageX-this.startX)*this.hot.getDirectionFactor();_i(this,RP,_t(this,jy)+e),Z(_t(this,Ba),n=>{_i(this,Wu,this.setManualSize(n,_t(this,RP)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function qtt(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeColumnResize",_t(this,Wu),n,!1),r&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_t(this,Wu),n,!1)};_t(this,zg)&&(this.hideHandleAndGuide(),_i(this,zg,!1),_t(this,Wu)!==_t(this,jy)&&(_t(this,Ba).length>1?(Z(_t(this,Ba),r=>{e(r)}),t()):Z(_t(this,Ba),r=>{e(r,!0)})),this.setupHandlePosition(_t(this,fh)))}function Ktt(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_t(this,fa)),this.hot.rootElement.removeChild(_t(this,hh)),_i(this,zg,!1),_i(this,DP,!0),this.hot._registerImmediate(()=>{_i(this,DP,!1)})}function Xtt(t,e){let n=t;if(this.enabled){let r=this.hot.toPhysicalColumn(e),i=_t(this,Ua).getValueAtIndex(r);this.hot.getSettings()[zb]&&i&&(n=i)}return n}function Ztt(t,e){let n=_t(this,Ua).getValueAtIndex(e);return n===null&&(n=t),n}function Qtt(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}var tQt=Q(ze(),1),nQt=Q(De(),1);var YZt=Q(De(),1);function uj(t,e,n){return e=Jtt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jtt(t){var e=ent(t,"string");return typeof e=="symbol"?e:String(e)}function ent(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dj=0,kpe=1,Fpe=2,$y="px",hj=class{constructor(e){uj(this,"hot",void 0),uj(this,"_element",null),uj(this,"state",dj),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=Fpe}build(){this.state===dj&&(this._element=this.hot.rootDocument.createElement("div"),this.state=kpe)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=dj}isAppended(){return this.state===Fpe}isBuilt(){return this.state>=kpe}setPosition(e,n){e!==void 0&&(this._element.style.top=e+$y),n!==void 0&&(this._element.style.left=n+$y)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+$y),n&&(this._element.style.height=n+$y)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+$y),n&&(this._element.style.marginLeft=n+$y)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},IP=hj;var tnt="ht__manualRowMove--backlight",fj=class extends IP{build(){super.build(),Ne(this._element,tnt)}},Lpe=fj;var nnt="ht__manualRowMove--guideline",mj=class extends IP{build(){super.build(),Ne(this._element,nnt)}},Hpe=mj;function Gy(t,e){zpe(t,e),e.add(t)}function zy(t,e,n){zpe(t,e),e.set(t,n)}function zpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yg(t,e,n){var r=Ype(t,e,"set");return rnt(t,r,n),n}function rnt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function cn(t,e){var n=Ype(t,e,"get");return int(t,n)}function Ype(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function int(t,e){return e.get?e.get.call(t):e.value}function Yy(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ot.getSingleton().register("beforeRowMove");ot.getSingleton().register("afterRowMove");var MP="manualRowMove",qpe=140,Vpe="ht__manualRowMove",OP="show-ui",pj="on-moving--rows",gj="after-selection--rows",js=new WeakMap,gm=new WeakMap,mh=new WeakMap,vm=new WeakMap,ma=new WeakMap,AP=new WeakMap,Bpe=new WeakSet,Upe=new WeakSet,Wpe=new WeakSet,jpe=new WeakSet,$pe=new WeakSet,Gpe=new WeakSet,qb=class extends Dt{constructor(){super(...arguments),Gy(this,Gpe),Gy(this,$pe),Gy(this,jpe),Gy(this,Wpe),Gy(this,Upe),Gy(this,Bpe),zy(this,js,{writable:!0,value:new Lpe(this.hot)}),zy(this,gm,{writable:!0,value:new Hpe(this.hot)}),zy(this,mh,{writable:!0,value:[]}),zy(this,vm,{writable:!0,value:void 0}),zy(this,ma,{writable:!0,value:{}}),zy(this,AP,{writable:!0,value:void 0})}static get PLUGIN_KEY(){return MP}static get PLUGIN_PRIORITY(){return qpe}isEnabled(){return!!this.hot.getSettings()[MP]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yy(e,Bpe,ont).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yy(e,Wpe,ant).call(e,...r)}),this.addHook("afterScrollHorizontally",()=>Yy(this,$pe,cnt).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Yy(e,Gpe,unt).call(e,...r)}),this.buildPluginUI(),this.registerEvents(),Ne(this.hot.rootElement,Vpe),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){bt(this.hot.rootElement,Vpe),this.unregisterEvents(),cn(this,js).destroy(),cn(this,gm).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){let r=cn(this,AP),i=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,r,i);if(Yg(this,AP,void 0),o===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,n);let s=i&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,r,i,s),s}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){let r=this.countFinalIndex(e,n);return Yg(this,AP,n),this.moveRows(e,r)}isMovePossible(e,n){let r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+n>r,o=n<0,s=e.some(l=>l<0),a=e.some(l=>l>=r);return!(i||o||s||a)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}countFinalIndex(e,n){let r=or(e,(i,o)=>(o<n&&(i+=1),i),0);return n-r}getRowsHeight(e,n){let r=this.hot.rowIndexMapper,i=0;for(let o=e;o<=n;o++){let s=r.getRenderableFromVisualIndex(o);s!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(s)||23)}return i}moveBySettingsOrLoad(){let e=this.hot.getSettings()[MP];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){let n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){let e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){let e=this.hot.getSelectedRangeLast(),n=[];if(!e)return n;let{from:r,to:i}=e,o=Math.min(r.row,i.row),s=Math.max(r.row,i.row);return st(o,s,a=>{n.push(a)}),n}refreshPositions(){let e=cn(this,ma).coords,n=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&r<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);let o=this.hot.view._wt.wtTable,s=cn(this,ma).TD,a=this.hot.rootElement,l=vr(a),c=gc(a),u=o.holder.scrollTop,d=this.hot.rootWindow!==c?c.scrollTop:0,h=l.top-d,f=cn(this,ma).eventPageY-h+u,p=o.hider.offsetHeight,g=o.TBODY.offsetTop,w=cn(this,js).getOffset().top,_=cn(this,js).getSize().height,S=s.offsetHeight/2,x=s.offsetHeight,P=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1),k=f>=P+S;this.isFixedRowTop(e.row)&&(P+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?cn(this,ma).row=n>0?n-1:n:k?(cn(this,ma).row=e.row+1,P+=e.row===0?x-1:x):cn(this,ma).row=e.row;let b=f,C=P;f+_+w>=p?b=p-_-w:f+w<g&&(b=g+Math.abs(w)),P>=p-1&&(C=p-1),cn(this,js).setPosition(b),cn(this,gm).setPosition(C)}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Yy(this,Upe,snt).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Yy(this,jpe,lnt).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){cn(this,js).build(),cn(this,gm).build()}destroy(){cn(this,js).destroy(),cn(this,gm).destroy(),super.destroy()}};function ont(t,e,n,r){let{wtTable:i,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!s||cn(this,vm)||t.button!==0){Yg(this,vm,!1),cn(this,mh).length=0,bt(this.hot.rootElement,[pj,OP]);return}let l=cn(this,gm).isBuilt()&&!cn(this,gm).isAppended(),c=cn(this,js).isBuilt()&&!cn(this,js).isAppended();l&&c&&(cn(this,gm).appendTo(i.hider),cn(this,js).appendTo(i.hider));let{from:u,to:d}=a,h=Math.min(u.row,d.row),f=Math.max(u.row,d.row);if(e.col<0&&e.row>=h&&e.row<=f){r.row=!0,Yg(this,vm,!0),cn(this,ma).eventPageY=t.pageY,cn(this,ma).coords=e,cn(this,ma).TD=n,Yg(this,mh,this.prepareRowsToMoving());let p=i.holder.scrollLeft+o.getRowHeaderWidth(),g=this.getRowsHeight(h,e.row-1)+t.offsetY;cn(this,js).setPosition(null,p),cn(this,js).setSize(i.hider.offsetWidth-p,this.getRowsHeight(h,f)),cn(this,js).setOffset(-g,null),Ne(this.hot.rootElement,pj),this.refreshPositions()}else bt(this.hot.rootElement,gj),Yg(this,vm,!1),cn(this,mh).length=0}function snt(t){cn(this,vm)&&(cn(this,ma).eventPageY=t.pageY,this.refreshPositions())}function ant(t,e,n,r){!this.hot.getSelectedRangeLast()||!cn(this,vm)||(cn(this,mh).indexOf(e.row)>-1?bt(this.hot.rootElement,OP):Ne(this.hot.rootElement,OP),r.row=!0,r.column=!0,r.cell=!0,cn(this,ma).coords=e,cn(this,ma).TD=n)}function lnt(){let t=cn(this,ma).row,e=cn(this,mh).length;if(Yg(this,vm,!1),bt(this.hot.rootElement,[pj,OP,gj]),this.hot.selection.isSelectedByRowHeader()&&Ne(this.hot.rootElement,gj),e<1||t===void 0)return;let n=cn(this,mh)[0],r=this.hot.toPhysicalRow(n),i=this.dragRows(cn(this,mh),t);if(cn(this,mh).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize(!0);let o=this.hot.toVisualRow(r),s=o+e-1;this.hot.selectRows(o,s)}}function cnt(){let t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,r=e+n;cn(this,js).setPosition(null,r),cn(this,js).setSize(t.hider.offsetWidth-r)}function unt(){this.moveBySettingsOrLoad()}var fQt=Q(ze(),1),mQt=Q(De(),1);function qg(t,e){rge(t,e),e.add(t)}function gs(t,e,n){rge(t,e),e.set(t,n)}function rge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kg(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}function ii(t,e,n){var r=ige(t,e,"set");return dnt(t,r,n),n}function dnt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ct(t,e){var n=ige(t,e,"get");return hnt(t,n)}function ige(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function hnt(t,e){return e.get?e.get.call(t):e.value}var Qb="manualRowResize",oge=30,Kpe="manualRowHeights",$u=new WeakMap,NP=new WeakMap,Wa=new WeakMap,kP=new WeakMap,wm=new WeakMap,vj=new WeakMap,qy=new WeakMap,PP=new WeakMap,$s=new WeakMap,ju=new WeakMap,Xg=new WeakMap,FP=new WeakMap,Kb=new WeakMap,Xb=new WeakMap,Lc=new WeakMap,Zb=new WeakMap,Xpe=new WeakSet,Zpe=new WeakSet,Qpe=new WeakSet,Jpe=new WeakSet,ege=new WeakSet,tge=new WeakSet,nge=new WeakSet,Jb=class extends Dt{static get PLUGIN_KEY(){return Qb}static get PLUGIN_PRIORITY(){return oge}constructor(e){super(e),qg(this,nge),qg(this,tge),qg(this,ege),qg(this,Jpe),qg(this,Qpe),qg(this,Zpe),qg(this,Xpe),gs(this,$u,{writable:!0,value:null}),gs(this,NP,{writable:!0,value:null}),gs(this,Wa,{writable:!0,value:[]}),gs(this,kP,{writable:!0,value:null}),gs(this,wm,{writable:!0,value:null}),gs(this,vj,{writable:!0,value:null}),gs(this,qy,{writable:!0,value:null}),gs(this,PP,{writable:!0,value:null}),gs(this,$s,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),gs(this,ju,{writable:!0,value:this.hot.rootDocument.createElement("DIV")}),gs(this,Xg,{writable:!0,value:!1}),gs(this,FP,{writable:!0,value:!1}),gs(this,Kb,{writable:!0,value:0}),gs(this,Xb,{writable:!0,value:null}),gs(this,Lc,{writable:!0,value:void 0}),gs(this,Zb,{writable:!0,value:void 0}),Ne(Ct(this,$s),"manualRowResizer"),Ne(Ct(this,ju),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[Qb]}enablePlugin(){this.enabled||(ii(this,Lc,new xo),Ct(this,Lc).addLocalHook("init",()=>Kg(this,nge,ynt).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ct(this,Lc)),this.addHook("modifyRowHeight",(e,n)=>Kg(this,tge,wnt).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){ii(this,Zb,Ct(this,Lc).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",Kpe,Ct(this,Lc).getValues())}loadManualRowHeights(){let e={};return this.hot.runHooks("persistentStateLoad",Kpe,e),e.value}setManualSize(e,n){let r=this.hot.toPhysicalRow(e),i=Math.max(n,pw.DEFAULT_HEIGHT);return Ct(this,Lc).setValueAtIndex(r,i),i}setupHandlePosition(e){ii(this,$u,e);let{view:n}=this.hot,{_wt:r}=n,i=r.wtTable.getCoords(Ct(this,$u)),o=i.row;if(o<0)return;let s=pn(Ct(this,$u)),a=Ct(this,$u).getBoundingClientRect(),l=o<r.getSetting("fixedRowsTop"),c=o>=n.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom"),u;l?u=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ct(this,$u),i.row,i.col):c&&(u=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Ct(this,$u),i.row,i.col)),u||(u=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Ct(this,$u),i.row,i.col)),ii(this,NP,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),ii(this,Wa,[]);let d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&d){let h=this.hot.getSelectedRange();Z(h,f=>{let p=f.getTopStartCorner().row,g=f.getBottomStartCorner().row;st(p,g,w=>{Ct(this,Wa).includes(w)||Ct(this,Wa).push(w)})})}Ct(this,Wa).includes(Ct(this,NP))||ii(this,Wa,[Ct(this,NP)]),ii(this,PP,u.top-6),ii(this,qy,parseInt(a.height,10)),Ct(this,$s).style.top=`${Ct(this,PP)+Ct(this,qy)}px`,Ct(this,$s).style[this.inlineDir]=`${u.start}px`,Ct(this,$s).style.width=`${s}px`,this.hot.rootElement.appendChild(Ct(this,$s))}refreshHandlePosition(){Ct(this,$s).style.top=`${Ct(this,PP)+Ct(this,kP)}px`}setupGuidePosition(){let e=parseInt(pn(Ct(this,$s)),10),n=parseInt(Ct(this,$s).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);Ne(Ct(this,$s),"active"),Ne(Ct(this,ju),"active"),Ct(this,ju).style.top=Ct(this,$s).style.top,Ct(this,ju).style[this.inlineDir]=`${n}px`,Ct(this,ju).style.width=`${r-e}px`,this.hot.rootElement.appendChild(Ct(this,ju))}refreshGuidePosition(){Ct(this,ju).style.top=Ct(this,$s).style.top}hideHandleAndGuide(){bt(Ct(this,$s),"active"),bt(Ct(this,ju),"active")}checkIfRowHeader(e){var n;return mc(e,["TH"],this.hot.rootElement)&&((n=e.parentNode)===null||n===void 0||(n=n.parentNode)===null||n===void 0?void 0:n.tagName)==="TBODY"}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){let n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&Ct(this,wm)<n?n:Ct(this,wm)}afterMouseDownTimeout(){let e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},n=(r,i)=>{let o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!0);o!==void 0&&ii(this,wm,o),this.setManualSize(r,Ct(this,wm)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!0),i&&e()};Ct(this,Kb)>=2&&(Ct(this,Wa).length>1?(Z(Ct(this,Wa),i=>{n(i)}),e()):Z(Ct(this,Wa),i=>{n(i,!0)})),ii(this,Kb,0),ii(this,Xb,null)}bindEvents(){let{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",r=>Kg(this,Xpe,fnt).call(this,r)),this.eventManager.addEventListener(e,"mousedown",r=>Kg(this,Zpe,mnt).call(this,r)),this.eventManager.addEventListener(n,"mousemove",r=>Kg(this,Qpe,pnt).call(this,r)),this.eventManager.addEventListener(n,"mouseup",()=>Kg(this,Jpe,gnt).call(this)),this.eventManager.addEventListener(Ct(this,$s),"contextmenu",()=>Kg(this,ege,vnt).call(this))}destroy(){super.destroy()}};function fnt(t){if(!wM(t.target)&&Ct(this,FP)!==!0&&this.checkIfRowHeader(t.target)){let e=this.getClosestTHParent(t.target);e&&(Ct(this,Xg)||this.setupHandlePosition(e))}}function mnt(t){St(t.target,"manualRowResizer")&&(this.setupHandlePosition(Ct(this,$u)),this.setupGuidePosition(),ii(this,Xg,!0),Ct(this,Xb)===null&&(ii(this,Xb,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ct(this,Xb))),ii(this,Kb,Ct(this,Kb)+1),ii(this,vj,t.pageY),ii(this,wm,Ct(this,qy)))}function pnt(t){Ct(this,Xg)&&(ii(this,kP,Ct(this,qy)+(t.pageY-Ct(this,vj))),Z(Ct(this,Wa),e=>{ii(this,wm,this.setManualSize(e,Ct(this,kP)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function gnt(){let t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize(!0)},e=(n,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),r&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};Ct(this,Xg)&&(this.hideHandleAndGuide(),ii(this,Xg,!1),Ct(this,wm)!==Ct(this,qy)&&(Ct(this,Wa).length>1?(Z(Ct(this,Wa),r=>{e(r)}),t()):Z(Ct(this,Wa),r=>{e(r,!0)})),this.setupHandlePosition(Ct(this,$u)))}function vnt(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ct(this,$s)),this.hot.rootElement.removeChild(Ct(this,ju)),ii(this,Xg,!1),ii(this,FP,!0),this.hot._registerImmediate(()=>{ii(this,FP,!1)})}function wnt(t,e){let n=t;if(this.enabled){let r=this.hot.toPhysicalRow(e),i=Ct(this,Lc).getValueAtIndex(r);this.hot.getSettings()[Qb]&&i&&(n=i)}return n}function ynt(){let t=this.hot.getSettings()[Qb],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,r)=>{Ct(this,Lc).setValueAtIndex(r,n)}):Array.isArray(t)?(t.forEach((n,r)=>{Ct(this,Lc).setValueAtIndex(r,n)}),ii(this,Zb,t)):t===!0&&Array.isArray(Ct(this,Zb))&&Ct(this,Zb).forEach((n,r)=>{Ct(this,Lc).setValueAtIndex(r,n)})},!0)}var zQt=Q(ze(),1),YQt=Q(De(),1);var DQt=Q(ze(),1),IQt=Q(De(),1);var xQt=Q(De(),1);function Zg(t,e,n){return e=_nt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _nt(t){var e=Cnt(t,"string");return typeof e=="symbol"?e:String(e)}function Cnt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wj=class{constructor(e,n,r,i,o,s){Zg(this,"row",void 0),Zg(this,"col",void 0),Zg(this,"rowspan",void 0),Zg(this,"colspan",void 0),Zg(this,"removed",!1),Zg(this,"cellCoordsFactory",void 0),Zg(this,"cellRangeFactory",void 0),this.row=e,this.col=n,this.rowspan=r,this.colspan=i,this.cellCoordsFactory=o,this.cellRangeFactory=s}static NEGATIVE_VALUES_WARNING(e){return Qt`The merged cell declared with {row: ${e.row}, col: ${e.col},\x20
      rowspan: ${e.rowspan}, colspan: ${e.colspan}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){return Qt`The merged cell declared at [${e.row}, ${e.col}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){return Qt`The merged cell declared at [${e.row}, ${e.col}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){return Qt`The merged cell declared at [${e.row}, ${e.col}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){return e.row<0||e.col<0||e.rowspan<0||e.colspan<0}static isSingleCell(e){return e.colspan===1&&e.rowspan===1}static containsZeroSpan(e){return e.colspan===0||e.rowspan===0}static isOutOfBounds(e,n,r){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=r||e.col+e.colspan-1>=r}normalize(e){let n=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){let r=e[0]||e[1],i=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",s=e[0]?"col":"row",a=Math.min(n,i),l=Math.max(n,i),c=this[s],u=this[s]+this[o]-1;if(c>=n&&(this[s]+=r),r>0)n<=u&&n>c&&(this[o]+=r);else if(r<0){if(a<=c&&l>=u)return this.removed=!0,!1;if(c>=a&&c<=l){let d=l-c+1,h=Math.abs(r)-d;this[s]-=h+r,this[o]-=d}else if(c<=a&&u>=l)this[o]+=r;else if(c<=a&&u>=a&&u<l){let d=u-a+1;this[o]-=d}}return!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))}},ja=wj;function eT(t,e,n,r){e?e.row===n&&e.col===r?(t.setAttribute("rowspan",e.rowspan.toString()),t.setAttribute("colspan",e.colspan.toString())):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none"):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="")}function yj(t,e,n){return e=Snt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Snt(t){var e=Ent(t,"string");return typeof e=="symbol"?e:String(e)}function Ent(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var _j=class t{constructor(e){yj(this,"plugin",void 0),yj(this,"mergedCells",[]),yj(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){return Qt`The merged cell declared at [${e.row}, ${e.col}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){let r=this.mergedCells,i=!1;return Z(r,o=>o.row<=e&&o.row+o.rowspan-1>=e&&o.col<=n&&o.col+o.colspan-1>=n?(i=o,!1):!0),i}getByRange(e){let n=this.mergedCells,r=!1;return Z(n,i=>i.row<=e.from.row&&i.row+i.rowspan-1>=e.to.row&&i.col<=e.from.col&&i.col+i.colspan-1>=e.to.col?(r=i,r):!0),r}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=this.mergedCells,i=[],o=e;if(!o.includesRange){let s=this.hot._createCellCoords(o.from.row,o.from.col),a=this.hot._createCellCoords(o.to.row,o.to.col);o=this.hot._createCellRange(s,s,a)}return Z(r,s=>{let a=this.hot._createCellCoords(s.row,s.col),l=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1),c=this.hot._createCellRange(a,a,l);n?o.overlaps(c)&&i.push(s):o.includesRange(c)&&i.push(s)}),i.length?i:!1}add(e){let n=this.mergedCells,r=e.row,i=e.col,o=e.rowspan,s=e.colspan,a=new ja(r,i,o,s,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(r,i),c=this.isOverlapping(a);return!l&&!c?(this.hot&&a.normalize(this.hot),n.push(a),a):(Sn(t.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){let r=this.mergedCells,i=this.get(e,n),o=i?this.mergedCells.indexOf(i):-1;return i&&o!==-1?(r.splice(o,1),i):!1}clear(){let e=this.mergedCells,n=[],r=[];Z(e,i=>{let o=this.hot.getCell(i.row,i.col);o&&n.push([o,this.get(i.row,i.col),i.row,i.col])}),this.mergedCells.length=0,Z(n,(i,o)=>{st(0,i.rowspan-1,s=>{st(0,i.colspan-1,a=>{if(a!==0||s!==0){let l=this.hot.getCell(i.row+s,i.col+a);l&&r.push([l,null,null,null])}})}),n[o][1]=null}),Z(n,i=>{eT(...i)}),Z(r,i=>{eT(...i)})}isOverlapping(e){let n=this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(e.row,e.col),this.hot._createCellCoords(e.row+e.rowspan-1,e.col+e.colspan-1)),r=!1;return Z(this.mergedCells,i=>this.hot._createCellRange(this.hot._createCellCoords(0,0),this.hot._createCellCoords(i.row,i.col),this.hot._createCellCoords(i.row+i.rowspan-1,i.col+i.colspan-1)).overlaps(n)?(r=!0,!1):!0),r}isFirstRenderableMergedCell(e,n){let r=this.get(e,n);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===n}getFirstRenderableCoords(e,n){let r=this.get(e,n);if(!r||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);let i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(i,o)}shiftCollections(e,n,r){let i=[0,0];switch(e){case"right":i[0]+=r;break;case"left":i[0]-=r;break;case"down":i[1]+=r;break;case"up":i[1]-=r;break;default:}Z(this.mergedCells,o=>{o.shift(i,n)}),DS(this.mergedCells.length-1,0,o=>{let s=this.mergedCells[o];s&&s.removed&&this.mergedCells.splice(this.mergedCells.indexOf(s),1)})}},sge=_j;var LQt=Q(De(),1);function Cj(t,e,n){return e=xnt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xnt(t){var e=bnt(t,"string");return typeof e=="symbol"?e:String(e)}function bnt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Sj=class{constructor(e){Cj(this,"plugin",void 0),Cj(this,"mergedCellsCollection",void 0),Cj(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){let n=this.mergedCellsCollection.get(e[0],e[1]);n&&(e[2]=e[0]+n.rowspan-1,e[3]=e[1]+n.colspan-1)}}getDirection(e,n){let r=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?r="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?r="up":n[1]===e[1]&&n[2]===e[2]?r="right":r="left",r}snapDragArea(e,n,r,i){let o=n.slice(0),s=this.getAutofillSize(e,n,r),[a,l,c,u]=e,h=["up","down"].indexOf(r)>-1?c-a+1:u-l+1,f=Math.floor(s/h)*h,p=s-f,g=this.getFarthestCollection(e,n,r,i);if(g){if(r==="down"){let w=g.row+g.rowspan-a-p;o[2]+w>=this.plugin.hot.countRows()?o[2]-=p:o[2]+=p?w:0}else if(r==="right"){let w=g.col+g.colspan-l-p;o[3]+w>=this.plugin.hot.countCols()?o[3]-=p:o[3]+=p?w:0}else if(r==="up"){let w=c-p-g.row+1;o[0]+w<0?o[0]+=p:o[0]-=p?w:0}else if(r==="left"){let w=u-p-g.col+1;o[1]+w<0?o[1]+=p:o[1]-=p?w:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:i,fillSize:s,dragArea:o,cycleLength:h}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Ln(this.currentFillData,e)}getAutofillSize(e,n,r){let[i,o,s,a]=e,[l,c,u,d]=n;switch(r){case"up":return i-l;case"down":return u-s;case"left":return o-c;case"right":return d-a;default:return null}}getDragArea(e,n,r){let[i,o,s,a]=e,[l,c,u,d]=n;switch(r){case"up":return[l,c,i-1,a];case"down":return[s+1,o,u,a];case"left":return[l,c,s,o-1];case"right":return[i,a+1,u,d];default:return null}}getFarthestCollection(e,n,r,i){let[o,s,a,l]=e,c=["up","down"].indexOf(r)>-1,u=c?a:l,d=c?o:s,h=this.getAutofillSize(e,n,r),f=c?a-o+1:l-s+1,p=Math.floor(h/f)*f,g=h-p,w=null,_=null,S=null;switch(r){case"up":w="includesVertically",S=u-g+1;break;case"left":w="includesHorizontally",S=u-g+1;break;case"down":w="includesVertically",S=d+g-1;break;case"right":w="includesHorizontally",S=d+g-1;break;default:}return Z(i,x=>{x[w](S)&&x.isFarther(_,r)&&(_=x)}),_}recreateAfterDataPopulation(e){if(!this.currentFillData)return;let n=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,o=(c,u)=>{switch(i){case"up":return c.row-u>=n.from.row;case"down":return c.row+c.rowspan-1+u<=n.to.row;case"left":return c.col-u>=n.from.column;case"right":return c.col+c.colspan-1+u<=n.to.column;default:return null}},s=0,a=null,l=1;do for(let c=0;c<r.length;c+=1){if(a=r[c],s=l*this.currentFillData.cycleLength,o(a,s))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+s,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-s,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+s,colspan:a.colspan});break;default:}c===r.length-1&&(l+=1)}while(o(a,s));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){let n={min:null,max:null},r={min:null,max:null};return Z(e,i=>{let o=i[0],s=this.plugin.hot.propToCol(i[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s)}),{from:{row:n.min,column:r.min},to:{row:n.max,column:r.max}}}dragAreaOverlapsCollections(e,n,r){let i=this.getDragArea(e,n,r),[o,s,a,l]=i,c=this.plugin.hot._createCellCoords(o,s),u=this.plugin.hot._createCellCoords(a,l),d=this.plugin.hot._createCellRange(c,c,u);return!!this.mergedCellsCollection.getWithinRange(d,!0)}},age=Sj;var UQt=Q(ze(),1),WQt=Q(De(),1);function Ej(t,e,n){return e=Tnt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tnt(t){var e=Rnt(t,"string");return typeof e=="symbol"?e:String(e)}function Rnt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xj=class{constructor(e){Ej(this,"plugin",void 0),Ej(this,"hot",void 0),Ej(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}snapDelta(e,n,r){let i=n.to,o=i.row+e.row,s=i.col+e.col;e.row?this.jumpOverMergedCell(e,r,o):e.col&&this.jumpOverMergedCell(e,r,s)}jumpOverMergedCell(e,n,r){let i=e.row||e.col,o=null,s=null,a=null;e.row?(o=n.includesVertically(r),s=n.row,a=n.getLastRow()):e.col&&(o=n.includesHorizontally(r),s=n.col,a=n.getLastColumn()),i!==0&&(i>0?o&&r!==s&&(i+=a-r+1):o&&r!==a&&(i-=r-s+1),e.row?e.row=i:e.col&&(e.col=i))}getUpdatedSelectionRange(e,n){return this.hot._createCellRange(e.highlight,e.from,this.hot._createCellCoords(e.to.row+n.row,e.to.col+n.col))}getSelectedMergedCellClassName(e,n,r,i){let o=Math.min(r[0],r[2]),s=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;let u=this.plugin.mergedCellsCollection.get(e,n);if(!u)return;let d=u.getLastRow(),h=u.getLastColumn();if(o<=u.row&&s<=u.col&&a>=d&&l>=h)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.plugin.selectionCalculations.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){let r=[];if(!n||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let o=0;o<e.colspan;o+=1)r.push(this.hot._createCellCoords(e.row+i,e.col+o));for(let i=0;i<r.length;i+=1){let o=[];for(let s=0;s<n.length;s+=1)o[s]=n[s].includes(r[i]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){let e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}},lge=xj;function bj(t){return{key:"mergeCells",name(){let e=this.getSelectedLast();if(e){let n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(wE)}return this.getTranslatedPhrase(vE)},callback(){t.toggleMergeOnSelection()},disabled(){let e=this.getSelectedLast();return e?ja.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Ci(t,e){Oge(t,e),e.add(t)}function Dnt(t,e,n){Oge(t,e),e.set(t,n)}function Oge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tj(t,e,n){return e=Int(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Int(t){var e=Ant(t,"string");return typeof e=="symbol"?e:String(e)}function Ant(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rj(t,e,n){var r=Nge(t,e,"set");return Mnt(t,r,n),n}function Mnt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Ky(t,e){var n=Nge(t,e,"get");return Ont(t,n)}function Nge(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Ont(t,e){return e.get?e.get.call(t):e.value}function oi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}ot.getSingleton().register("beforeMergeCells");ot.getSingleton().register("afterMergeCells");ot.getSingleton().register("beforeUnmergeCells");ot.getSingleton().register("afterUnmergeCells");var Xy="mergeCells",Pge=150,cge=Xy,Gu=new WeakMap,uge=new WeakSet,dge=new WeakSet,hge=new WeakSet,fge=new WeakSet,mge=new WeakSet,pge=new WeakSet,gge=new WeakSet,Dj=new WeakSet,vge=new WeakSet,wge=new WeakSet,yge=new WeakSet,_ge=new WeakSet,Cge=new WeakSet,Sge=new WeakSet,Ege=new WeakSet,xge=new WeakSet,bge=new WeakSet,Tge=new WeakSet,Rge=new WeakSet,Dge=new WeakSet,Ige=new WeakSet,Age=new WeakSet,tT=class extends Dt{constructor(){super(...arguments),Ci(this,Age),Ci(this,Ige),Ci(this,Dge),Ci(this,Rge),Ci(this,Tge),Ci(this,bge),Ci(this,xge),Ci(this,Ege),Ci(this,Sge),Ci(this,Cge),Ci(this,_ge),Ci(this,yge),Ci(this,wge),Ci(this,vge),Ci(this,Dj),Ci(this,gge),Ci(this,pge),Ci(this,mge),Ci(this,fge),Ci(this,hge),Ci(this,dge),Ci(this,uge),Tj(this,"mergedCellsCollection",null),Tj(this,"autofillCalculations",null),Tj(this,"selectionCalculations",null),Dnt(this,Gu,{writable:!0,value:null})}static get PLUGIN_KEY(){return Xy}static get PLUGIN_PRIORITY(){return Pge}isEnabled(){return!!this.hot.getSettings()[Xy]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new sge(this),this.autofillCalculations=new age(this),this.selectionCalculations=new lge(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,uge,Nnt).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,hge,knt).call(e,...r)}),this.addHook("afterModifyTransformStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Dge,Znt).call(e,...r)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,fge,Fnt).call(e,...r)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,mge,Lnt).call(e,...r)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Dj,Mge).call(e,...r)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Dj,Mge).call(e,...r)}),this.addHook("beforeSetRangeEnd",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,vge,Bnt).call(e,...r)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,dge,Pnt).call(e,...r)}),this.addHook("afterRenderer",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,gge,Vnt).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,pge,Hnt).call(e,...r)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,wge,Unt).call(e,...r)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,yge,Wnt).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,_ge,jnt).call(e,...r)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Cge,$nt).call(e,...r)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Sge,Gnt).call(e,...r)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Ege,znt).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,xge,Ynt).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,bge,qnt).call(e,...r)}),this.addHook("afterChange",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Tge,Knt).call(e,...r)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Rge,Xnt).call(e,...r)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Ige,Qnt).call(e,...r)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return oi(e,Age,Jnt).call(e,...r)}),this.addHook("beforeUndoStackChange",(n,r)=>{if(r==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){let e=this.hot.getSettings()[Xy];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!EM())return;let e=[],n=[];this.mergedCellsCollection.mergedCells.forEach(r=>{let{row:i,rowspan:o}=r;for(let s=i+1;s<i+o;s++)n.push(s)}),n=[...new Set(n)],n.forEach(r=>{let i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(r);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{let s=o.getRow(i);s&&(s.style.background=Df(s,"backgroundColor").replace(")",", 0.99)"),e.push(s))})}),this.hot._registerTimeout(()=>{e.forEach(r=>{r.style.background=Df(r,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){let n=!0;return e?(ja.containsNegativeValues(e)?(Sn(ja.NEGATIVE_VALUES_WARNING(e)),n=!1):ja.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Sn(ja.IS_OUT_OF_BOUNDS_WARNING(e)),n=!1):ja.isSingleCell(e)?(Sn(ja.IS_SINGLE_CELL(e)),n=!1):ja.containsZeroSpan(e)&&(Sn(ja.ZERO_SPAN_WARNING(e)),n=!1),n):!1}generateFromSettings(e){if(Array.isArray(e)){let n=[];if(Z(e,r=>{if(!this.validateSetting(r))return;let i=this.hot._createCellCoords(r.row,r.col),o=this.hot._createCellCoords(r.row+r.rowspan-1,r.col+r.colspan-1),s=this.hot._createCellRange(i,i,o);this.mergeRange(s,!0,!0),st(r.row,r.row+r.rowspan-1,a=>{st(r.col,r.col+r.colspan-1,l=>{a===r.row&&l===r.col||n.push([a,l,null])})})}),n.length===0)return;this.hot.setDataAtCell(n)}}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}toggleMergeOnSelection(){let e=this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:n,to:r}=e;this.toggleMerge(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:n,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;let{from:n,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,r.row,r.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=e.getTopStartCorner(),o=e.getBottomEndCorner(),s={row:i.row,col:i.col,rowspan:o.row-i.row+1,colspan:o.col-i.col+1},a=[],l=null;return this.canMergeRange(s,n)?(this.hot.runHooks("beforeMergeCells",e,n),st(0,s.rowspan-1,u=>{st(0,s.colspan-1,d=>{let h=null;a[u]||(a[u]=[]),u===0&&d===0?h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s.row),this.hot.toPhysicalColumn(s.col)):this.hot.setCellMeta(s.row+u,s.col+d,"hidden",!0),a[u][d]=h})}),this.hot.setCellMeta(s.row,s.col,"spanned",!0),this.mergedCellsCollection.add(s)?(r?l=[s.row,s.col,a]:this.hot.populateFromArray(s.row,s.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,s,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=this.mergedCellsCollection.getWithinRange(e);r&&(this.hot.runHooks("beforeUnmergeCells",e,n),Z(r,i=>{this.mergedCellsCollection.remove(i.row,i.col),st(0,i.rowspan-1,o=>{st(0,i.colspan-1,s=>{this.hot.removeCellMeta(i.row+o,i.col+s,"hidden"),this.hot.removeCellMeta(i.row+o,i.col+s,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){let n=this.mergedCellsCollection.get(e.from.row,e.from.col);n.row===e.from.row&&n.col===e.from.col&&n.row+n.rowspan-1===e.to.row&&n.col+n.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,r,i){let o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.mergeRange(this.hot._createCellRange(o,o,s))}unmerge(e,n,r,i){let o=this.hot._createCellCoords(e,n),s=this.hot._createCellCoords(r,i);this.unmergeRange(this.hot._createCellRange(o,o,s))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{let r=this.hot.getSelectedRangeLast();r&&!r.isSingleHeader()&&(this.toggleMerge(r),this.hot.render())},runOnlyIf:r=>!r.altKey,group:cge})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cge)}modifyViewportRowStart(e,n){let r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){let s=this.mergedCellsCollection.get(i,o);if(Tt(s)){let a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){let r=this.hot.rowIndexMapper,i=r.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){let s=this.mergedCellsCollection.get(i,o);if(Tt(s)){let a=s.row+s.rowspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){let r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){let s=this.mergedCellsCollection.get(o,i);if(Tt(s)){let a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){let r=this.hot.columnIndexMapper,i=r.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){let s=this.mergedCellsCollection.get(o,i);if(Tt(s)){let a=s.col+s.colspan-1,l=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,r,i){let{rowIndexMapper:o,columnIndexMapper:s}=this.hot,a,l;n===0?a=o.getNearestNotHiddenIndex(e,1):a=o.getNearestNotHiddenIndex(e+n-1,-1),i===0?l=s.getNearestNotHiddenIndex(r,1):l=s.getNearestNotHiddenIndex(r+i-1,-1);let c=e>=0?o.getRenderableFromVisualIndex(a):e,u=r>=0?s.getRenderableFromVisualIndex(l):r;return[c,u]}};function Nnt(){this.generateFromSettings(this.hot.getSettings()[Xy]),this.hot.render()}function Pnt(t){if(t){let e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeLast();for(let r=0;r<e.length;r+=1)if(n.from.row===e[r].row&&n.from.col===e[r].col&&n.to.row===e[r].row+e[r].rowspan-1&&n.to.col===e[r].col+e[r].colspan-1)return!1}return t}function knt(t){let e=this.hot.getSelectedRangeLast(),n={row:t.row,col:t.col},r=null,i=this.hot._createCellCoords(e.highlight.row,e.highlight.col),o=this.mergedCellsCollection.get(i.row,i.col);if(Ky(this,Gu)||Rj(this,Gu,this.hot._createCellCoords(null,null)),o){let a=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);this.hot._createCellRange(a,a,l).includes(Ky(this,Gu))||Rj(this,Gu,this.hot._createCellCoords(null,null)),n.row=Ky(this,Gu).row?Ky(this,Gu).row-i.row:n.row,n.col=Ky(this,Gu).col?Ky(this,Gu).col-i.col:n.col,t.row>0?n.row=o.row+o.rowspan-1-i.row+t.row:t.row<0&&(n.row=i.row-o.row+t.row),t.col>0?n.col=o.col+o.colspan-1-i.col+t.col:t.col<0&&(n.col=i.col-o.col+t.col)}r=this.hot._createCellCoords(e.highlight.row+n.row,e.highlight.col+n.col);let s=this.mergedCellsCollection.get(r.row,r.col);if(s){let a=this.mergedCellsCollection.getFirstRenderableCoords(s.row,s.col);Rj(this,Gu,r),n={row:a.row-i.row,col:a.col-i.col}}n.row!==0&&(t.row=n.row),n.col!==0&&(t.col=n.col)}function Fnt(t){let e=this.hot.getSelectedRangeLast(),n=$r(t),r=this.selectionCalculations.getUpdatedSelectionRange(e,t),i=$r(n),o=this.mergedCellsCollection.getWithinRange(r,!0);do i=$r(n),this.selectionCalculations.getUpdatedSelectionRange(e,n),Z(o,s=>{this.selectionCalculations.snapDelta(n,e,s)});while(n.row!==i.row||n.col!==i.col);t.row=n.row,t.col=n.col}function Lnt(t,e){if(t<0||e<0)return;let n=this.mergedCellsCollection.get(t,e);if(!n)return;let{row:r,col:i,colspan:o,rowspan:s}=n;return[r,i,r+s-1,i+o-1]}function Hnt(t){t.items.push({name:"---------"},bj(this))}function Vnt(t,e,n){let r=this.mergedCellsCollection.get(e,n),i=Tt(r)?$r(r):void 0;if(Tt(i)){let{rowIndexMapper:o,columnIndexMapper:s}=this.hot,{row:a,col:l,colspan:c,rowspan:u}=i,[d,h]=this.translateMergedCellToRenderable(a,u,l,c),f=o.getRenderableFromVisualIndex(e),p=s.getRenderableFromVisualIndex(n),g=d-f+1,w=h-p+1;i.row=o.getNearestNotHiddenIndex(i.row,1),i.col=s.getNearestNotHiddenIndex(i.col,1),i.rowspan=Math.min(i.rowspan,g),i.colspan=Math.min(i.colspan,w)}eT(t,i,e,n)}function Mge(t){if(this.mergedCellsCollection.isFirstRenderableMergedCell(t.row,t.col)){let e=this.mergedCellsCollection.get(t.row,t.col);[t.row,t.col]=[e.row,e.col]}}function Bnt(t){let e=this.hot.getSelectedRangeLast();e.highlight=this.hot._createCellCoords(e.highlight.row,e.highlight.col),e.to=t;let n=!1;if(!(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()))do{n=!1;for(let r=0;r<this.mergedCellsCollection.mergedCells.length;r+=1){let o=this.mergedCellsCollection.mergedCells[r].getRange();e.expandByRange(o)&&(t.row=e.to.row,t.col=e.to.col,n=!0)}}while(n)}function Unt(t,e,n){let r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?n.copyable=!1:(n.rowspan=r.rowspan,n.colspan=r.colspan))}function Wnt(t){let e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function jnt(t){let e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function $nt(t,e){this.autofillCalculations.correctSelectionAreaSize(e);let n=this.autofillCalculations.getDirection(e,t),r=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,r,n))return r=e,r;let i=this.mergedCellsCollection.getWithinRange({from:{row:e[0],col:e[1]},to:{row:e[2],col:e[3]}});return i&&(r=this.autofillCalculations.snapDragArea(e,r,n,i)),r}function Gnt(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function znt(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Ynt(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function qnt(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function Knt(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function Xnt(t,e){if(e&&e==="area"){let n=this.hot.getSelectedRangeLast(),r=this.mergedCellsCollection.getWithinRange(n);Z(r,i=>{n.getBottomEndCorner().row===i.getLastRow()&&n.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function Znt(t,e,n){if(!this.enabled)return;let r=this.mergedCellsCollection.get(t.row,t.col);if(!r)return;let i=e>0,o=e<0,s=n<0,a=n>0,l=r.row+r.rowspan-1===this.hot.countRows()-1,c=r.row===0,u=r.col+r.colspan-1===this.hot.countCols()-1,d=r.col===0;(i&&l||o&&c||a&&u||s&&d)&&(t.row=r.row,t.col=r.col)}function Qnt(t,e,n,r){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,r)}function Jnt(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}var wJt=Q(De(),1);function kge(t,e){return function(n,r){let[,...i]=n,[,...o]=r;return function s(a){let l=t[a],c=e[a],u=i[a],d=o[a],h=c.multiColumnSorting,p=(h.compareFunctionFactory?h.compareFunctionFactory:qx(c.type))(l,c,h)(u,d);if(p===fs){let g=a+1;if(typeof e[g]<"u")return s(g)}return p}(0)}}function Ij(){Sn(Qt`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work.`)}var gJt=Q(ze(),1),Fge="sort";function Lge(t,e,n){let r=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${Fge}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}function Hge(t){let e=t.className.split(" "),n=new RegExp(`^${Fge}-[0-9]{1,2}$`);return e.filter(r=>n.test(r))}function ert(t,e,n){return e=trt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function trt(t){var e=nrt(t,"string");return typeof e=="symbol"?e:String(e)}function nrt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nT="multiColumnSorting",Uge=170,Vge="columnSorting",Bge=nT;Yx(nT,kge);var rT=class extends Eg{constructor(){super(...arguments),ert(this,"pluginKey",nT)}static get PLUGIN_KEY(){return nT}static get PLUGIN_PRIORITY(){return Uge}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Vge]&&Ij(),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,oy))},runOnlyIf:()=>{var e;let n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:Bge})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Bge)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];super.updateHeaderClasses(e,...r),bt(e,Hge(e)),this.enabled!==!1&&Ne(e,Lge(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[Vge]&&Ij(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,n){zx(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,oy))):this.sort(this.getColumnNextConfig(n.col)))}};var IJt=Q(ze(),1),AJt=Q(De(),1);function Wge(t,e,n){return e=rrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rrt(t){var e=irt(t,"string");return typeof e=="symbol"?e:String(e)}function irt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var jge="multipleSelectionHandles",$ge=160,iT=class extends Dt{constructor(){super(...arguments),Wge(this,"dragged",[]),Wge(this,"lastSetCell",null)}static get PLUGIN_KEY(){return jge}static get PLUGIN_PRIORITY(){return $ge}isEnabled(){return Oa()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){let e=this,{rootElement:n}=this.hot;function r(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;let o=e.dragged.indexOf(i);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",i=>{let o;if(St(i.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1;if(St(i.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",i=>{if(St(i.target,"topSelectionHandle-HitArea"))return r.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(St(i.target,"bottomSelectionHandle-HitArea"))return r.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",i=>{let{rootDocument:o}=this.hot,s,a,l,c,u,d;if(e.dragged.length===0)return;let h=o.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!h||h===e.lastSetCell||((h.nodeName==="TD"||h.nodeName==="TH")&&(s=e.hot.getCoords(h),s.col===-1&&(s.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),c=a.getHeight(),u=a.getDirection(),l===1&&c===1&&e.hot.selection.setRangeEnd(s),d=e.getCurrentRangeCoords(a,s,e.touchStartRange.direction,u,e.dragged[0]),d.start!==null&&e.hot.selection.setRangeStart(d.start),e.hot.selection.setRangeEnd(d.end),e.lastSetCell=h),i.preventDefault())})}getCurrentRangeCoords(e,n,r,i,o){let s=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),c=e.getTopEndCorner(),u={start:null,end:null};switch(r){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":o==="top"?u={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:u={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,s.col)};break;case"SE-NW":o==="bottom"&&(u={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,s.col)});break;default:break}break;case"NW-SE":switch(i){case"NE-SW":o==="top"?u={start:n,end:l}:u.end=n;break;case"NW-SE":o==="top"?u={start:n,end:a}:u.end=n;break;case"SE-NW":o==="top"?u={start:n,end:s}:u.end=n;break;case"SW-NE":o==="top"?u={start:n,end:c}:u.end=n;break;default:break}break;case"SW-NE":switch(i){case"NW-SE":o==="bottom"?u={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(l.row,n.col)}:u={start:this.hot._createCellCoords(s.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":o==="top"?u={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:u={start:this.hot._createCellCoords(n.row,s.col),end:this.hot._createCellCoords(s.row,n.col)};break;case"SE-NW":o==="bottom"?u={start:this.hot._createCellCoords(n.row,c.col),end:this.hot._createCellCoords(s.row,n.col)}:o==="top"&&(u={start:l,end:n});break;default:break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(u.end=n);break;case"SE-NW":o==="top"?u.end=n:u={start:n,end:s};break;default:break}break;default:break}return u}isDragged(){return this.dragged.length>0}};var zen=Q(ze(),1),Yen=Q(De(),1);var Nen=Q(ze(),1),Pen=Q(De(),1);var $Jt=Q(De(),1),GJt=Q(ze(),1);var HJt=Q(ze(),1);function oT(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:r=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:a=!1,isPlaceholder:l=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:r,isCollapsed:o,crossHiddenColumns:i,isHidden:s,isRoot:a,isPlaceholder:l}}function LP(){return{label:"",isPlaceholder:!0}}function Gge(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,n=[];if(e===0)return n;Z(t,i=>{let o=[],s=0;n.push(o),Z(i,a=>{let l=oT();if(Tt(a)){let{label:u,colspan:d}=a;l.label=Qn(u),typeof d=="number"&&d>1&&(l.colspan=d,l.origColspan=d)}else l.label=Qn(a);s+=l.origColspan;let c=!1;if(s>=e&&(l.colspan=l.origColspan-(s-e),l.origColspan=l.colspan,c=!0),o.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)o.push(LP());return!c})});let r=Math.max(...At(n,i=>i.length));return Z(n,i=>{if(i.length<r){let o=At(new Array(r-i.length),()=>oT());i.splice(i.length,0,...o)}}),n}function Aj(t,e,n){ort(t,e),e.set(t,n)}function ort(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hc(t,e){var n=Yge(t,e,"get");return srt(t,n)}function srt(t,e){return e.get?e.get.call(t):e.value}function sT(t,e,n){var r=Yge(t,e,"set");return art(t,r,n),n}function Yge(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function art(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var zge=["label","collapsible"],ph=new WeakMap,Qg=new WeakMap,Mj=new WeakMap,HP=class{constructor(){Aj(this,ph,{writable:!0,value:[]}),Aj(this,Qg,{writable:!0,value:0}),Aj(this,Mj,{writable:!0,value:1/0})}setColumnsLimit(e){sT(this,Mj,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];sT(this,ph,Gge(e,Hc(this,Mj))),sT(this,Qg,Hc(this,ph).length)}getData(){return Hc(this,ph)}mergeWith(e){Z(e,n=>{let a=n,{row:r,col:i}=a,o=tr(a,["row","col"]),s=this.getHeaderSettings(r,i);s!==null&&Ln(s,o,zge)})}map(e){Z(Hc(this,ph),n=>{Z(n,r=>{let i=e(Ee({},r));Tt(i)&&Ln(r,i,zge)})})}getHeaderSettings(e,n){var r;if(e>=Hc(this,Qg)||e<0)return null;let i=Hc(this,ph)[e];return n>=i.length?null:(r=i[n])!==null&&r!==void 0?r:null}getHeadersSettings(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=[];if(e>=Hc(this,Qg)||e<0)return i;let o=Hc(this,ph)[e],s=0;for(let a=n;a<o.length;a++){let l=o[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(s+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),s===r)break;if(s>r)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return Hc(this,Qg)}getColumnsCount(){return Hc(this,Qg)>0?Hc(this,ph)[0].length:0}clear(){sT(this,ph,[]),sT(this,Qg,0)}};var ten=Q(De(),1);var ZJt=Q(ze(),1),QJt=Q(De(),1);function Oj(t,e,n){return e=lrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lrt(t){var e=crt(t,"string");return typeof e=="symbol"?e:String(e)}function crt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Nj="DF-pre-order";function Kge(t,e){let n=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(n===!1)return!1;n=Kge.call(this.childs[r],t,e)}return n}var urt="DF-post-order";function Xge(t,e){for(let n=0;n<this.childs.length;n++)if(Xge.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}var Zge="BF";function drt(t,e){let n=[this];function r(){if(n.length===0)return;let i=n.shift();n.push(...i.childs),t.call(e,i)!==!1&&r()}r()}var hrt=Zge,qge=new Map([[Nj,Kge],[urt,Xge],[Zge,drt]]),aT=class t{constructor(e){Oj(this,"data",{}),Oj(this,"parent",null),Oj(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this,n=new t(Ee({},e.data));for(let r=0;r<e.childs.length;r++)n.addChild(this.cloneTree(e.childs[r]));return n}replaceTreeWith(e){this.data=Ee({},e.data),this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hrt;if(!qge.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);qge.get(n).call(this,e,this)}walkUp(e){let n=this,r=i=>{e.call(n,i)!==!1&&i.parent!==null&&r(i.parent)};r(this)}};function Pj(t,e,n){frt(t,e),e.set(t,n)}function frt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gs(t,e){var n=Qge(t,e,"get");return mrt(t,n)}function mrt(t,e){return e.get?e.get.call(t):e.value}function prt(t,e,n){var r=Qge(t,e,"set");return grt(t,r,n),n}function Qge(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function grt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}var Zy=new WeakMap,Jg=new WeakMap,Qy=new WeakMap,VP=class{constructor(e){Pj(this,Zy,{writable:!0,value:new Map}),Pj(this,Jg,{writable:!0,value:new Map}),Pj(this,Qy,{writable:!0,value:null}),prt(this,Qy,e)}getRoots(){return Array.from(Gs(this,Zy).values())}getRootByColumn(e){let n;return Gs(this,Jg).has(e)&&(n=Gs(this,Zy).get(Gs(this,Jg).get(e))),n}getNode(e,n){let r=this.getRootByColumn(n);if(!r)return;let i=n-Gs(this,Jg).get(n),o=0,s;return r.walkDown(a=>{let{data:{origColspan:l,headerLevel:c}}=a;if(e===c){if(i>=o&&i<=o+l-1)return s=a,s.data.isRoot=n===s.data.columnIndex,!1;o+=l}}),s}rebuildTreeIndex(){let e=0;Gs(this,Jg).clear(),Z(Gs(this,Zy),n=>{let[,{data:{colspan:r}}]=n;for(let i=e;i<e+r;i++)Gs(this,Jg).set(i,e);e+=r})}buildTree(){this.clear();let e=Gs(this,Qy).getColumnsCount(),n=0;for(;n<e;){let r=Gs(this,Qy).getHeaderSettings(0,n),i=new aT;Gs(this,Zy).set(n,i),this.buildLeaves(i,n,0,r.origColspan),n+=r.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1,o=Gs(this,Qy).getHeadersSettings(r,n,i);r+=1,Z(o,s=>{let a=ft(Ee({},s),{headerLevel:r-1,columnIndex:n}),l;r===1?(e.data=a,l=e):(l=new aT(a),e.addChild(l)),r<Gs(this,Qy).getLayersCount()&&this.buildLeaves(l,n,r,s.origColspan),n+=s.origColspan})}clear(){Gs(this,Zy).clear(),Gs(this,Jg).clear()}};var Sen=Q(De(),1);function BP(t,e){t.walkDown(n=>{let{data:r,childs:i}=n;if(!r.isHidden&&(e(r.columnIndex),i.length===0))for(let o=1;o<r.colspan;o++)e(r.columnIndex+o)})}function Jy(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function e_(t){return Jy(t,"origColspan")===t.data.origColspan}function lT(t){let{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(e_(t))return lT(n[0]);e.isCollapsed=!1;let i=n.slice(1),o=new Set,s=0;if(i.length>0)Z(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;let l=a.data;s+=l.colspan,BP(a,c=>{o.add(c)})});else{let{colspan:a,origColspan:l,columnIndex:c}=e;s=l-a;for(let u=1;u<l;u++)o.add(c+u)}return t.walkUp(a=>{let{data:l}=a;l.colspan+=s,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):e_(a)&&(l.isCollapsed=Jy(a,"isCollapsed"))}),{rollbackModification:()=>cT(t),affectedColumns:Array.from(o),colspanCompensation:s}}function cT(t){var e;let{data:n,childs:r}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(e_(t))return cT(r[0]);n.isCollapsed=!0;let o=r.slice(1),s=new Set;if(o.length>0)Z(o,l=>{BP(l,c=>{s.add(c)}),l.data.clonedTree=l.cloneTree(),l.walkDown(c=>{let{data:u}=c;u.isHidden=!0})});else{let{origColspan:l,columnIndex:c}=n;for(let u=1;u<l;u++){let d=c+u;s.add(d)}}let a=n.colspan-((e=Jy(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{let{data:c}=l;c.colspan-=a,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):e_(l)&&(c.isCollapsed=Jy(l,"isCollapsed"))}),{rollbackModification:()=>lT(t),affectedColumns:Array.from(s),colspanCompensation:a}}var pen=Q(De(),1),gen=Q(ze(),1);function Jge(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Qt`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);let{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let r=!1;t.walkUp(i=>{let{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{let{data:o}=i;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}var yen=Q(De(),1);function e0e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Qt`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);let{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let r=!1;t.walkUp(i=>{let{data:{collapsible:o}}=i;if(o)return r=!0,!1}),!r&&t.walkUp(i=>{let{data:o}=i;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}var t0e=new Map([["collapse",cT],["expand",lT],["hide-column",Jge],["show-column",e0e]]);function n0e(t,e,n){if(!t0e.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return t0e.get(t)(e,n)}var Den=Q(ze(),1);function uT(t){let e=[];return Z(t,n=>{n.walkDown(r=>{let i=r.data,{origColspan:o,columnIndex:s,headerLevel:a,crossHiddenColumns:l}=i,c=wrt(e,a),u=!1;for(let d=s;d<s+o;d++)if(l.includes(d)||u)c.push(LP(i));else{let f=vrt(i);f.isRoot=!0,c.push(f),u=!0}})}),e}function vrt(t){let r=oT(t),{crossHiddenColumns:e}=r;return tr(r,["crossHiddenColumns"])}function wrt(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function kj(t,e,n){yrt(t,e),e.set(t,n)}function yrt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dT(t,e,n){var r=r0e(t,e,"set");return _rt(t,r,n),n}function _rt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function si(t,e){var n=r0e(t,e,"get");return Crt(t,n)}function r0e(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Crt(t,e){return e.get?e.get.call(t):e.value}var zu=new WeakMap,pa=new WeakMap,e0=new WeakMap,UP=class{constructor(){kj(this,zu,{writable:!0,value:new HP}),kj(this,pa,{writable:!0,value:new VP(si(this,zu))}),kj(this,e0,{writable:!0,value:[[]]})}setState(e){si(this,zu).setData(e);let n=!1;try{si(this,pa).buildTree()}catch{si(this,pa).clear(),si(this,zu).clear(),n=!0}return dT(this,e0,uT(si(this,pa).getRoots())),n}setColumnsLimit(e){si(this,zu).setColumnsLimit(e)}mergeStateWith(e){let n=At(e,r=>{let s=r,{row:i}=s,o=tr(s,["row"]);return Ee({row:i<0?this.rowCoordsToLevel(i):i},o)});si(this,zu).mergeWith(n),si(this,pa).buildTree(),dT(this,e0,uT(si(this,pa).getRoots()))}mapState(e){si(this,zu).map(e),si(this,pa).buildTree(),dT(this,e0,uT(si(this,pa).getRoots()))}mapNodes(e){return or(si(this,pa).getRoots(),(n,r)=>(r.walkDown(i=>{let o=e(i.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,r){n<0&&(n=this.rowCoordsToLevel(n));let i=si(this,pa).getNode(n,r),o;return i&&(o=n0e(e,i,r),dT(this,e0,uT(si(this,pa).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;let n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;let n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var r,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(r=(i=si(this,e0)[e])===null||i===void 0?void 0:i[n])!==null&&r!==void 0?r:null}getHeaderTreeNodeData(e,n){let r=this.getHeaderTreeNode(e,n);return r?Ee({},r.data):null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;let r=si(this,pa).getNode(e,n);return r||null}findTopMostEntireHeaderLevel(e){var n;let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=r-e+1,o=!1,s=null;for(let a=e;a<=r;a++){let l=si(this,pa).getRootByColumn(a);if(!l)break;o=!0,l.walkDown(c=>{let{columnIndex:u,headerLevel:d,origColspan:h,isHidden:f}=c.data;f||h<=i&&u>=e&&u+h-1<=r&&(s===null||d<s)&&(s=d)},Nj)}return o&&s===null?-1:this.levelToRowCoords((n=s)!==null&&n!==void 0?n:0)}findLeftMostColumnIndex(e,n){var r;let{isRoot:i}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0};if(i)return n;let o=n-1;for(;o>=0;){var s;let{isRoot:a}=(s=this.getHeaderSettings(e,o))!==null&&s!==void 0?s:{isRoot:!0};if(a)break;o-=1}return o}findRightMostColumnIndex(e,n){var r;let{isRoot:i,origColspan:o}=(r=this.getHeaderSettings(e,n))!==null&&r!==void 0?r:{isRoot:!0,origColspan:1};if(i)return n+o-1;let s=n+1;for(;s<this.getColumnsCount();){var a;let{isRoot:l}=(a=this.getHeaderSettings(e,s))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;s+=1}return s-1}getLayersCount(){return si(this,zu).getLayersCount()}getColumnsCount(){return si(this,zu).getColumnsCount()}clear(){dT(this,e0,[]),si(this,zu).clear(),si(this,pa).clear()}};var jen=Q(De(),1);function hT(t,e,n){return e=Srt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Srt(t){var e=Ert(t,"string");return typeof e=="symbol"?e:String(e)}function Ert(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fj=class{constructor(e,n){hT(this,"hot",void 0),hT(this,"nestedHeaderSettingsGetter",void 0),hT(this,"layersCount",0),hT(this,"container",void 0),hT(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);let e=this.container.querySelectorAll("tr:last-of-type th"),n=e.length;this.widthsMap.clear();for(let r=0;r<n;r++){let i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(o,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){let{rootDocument:n,columnIndexMapper:r}=this.hot,i=n.createDocumentFragment(),o=n.createElement("table"),s=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){let c=n.createElement("tr");for(let u=0;u<a;u++){let d=r.getVisualFromRenderableIndex(u);d===null&&(d=u);let h=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,d);if(f&&(!f.isPlaceholder||f.isHidden)){let p=f.label;s&&(p+='<button class="changeType"></button>'),vl(h,p),h.colSpan=f.colspan,c.appendChild(h)}}o.appendChild(c)}i.appendChild(o),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}},i0e=Fj;function Ro(t,e){E0e(t,e),e.add(t)}function o0e(t,e,n){return e=xrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xrt(t){var e=brt(t,"string");return typeof e=="symbol"?e:String(e)}function brt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function WP(t,e,n){E0e(t,e),e.set(t,n)}function E0e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function t0(t,e,n){var r=x0e(t,e,"set");return Trt(t,r,n),n}function Trt(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function Bn(t,e){var n=x0e(t,e,"get");return Rrt(t,n)}function x0e(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function Rrt(t,e){return e.get?e.get.call(t):e.value}function Wi(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var Hj="nestedHeaders",b0e=280,wr=new WeakMap,ym=new WeakMap,fT=new WeakMap,$P=new WeakMap,jP=new WeakSet,s0e=new WeakSet,a0e=new WeakSet,l0e=new WeakSet,c0e=new WeakSet,u0e=new WeakSet,d0e=new WeakSet,h0e=new WeakSet,f0e=new WeakSet,m0e=new WeakSet,p0e=new WeakSet,g0e=new WeakSet,v0e=new WeakSet,w0e=new WeakSet,y0e=new WeakSet,_0e=new WeakSet,C0e=new WeakSet,S0e=new WeakSet,mT=class extends Dt{constructor(){super(...arguments),Ro(this,S0e),Ro(this,C0e),Ro(this,_0e),Ro(this,y0e),Ro(this,w0e),Ro(this,v0e),Ro(this,g0e),Ro(this,p0e),Ro(this,m0e),Ro(this,f0e),Ro(this,h0e),Ro(this,d0e),Ro(this,u0e),Ro(this,c0e),Ro(this,l0e),Ro(this,a0e),Ro(this,s0e),Ro(this,jP),WP(this,wr,{writable:!0,value:new UP}),WP(this,ym,{writable:!0,value:null}),WP(this,fT,{writable:!0,value:null}),WP(this,$P,{writable:!0,value:!1}),o0e(this,"ghostTable",new i0e(this.hot,(e,n)=>this.getHeaderSettings(e,n))),o0e(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return Hj}static get PLUGIN_PRIORITY(){return b0e}isEnabled(){return!!this.hot.getSettings()[Hj]}enablePlugin(){var e=this;if(this.enabled)return;let{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Sn(Qt`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Wi(this,C0e,jrt).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,S0e,$rt).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,c0e,Mrt).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,u0e,Ort).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,d0e,Nrt).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,h0e,Prt).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,f0e,krt).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,m0e,Frt).call(e,...i)}),this.addHook("afterSelection",()=>Wi(this,jP,Lj).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,s0e,Drt).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",r=>Wi(this,g0e,Hrt).call(this,r)),this.addHook("modifyColWidth",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,w0e,Brt).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,y0e,Urt).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,a0e,Irt).call(e,...i)}),this.addHook("beforeCopy",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,l0e,Art).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,p0e,Lrt).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,v0e,Vrt).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return Wi(e,_0e,Wrt).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>Wi(this,jP,Lj).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>Wi(this,jP,Lj).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;let{nestedHeaders:e}=this.hot.getSettings();Bn(this,wr).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Bn(this,wr).setState(e)),this.detectedOverlappedHeaders&&Sn(Qt`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,r)=>{let i=n===!0?"hide-column":"show-column";Bn(this,wr).triggerColumnModification(i,r)}),!Bn(this,ym)&&this.enabled&&t0(this,ym,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(r=>{let{op:i,index:o,newValue:s}=r;if(i==="replace"){let a=s===!0?"hide-column":"show-column";Bn(this,wr).triggerColumnModification(a,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Bn(this,wr).clear(),Bn(this,ym).unsubscribe(),t0(this,ym,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Bn(this,wr)}getLayersCount(){return Bn(this,wr).getLayersCount()}getHeaderSettings(e,n){return Bn(this,wr).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;let{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let s=0;s<n;s++){let a=r.childNodes[s];if(!a)break;let l=i.childNodes[s],c=o?o.childNodes[s]:null;for(let u=0,d=a.childNodes.length;u<d;u++)a.childNodes[u].removeAttribute("colspan"),bt(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),bt(l.childNodes[u],"hiddenHeader")),o&&c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),bt(c.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var n=this;let r=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,o)=>{var s;let{columnIndexMapper:a,view:l}=this.hot,c=a.getVisualFromRenderableIndex(i);c===null&&(c=i),o.removeAttribute("colspan"),bt(o,"hiddenHeader");let{colspan:u,isHidden:d,isPlaceholder:h}=(s=Bn(this,wr).getHeaderSettings(e,c))!==null&&s!==void 0?s:{label:""};if(h||d)Ne(o,"hiddenHeader");else if(u>1){var f,p;let{wtOverlays:g}=l._wt,w=(f=g.topInlineStartCornerOverlay)===null||f===void 0?void 0:f.clone.wtTable.THEAD.contains(o),_=(p=g.inlineStartOverlay)===null||p===void 0?void 0:p.clone.wtTable.THEAD.contains(o),S=w||_?Math.min(u,r-i):u;S>1&&o.setAttribute("colspan",S)}this.hot.view.appendColHeader(c,o,function(){return n.getColumnHeaderValue(...arguments)},e)}}getColumnHeaderValue(e,n){var r;let{isHidden:i,isPlaceholder:o}=(r=Bn(this,wr).getHeaderSettings(n,e))!==null&&r!==void 0?r:{};return o||i?"":this.hot.getColHeader(e,n)}destroy(){t0(this,wr,null),Bn(this,ym)!==null&&(Bn(this,ym).unsubscribe(),t0(this,ym,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Bn(this,wr).getHeaderTreeNodeData(e.row,e.col)}};function Lj(){var t;let e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;let{highlight:n}=e;if(n.isHeader()&&n.col>=0){let i=Bn(this,wr).findLeftMostColumnIndex(n.row,n.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=i,o.visualCellRange.from.col=i,o.visualCellRange.to.col=i,o.commit()}}function Drt(t){let e=this.hot.getSelectedRangeLast();if(!e)return t;let{highlight:n}=e;if(!(n.isHeader()&&n.col>=0))return t;let i=this.hot.view.getFirstFullyVisibleColumn(),o=this.hot.view.getLastFullyVisibleColumn(),s=Bn(this,wr).findLeftMostColumnIndex(n.row,n.col),a=Bn(this,wr).findRightMostColumnIndex(n.row,n.col);return s<i&&a>o?t:s<i?s:a}function Irt(t,e,n){let r=Bn(this,wr).getHeaderTreeNodeData(e,t);if(!r)return t;let{columnCursor:i,selectionType:o,selectionWidth:s}=n,{isRoot:a,colspan:l}=Bn(this,wr).getHeaderSettings(e,t);if(o===Bf){if(!a)return r.columnIndex}else if(o===xw&&(l>s-i||!a))return null;return t}function Art(t,e,n){let{columnHeadersCount:r}=n;if(r!==0)for(let o=0;o<e.length;o++){let{startRow:s,startCol:a,endRow:l,endCol:c}=e[o],u=l-s+1,d=a-c+1;if(s>=0||d===1)break;for(let h=a;h<=c;h++)for(let f=s;f<=l;f++){var i;let p=u+f,g=h-a;if(g===0)continue;((i=Bn(this,wr).getHeaderTreeNodeData(f,h))===null||i===void 0?void 0:i.isRoot)===!1&&(t[p][g]="")}}}function Mrt(t,e,n,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function Ort(t,e){let n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;t0(this,fT,e.clone()),t0(this,$P,!0);let{selection:r}=this.hot,i=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:a}=n,l=!r.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?o.push(i.getTopEndCorner().col,s,e.row):e.col>i.from.col?o.push(i.getTopStartCorner().col,s+a-1,e.row):o.push(s,s+a-1,e.row):(dw(t)||Na(t)&&l)&&o.push(s,s+a-1,e.row),r.selectColumns(...o)}function Nrt(t,e,n,r){if(!this.hot.view.isMouseDown())return;let i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;let{columnIndex:o,origColspan:s}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:u}=a;r.column=!0,r.cell=!0;let d=[],h=eo(e.row,-1/0,-1);e.col<u.col?d.push(c.col,o,h):e.col>u.col?d.push(l.col,o+s-1,h):d.push(o,o+s-1,h),this.hot.selection.selectColumns(...d)}function Prt(){t0(this,$P,!1)}function krt(){let{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Bn(this,$P)||!t)return;let e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=Bn(this,wr).getHeaderTreeNodeData(Bn(this,fT).row,Bn(this,fT).col);if(e.setHighlight(Bn(this,fT)),o>e.getWidth()||i<n||i+o-1>r){let s=Bn(this,wr).findTopMostEntireHeaderLevel(eo(n,i,i+o-1),eo(r,i,i+o-1));e.highlight.row=s,e.highlight.col=e.from.col}}function Frt(t){let{highlight:e}=this.hot.getSelectedRangeLast(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;let i=Bn(this,wr).findLeftMostColumnIndex(n.row,n.col),o=Bn(this,wr).findRightMostColumnIndex(n.row,n.col);if(t.col<0){let s=e.col>=i&&e.col<=o?i-1:o,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){let s=e.col>=i&&e.col<=o?o+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(s,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function Lrt(t,e){let n=t.row,r=this._getHeaderTreeNodeDataByCoords({row:n,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:n,col:e.col});e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function Hrt(t){t.length=0;for(let e=0;e<Bn(this,wr).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Vrt(t){let e=Bn(this,wr).getLayersCount(),n=t.startColumn,r=!!e;for(let i=0;i<e;i++){let o=Bn(this,wr).findLeftMostColumnIndex(i,t.startColumn),s=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(r=!1),Vi(s)&&s<t.startColumn){n=s;break}}t.startColumn=r?Bn(this,wr).getHeaderTreeNodeData(0,n).columnIndex:n}function Brt(t,e){let n=this.ghostTable.getWidth(e);return t>n?t:n}function Urt(t,e,n){var r;let{label:i}=(r=Bn(this,wr).getHeaderTreeNodeData(n,e))!==null&&r!==void 0?r:{label:""};return i}function Wrt(t,e){if(t<0)return this.hot.getCell(t,Bn(this,wr).findLeftMostColumnIndex(t,e),!0)}function jrt(){this.updatePlugin()}function $rt(t,e){e||this.updatePlugin()}var Vtn=Q(ze(),1),Btn=Q(De(),1);var stn=Q(ze(),1),atn=Q(De(),1);function pT(t,e,n){return e=Grt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Grt(t){var e=zrt(t,"string");return typeof e=="symbol"?e:String(e)}function zrt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Vj=class{constructor(e,n){pT(this,"hot",void 0),pT(this,"data",null),pT(this,"plugin",void 0),pT(this,"parentReference",new WeakMap),pT(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},st(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,r){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&Z(e.__children,i=>{this.cacheNode(i,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,r,i){let o=!1,s=n;if(isNaN(s)&&s.end)return s;let a=e;return a||(a={__children:this.data},o=!0,s-=1),r!=null&&s===r?{result:a,end:!0}:i!=null&&a===i?{result:s,end:!0}:(s+=1,a.__children&&Z(a.__children,l=>{if(this.parentReference.set(l,o?null:a),s=this.readTreeNodes(l,s,r,i),isNaN(s)&&s.end)return!1}),s)}mockParent(){let e=this.mockNode();return e.__children=this.data,e}mockNode(){let e={};return Rt(this.data[0],(n,r)=>{e[r]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);let r=this.getRowParent(e);return r==null?this.data.indexOf(n):r.__children.indexOf(n)}countAllRows(){let e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),!r||!r.__children?0:(Z(r.__children,i=>{n+=1,i.__children&&(n+=this.countChildren(i))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var r;return((r=e.__children)===null||r===void 0?void 0:r[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&((n=r.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let r=n;this.hot.runHooks("beforeAddChild",e,r);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),r||(r=this.mockNode()),o.__children.push(r),this.rewriteCache();let s=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(s,1),this.hot.runHooks("afterCreateRow",s,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,n,r){let i=r,o;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,n),e){let a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),o=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);i=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,i,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below",r=this.translateTrimmedRow(e),i=this.getRowParent(r),o=this.getRowIndexWithinParent(r);switch(n){case"below":this.addChildAtIndex(i,o+1,null);break;case"above":this.addChildAtIndex(i,o,null);break;default:break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=null,i=[];Array.isArray(e)?(st(e[0],e[2],h=>{let f=this.translateTrimmedRow(h);i.push(this.getDataObject(f))}),st(0,i.length-2,h=>{this.detachFromParent(i[h],!1)}),r=i[i.length-1]):r=e;let o=this.getRowIndex(r),s=this.countChildren(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),c=this.getRowParent(l),u=this.getRowIndex(c),d=null;if(this.hot.runHooks("beforeDetachChild",l,r),a!=null){let h=Array.from(new Array(o+s+1).keys()).splice(-1*(s+1));if(this.hot.runHooks("beforeRemoveRow",o,s+1,h,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,s+1,h,this.plugin.pluginName),c){d=u+this.countChildren(c);let f=this.getChild(c,this.countChildren(c)-1),p=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",p+1,s+1,this.plugin.pluginName),c.__children.push(r)}else d=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",d-2,s+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",d-2,s+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,r,this.getRowIndex(r)),n&&this.hot.render()}filterData(e,n,r){let i=[];Z(r,o=>{i.push(this.getDataObject(o))}),Z(i,o=>{let s=this.getRowIndexWithinParent(o),a=this.getRowParent(o);a===null?this.data.splice(s,1):a.__children.splice(s,1)}),this.rewriteCache()}spliceData(e,n,r){let i=this.getDataObject(e-1),o=null,s=e;i&&i.__children&&i.__children.length===0?(o=i,s=0):e<this.countAllRows()&&(o=this.getRowParent(e),s=this.getRowIndexWithinParent(e)),o?r?o.__children.splice(s,n,...r):o.__children.splice(s,n):r?this.data.splice(s,n,...r):this.data.splice(s,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,r=null;do r=this.getRowParent(r),r!==null&&(n=r);while(r!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,r,i){let o=n===this.hot.countRows(),s=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=s.__children.slice(a,a+1),c=e>n,u=o?this.getRowParent(n-1):this.getRowParent(n);u==null&&(u=this.getRowParent(n-1)),u==null&&(u=this.getDataObject(n-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(n),u.__children=[]);let d=o||r||i?u.__children.length:this.getRowIndexWithinParent(n),h=s===u;u.__children.splice(d,0,l[0]),s.__children.splice(a+(c&&h?1:0),1),this.syncRowWithRawSource(s),h||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}},T0e=Vj;var _tn=Q(ze(),1);var htn=Q(De(),1);function R0e(t,e,n){return e=Yrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yrt(t){var e=qrt(t,"string");return typeof e=="symbol"?e:String(e)}function qrt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Bj=class{constructor(e,n){R0e(this,"hot",void 0),R0e(this,"plugin",void 0),this.hot=n,this.plugin=e}},t_=Bj;var Uj=class t extends t_{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){let r=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(r),o=this.dataManager.getDataObject(r),s=n.getElementsByTagName("DIV")[0],a=s.querySelector("span.rowHeader"),l=s.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(Z(l,u=>{u&&s.removeChild(u)}),Ne(n,t.CSS_CLASSES.indicatorContainer),i){let{rootDocument:u}=this.hot,d=a.cloneNode(!0);s.innerHTML="",st(0,i-1,()=>{let h=u.createElement("SPAN");Ne(h,t.CSS_CLASSES.emptyIndicator),s.appendChild(h)}),s.appendChild(d)}if(this.dataManager.hasChildren(o)){let u=this.hot.rootDocument.createElement("DIV");c&&vt(u,[wo()]),Ne(n,t.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(Ne(u,`${t.CSS_CLASSES.button} ${t.CSS_CLASSES.expandButton}`),c&&vt(n,[Wo(!1)])):(Ne(u,`${t.CSS_CLASSES.button} ${t.CSS_CLASSES.collapseButton}`),c&&vt(n,[Wo(!0)])),s.appendChild(u)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*n+25),this.hot.render()}},GP=Uj;var Wj=class extends t_{constructor(e,n){var r;super(e,n),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,i)},shiftStash:function(i,o){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),Z(r.lastCollapsedRows,(a,l)=>{a>=i&&a<o&&(r.lastCollapsedRows[l]=a+s)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;r.collapseMultipleChildren(r.lastCollapsedRows,i),r.lastCollapsedRows=void 0},trimStash:(i,o)=>{st(i,i+o-1,s=>{let a=this.lastCollapsedRows.indexOf(s);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=[],o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(o)&&Z(o.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),r&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=[];Z(e,o=>{i.push(...this.collapseChildren(o,!1,!1))}),r&&this.trimRows(i),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=[];return Z(e,o=>{i.push(o),n&&this.collapseChildRows(o,i)}),r&&this.trimRows(i),i}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){let o=this.dataManager.getDataObject(e);Z(o.__children,s=>{let a=this.dataManager.getRowIndex(s);n.push(a),this.collapseChildRows(a,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=[];return Z(e,o=>{i.push(o),n&&this.expandChildRows(o,i)}),r&&this.untrimRows(i),i}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){let o=this.dataManager.getDataObject(e);Z(o.__children,s=>{if(!this.isAnyParentCollapsed(s)){let a=this.dataManager.getRowIndex(s);n.push(a),this.expandChildRows(a,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=[],o=null,s=null,a=null;return isNaN(e)?(o=e,s=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(o)&&Z(o.__children,l=>{let c=this.dataManager.getRowIndex(l);i.push(c)}),a=this.expandRows(i,!0,!1),r&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=[];Z(e,o=>{i.push(...this.expandChildren(o,!1,!1))}),r&&this.untrimRows(i),n&&this.renderAndAdjust()}collapseAll(){let e=this.dataManager.getData(),n=[];Z(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){let e=this.dataManager.getData(),n=[];Z(e,r=>{this.dataManager.hasChildren(r)&&n.push(r)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{Z(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{Z(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&Z(n.__children,i=>{let o=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return r=!1,!1}),r}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);let r=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(r)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;let r=this.translateTrimmedRow(n.row);St(e.target,GP.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),wi(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}},D0e=Wj;var Dtn=Q(De(),1);function Krt(t,e,n){Xrt(t,e),e.set(t,n)}function Xrt(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zrt(t,e,n){return e=Qrt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qrt(t){var e=Jrt(t,"string");return typeof e=="symbol"?e:String(e)}function Jrt(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eit(t,e){var n=tit(t,e,"get");return nit(t,n)}function tit(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function nit(t,e){return e.get?e.get.call(t):e.value}var I0e=new WeakMap,jj=class extends t_{constructor(){super(...arguments),Zrt(this,"dataManager",this.plugin.dataManager),Krt(this,I0e,{writable:!0,value:{row_above:(e,n)=>{let r=n[n.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,n)=>{let r=n[n.length-1];this.dataManager.addSibling(r.start.row,"below")}}})}appendOptions(e){let n=[{key:"add_child",name(){return this.getTranslatedPhrase(LE)},callback:()=>{let r=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(r);this.dataManager.addChild(i)},disabled:()=>{let r=this.hot.getSelectedLast();return!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(HE)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{let r=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(r[0]);return!this.dataManager.getRowParent(i)||!r||r[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return st(0,e.items.length-1,r=>{if(r===0)return Z(n,(i,o)=>{e.items.splice(r+o,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return st(0,e.items.length-1,n=>{let r=eit(this,I0e)[e.items[n].key];r!=null&&(e.items[n].callback=r)}),e}},A0e=jj;var Ntn=Q(ze(),1),Ptn=Q(De(),1);function zP(t,e,n){return e=rit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rit(t){var e=iit(t,"string");return typeof e=="symbol"?e:String(e)}function iit(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var YP=class{constructor(e){zP(this,"plugin",void 0),zP(this,"hot",void 0),zP(this,"dataManager",void 0),zP(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,r,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:r,movePossible:i}))return!1;this.movedToCollapsed=!1;let s=r===this.hot.countRows(),a=s?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r),l=!0,c=e.map(p=>{if(!l)return!1;let g=this.dataManager.translateTrimmedRow(p);return l=this.shouldAllowMoving(g,a),g}),u=c.indexOf(a)===-1;if(!l||!u)return!1;let d=this.getBaseParent(c),h=this.getTargetParent(s,a),f=d===h;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(h),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,a,f),this.moveRows(c,a,h),this.dataManager.rewriteCache(),this.moveCellsMeta(c,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,r,i,i&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){let{rows:n,finalIndex:r,dropIndex:i,movePossible:o}=e,s=!1;return mn(i)&&(Sn(Qt`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,r,i,o,!1),s=!0),s}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let r=this.dataManager.getRowParent(e?n-1:n);return r==null&&(r=this.dataManager.getRowParent(n-1)),r}shiftCollapsibleParentsLocations(e,n,r){r||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,r){let i=n===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,i)})})}moveCellsMeta(e,n){let r=[],i=Math.max(...e)<n;e.forEach(o=>{r.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(i?r.length:0),0,...r)}selectCells(e,n){let r=e.length,i=0,o=0,s=null,a=null;if(this.movedToCollapsed){let l=null;e[r-1]<n?l=this.dataManager.translateTrimmedRow(n-r):l=this.dataManager.translateTrimmedRow(n);let c=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),u=this.dataManager.getRowIndex(c);i=this.dataManager.untranslateTrimmedRow(u),o=i}else e[r-1]<n?(o=n-1,i=o-r+1):(i=n,o=i+r-1);s=this.hot.selection,a=this.hot.countCols()-1,s.setRangeStart(this.hot._createCellCoords(i,0)),s.setRangeEnd(this.hot._createCellCoords(o,a),!0)}isRowOrderChanged(e,n){return e.some((r,i)=>r-i!==n)}};function vs(t,e){K0e(t,e),e.add(t)}function M0e(t,e,n){K0e(t,e),e.set(t,n)}function K0e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $j(t,e,n){return e=oit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oit(t){var e=sit(t,"string");return typeof e=="symbol"?e:String(e)}function sit(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qP(t,e){var n=X0e(t,e,"get");return ait(t,n)}function ait(t,e){return e.get?e.get.call(t):e.value}function KP(t,e,n){var r=X0e(t,e,"set");return lit(t,r,n),n}function X0e(t,e,n){if(!e.has(t))throw new TypeError("attempted to "+n+" private field on non-instance");return e.get(t)}function lit(t,e,n){if(e.set)e.set.call(t,n);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=n}}function zo(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var gT="nestedRows",Z0e=300,O0e=gT,cit="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.",XP=new WeakMap,n_=new WeakMap,N0e=new WeakSet,P0e=new WeakSet,k0e=new WeakSet,F0e=new WeakSet,L0e=new WeakSet,H0e=new WeakSet,V0e=new WeakSet,B0e=new WeakSet,U0e=new WeakSet,W0e=new WeakSet,j0e=new WeakSet,$0e=new WeakSet,G0e=new WeakSet,z0e=new WeakSet,Y0e=new WeakSet,Gj=new WeakSet,vT=class extends Dt{constructor(){super(...arguments),vs(this,Gj),vs(this,Y0e),vs(this,z0e),vs(this,G0e),vs(this,$0e),vs(this,j0e),vs(this,W0e),vs(this,U0e),vs(this,B0e),vs(this,V0e),vs(this,H0e),vs(this,L0e),vs(this,F0e),vs(this,k0e),vs(this,P0e),vs(this,N0e),$j(this,"dataManager",null),$j(this,"headersUI",null),$j(this,"collapsedRowsMap",null),M0e(this,XP,{writable:!0,value:!1}),M0e(this,n_,{writable:!0,value:!1})}static get PLUGIN_KEY(){return gT}static get PLUGIN_PRIORITY(){return Z0e}isEnabled(){return!!this.hot.getSettings()[gT]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Rl),this.dataManager=new T0e(this,this.hot),this.collapsingUI=new D0e(this,this.hot),this.headersUI=new GP(this,this.hot),this.contextMenuUI=new A0e(this,this.hot),this.rowMoveController=new YP(this),this.addHook("afterInit",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,z0e,Eit).call(e,...r)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,Y0e,xit).call(e,...r)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,k0e,hit).call(e,...r)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,F0e,fit).call(e,...r)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,L0e,mit).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,P0e,dit).call(e,...r)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,B0e,vit).call(e,...r)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,V0e,git).call(e,...r)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,U0e,wit).call(e,...r)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,W0e,yit).call(e,...r)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,j0e,_it).call(e,...r)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,$0e,Cit).call(e,...r)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,H0e,pit).call(e,...r)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,G0e,Sit).call(e,...r)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return zo(e,N0e,uit).call(e,...r)}),this.addHook("beforeLoadData",n=>zo(this,Gj,q0e).call(this,n)),this.addHook("beforeUpdateData",n=>zo(this,Gj,q0e).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();let e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();if(e.col===-1&&e.row>=0){let n=this.collapsingUI.translateTrimmedRow(e.row);this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n)}},runOnlyIf:()=>{var e;let n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&n.isHeader()},group:O0e})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(O0e)}disableCoreAPIModifiers(){KP(this,n_,!0)}enableCoreAPIModifiers(){KP(this,n_,!1)}onModifyRowData(e){if(!qP(this,n_))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!qP(this,n_))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,r){return qP(this,n_)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,r),!1)}destroy(){super.destroy()}};function uit(t,e,n,r){return this.rowMoveController.onBeforeRowMove(t,e,n,r)}function dit(t,e,n){this.collapsingUI.toggleState(t,e,n)}function hit(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),KP(this,XP,!0),this.dataManager.getData().slice()}function fit(t){return this.contextMenuUI.appendOptions(t)}function mit(t,e){this.headersUI.appendLevelIndicators(t,e)}function pit(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function git(t,e,n,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{KP(this,XP,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function vit(t,e,n){let r=Array.from(n.reduce((i,o)=>{if(this.dataManager.isParent(o)){let s=this.dataManager.getDataObject(o).__children;return i.add(o),Array.isArray(s)&&s.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(o)},new Set));n.length=0,n.push(...r)}function wit(){this.collapsingUI.collapsedRowsStash.stash()}function yit(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _it(){this.collapsingUI.collapsedRowsStash.stash()}function Cit(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function Sit(){this.dataManager.rewriteCache()}function Eit(){this.headersUI.updateRowHeaderWidth()}function xit(t,e){qP(this,XP)&&(e.skipRender=!0)}function q0e(t){if(!pae(t)){hw(cit),this.hot.getSettings()[gT]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}var inn=Q(De(),1);var Jtn=Q(CM(),1),enn=Q(ze(),1),tnn=Q(De(),1);function zj(t,e,n){return e=bit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bit(t){var e=Tit(t,"string");return typeof e=="symbol"?e:String(e)}function Tit(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Yj=class{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;zj(this,"rootWindow",void 0),zj(this,"prefix",void 0),zj(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){let r=typeof e>"u"?n:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Z(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){let e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}},Q0e=Yj;function Rit(t,e,n){return e=Dit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dit(t){var e=Iit(t,"string");return typeof e=="symbol"?e:String(e)}function Iit(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}ot.getSingleton().register("persistentStateSave");ot.getSingleton().register("persistentStateLoad");ot.getSingleton().register("persistentStateReset");var qj="persistentState",J0e=0,wT=class extends Dt{constructor(){super(...arguments),Rit(this,"storage",void 0)}static get PLUGIN_KEY(){return qj}static get PLUGIN_PRIORITY(){return J0e}isEnabled(){return!!this.hot.getSettings()[qj]}enablePlugin(){this.enabled||(this.storage||(this.storage=new Q0e(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}};var dnn=Q(ze(),1),hnn=Q(De(),1);function Ait(t,e){Mit(t,e),e.add(t)}function Mit(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kj(t,e,n){return e=Oit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oit(t){var e=Nit(t,"string");return typeof e=="symbol"?e:String(e)}function Nit(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eve(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var ZP="search",nve=190,Pit="htSearchResult",kit=function(t,e,n,r,i){t.getCellMeta(e,n).isSearchResult=i},Fit=function(t,e,n){return mn(t)||t===null||!t.toLocaleLowerCase||t.length===0||mn(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1},Xj=new WeakSet,yT=class extends Dt{constructor(){super(...arguments),Ait(this,Xj),Kj(this,"callback",kit),Kj(this,"queryMethod",Fit),Kj(this,"searchResultClass",Pit)}static get PLUGIN_KEY(){return ZP}static get PLUGIN_PRIORITY(){return nve}isEnabled(){return this.hot.getSettings()[ZP]}enablePlugin(){var e=this;if(this.enabled)return;let n=this.hot.getSettings()[ZP];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return eve(e,Xj,tve).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;let n=function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return eve(e,Xj,tve).call(e,...i)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod(),i=this.hot.countRows(),o=this.hot.countCols(),s=[],a=this.hot;return st(0,i-1,l=>{st(0,o-1,c=>{let u=this.hot.getDataAtCell(l,c),d=this.hot.getCellMeta(l,c),h=d.search.callback||n,p=(d.search.queryMethod||r)(e,u,d);if(p){let g={row:l,col:c,data:u};s.push(g)}h&&h(a,l,c,u,p)})}),s}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Tt(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}};function tve(t,e,n,r,i,o){let s=o.className||[],a=[];typeof s=="string"?a=s.split(" "):a.push(...s),this.isEnabled()&&o.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),o.className=a.join(" ")}var _nn=Q(ze(),1),Cnn=Q(De(),1);function Zj(t,e){Lit(t,e),e.add(t)}function Lit(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function QP(t,e,n){return e=Hit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hit(t){var e=Vit(t,"string");return typeof e=="symbol"?e:String(e)}function Vit(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qj(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var sve="touchScroll",ave=200,rve=new WeakSet,ive=new WeakSet,ove=new WeakSet,_T=class extends Dt{constructor(){super(...arguments),Zj(this,ove),Zj(this,ive),Zj(this,rve),QP(this,"scrollbars",[]),QP(this,"clones",[]),QP(this,"lockedCollection",!1),QP(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return sve}static get PLUGIN_PRIORITY(){return ave}static get SETTING_KEYS(){return!0}isEnabled(){return jM()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Qj(this,rve,Bit).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Qj(this,ive,Uit).call(this)),this.addHook("afterMomentumScroll",()=>Qj(this,ove,Wit).call(this))}};function Bit(){if(this.lockedCollection)return;let{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),r&&this.scrollbars.push(r),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function Uit(){this.freezeOverlays=!0,Z(this.clones,t=>{Ne(t,"hide-tween")})}function Wit(){this.freezeOverlays=!1,Z(this.clones,t=>{bt(t,"hide-tween"),Ne(t,"show-tween")}),this.hot._registerTimeout(()=>{Z(this.clones,t=>{bt(t,"show-tween")})},400),Z(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}var Inn=Q(ze(),1),Ann=Q(De(),1);function jit(t,e){$it(t,e),e.add(t)}function $it(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Git(t,e,n){return e=zit(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zit(t){var e=Yit(t,"string");return typeof e=="symbol"?e:String(e)}function Yit(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qit(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var CT="trimRows",cve=330,lve=new WeakSet,ST=class extends Dt{constructor(){super(...arguments),jit(this,lve),Git(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return CT}static get PLUGIN_PRIORITY(){return cve}isEnabled(){return!!this.hot.getSettings()[CT]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Rl),this.trimmedRowsMap.addLocalHook("init",()=>qit(this,lve,Kit).call(this)),super.enablePlugin())}updatePlugin(){let e=this.hot.getSettings()[CT];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),Z(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){let n=this.getTrimmedRows(),r=this.isValidConfig(e),i=n;r&&(i=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,i,r)!==!1&&(r&&this.hot.batchExecution(()=>{Z(e,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0),this.hot.runHooks("afterTrimRow",n,i,r,r&&i.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.trimRows(n)}untrimRows(e){let n=this.getTrimmedRows(),r=this.isValidConfig(e),i=n,o=this.trimmedRowsMap.getValues().slice(),s=e.length>0;r&&s&&(Z(e,l=>{o[l]=!1}),i=or(o,(l,c,u)=>(c&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",n,i,r&&s)!==!1&&(r&&s&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,i,r&&s,r&&i.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){let n=this.hot.countSourceRows();return e.every(r=>Number.isInteger(r)&&r>=0&&r<n)}destroy(){super.destroy()}};function Kit(){let t=this.hot.getSettings()[CT];Array.isArray(t)&&this.hot.batchExecution(()=>{Z(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var Lnn=Q(ze(),1);var uve="undoRedo",dve="undoRedo";function xt(t){let e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,r){let i=n&&n.length;if(!i||!n.find(a=>{let[,,l,c]=a;return l!==c}))return;let s=()=>{let a=n.reduce((c,u)=>(c.push([...u]),c),[]);Z(a,c=>{c[1]=t.propToCol(c[1])});let l=i>1?this.getSelected():[[a[0][0],a[0][1]]];return new xt.ChangeAction(a,l)};e.done(s,r)}),t.addHook("afterCreateRow",(n,r,i)=>{e.done(()=>new xt.CreateRowAction(n,r),i)}),t.addHook("beforeRemoveRow",(n,r,i,o)=>{let s=()=>{let a=t.toPhysicalRow(n),l=vi(e.instance.getSourceData(a,0,a+r-1,e.instance.countSourceCols()-1));return new xt.RemoveRowAction(a,l,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence())};e.done(s,o)}),t.addHook("afterCreateCol",(n,r,i)=>{e.done(()=>new xt.CreateColumnAction(n,r),i)}),t.addHook("beforeRemoveCol",(n,r,i,o)=>{let s=()=>{let a=e.instance.getSourceDataArray(),l=(e.instance.countCols()+n)%e.instance.countCols(),c=[],u=[],d=[];st(a.length-1,p=>{let g=[],w=a[p];st(l,l+(r-1),_=>{g.push(w[t.toPhysicalColumn(_)])}),c.push(g)}),st(r-1,p=>{d.push(t.toPhysicalColumn(l+p))}),Array.isArray(t.getSettings().colHeaders)&&st(r-1,p=>{u.push(t.getSettings().colHeaders[t.toPhysicalColumn(l+p)]||null)});let h=t.columnIndexMapper.getIndexesSequence(),f=t.rowIndexMapper.getIndexesSequence();return new xt.RemoveColumnAction(l,d,c,u,h,f,t.getSettings().fixedColumnsStart)};e.done(s,o)}),t.addHook("beforeCellAlignment",(n,r,i,o)=>{e.done(()=>new xt.CellAlignmentAction(n,r,i,o))}),t.addHook("beforeFilter",n=>{e.done(()=>new xt.FiltersAction(n))}),t.addHook("beforeRowMove",(n,r)=>{n!==!1&&e.done(()=>new xt.RowMoveAction(n,r))}),t.addHook("beforeMergeCells",(n,r)=>{r||e.done(()=>new xt.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,r)=>{r||e.done(()=>new xt.UnmergeCellsAction(t,n))}),t.addHook("afterInit",()=>{e.init()})}xt.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;let r=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",r,e)===!1)return;let o=t(),s=this.undoneActions.slice();this.doneActions.push(o),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",s),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice())};xt.prototype.undo=function(){if(this.isUndoAvailable()){let t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);let e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());let n=vi(e);if(this.instance.runHooks("beforeUndo",n)===!1)return;this.ignoreNewActions=!0;let i=this,o=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",o),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.instance.runHooks("afterUndo",n)}};xt.prototype.redo=function(){if(this.isRedoAvailable()){let t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);let e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());let n=vi(e);if(this.instance.runHooks("beforeRedo",n)===!1)return;this.ignoreNewActions=!0;let i=this,o=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",o),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.instance.runHooks("afterRedo",n)}};xt.prototype.isUndoAvailable=function(){return this.doneActions.length>0};xt.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};xt.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};xt.prototype.isEnabled=function(){return this.enabled};xt.prototype.enable=function(){if(this.isEnabled())return;let t=this.instance;this.enabled=!0,Xit(t),this.registerShortcuts(),t.addHook("afterChange",hve)};xt.prototype.disable=function(){if(!this.isEnabled())return;let t=this.instance;this.enabled=!1,Zit(t),this.unregisterShortcuts(),t.removeHook("afterChange",hve)};xt.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};xt.Action=function(){};xt.Action.prototype.undo=function(){};xt.Action.prototype.redo=function(){};xt.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};wu(xt.ChangeAction,xt.Action);xt.ChangeAction.prototype.undo=function(t,e){let n=vi(this.changes),r=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,s=n.length;o<s;o++)n[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.undo");for(let o=0,s=n.length;o<s;o++){let[a,l]=n[o];t.getSettings().minSpareRows&&a+1+t.getSettings().minSpareRows===t.countRows()&&r===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(a+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&l+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(l+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}t.selectCells(this.selected,!1,!1)};xt.ChangeAction.prototype.redo=function(t,e){let n=vi(this.changes);for(let r=0,i=n.length;r<i;r++)n[r].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(n,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};xt.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};wu(xt.CreateRowAction,xt.Action);xt.CreateRowAction.prototype.undo=function(t,e){let n=t.countRows(),r=t.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};xt.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};xt.RemoveRowAction=function(t,e,n,r,i){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=n,this.fixedRowsTop=r,this.rowIndexesSequence=i};wu(xt.RemoveRowAction,xt.Action);xt.RemoveRowAction.prototype.undo=function(t,e){let n=t.getSettings(),r=[];n.fixedRowsBottom=this.fixedRowsBottom,n.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,o)=>{Object.keys(i).forEach(s=>{let a=parseInt(s,10);r.push([this.index+o,isNaN(a)?s:a,i[s]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};xt.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};xt.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};wu(xt.CreateColumnAction,xt.Action);xt.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};xt.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};xt.RemoveColumnAction=function(t,e,n,r,i,o,s){this.index=t,this.indexes=e,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=s};wu(xt.RemoveColumnAction,xt.Action);xt.RemoveColumnAction.prototype.undo=function(t,e){let n=t.getSettings();n.fixedColumnsStart=this.fixedColumnsStart;let r=this.indexes.slice(0).sort(),i=(c,u,d)=>d[this.indexes.indexOf(r[u])],o=this.data.length,s=[];for(let c=0;c<o;c++)s.push(At(this.data[c],i));let a=At(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Z(t.getSourceDataArray(),(c,u)=>{Z(r,(d,h)=>{c[d]=s[u][h],l.push([u,d,c[d]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&Z(a,(c,u)=>{t.getSettings().colHeaders[r[u]]=c}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};xt.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};xt.CellAlignmentAction=function(t,e,n,r){this.stateBefore=t,this.range=e,this.type=n,this.alignment=r};xt.CellAlignmentAction.prototype.undo=function(t,e){Z(this.range,n=>{n.forAll((r,i)=>{r>=0&&i>=0&&t.setCellMeta(r,i,"className",this.stateBefore[r][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};xt.CellAlignmentAction.prototype.redo=function(t,e){Ou(this.range,this.type,this.alignment,(n,r)=>t.getCellMeta(n,r),(n,r,i,o)=>t.setCellMeta(n,r,i,o)),t.addHookOnce("afterViewRender",e),t.render()};xt.FiltersAction=function(t){this.conditionsStack=t,this.actionType="filter"};wu(xt.FiltersAction,xt.Action);xt.FiltersAction.prototype.undo=function(t,e){let n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()};xt.FiltersAction.prototype.redo=function(t,e){let n=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()};var Jj=class extends xt.Action{constructor(e,n){super(),this.cellRange=n;let r=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,i.row,i.col)}undo(e,n){let r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0);let i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,n){let r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange)}};xt.MergeCellsAction=Jj;var e$=class extends xt.Action{constructor(e,n){super(),this.cellRange=n}undo(e,n){let r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.mergeRange(this.cellRange,!0)}redo(e,n){let r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),r.unmergeRange(this.cellRange,!0),e.render()}};xt.UnmergeCellsAction=e$;xt.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalIndex=e,this.actionType="row_move"};wu(xt.RowMoveAction,xt.Action);xt.RowMoveAction.prototype.undo=function(t,e){let n=t.getPlugin("manualRowMove"),r=[].concat(this.rows),i=r.filter(a=>a>this.finalIndex),o=r.filter(a=>a<=this.finalIndex),s=i.sort((a,l)=>l-a).concat(o.sort((a,l)=>a-l));t.addHookOnce("afterViewRender",e);for(let a=0;a<s.length;a+=1){let l=t.toVisualRow(s[a]);n.moveRow(l,s[a])}t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};xt.RowMoveAction.prototype.redo=function(t,e){let n=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),n.moveRows(this.rows.slice(),this.finalIndex),t.render(),t.deselectCell(),t.selectRows(this.finalIndex,this.finalIndex+this.rows.length-1)};xt.prototype.init=function(){let t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};xt.prototype.registerShortcuts=function(){let e=this.instance.getShortcutManager().getContext("grid"),r={runOnlyIf:i=>!i.altKey,group:uve};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)};xt.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(uve)};function hve(t,e){let n=this;if(e==="loadData")return n.undoRedo.clear()}function Xit(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Zit(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}var ET=ot.getSingleton();ET.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});ET.register("beforeUndo");ET.register("afterUndo");ET.register("beforeRedo");ET.register("afterRedo");xt.PLUGIN_KEY=dve;xt.SETTING_KEYS=!0;var t$=xt;function fve(){$n(Px),$n(Lx),$n(Bx),$n(Ux),$n(jx),$n(Eg),$n(Xx),$n(Jx),$n(my),$n(cb),$n(db),$n(hb),$n(Cy),$n(mb),$n(Mb),$n(kb),$n(Lb),$n(Vb),$n(Bb),$n(Wb),$n(Yb),$n(qb),$n(Jb),$n(tT),$n(rT),$n(iT),$n(mT),$n(vT),$n(wT),$n(yT),$n(_T),$n(ST),$n(t$)}function mve(){Hce(),jce(),Yce(),Zce(),fve()}var gve=Q(pve());mve();var vve=(()=>{let e=class e{constructor(r,i,o){this.service=r,this.toastService=i,this.route=o,this.hotRegisterer=new Dc,this.domainData={machineRolls:"MACHINE ROLLS",maintenanceRolls:"MAINTENANCE ROLLS",machineNonRolls:"MACHINE NON ROLLS",maintenanceNonRolls:"MAINTENANCE NON ROLLS","all-rolling":"ALL-ROLLING","all-non-rolling":"ALL-NON-ROLLING"},this.id="hotInstance",this.dataset=[],this.hotSettings=Ee({editor:!1,readOnly:!0},Hw)}ngOnInit(){this.route.params.subscribe(r=>{this.title=r.id;let i=[];this.title=="all-rolling"?(i=["machineRolls","maintenanceRolls"],this.dataset=[]):this.title==="all-non-rolling"?(i=["maintenanceNonRolls","machineNonRolls"],this.dataset=[]):(i=[this.title],this.dataset=[]);for(let o of i)Promise.resolve().then(()=>{this.service.getAllMachineRoll(o).subscribe(s=>{let a=this.hotRegisterer.getInstance(this.id);this.dataset.push(...s),a.updateData(this.dataset)})})})}onExcelDownload(){let o=this.hotRegisterer.getInstance(this.id).getPlugin("exportFile").exportAsString("csv",{bom:!1,columnHeaders:!0,exportHiddenColumns:!0,exportHiddenRows:!0,rowDelimiter:`\r
`}),s=gve.parse(o),a=Hp.book_new(),l=Hp.json_to_sheet([]);Hp.book_append_sheet(a,l,"Dates"),Hp.sheet_add_aoa(l,s.data),Mee(a,"MachineRolls.xlsx"),this.toastService.showSuccess("Downloaded Excel file")}onPdfDownload(){}selectStartDate(r){this.startDate=ln.fromISO(r.target.value)}selectEndDate(r){this.endDate=ln.fromISO(r.target.value)}filterDataWithDate(){if(!this.startDate&&!this.endDate)return;let r=this.hotRegisterer.getInstance(this.id),i=this.dataset.filter(o=>{let s=ln.fromFormat(o.date,"dd/MM/yyyy");return this.startDate<=s&&this.endDate>=s||this.startDate!==void 0&&this.startDate<=s&&this.endDate==null?!0:this.endDate!==void 0&&this.endDate>=s&&this.startDate==null});console.log("\u{1F680} ~ this.dataset:",i),r.updateData(i)}ResetDates(){this.hotRegisterer.getInstance(this.id).updateData(this.dataset)}};e.\u0275fac=function(i){return new(i||e)(je(ui),je(lo),je(Xl))},e.\u0275cmp=jt({type:e,selectors:[["app-machine-roll"]],standalone:!0,features:[qt],decls:26,vars:3,consts:[[1,"report"],[1,"pt-3"],[1,"fw-semibold","text-center"],[1,"btn","btn-primary",3,"click"],[1,"row","w-100"],[1,"col-2"],[1,"text-end","fw-semibold"],[1,"col-3"],["type","date",1,"form-control",3,"change"],[1,"mt-3","Handsontable"],["licenseKey","non-commercial-and-evaluation",1,"hot",3,"hotId","settings"]],template:function(i,o){i&1&&(W(0,"div",0)(1,"div",1)(2,"h1",2),re(3),V(),W(4,"button",3),Ue("click",function(){return o.onExcelDownload()}),re(5," Excel "),V(),W(6,"div",4)(7,"div",5)(8,"h4",6),re(9,"Filter:"),V()(),W(10,"div",7)(11,"label"),re(12,"From: "),V(),W(13,"input",8),Ue("change",function(a){return o.selectStartDate(a)}),V()(),W(14,"div",7)(15,"label"),re(16,"To: "),V(),W(17,"input",8),Ue("change",function(a){return o.selectEndDate(a)}),V()(),W(18,"div",5)(19,"button",3),Ue("click",function(){return o.filterDataWithDate()}),re(20,"Submit"),V()(),W(21,"div",5)(22,"button",3),Ue("click",function(){return o.ResetDates()}),re(23,"Reset"),V()()()(),W(24,"div",9),at(25,"hot-table",10),V()()),i&2&&(Te(3),Hn(o.domainData[o.title]),Te(22),lt("hotId",o.id)("settings",o.hotSettings))},dependencies:[Au,Zf,Mo],styles:[".report[_ngcontent-%COMP%]{width:100%;height:100%}.Handsontable[_ngcontent-%COMP%]{height:55svh}"]});let t=e;return t})();var Qit=()=>["./","machineRolls"],Jit=()=>["./","machineNonRolls"],eot=()=>["./","maintenanceRolls"],tot=()=>["./","maintenanceNonRolls"],not=()=>["./","all-rolling"],rot=()=>["./","all-non-rolling"],wve=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-report"]],standalone:!0,features:[qt],decls:20,vars:12,consts:[[1,"pt-5"],["type","radio","id","machineRolls","name","roll",1,"btn-check",3,"routerLink"],["for","machineRolls",1,"btn","btn-outline-primary","ms-3"],["type","radio","id","machineNonRolls","name","roll",1,"btn-check",3,"routerLink"],["for","machineNonRolls",1,"btn","btn-outline-primary","ms-3"],["type","radio","id","maintenanceRolls","name","roll",1,"btn-check",3,"routerLink"],["for","maintenanceRolls",1,"btn","btn-outline-primary","ms-3"],["type","radio","id","maintenanceNonRolls","name","roll",1,"btn-check",3,"routerLink"],["for","maintenanceNonRolls",1,"btn","btn-outline-primary","ms-3"],["type","radio","id","all-rolling","name","roll",1,"btn-check",3,"routerLink"],["for","all-rolling",1,"btn","btn-outline-primary","ms-3"],["type","radio","id","all-non-rolling","name","roll",1,"btn-check",3,"routerLink"],["for","all-non-rolling",1,"btn","btn-outline-primary","ms-3"]],template:function(i,o){i&1&&(W(0,"div",0),at(1,"input",1),W(2,"label",2),re(3,"MACHINE-ROLLS"),V(),at(4,"input",3),W(5,"label",4),re(6,"MACHINE-NON-ROLLS"),V(),at(7,"input",5),W(8,"label",6),re(9,"MAINTENANCE-ROLLS"),V(),at(10,"input",7),W(11,"label",8),re(12,"MAINTENANCE-NON-ROLLS"),V(),at(13,"input",9),W(14,"label",10),re(15,"ALL-ROLLING"),V(),at(16,"input",11),W(17,"label",12),re(18,"ALL-NON-ROLLING"),V()(),at(19,"router-outlet")),i&2&&(Te(1),lt("routerLink",Ei(6,Qit)),Te(3),lt("routerLink",Ei(7,Jit)),Te(3),lt("routerLink",Ei(8,eot)),Te(3),lt("routerLink",Ei(9,tot)),Te(3),lt("routerLink",Ei(10,not)),Te(3),lt("routerLink",Ei(11,rot)))},dependencies:[Mo,ep,ov],styles:[".nav-btn[_ngcontent-%COMP%]{border-right:2px solid black}"]});let t=e;return t})();var iot=(t,e)=>e._id;function oot(t,e){if(t&1){let n=Fn();W(0,"tr")(1,"th",9),re(2),V(),W(3,"td"),at(4,"ngb-highlight",10),V(),W(5,"td"),at(6,"ngb-highlight",10),V(),W(7,"td"),at(8,"ngb-highlight",10),V(),W(9,"td")(10,"button",11),Ue("click",function(){let o=mt(n).$implicit,s=Le();return pt(s.onDeleteUser(o))}),re(11,"x"),V()()()}if(t&2){let n=e.$implicit,r=e.$index,i=Le();Te(2),Hn(r+1),Te(2),lt("result",n.username)("term",i.filterTxt),Te(2),lt("result",n.department)("term",i.filterTxt),Te(2),lt("result",n.designation)("term",i.filterTxt)}}function sot(t,e){t&1&&(W(0,"tr")(1,"td",12),re(2,"No Users found"),V()())}var yve=(()=>{let e=class e{constructor(r,i,o,s,a){this.service=r,this.toastService=i,this.router=o,this.ls=s,this.pipe=a,this.filterTxt="",this.ls.getUser().department!=="OPERATING"&&this.router.navigate(["/lmg"])}ngOnInit(){Promise.resolve().then(()=>{this.service.getAllUser().subscribe(r=>{this.userData=r,this.dataSet=r})})}filterInput(r){this.filterTxt=r.target.value,this.userData=this.dataSet,this.userData=this.search(this.filterTxt)}search(r){return this.userData===void 0?[]:this.userData.filter(i=>{let o=r.toLowerCase();return i.username.toLowerCase().includes(o)||i.department.toLowerCase().includes(o)||i.designation.toLowerCase().includes(o)})}onDeleteUser(r){confirm("sure want to delete "+r.username.toUpperCase()+" USER")&&this.service.deleteUser(r._id).subscribe(i=>{if(this.ls.getUser()._id==r._id){this.router.navigate(["login"]);return}this.userData=this.userData.filter(s=>s._id!==r._id),this.toastService.showSuccess(" Successfully deleted ")})}};e.\u0275fac=function(i){return new(i||e)(je(ui),je(lo),je(Ds),je(Ni),je(WD))},e.\u0275cmp=jt({type:e,selectors:[["app-user-details"]],standalone:!0,features:[ao([WD]),qt],decls:26,vars:1,consts:[[1,"user-details","container-fluid"],[1,"mt-5"],[1,"mb-3","row"],[1,"col-xs-3","col-sm-auto","col-form-label"],[1,"col-xs-3","col-sm-auto"],["id","table-filtering-search","type","text",1,"form-control",3,"change"],[1,"user-table"],[1,"table","table-striped"],["scope","col"],["scope","row"],[3,"result","term"],[1,"btn","btn-outline-danger",3,"click"],["colspan","4",2,"text-align","center"]],template:function(i,o){i&1&&(W(0,"div",0)(1,"div",1)(2,"form")(3,"div",2)(4,"label",3),re(5,"SEARCH:"),V(),W(6,"div",4)(7,"input",5),Ue("change",function(a){return o.filterInput(a)}),V()()()()(),W(8,"div",6)(9,"table",7)(10,"thead")(11,"tr")(12,"th",8),re(13,"#"),V(),W(14,"th",8),re(15,"USERNAME"),V(),W(16,"th",8),re(17,"DEPARTMENT"),V(),W(18,"th",8),re(19,"DESIGNATION"),V(),W(20,"th",8),re(21,"DELETE"),V()()(),W(22,"tbody"),Gn(23,oot,12,7,"tr",null,iot,!1,sot,3,0),V()()()()),i&2&&(Te(23),zn(o.userData))},dependencies:[ef,SI,Xh,oX],styles:[".user-table[_ngcontent-%COMP%]{height:70svh;overflow-y:scroll;scroll-behavior:smooth}"]});let t=e;return t})();var _ve=[{path:"lmg",component:wZ,canActivate:[gZ],children:[{path:"",component:Uq},{path:"demand",children:[{path:"machine-roll",component:pZ},{path:"machine-non-roll",component:yZ},{path:"maintenance-roll",component:_Z},{path:"maintenance-non-roll",component:CZ},{path:"machine-upload-file",component:Tce}]},{path:"verify-demand",component:Ace},{path:"report",component:wve,children:[{path:":id",component:vve}]},{path:"edit/:domain",component:Dce},{path:"dashboard",component:Mce},{path:"users-details",component:yve}]},{path:"login",component:EK},{path:"register",component:SK},{path:"",redirectTo:"/login",pathMatch:"full"}];var Yu="*";function Cve(t,e=null){return{type:2,steps:t,options:e}}function i$(t){return{type:6,styles:t,offset:null}}var _m=class{constructor(e=0,n=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+n}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){let n=e=="start"?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}},xT=class{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let n=0,r=0,i=0,o=this.players.length;o==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++n==o&&this._onFinish()}),s.onDestroy(()=>{++r==o&&this._onDestroy()}),s.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){let n=e*this.totalTime;this.players.forEach(r=>{let i=r.totalTime?Math.min(1,n/r.totalTime):1;r.setPosition(i)})}getPosition(){let e=this.players.reduce((n,r)=>n===null||r.totalTime>n.totalTime?r:n,null);return e!=null?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){let n=e=="start"?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}},JP="!";function Sve(t){return new Je(3e3,!1)}function aot(){return new Je(3100,!1)}function lot(){return new Je(3101,!1)}function cot(t){return new Je(3001,!1)}function uot(t){return new Je(3003,!1)}function dot(t){return new Je(3004,!1)}function hot(t,e){return new Je(3005,!1)}function fot(){return new Je(3006,!1)}function mot(){return new Je(3007,!1)}function pot(t,e){return new Je(3008,!1)}function got(t){return new Je(3002,!1)}function vot(t,e,n,r,i){return new Je(3010,!1)}function wot(){return new Je(3011,!1)}function yot(){return new Je(3012,!1)}function _ot(){return new Je(3200,!1)}function Cot(){return new Je(3202,!1)}function Sot(){return new Je(3013,!1)}function Eot(t){return new Je(3014,!1)}function xot(t){return new Je(3015,!1)}function bot(t){return new Je(3016,!1)}function Tot(t,e){return new Je(3404,!1)}function Rot(t){return new Je(3502,!1)}function Dot(t){return new Je(3503,!1)}function Iot(){return new Je(3300,!1)}function Aot(t){return new Je(3504,!1)}function Mot(t){return new Je(3301,!1)}function Oot(t,e){return new Je(3302,!1)}function Not(t){return new Je(3303,!1)}function Pot(t,e){return new Je(3400,!1)}function kot(t){return new Je(3401,!1)}function Fot(t){return new Je(3402,!1)}function Lot(t,e){return new Je(3505,!1)}function Cm(t){switch(t.length){case 0:return new _m;case 1:return t[0];default:return new xT(t)}}function Fve(t,e,n=new Map,r=new Map){let i=[],o=[],s=-1,a=null;if(e.forEach(l=>{let c=l.get("offset"),u=c==s,d=u&&a||new Map;l.forEach((h,f)=>{let p=f,g=h;if(f!=="offset")switch(p=t.normalizePropertyName(p,i),g){case JP:g=n.get(f);break;case Yu:g=r.get(f);break;default:g=t.normalizeStyleValue(f,p,g,i);break}d.set(p,g)}),u||o.push(d),a=d,s=c}),i.length)throw Rot(i);return o}function T$(t,e,n,r){switch(e){case"start":t.onStart(()=>r(n&&o$(n,"start",t)));break;case"done":t.onDone(()=>r(n&&o$(n,"done",t)));break;case"destroy":t.onDestroy(()=>r(n&&o$(n,"destroy",t)));break}}function o$(t,e,n){let r=n.totalTime,i=!!n.disabled,o=R$(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,r??t.totalTime,i),s=t._data;return s!=null&&(o._data=s),o}function R$(t,e,n,r,i="",o=0,s){return{element:t,triggerName:e,fromState:n,toState:r,phaseName:i,totalTime:o,disabled:!!s}}function Ga(t,e,n){let r=t.get(e);return r||t.set(e,r=n),r}function Eve(t){let e=t.indexOf(":"),n=t.substring(1,e),r=t.slice(e+1);return[n,r]}var Hot=(()=>typeof document>"u"?null:document.documentElement)();function D$(t){let e=t.parentNode||t.host||null;return e===Hot?null:e}function Vot(t){return t.substring(1,6)=="ebkit"}var n0=null,xve=!1;function Bot(t){n0||(n0=Uot()||{},xve=n0.style?"WebkitAppearance"in n0.style:!1);let e=!0;return n0.style&&!Vot(t)&&(e=t in n0.style,!e&&xve&&(e="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in n0.style)),e}function Uot(){return typeof document<"u"?document.body:null}function Lve(t,e){for(;e;){if(e===t)return!0;e=D$(e)}return!1}function Hve(t,e,n){if(n)return Array.from(t.querySelectorAll(e));let r=t.querySelector(e);return r?[r]:[]}var I$=(()=>{let e=class e{validateStyleProperty(r){return Bot(r)}matchesElement(r,i){return!1}containsElement(r,i){return Lve(r,i)}getParentElement(r){return D$(r)}query(r,i,o){return Hve(r,i,o)}computeStyle(r,i,o){return o||""}animate(r,i,o,s,a,l=[],c){return new _m(o,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})(),MT=(()=>{let e=class e{};e.NOOP=new I$;let t=e;return t})(),o0=class{};var Wot=1e3,Vve="{{",jot="}}",Bve="ng-enter",d$="ng-leave",ek="ng-trigger",ok=".ng-trigger",bve="ng-animating",h$=".ng-animating";function gh(t){if(typeof t=="number")return t;let e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:f$(parseFloat(e[1]),e[2])}function f$(t,e){switch(e){case"s":return t*Wot;default:return t}}function sk(t,e,n){return t.hasOwnProperty("duration")?t:$ot(t,e,n)}function $ot(t,e,n){let r=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,i,o=0,s="";if(typeof t=="string"){let a=t.match(r);if(a===null)return e.push(Sve(t)),{duration:0,delay:0,easing:""};i=f$(parseFloat(a[1]),a[2]);let l=a[3];l!=null&&(o=f$(parseFloat(l),a[4]));let c=a[5];c&&(s=c)}else i=t;if(!n){let a=!1,l=e.length;i<0&&(e.push(aot()),a=!0),o<0&&(e.push(lot()),a=!0),a&&e.splice(l,0,Sve(t))}return{duration:i,delay:o,easing:s}}function OT(t,e={}){return Object.keys(t).forEach(n=>{e[n]=t[n]}),e}function Uve(t){let e=new Map;return Object.keys(t).forEach(n=>{let r=t[n];e.set(n,r)}),e}function Got(t){return t.length?t[0]instanceof Map?t:t.map(e=>Uve(e)):[]}function i_(t,e=new Map,n){if(n)for(let[r,i]of n)e.set(r,i);for(let[r,i]of t)e.set(r,i);return e}function qu(t,e,n){e.forEach((r,i)=>{let o=A$(i);n&&!n.has(i)&&n.set(i,t.style[o]),t.style[o]=r})}function i0(t,e){e.forEach((n,r)=>{let i=A$(r);t.style[i]=""})}function bT(t){return Array.isArray(t)?t.length==1?t[0]:Cve(t):t}function zot(t,e,n){let r=e.params||{},i=Wve(t);i.length&&i.forEach(o=>{r.hasOwnProperty(o)||n.push(cot(o))})}var m$=new RegExp(`${Vve}\\s*(.+?)\\s*${jot}`,"g");function Wve(t){let e=[];if(typeof t=="string"){let n;for(;n=m$.exec(t);)e.push(n[1]);m$.lastIndex=0}return e}function RT(t,e,n){let r=t.toString(),i=r.replace(m$,(o,s)=>{let a=e[s];return a==null&&(n.push(uot(s)),a=""),a.toString()});return i==r?t:i}function ak(t){let e=[],n=t.next();for(;!n.done;)e.push(n.value),n=t.next();return e}var Yot=/-+([a-z0-9])/g;function A$(t){return t.replace(Yot,(...e)=>e[1].toUpperCase())}function qot(t,e){return t===0||e===0}function Kot(t,e,n){if(n.size&&e.length){let r=e[0],i=[];if(n.forEach((o,s)=>{r.has(s)||i.push(s),r.set(s,o)}),i.length)for(let o=1;o<e.length;o++){let s=e[o];i.forEach(a=>s.set(a,jve(t,a)))}}return e}function $a(t,e,n){switch(e.type){case 7:return t.visitTrigger(e,n);case 0:return t.visitState(e,n);case 1:return t.visitTransition(e,n);case 2:return t.visitSequence(e,n);case 3:return t.visitGroup(e,n);case 4:return t.visitAnimate(e,n);case 5:return t.visitKeyframes(e,n);case 6:return t.visitStyle(e,n);case 8:return t.visitReference(e,n);case 9:return t.visitAnimateChild(e,n);case 10:return t.visitAnimateRef(e,n);case 11:return t.visitQuery(e,n);case 12:return t.visitStagger(e,n);default:throw dot(e.type)}}function jve(t,e){return window.getComputedStyle(t)[e]}var Xot=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),lk=class extends o0{normalizePropertyName(e,n){return A$(e)}normalizeStyleValue(e,n,r,i){let o="",s=r.toString().trim();if(Xot.has(n)&&r!==0&&r!=="0")if(typeof r=="number")o="px";else{let a=r.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&a[1].length==0&&i.push(hot(e,r))}return s+o}};var ck="*";function Zot(t,e){let n=[];return typeof t=="string"?t.split(/\s*,\s*/).forEach(r=>Qot(r,n,e)):n.push(t),n}function Qot(t,e,n){if(t[0]==":"){let l=Jot(t,n);if(typeof l=="function"){e.push(l);return}t=l}let r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(r==null||r.length<4)return n.push(xot(t)),e;let i=r[1],o=r[2],s=r[3];e.push(Tve(i,s));let a=i==ck&&s==ck;o[0]=="<"&&!a&&e.push(Tve(s,i))}function Jot(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(n,r)=>parseFloat(r)>parseFloat(n);case":decrement":return(n,r)=>parseFloat(r)<parseFloat(n);default:return e.push(bot(t)),"* => *"}}var tk=new Set(["true","1"]),nk=new Set(["false","0"]);function Tve(t,e){let n=tk.has(t)||nk.has(t),r=tk.has(e)||nk.has(e);return(i,o)=>{let s=t==ck||t==i,a=e==ck||e==o;return!s&&n&&typeof i=="boolean"&&(s=i?tk.has(t):nk.has(t)),!a&&r&&typeof o=="boolean"&&(a=o?tk.has(e):nk.has(e)),s&&a}}var $ve=":self",est=new RegExp(`s*${$ve}s*,?`,"g");function Gve(t,e,n,r){return new p$(t).build(e,n,r)}var Rve="",p$=class{constructor(e){this._driver=e}build(e,n,r){let i=new g$(n);return this._resetContextStyleTimingState(i),$a(this,bT(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector=Rve,e.collectedStyles=new Map,e.collectedStyles.set(Rve,new Map),e.currentTime=0}visitTrigger(e,n){let r=n.queryCount=0,i=n.depCount=0,o=[],s=[];return e.name.charAt(0)=="@"&&n.errors.push(fot()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(n),a.type==0){let l=a,c=l.name;c.toString().split(/\s*,\s*/).forEach(u=>{l.name=u,o.push(this.visitState(l,n))}),l.name=c}else if(a.type==1){let l=this.visitTransition(a,n);r+=l.queryCount,i+=l.depCount,s.push(l)}else n.errors.push(mot())}),{type:7,name:e.name,states:o,transitions:s,queryCount:r,depCount:i,options:null}}visitState(e,n){let r=this.visitStyle(e.styles,n),i=e.options&&e.options.params||null;if(r.containsDynamicStyles){let o=new Set,s=i||{};if(r.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{Wve(l).forEach(c=>{s.hasOwnProperty(c)||o.add(c)})})}),o.size){let a=ak(o.values());n.errors.push(pot(e.name,a))}}return{type:0,name:e.name,style:r,options:i?{params:i}:null}}visitTransition(e,n){n.queryCount=0,n.depCount=0;let r=$a(this,bT(e.animation),n);return{type:1,matchers:Zot(e.expr,n.errors),animation:r,queryCount:n.queryCount,depCount:n.depCount,options:r0(e.options)}}visitSequence(e,n){return{type:2,steps:e.steps.map(r=>$a(this,r,n)),options:r0(e.options)}}visitGroup(e,n){let r=n.currentTime,i=0,o=e.steps.map(s=>{n.currentTime=r;let a=$a(this,s,n);return i=Math.max(i,n.currentTime),a});return n.currentTime=i,{type:3,steps:o,options:r0(e.options)}}visitAnimate(e,n){let r=ist(e.timings,n.errors);n.currentAnimateTimings=r;let i,o=e.styles?e.styles:i$({});if(o.type==5)i=this.visitKeyframes(o,n);else{let s=e.styles,a=!1;if(!s){a=!0;let c={};r.easing&&(c.easing=r.easing),s=i$(c)}n.currentTime+=r.duration+r.delay;let l=this.visitStyle(s,n);l.isEmptyStep=a,i=l}return n.currentAnimateTimings=null,{type:4,timings:r,style:i,options:null}}visitStyle(e,n){let r=this._makeStyleAst(e,n);return this._validateStyleAst(r,n),r}_makeStyleAst(e,n){let r=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)typeof a=="string"?a===Yu?r.push(a):n.errors.push(got(a)):r.push(Uve(a));let o=!1,s=null;return r.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o)){for(let l of a.values())if(l.toString().indexOf(Vve)>=0){o=!0;break}}}),{type:6,styles:r,easing:s,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,n){let r=n.currentAnimateTimings,i=n.currentTime,o=n.currentTime;r&&o>0&&(o-=r.duration+r.delay),e.styles.forEach(s=>{typeof s!="string"&&s.forEach((a,l)=>{let c=n.collectedStyles.get(n.currentQuerySelector),u=c.get(l),d=!0;u&&(o!=i&&o>=u.startTime&&i<=u.endTime&&(n.errors.push(vot(l,u.startTime,u.endTime,o,i)),d=!1),o=u.startTime),d&&c.set(l,{startTime:o,endTime:i}),n.options&&zot(a,n.options,n.errors)})})}visitKeyframes(e,n){let r={type:5,styles:[],options:null};if(!n.currentAnimateTimings)return n.errors.push(wot()),r;let i=1,o=0,s=[],a=!1,l=!1,c=0,u=e.steps.map(_=>{let S=this._makeStyleAst(_,n),x=S.offset!=null?S.offset:rst(S.styles),P=0;return x!=null&&(o++,P=S.offset=x),l=l||P<0||P>1,a=a||P<c,c=P,s.push(P),S});l&&n.errors.push(yot()),a&&n.errors.push(_ot());let d=e.steps.length,h=0;o>0&&o<d?n.errors.push(Cot()):o==0&&(h=i/(d-1));let f=d-1,p=n.currentTime,g=n.currentAnimateTimings,w=g.duration;return u.forEach((_,S)=>{let x=h>0?S==f?1:h*S:s[S],P=x*w;n.currentTime=p+g.delay+P,g.duration=P,this._validateStyleAst(_,n),_.offset=x,r.styles.push(_)}),r}visitReference(e,n){return{type:8,animation:$a(this,bT(e.animation),n),options:r0(e.options)}}visitAnimateChild(e,n){return n.depCount++,{type:9,options:r0(e.options)}}visitAnimateRef(e,n){return{type:10,animation:this.visitReference(e.animation,n),options:r0(e.options)}}visitQuery(e,n){let r=n.currentQuerySelector,i=e.options||{};n.queryCount++,n.currentQuery=e;let[o,s]=tst(e.selector);n.currentQuerySelector=r.length?r+" "+o:o,Ga(n.collectedStyles,n.currentQuerySelector,new Map);let a=$a(this,bT(e.animation),n);return n.currentQuery=null,n.currentQuerySelector=r,{type:11,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:a,originalSelector:e.selector,options:r0(e.options)}}visitStagger(e,n){n.currentQuery||n.errors.push(Sot());let r=e.timings==="full"?{duration:0,delay:0,easing:"full"}:sk(e.timings,n.errors,!0);return{type:12,animation:$a(this,bT(e.animation),n),timings:r,options:null}}};function tst(t){let e=!!t.split(/\s*,\s*/).find(n=>n==$ve);return e&&(t=t.replace(est,"")),t=t.replace(/@\*/g,ok).replace(/@\w+/g,n=>ok+"-"+n.slice(1)).replace(/:animating/g,h$),[t,e]}function nst(t){return t?OT(t):null}var g$=class{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function rst(t){if(typeof t=="string")return null;let e=null;if(Array.isArray(t))t.forEach(n=>{if(n instanceof Map&&n.has("offset")){let r=n;e=parseFloat(r.get("offset")),r.delete("offset")}});else if(t instanceof Map&&t.has("offset")){let n=t;e=parseFloat(n.get("offset")),n.delete("offset")}return e}function ist(t,e){if(t.hasOwnProperty("duration"))return t;if(typeof t=="number"){let o=sk(t,e).duration;return s$(o,0,"")}let n=t;if(n.split(/\s+/).some(o=>o.charAt(0)=="{"&&o.charAt(1)=="{")){let o=s$(0,0,"");return o.dynamic=!0,o.strValue=n,o}let i=sk(n,e);return s$(i.duration,i.delay,i.easing)}function r0(t){return t?(t=OT(t),t.params&&(t.params=nst(t.params))):t={},t}function s$(t,e,n){return{duration:t,delay:e,easing:n}}function M$(t,e,n,r,i,o,s=null,a=!1){return{type:1,element:t,keyframes:e,preStyleProps:n,postStyleProps:r,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}var DT=class{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,n){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...n)}has(e){return this._map.has(e)}clear(){this._map.clear()}},ost=1,sst=":enter",ast=new RegExp(sst,"g"),lst=":leave",cst=new RegExp(lst,"g");function zve(t,e,n,r,i,o=new Map,s=new Map,a,l,c=[]){return new v$().buildKeyframes(t,e,n,r,i,o,s,a,l,c)}var v$=class{buildKeyframes(e,n,r,i,o,s,a,l,c,u=[]){c=c||new DT;let d=new w$(e,n,c,i,o,u,[]);d.options=l;let h=l.delay?gh(l.delay):0;d.currentTimeline.delayNextStep(h),d.currentTimeline.setStyles([s],null,d.errors,l),$a(this,r,d);let f=d.timelines.filter(p=>p.containsAnimation());if(f.length&&a.size){let p;for(let g=f.length-1;g>=0;g--){let w=f[g];if(w.element===n){p=w;break}}p&&!p.allowOnlyTimelineStyles()&&p.setStyles([a],null,d.errors,l)}return f.length?f.map(p=>p.buildKeyframes()):[M$(n,[],[],[],0,h,"",!1)]}visitTrigger(e,n){}visitState(e,n){}visitTransition(e,n){}visitAnimateChild(e,n){let r=n.subInstructions.get(n.element);if(r){let i=n.createSubContext(e.options),o=n.currentTimeline.currentTime,s=this._visitSubInstructions(r,i,i.options);o!=s&&n.transformIntoNewTimeline(s)}n.previousNode=e}visitAnimateRef(e,n){let r=n.createSubContext(e.options);r.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],n,r),this.visitReference(e.animation,r),n.transformIntoNewTimeline(r.currentTimeline.currentTime),n.previousNode=e}_applyAnimationRefDelays(e,n,r){for(let i of e){let o=i?.delay;if(o){let s=typeof o=="number"?o:gh(RT(o,i?.params??{},n.errors));r.delayNextStep(s)}}}_visitSubInstructions(e,n,r){let o=n.currentTimeline.currentTime,s=r.duration!=null?gh(r.duration):null,a=r.delay!=null?gh(r.delay):null;return s!==0&&e.forEach(l=>{let c=n.appendInstructionToTimeline(l,s,a);o=Math.max(o,c.duration+c.delay)}),o}visitReference(e,n){n.updateOptions(e.options,!0),$a(this,e.animation,n),n.previousNode=e}visitSequence(e,n){let r=n.subContextCount,i=n,o=e.options;if(o&&(o.params||o.delay)&&(i=n.createSubContext(o),i.transformIntoNewTimeline(),o.delay!=null)){i.previousNode.type==6&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=uk);let s=gh(o.delay);i.delayNextStep(s)}e.steps.length&&(e.steps.forEach(s=>$a(this,s,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>r&&i.transformIntoNewTimeline()),n.previousNode=e}visitGroup(e,n){let r=[],i=n.currentTimeline.currentTime,o=e.options&&e.options.delay?gh(e.options.delay):0;e.steps.forEach(s=>{let a=n.createSubContext(e.options);o&&a.delayNextStep(o),$a(this,s,a),i=Math.max(i,a.currentTimeline.currentTime),r.push(a.currentTimeline)}),r.forEach(s=>n.currentTimeline.mergeTimelineCollectedStyles(s)),n.transformIntoNewTimeline(i),n.previousNode=e}_visitTiming(e,n){if(e.dynamic){let r=e.strValue,i=n.params?RT(r,n.params,n.errors):r;return sk(i,n.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,n){let r=n.currentAnimateTimings=this._visitTiming(e.timings,n),i=n.currentTimeline;r.delay&&(n.incrementTime(r.delay),i.snapshotCurrentStyles());let o=e.style;o.type==5?this.visitKeyframes(o,n):(n.incrementTime(r.duration),this.visitStyle(o,n),i.applyStylesToKeyframe()),n.currentAnimateTimings=null,n.previousNode=e}visitStyle(e,n){let r=n.currentTimeline,i=n.currentAnimateTimings;!i&&r.hasCurrentStyleProperties()&&r.forwardFrame();let o=i&&i.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(o):r.setStyles(e.styles,o,n.errors,n.options),n.previousNode=e}visitKeyframes(e,n){let r=n.currentAnimateTimings,i=n.currentTimeline.duration,o=r.duration,a=n.createSubContext().currentTimeline;a.easing=r.easing,e.styles.forEach(l=>{let c=l.offset||0;a.forwardTime(c*o),a.setStyles(l.styles,l.easing,n.errors,n.options),a.applyStylesToKeyframe()}),n.currentTimeline.mergeTimelineCollectedStyles(a),n.transformIntoNewTimeline(i+o),n.previousNode=e}visitQuery(e,n){let r=n.currentTimeline.currentTime,i=e.options||{},o=i.delay?gh(i.delay):0;o&&(n.previousNode.type===6||r==0&&n.currentTimeline.hasCurrentStyleProperties())&&(n.currentTimeline.snapshotCurrentStyles(),n.previousNode=uk);let s=r,a=n.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,n.errors);n.currentQueryTotal=a.length;let l=null;a.forEach((c,u)=>{n.currentQueryIndex=u;let d=n.createSubContext(e.options,c);o&&d.delayNextStep(o),c===n.element&&(l=d.currentTimeline),$a(this,e.animation,d),d.currentTimeline.applyStylesToKeyframe();let h=d.currentTimeline.currentTime;s=Math.max(s,h)}),n.currentQueryIndex=0,n.currentQueryTotal=0,n.transformIntoNewTimeline(s),l&&(n.currentTimeline.mergeTimelineCollectedStyles(l),n.currentTimeline.snapshotCurrentStyles()),n.previousNode=e}visitStagger(e,n){let r=n.parentContext,i=n.currentTimeline,o=e.timings,s=Math.abs(o.duration),a=s*(n.currentQueryTotal-1),l=s*n.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=a-l;break;case"full":l=r.currentStaggerTime;break}let u=n.currentTimeline;l&&u.delayNextStep(l);let d=u.currentTime;$a(this,e.animation,n),n.previousNode=e,r.currentStaggerTime=i.currentTime-d+(i.startTime-r.currentTimeline.startTime)}},uk={},w$=class t{constructor(e,n,r,i,o,s,a,l){this._driver=e,this.element=n,this.subInstructions=r,this._enterClassName=i,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=uk,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new dk(this._driver,n,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,n){if(!e)return;let r=e,i=this.options;r.duration!=null&&(i.duration=gh(r.duration)),r.delay!=null&&(i.delay=gh(r.delay));let o=r.params;if(o){let s=i.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!n||!s.hasOwnProperty(a))&&(s[a]=RT(o[a],s,this.errors))})}}_copyOptions(){let e={};if(this.options){let n=this.options.params;if(n){let r=e.params={};Object.keys(n).forEach(i=>{r[i]=n[i]})}}return e}createSubContext(e=null,n,r){let i=n||this.element,o=new t(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,r||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=uk,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,n,r){let i={duration:n??e.duration,delay:this.currentTimeline.currentTime+(r??0)+e.delay,easing:""},o=new y$(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,n,r,i,o,s){let a=[];if(i&&a.push(this.element),e.length>0){e=e.replace(ast,"."+this._enterClassName),e=e.replace(cst,"."+this._leaveClassName);let l=r!=1,c=this._driver.query(this.element,e,l);r!==0&&(c=r<0?c.slice(c.length+r,c.length):c.slice(0,r)),a.push(...c)}return!o&&a.length==0&&s.push(Eot(n)),a}},dk=class t{constructor(e,n,r,i){this._driver=e,this.element=n,this.startTime=r,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let n=this._keyframes.size===1&&this._pendingStyles.size;this.duration||n?(this.forwardTime(this.currentTime+e),n&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,n){return this.applyStylesToKeyframe(),new t(this._driver,e,n||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=ost,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,n){this._localTimelineStyles.set(e,n),this._globalTimelineStyles.set(e,n),this._styleSummary.set(e,{time:this.currentTime,value:n})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[n,r]of this._globalTimelineStyles)this._backFill.set(n,r||Yu),this._currentKeyframe.set(n,Yu);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,n,r,i){n&&this._previousKeyframe.set("easing",n);let o=i&&i.params||{},s=ust(e,this._globalTimelineStyles);for(let[a,l]of s){let c=RT(l,o,r);this._pendingStyles.set(a,c),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Yu),this._updateStyle(a,c)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,n)=>{this._currentKeyframe.set(n,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,n)=>{this._currentKeyframe.has(n)||this._currentKeyframe.set(n,e)}))}snapshotCurrentStyles(){for(let[e,n]of this._localTimelineStyles)this._pendingStyles.set(e,n),this._updateStyle(e,n)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let n in this._currentKeyframe)e.push(n);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((n,r)=>{let i=this._styleSummary.get(r);(!i||n.time>i.time)&&this._updateStyle(r,n.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,n=new Set,r=this._keyframes.size===1&&this.duration===0,i=[];this._keyframes.forEach((a,l)=>{let c=i_(a,new Map,this._backFill);c.forEach((u,d)=>{u===JP?e.add(d):u===Yu&&n.add(d)}),r||c.set("offset",l/this.duration),i.push(c)});let o=e.size?ak(e.values()):[],s=n.size?ak(n.values()):[];if(r){let a=i[0],l=new Map(a);a.set("offset",0),l.set("offset",1),i=[a,l]}return M$(this.element,i,o,s,this.duration,this.startTime,this.easing,!1)}},y$=class extends dk{constructor(e,n,r,i,o,s,a=!1){super(e,n,s.delay),this.keyframes=r,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:n,duration:r,easing:i}=this.timings;if(this._stretchStartingKeyframe&&n){let o=[],s=r+n,a=n/s,l=i_(e[0]);l.set("offset",0),o.push(l);let c=i_(e[0]);c.set("offset",Dve(a)),o.push(c);let u=e.length-1;for(let d=1;d<=u;d++){let h=i_(e[d]),f=h.get("offset"),p=n+f*r;h.set("offset",Dve(p/s)),o.push(h)}r=s,n=0,i="",e=o}return M$(this.element,e,this.preStyleProps,this.postStyleProps,r,n,i,!0)}};function Dve(t,e=3){let n=Math.pow(10,e-1);return Math.round(t*n)/n}function ust(t,e){let n=new Map,r;return t.forEach(i=>{if(i==="*"){r=r||e.keys();for(let o of r)n.set(o,Yu)}else i_(i,n)}),n}function Ive(t,e,n,r,i,o,s,a,l,c,u,d,h){return{type:0,element:t,triggerName:e,isRemovalTransition:i,fromState:n,fromStyles:o,toState:r,toStyles:s,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:d,errors:h}}var a$={},hk=class{constructor(e,n,r){this._triggerName=e,this.ast=n,this._stateStyles=r}match(e,n,r,i){return dst(this.ast.matchers,e,n,r,i)}buildStyles(e,n,r){let i=this._stateStyles.get("*");return e!==void 0&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(n,r):new Map}build(e,n,r,i,o,s,a,l,c,u){let d=[],h=this.ast.options&&this.ast.options.params||a$,f=a&&a.params||a$,p=this.buildStyles(r,f,d),g=l&&l.params||a$,w=this.buildStyles(i,g,d),_=new Set,S=new Map,x=new Map,P=i==="void",k={params:hst(g,h),delay:this.ast.options?.delay},b=u?[]:zve(e,n,this.ast.animation,o,s,p,w,k,c,d),C=0;if(b.forEach(B=>{C=Math.max(B.duration+B.delay,C)}),d.length)return Ive(n,this._triggerName,r,i,P,p,w,[],[],S,x,C,d);b.forEach(B=>{let Y=B.element,ee=Ga(S,Y,new Set);B.preStyleProps.forEach(Ce=>ee.add(Ce));let te=Ga(x,Y,new Set);B.postStyleProps.forEach(Ce=>te.add(Ce)),Y!==n&&_.add(Y)});let N=ak(_.values());return Ive(n,this._triggerName,r,i,P,p,w,b,N,S,x,C)}};function dst(t,e,n,r,i){return t.some(o=>o(e,n,r,i))}function hst(t,e){let n=OT(e);for(let r in t)t.hasOwnProperty(r)&&t[r]!=null&&(n[r]=t[r]);return n}var _$=class{constructor(e,n,r){this.styles=e,this.defaultParams=n,this.normalizer=r}buildStyles(e,n){let r=new Map,i=OT(this.defaultParams);return Object.keys(e).forEach(o=>{let s=e[o];s!==null&&(i[o]=s)}),this.styles.styles.forEach(o=>{typeof o!="string"&&o.forEach((s,a)=>{s&&(s=RT(s,i,n));let l=this.normalizer.normalizePropertyName(a,n);s=this.normalizer.normalizeStyleValue(a,l,s,n),r.set(a,s)})}),r}};function fst(t,e,n){return new C$(t,e,n)}var C$=class{constructor(e,n,r){this.name=e,this.ast=n,this._normalizer=r,this.transitionFactories=[],this.states=new Map,n.states.forEach(i=>{let o=i.options&&i.options.params||{};this.states.set(i.name,new _$(i.style,o,r))}),Ave(this.states,"true","1"),Ave(this.states,"false","0"),n.transitions.forEach(i=>{this.transitionFactories.push(new hk(e,i,this.states))}),this.fallbackTransition=mst(e,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,n,r,i){return this.transitionFactories.find(s=>s.match(e,n,r,i))||null}matchStyles(e,n,r){return this.fallbackTransition.buildStyles(e,n,r)}};function mst(t,e,n){let o={type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0};return new hk(t,o,e)}function Ave(t,e,n){t.has(e)?t.has(n)||t.set(n,t.get(e)):t.has(n)&&t.set(e,t.get(n))}var pst=new DT,S$=class{constructor(e,n,r){this.bodyNode=e,this._driver=n,this._normalizer=r,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,n){let r=[],i=[],o=Gve(this._driver,n,r,i);if(r.length)throw Dot(r);i.length&&void 0,this._animations.set(e,o)}_buildPlayer(e,n,r){let i=e.element,o=Fve(this._normalizer,e.keyframes,n,r);return this._driver.animate(i,o,e.duration,e.delay,e.easing,[],!0)}create(e,n,r={}){let i=[],o=this._animations.get(e),s,a=new Map;if(o?(s=zve(this._driver,n,o,Bve,d$,new Map,new Map,r,pst,i),s.forEach(u=>{let d=Ga(a,u.element,new Map);u.postStyleProps.forEach(h=>d.set(h,null))})):(i.push(Iot()),s=[]),i.length)throw Aot(i);a.forEach((u,d)=>{u.forEach((h,f)=>{u.set(f,this._driver.computeStyle(d,f,Yu))})});let l=s.map(u=>{let d=a.get(u.element);return this._buildPlayer(u,new Map,d)}),c=Cm(l);return this._playersById.set(e,c),c.onDestroy(()=>this.destroy(e)),this.players.push(c),c}destroy(e){let n=this._getPlayer(e);n.destroy(),this._playersById.delete(e);let r=this.players.indexOf(n);r>=0&&this.players.splice(r,1)}_getPlayer(e){let n=this._playersById.get(e);if(!n)throw Mot(e);return n}listen(e,n,r,i){let o=R$(n,"","","");return T$(this._getPlayer(e),r,o,i),()=>{}}command(e,n,r,i){if(r=="register"){this.register(e,i[0]);return}if(r=="create"){let s=i[0]||{};this.create(e,n,s);return}let o=this._getPlayer(e);switch(r){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e);break}}},Mve="ng-animate-queued",gst=".ng-animate-queued",l$="ng-animate-disabled",vst=".ng-animate-disabled",wst="ng-star-inserted",yst=".ng-star-inserted",_st=[],Yve={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Cst={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Vc="__ng_removed",IT=class{get params(){return this.options.params}constructor(e,n=""){this.namespaceId=n;let r=e&&e.hasOwnProperty("value"),i=r?e.value:e;if(this.value=Est(i),r){let o=OT(e);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let n=e.params;if(n){let r=this.options.params;Object.keys(n).forEach(i=>{r[i]==null&&(r[i]=n[i])})}}},TT="void",c$=new IT(TT),E$=class{constructor(e,n,r){this.id=e,this.hostElement=n,this._engine=r,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Pl(n,this._hostClassName)}listen(e,n,r,i){if(!this._triggers.has(n))throw Oot(r,n);if(r==null||r.length==0)throw Not(n);if(!xst(r))throw Pot(r,n);let o=Ga(this._elementListeners,e,[]),s={name:n,phase:r,callback:i};o.push(s);let a=Ga(this._engine.statesByElement,e,new Map);return a.has(n)||(Pl(e,ek),Pl(e,ek+"-"+n),a.set(n,c$)),()=>{this._engine.afterFlush(()=>{let l=o.indexOf(s);l>=0&&o.splice(l,1),this._triggers.has(n)||a.delete(n)})}}register(e,n){return this._triggers.has(e)?!1:(this._triggers.set(e,n),!0)}_getTrigger(e){let n=this._triggers.get(e);if(!n)throw kot(e);return n}trigger(e,n,r,i=!0){let o=this._getTrigger(n),s=new AT(this.id,n,e),a=this._engine.statesByElement.get(e);a||(Pl(e,ek),Pl(e,ek+"-"+n),this._engine.statesByElement.set(e,a=new Map));let l=a.get(n),c=new IT(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),a.set(n,c),l||(l=c$),!(c.value===TT)&&l.value===c.value){if(!Rst(l.params,c.params)){let g=[],w=o.matchStyles(l.value,l.params,g),_=o.matchStyles(c.value,c.params,g);g.length?this._engine.reportError(g):this._engine.afterFlush(()=>{i0(e,w),qu(e,_)})}return}let h=Ga(this._engine.playersByElement,e,[]);h.forEach(g=>{g.namespaceId==this.id&&g.triggerName==n&&g.queued&&g.destroy()});let f=o.matchTransition(l.value,c.value,e,c.params),p=!1;if(!f){if(!i)return;f=o.fallbackTransition,p=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:n,transition:f,fromState:l,toState:c,player:s,isFallbackTransition:p}),p||(Pl(e,Mve),s.onStart(()=>{r_(e,Mve)})),s.onDone(()=>{let g=this.players.indexOf(s);g>=0&&this.players.splice(g,1);let w=this._engine.playersByElement.get(e);if(w){let _=w.indexOf(s);_>=0&&w.splice(_,1)}}),this.players.push(s),h.push(s),s}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(n=>n.delete(e)),this._elementListeners.forEach((n,r)=>{this._elementListeners.set(r,n.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let n=this._engine.playersByElement.get(e);n&&(n.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,n){let r=this._engine.driver.query(e,ok,!0);r.forEach(i=>{if(i[Vc])return;let o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(s=>s.triggerLeaveAnimation(i,n,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,n,r,i){let o=this._engine.statesByElement.get(e),s=new Map;if(o){let a=[];if(o.forEach((l,c)=>{if(s.set(c,l.value),this._triggers.has(c)){let u=this.trigger(e,c,TT,i);u&&a.push(u)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,n,s),r&&Cm(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let n=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(n&&r){let i=new Set;n.forEach(o=>{let s=o.name;if(i.has(s))return;i.add(s);let l=this._triggers.get(s).fallbackTransition,c=r.get(s)||c$,u=new IT(TT),d=new AT(this.id,s,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:s,transition:l,fromState:c,toState:u,player:d,isFallbackTransition:!0})})}}removeNode(e,n){let r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,n),this.triggerLeaveAnimation(e,n,!0))return;let i=!1;if(r.totalAnimations){let o=r.players.length?r.playersByQueriedElement.get(e):[];if(o&&o.length)i=!0;else{let s=e;for(;s=s.parentNode;)if(r.statesByElement.get(s)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)r.markElementAsRemoved(this.id,e,!1,n);else{let o=e[Vc];(!o||o===Yve)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,n))}}insertNode(e,n){Pl(e,this._hostClassName)}drainQueuedTransitions(e){let n=[];return this._queue.forEach(r=>{let i=r.player;if(i.destroyed)return;let o=r.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==r.triggerName){let l=R$(o,r.triggerName,r.fromState.value,r.toState.value);l._data=e,T$(r.player,a.phase,l,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):n.push(r)}),this._queue=[],n.sort((r,i)=>{let o=r.transition.ast.depCount,s=i.transition.ast.depCount;return o==0||s==0?o-s:this._engine.driver.containsElement(r.element,i.element)?1:-1})}destroy(e){this.players.forEach(n=>n.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},x$=class{_onRemovalComplete(e,n){this.onRemovalComplete(e,n)}constructor(e,n,r){this.bodyNode=e,this.driver=n,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,o)=>{}}get queuedPlayers(){let e=[];return this._namespaceList.forEach(n=>{n.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,n){let r=new E$(e,n,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,n)?this._balanceNamespaceList(r,n):(this.newHostElements.set(n,r),this.collectEnterElement(n)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,n){let r=this._namespaceList,i=this.namespacesByHostElement;if(r.length-1>=0){let s=!1,a=this.driver.getParentElement(n);for(;a;){let l=i.get(a);if(l){let c=r.indexOf(l);r.splice(c+1,0,e),s=!0;break}a=this.driver.getParentElement(a)}s||r.unshift(e)}else r.push(e);return i.set(n,e),e}register(e,n){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,n)),r}registerTrigger(e,n,r){let i=this._namespaceLookup[e];i&&i.register(n,r)&&this.totalAnimations++}destroy(e,n){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let r=this._fetchNamespace(e);this.namespacesByHostElement.delete(r.hostElement);let i=this._namespaceList.indexOf(r);i>=0&&this._namespaceList.splice(i,1),r.destroy(n),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let n=new Set,r=this.statesByElement.get(e);if(r){for(let i of r.values())if(i.namespaceId){let o=this._fetchNamespace(i.namespaceId);o&&n.add(o)}}return n}trigger(e,n,r,i){if(rk(n)){let o=this._fetchNamespace(e);if(o)return o.trigger(n,r,i),!0}return!1}insertNode(e,n,r,i){if(!rk(n))return;let o=n[Vc];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;let s=this.collectedLeaveElements.indexOf(n);s>=0&&this.collectedLeaveElements.splice(s,1)}if(e){let s=this._fetchNamespace(e);s&&s.insertNode(n,r)}i&&this.collectEnterElement(n)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,n){n?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Pl(e,l$)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),r_(e,l$))}removeNode(e,n,r){if(rk(n)){let i=e?this._fetchNamespace(e):null;i?i.removeNode(n,r):this.markElementAsRemoved(e,n,!1,r);let o=this.namespacesByHostElement.get(n);o&&o.id!==e&&o.removeNode(n,r)}else this._onRemovalComplete(n,r)}markElementAsRemoved(e,n,r,i,o){this.collectedLeaveElements.push(n),n[Vc]={namespaceId:e,setForRemoval:i,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,n,r,i,o){return rk(n)?this._fetchNamespace(e).listen(n,r,i,o):()=>{}}_buildInstruction(e,n,r,i,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,i,e.fromState.options,e.toState.options,n,o)}destroyInnerAnimations(e){let n=this.driver.query(e,ok,!0);n.forEach(r=>this.destroyActiveAnimationsForElement(r)),this.playersByQueriedElement.size!=0&&(n=this.driver.query(e,h$,!0),n.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){let n=this.playersByElement.get(e);n&&n.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){let n=this.playersByQueriedElement.get(e);n&&n.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Cm(this.players).onDone(()=>e());e()})}processLeaveNode(e){let n=e[Vc];if(n&&n.setForRemoval){if(e[Vc]=Yve,n.namespaceId){this.destroyInnerAnimations(e);let r=this._fetchNamespace(n.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}e.classList?.contains(l$)&&this.markElementAsDisabled(e,!1),this.driver.query(e,vst,!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let n=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,i)=>this._balanceNamespaceList(r,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++){let i=this.collectedEnterElements[r];Pl(i,wst)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let r=[];try{n=this._flushAnimations(r,e)}finally{for(let i=0;i<r.length;i++)r[i]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++){let i=this.collectedLeaveElements[r];this.processLeaveNode(i)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){let r=this._whenQuietFns;this._whenQuietFns=[],n.length?Cm(n).onDone(()=>{r.forEach(i=>i())}):r.forEach(i=>i())}}reportError(e){throw Fot(e)}_flushAnimations(e,n){let r=new DT,i=[],o=new Map,s=[],a=new Map,l=new Map,c=new Map,u=new Set;this.disabledNodes.forEach(L=>{u.add(L);let M=this.driver.query(L,gst,!0);for(let q=0;q<M.length;q++)u.add(M[q])});let d=this.bodyNode,h=Array.from(this.statesByElement.keys()),f=Pve(h,this.collectedEnterElements),p=new Map,g=0;f.forEach((L,M)=>{let q=Bve+g++;p.set(M,q),L.forEach(y=>Pl(y,q))});let w=[],_=new Set,S=new Set;for(let L=0;L<this.collectedLeaveElements.length;L++){let M=this.collectedLeaveElements[L],q=M[Vc];q&&q.setForRemoval&&(w.push(M),_.add(M),q.hasAnimation?this.driver.query(M,yst,!0).forEach(y=>_.add(y)):S.add(M))}let x=new Map,P=Pve(h,Array.from(_));P.forEach((L,M)=>{let q=d$+g++;x.set(M,q),L.forEach(y=>Pl(y,q))}),e.push(()=>{f.forEach((L,M)=>{let q=p.get(M);L.forEach(y=>r_(y,q))}),P.forEach((L,M)=>{let q=x.get(M);L.forEach(y=>r_(y,q))}),w.forEach(L=>{this.processLeaveNode(L)})});let k=[],b=[];for(let L=this._namespaceList.length-1;L>=0;L--)this._namespaceList[L].drainQueuedTransitions(n).forEach(q=>{let y=q.player,E=q.element;if(k.push(y),this.collectedEnterElements.length){let ue=E[Vc];if(ue&&ue.setForMove){if(ue.previousTriggersValues&&ue.previousTriggersValues.has(q.triggerName)){let fe=ue.previousTriggersValues.get(q.triggerName),de=this.statesByElement.get(q.element);if(de&&de.has(q.triggerName)){let ye=de.get(q.triggerName);ye.value=fe,de.set(q.triggerName,ye)}}y.destroy();return}}let R=!d||!this.driver.containsElement(d,E),D=x.get(E),A=p.get(E),O=this._buildInstruction(q,r,A,D,R);if(O.errors&&O.errors.length){b.push(O);return}if(R){y.onStart(()=>i0(E,O.fromStyles)),y.onDestroy(()=>qu(E,O.toStyles)),i.push(y);return}if(q.isFallbackTransition){y.onStart(()=>i0(E,O.fromStyles)),y.onDestroy(()=>qu(E,O.toStyles)),i.push(y);return}let U=[];O.timelines.forEach(ue=>{ue.stretchStartingKeyframe=!0,this.disabledNodes.has(ue.element)||U.push(ue)}),O.timelines=U,r.append(E,O.timelines);let ie={instruction:O,player:y,element:E};s.push(ie),O.queriedElements.forEach(ue=>Ga(a,ue,[]).push(y)),O.preStyleProps.forEach((ue,fe)=>{if(ue.size){let de=l.get(fe);de||l.set(fe,de=new Set),ue.forEach((ye,Pe)=>de.add(Pe))}}),O.postStyleProps.forEach((ue,fe)=>{let de=c.get(fe);de||c.set(fe,de=new Set),ue.forEach((ye,Pe)=>de.add(Pe))})});if(b.length){let L=[];b.forEach(M=>{L.push(Lot(M.triggerName,M.errors))}),k.forEach(M=>M.destroy()),this.reportError(L)}let C=new Map,N=new Map;s.forEach(L=>{let M=L.element;r.has(M)&&(N.set(M,M),this._beforeAnimationBuild(L.player.namespaceId,L.instruction,C))}),i.forEach(L=>{let M=L.element;this._getPreviousPlayers(M,!1,L.namespaceId,L.triggerName,null).forEach(y=>{Ga(C,M,[]).push(y),y.destroy()})});let B=w.filter(L=>kve(L,l,c)),Y=new Map;Nve(Y,this.driver,S,c,Yu).forEach(L=>{kve(L,l,c)&&B.push(L)});let te=new Map;f.forEach((L,M)=>{Nve(te,this.driver,new Set(L),l,JP)}),B.forEach(L=>{let M=Y.get(L),q=te.get(L);Y.set(L,new Map([...M?.entries()??[],...q?.entries()??[]]))});let Ce=[],Re=[],_e={};s.forEach(L=>{let{element:M,player:q,instruction:y}=L;if(r.has(M)){if(u.has(M)){q.onDestroy(()=>qu(M,y.toStyles)),q.disabled=!0,q.overrideTotalTime(y.totalTime),i.push(q);return}let E=_e;if(N.size>1){let D=M,A=[];for(;D=D.parentNode;){let O=N.get(D);if(O){E=O;break}A.push(D)}A.forEach(O=>N.set(O,E))}let R=this._buildAnimation(q.namespaceId,y,C,o,te,Y);if(q.setRealPlayer(R),E===_e)Ce.push(q);else{let D=this.playersByElement.get(E);D&&D.length&&(q.parentPlayer=Cm(D)),i.push(q)}}else i0(M,y.fromStyles),q.onDestroy(()=>qu(M,y.toStyles)),Re.push(q),u.has(M)&&i.push(q)}),Re.forEach(L=>{let M=o.get(L.element);if(M&&M.length){let q=Cm(M);L.setRealPlayer(q)}}),i.forEach(L=>{L.parentPlayer?L.syncPlayerEvents(L.parentPlayer):L.destroy()});for(let L=0;L<w.length;L++){let M=w[L],q=M[Vc];if(r_(M,d$),q&&q.hasAnimation)continue;let y=[];if(a.size){let R=a.get(M);R&&R.length&&y.push(...R);let D=this.driver.query(M,h$,!0);for(let A=0;A<D.length;A++){let O=a.get(D[A]);O&&O.length&&y.push(...O)}}let E=y.filter(R=>!R.destroyed);E.length?bst(this,M,E):this.processLeaveNode(M)}return w.length=0,Ce.forEach(L=>{this.players.push(L),L.onDone(()=>{L.destroy();let M=this.players.indexOf(L);this.players.splice(M,1)}),L.play()}),Ce}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,n,r,i,o){let s=[];if(n){let a=this.playersByQueriedElement.get(e);a&&(s=a)}else{let a=this.playersByElement.get(e);if(a){let l=!o||o==TT;a.forEach(c=>{c.queued||!l&&c.triggerName!=i||s.push(c)})}}return(r||i)&&(s=s.filter(a=>!(r&&r!=a.namespaceId||i&&i!=a.triggerName))),s}_beforeAnimationBuild(e,n,r){let i=n.triggerName,o=n.element,s=n.isRemovalTransition?void 0:e,a=n.isRemovalTransition?void 0:i;for(let l of n.timelines){let c=l.element,u=c!==o,d=Ga(r,c,[]);this._getPreviousPlayers(c,u,s,a,n.toState).forEach(f=>{let p=f.getRealPlayer();p.beforeDestroy&&p.beforeDestroy(),f.destroy(),d.push(f)})}i0(o,n.fromStyles)}_buildAnimation(e,n,r,i,o,s){let a=n.triggerName,l=n.element,c=[],u=new Set,d=new Set,h=n.timelines.map(p=>{let g=p.element;u.add(g);let w=g[Vc];if(w&&w.removedBeforeQueried)return new _m(p.duration,p.delay);let _=g!==l,S=Tst((r.get(g)||_st).map(C=>C.getRealPlayer())).filter(C=>{let N=C;return N.element?N.element===g:!1}),x=o.get(g),P=s.get(g),k=Fve(this._normalizer,p.keyframes,x,P),b=this._buildPlayer(p,k,S);if(p.subTimeline&&i&&d.add(g),_){let C=new AT(e,a,g);C.setRealPlayer(b),c.push(C)}return b});c.forEach(p=>{Ga(this.playersByQueriedElement,p.element,[]).push(p),p.onDone(()=>Sst(this.playersByQueriedElement,p.element,p))}),u.forEach(p=>Pl(p,bve));let f=Cm(h);return f.onDestroy(()=>{u.forEach(p=>r_(p,bve)),qu(l,n.toStyles)}),d.forEach(p=>{Ga(i,p,[]).push(f)}),f}_buildPlayer(e,n,r){return n.length>0?this.driver.animate(e.element,n,e.duration,e.delay,e.easing,r):new _m(e.duration,e.delay)}},AT=class{constructor(e,n,r){this.namespaceId=e,this.triggerName=n,this.element=r,this._player=new _m,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((n,r)=>{n.forEach(i=>T$(e,r,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let n=this._player;n.triggerCallback&&e.onStart(()=>n.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,n){Ga(this._queuedCallbacks,e,[]).push(n)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let n=this._player;n.triggerCallback&&n.triggerCallback(e)}};function Sst(t,e,n){let r=t.get(e);if(r){if(r.length){let i=r.indexOf(n);r.splice(i,1)}r.length==0&&t.delete(e)}return r}function Est(t){return t??null}function rk(t){return t&&t.nodeType===1}function xst(t){return t=="start"||t=="done"}function Ove(t,e){let n=t.style.display;return t.style.display=e??"none",n}function Nve(t,e,n,r,i){let o=[];n.forEach(l=>o.push(Ove(l)));let s=[];r.forEach((l,c)=>{let u=new Map;l.forEach(d=>{let h=e.computeStyle(c,d,i);u.set(d,h),(!h||h.length==0)&&(c[Vc]=Cst,s.push(c))}),t.set(c,u)});let a=0;return n.forEach(l=>Ove(l,o[a++])),s}function Pve(t,e){let n=new Map;if(t.forEach(a=>n.set(a,[])),e.length==0)return n;let r=1,i=new Set(e),o=new Map;function s(a){if(!a)return r;let l=o.get(a);if(l)return l;let c=a.parentNode;return n.has(c)?l=c:i.has(c)?l=r:l=s(c),o.set(a,l),l}return e.forEach(a=>{let l=s(a);l!==r&&n.get(l).push(a)}),n}function Pl(t,e){t.classList?.add(e)}function r_(t,e){t.classList?.remove(e)}function bst(t,e,n){Cm(n).onDone(()=>t.processLeaveNode(e))}function Tst(t){let e=[];return qve(t,e),e}function qve(t,e){for(let n=0;n<t.length;n++){let r=t[n];r instanceof xT?qve(r.players,e):e.push(r)}}function Rst(t,e){let n=Object.keys(t),r=Object.keys(e);if(n.length!=r.length)return!1;for(let i=0;i<n.length;i++){let o=n[i];if(!e.hasOwnProperty(o)||t[o]!==e[o])return!1}return!0}function kve(t,e,n){let r=n.get(t);if(!r)return!1;let i=e.get(t);return i?r.forEach(o=>i.add(o)):e.set(t,r),n.delete(t),!0}var o_=class{constructor(e,n,r){this._driver=n,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(i,o)=>{},this._transitionEngine=new x$(e.body,n,r),this._timelineEngine=new S$(e.body,n,r),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(e,n,r,i,o){let s=e+"-"+i,a=this._triggerCache[s];if(!a){let l=[],c=[],u=Gve(this._driver,o,l,c);if(l.length)throw Tot(i,l);c.length&&void 0,a=fst(i,u,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(n,i,a)}register(e,n){this._transitionEngine.register(e,n)}destroy(e,n){this._transitionEngine.destroy(e,n)}onInsert(e,n,r,i){this._transitionEngine.insertNode(e,n,r,i)}onRemove(e,n,r){this._transitionEngine.removeNode(e,n,r)}disableAnimations(e,n){this._transitionEngine.markElementAsDisabled(e,n)}process(e,n,r,i){if(r.charAt(0)=="@"){let[o,s]=Eve(r),a=i;this._timelineEngine.command(o,n,s,a)}else this._transitionEngine.trigger(e,n,r,i)}listen(e,n,r,i,o){if(r.charAt(0)=="@"){let[s,a]=Eve(r);return this._timelineEngine.listen(s,n,a,o)}return this._transitionEngine.listen(e,n,r,i,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function Dst(t,e){let n=null,r=null;return Array.isArray(e)&&e.length?(n=u$(e[0]),e.length>1&&(r=u$(e[e.length-1]))):e instanceof Map&&(n=u$(e)),n||r?new Ist(t,n,r):null}var Ist=(()=>{let e=class e{constructor(r,i,o){this._element=r,this._startStyles=i,this._endStyles=o,this._state=0;let s=e.initialStylesByElement.get(r);s||e.initialStylesByElement.set(r,s=new Map),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&qu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(qu(this._element,this._initialStyles),this._endStyles&&(qu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(i0(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(i0(this._element,this._endStyles),this._endStyles=null),qu(this._element,this._initialStyles),this._state=3)}};e.initialStylesByElement=new WeakMap;let t=e;return t})();function u$(t){let e=null;return t.forEach((n,r)=>{Ast(r)&&(e=e||new Map,e.set(r,n))}),e}function Ast(t){return t==="display"||t==="position"}var fk=class{constructor(e,n,r,i){this.element=e,this.keyframes=n,this.options=r,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let n=()=>this._onFinish();this.domPlayer.addEventListener("finish",n),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",n)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let n=[];return e.forEach(r=>{n.push(Object.fromEntries(r))}),n}_triggerWebAnimation(e,n,r){return e.animate(this._convertKeyframesToObject(n),r)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((r,i)=>{i!=="offset"&&e.set(i,this._finished?r:jve(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){let n=e==="start"?this._onStartFns:this._onDoneFns;n.forEach(r=>r()),n.length=0}},mk=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,n){return!1}containsElement(e,n){return Lve(e,n)}getParentElement(e){return D$(e)}query(e,n,r){return Hve(e,n,r)}computeStyle(e,n,r){return window.getComputedStyle(e)[n]}animate(e,n,r,i,o,s=[]){let a=i==0?"both":"forwards",l={duration:r,delay:i,fill:a};o&&(l.easing=o);let c=new Map,u=s.filter(f=>f instanceof fk);qot(r,i)&&u.forEach(f=>{f.currentSnapshot.forEach((p,g)=>c.set(g,p))});let d=Got(n).map(f=>i_(f));d=Kot(e,d,c);let h=Dst(e,d);return new fk(e,d,l,h)}};var ik="@",Kve="@.disabled",pk=class{constructor(e,n,r,i){this.namespaceId=e,this.delegate=n,this.engine=r,this._onDestroy=i,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,n){this.delegate.appendChild(e,n),this.engine.onInsert(this.namespaceId,n,e,!1)}insertBefore(e,n,r,i=!0){this.delegate.insertBefore(e,n,r),this.engine.onInsert(this.namespaceId,n,e,i)}removeChild(e,n,r){this.engine.onRemove(this.namespaceId,n,this.delegate)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,r,i){this.delegate.setAttribute(e,n,r,i)}removeAttribute(e,n,r){this.delegate.removeAttribute(e,n,r)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,r,i){this.delegate.setStyle(e,n,r,i)}removeStyle(e,n,r){this.delegate.removeStyle(e,n,r)}setProperty(e,n,r){n.charAt(0)==ik&&n==Kve?this.disableAnimations(e,!!r):this.delegate.setProperty(e,n,r)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,r){return this.delegate.listen(e,n,r)}disableAnimations(e,n){this.engine.disableAnimations(e,n)}},b$=class extends pk{constructor(e,n,r,i,o){super(n,r,i,o),this.factory=e,this.namespaceId=n}setProperty(e,n,r){n.charAt(0)==ik?n.charAt(1)=="."&&n==Kve?(r=r===void 0?!0:!!r,this.disableAnimations(e,r)):this.engine.process(this.namespaceId,e,n.slice(1),r):this.delegate.setProperty(e,n,r)}listen(e,n,r){if(n.charAt(0)==ik){let i=Mst(e),o=n.slice(1),s="";return o.charAt(0)!=ik&&([o,s]=Ost(o)),this.engine.listen(this.namespaceId,i,o,s,a=>{let l=a._data||-1;this.factory.scheduleListenerCallback(l,r,a)})}return this.delegate.listen(e,n,r)}};function Mst(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}function Ost(t){let e=t.indexOf("."),n=t.substring(0,e),r=t.slice(e+1);return[n,r]}var gk=class{constructor(e,n,r){this.delegate=e,this.engine=n,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,n.onRemovalComplete=(i,o)=>{let s=o?.parentNode(i);s&&o.removeChild(s,i)}}createRenderer(e,n){let r="",i=this.delegate.createRenderer(e,n);if(!e||!n?.data?.animation){let c=this._rendererCache,u=c.get(i);if(!u){let d=()=>c.delete(i);u=new pk(r,i,this.engine,d),c.set(i,u)}return u}let o=n.id,s=n.id+"-"+this._currentId;this._currentId++,this.engine.register(s,e);let a=c=>{Array.isArray(c)?c.forEach(a):this.engine.registerTrigger(o,s,e,c.name,c)};return n.data.animation.forEach(a),new b$(this,s,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,n,r){if(e>=0&&e<this._microtaskId){this._zone.run(()=>n(r));return}let i=this._animationCallbacksBuffer;i.length==0&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{let[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),i.push([n,r])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var Pst=(()=>{let e=class e extends o_{constructor(r,i,o,s){super(r,i,o)}ngOnDestroy(){this.flush()}};e.\u0275fac=function(i){return new(i||e)(kt(ci),kt(MT),kt(o0),kt(Jc))},e.\u0275prov=ht({token:e,factory:e.\u0275fac});let t=e;return t})();function kst(){return new lk}function Fst(t,e,n){return new gk(t,e,n)}var Xve=[{provide:o0,useFactory:kst},{provide:o_,useClass:Pst},{provide:$m,useFactory:Fst,deps:[YD,o_,nr]}],Lst=[{provide:MT,useFactory:()=>new mk},{provide:Q2,useValue:"BrowserAnimations"},...Xve],Ein=[{provide:MT,useClass:I$},{provide:Q2,useValue:"NoopAnimations"},...Xve];function Zve(){return[...Lst]}var Qve=(()=>{let e=class e{constructor(r){this.service=r}intercept(r,i){return this.service.isLoading$.next(!0),i.handle(r).pipe(kr(o=>{o.type===tu.Response&&(this.service.isLoading$.next(!1),console.log(r.url,"returned a response with status",o.status))}))}};e.\u0275fac=function(i){return new(i||e)(kt(ui))},e.\u0275prov=ht({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Jve={providers:[Bq(_ve),XY(QY(),ZY()),Zve(),{provide:QL,useClass:Qve,multi:!0},{provide:yd,useClass:VL}]};var ewe=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=jt({type:e,selectors:[["app-spinner"]],standalone:!0,features:[qt],decls:2,vars:0,consts:[[1,"overlay"],["role","status",1,"spinner-border"]],template:function(i,o){i&1&&(W(0,"div",0),at(1,"div",1),V())},styles:[".overlay[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background:rgba(0,0,0,.333);position:absolute;width:100%;z-index:999}.spinner-border[_ngcontent-%COMP%]{width:6rem;height:6rem}"]});let t=e;return t})();function Hst(t,e){if(t&1){let n=Fn();W(0,"ngb-toast",0),Ue("hidden",function(){let o=mt(n).$implicit,s=Le();return pt(s.toastService.remove(o))}),W(1,"div"),re(2),V()()}if(t&2){let n=e.$implicit;eC(n.classname),lt("autohide",!0)("delay",n.delay||5e3),Te(2),Hn(n.template)}}var twe=(()=>{let e=class e{constructor(r){this.toastService=r}};e.\u0275fac=function(i){return new(i||e)(je(lo))},e.\u0275cmp=jt({type:e,selectors:[["app-toast"]],hostAttrs:[1,"toast-container","position-fixed","top-0","end-0","p-3",2,"z-index","1200"],standalone:!0,features:[qt],decls:2,vars:0,consts:[[3,"autohide","delay","hidden"],[3,"class","autohide","delay"]],template:function(i,o){i&1&&Gn(0,Hst,3,5,"ngb-toast",1,tC),i&2&&zn(o.toastService.toasts)},dependencies:[iX,rX]});let t=e;return t})();function Vst(t,e){t&1&&at(0,"app-spinner")}var nwe=(()=>{let e=class e{constructor(r){this.service=r,this.isLoading=!1}ngOnInit(){this.service.isLoading$.subscribe(r=>this.isLoading=r)}};e.\u0275fac=function(i){return new(i||e)(je(ui))},e.\u0275cmp=jt({type:e,selectors:[["app-root"]],standalone:!0,features:[qt],decls:3,vars:1,template:function(i,o){i&1&&(at(0,"app-toast"),rn(1,Vst,1,0,"app-spinner"),at(2,"router-outlet")),i&2&&(Te(1),rr(1,o.isLoading?1:-1))},dependencies:[Mo,ep,ewe,twe]});let t=e;return t})();oq(nwe,Jve).catch(t=>console.error(t));
